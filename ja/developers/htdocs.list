<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<!-- Copyright (c) 1994-2003
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.ORG">
<title>Editing htdocs</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<DEVHEADING>Editing htdocs

This is intended to become a reference for those wishing to edit htdocs
(the CVS repository for the NetBSD web server).

<LIST>

<h2>Related documentation</h2>

<ul>
  <li><a href="announce.html">News story guidelines</a>
  <li><a href="translate.html">Translating htdocs</a>
</ul>

<SECTION>General notes on htdocs

<ENTRY>who-can-edit Who can edit htdocs
    Anyone with write access to the NetBSD CVS tree can checkout
    htdocs and make changes, and in fact is encouraged to do so.
    In particular as developers add features and drivers they should
    update the appropriate hardware or port homepage. Use your
    netbsd.org login against cvs.netbsd.org and checkout 'htdocs'.

<ENTRY>what-is-required What is required to edit htdocs
    <ul>
    <li>Read <a href="cvs-repos/cvs_intro.html">the CVS introduction</a>.
    <li>Install <PKGSRC>security/ssh, <PKGSRC>devel/cvs, and ideally
	<PKGSRC>lang/perl5 (for .list and similar files).
    <li>Set your CVSROOT as indicated and '<tt><b>cvs get htdocs</b></tt>.
	(you can get checkout just part of the tree, but it is usually easier
	to work on the entire tree).
    <li>Edit your preferred file, type <tt><b>make</b></tt> if you need to
	regenerate any .html files, <PKGSRC>www/weblint any updated .html
	files, and <tt><b>cvs commit</b></tt>.
    </ul>

<ENTRY>validate-html Validate your HTML
    After making any changes you should run your html through an HTML
    verifier such as <PKGSRC>www/weblint, or better still <a
    href="http://validator.w3.org/">http://validator.w3.org/</a>.
    The URL for a link to an index.html file should not include the
    trailing index.html.
    If you use weblint you may want to add the following to your
    <tt>~/.weblintrc</tt>.
    <pre>	extension Netscape</pre>

<ENTRY>dotlist-files What are .list files, and how to use them
    A <tt>.list</tt> file contains standard HTML with additional special
    tags to simplify formatting. It is processed by <tt><a
    href="../list2html.pl">list2html.pl</a></tt> into the desired .html
    file.
    <p>
    There should be a Makefile in each directory which handles processing
    the .list files into .html, and will recurse into any subdirs
    containing Makefiles.
    <p>
    Continuation lines are understood (useful for the special tags).
    <p>
    If you do not have CVS access and wish to submit changes, you
    can check out htdocs via anonymous CVS (see the <a
    href="cvs-repos/cvs_intro.html">NetBSD CVS HOWTO</a>). The best
    approach is usually to:
    <ol>
	<li>Checkout the <em>htdocs</em> module<br>
	    <tt>'<b>cvs checkout htdocs</b>'</tt>
	<li>Edit the desired file. Most FAQ-style documents are
	    generated from <tt>.list</tt> files, so it is best to check
	    before editing.
	<li>Run 'make' if you have edited .list or similar files.
	<li><a href="#validate-html">Validate</a> the HTML. (Repeat
	    these three steps as necessary).
	<li>Submit a diff to <www@netbsd.org> using <b>cvs diff</b>, eg.<br>
	    <tt>'<b>cvs diff -u <em>htdocs/path/to/file.list</em></b>'</tt>
    </ol>
    <p>
    You should run <b>make</b> before committing. You will need
    <PKGSRC>lang/perl5 installed.

<p>

<center>

<table border=0 cellpadding=1 cellspacing=0><tr><td bgcolor="#d8d8d8">

<table border=0 cellpadding=4 cellspacing=0 width="550"><tr>

<td colspan=2 align=right bgcolor="#f5f5f5"><big><b>Compulsory
tags&nbsp;</b></big></td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;LIST&gt;:</b></td>
<td>Include generated list of entries here.</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;SECTION&gt;Text:</b></td>
<td>Introduces new section, before DATE or ENTRY</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;/LIST&gt;:</b></td>
<td>Tag for end of all special entries<br>&nbsp;<br></td>
</tr><tr>

<td colspan=2 align=right bgcolor="#f5f5f5"><big><b>Optional
tags&nbsp;</b></big></td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;DATE&gt;tag&nbsp;date&nbsp;Text:</b></td>
<td>Changes entry, expanded to title & added to list</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;ENTRY&gt;tag Text:</b></td>
<td>Text expanded to entry title and added to list</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;LISTLINK&gt;url Text:</b></td>
<td>Link added to TOC, removed from main text</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;ENTRYLINK&gt;url Text:</b></td>
<td>Link added to list and main text</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;HEADING&gt;Text:</b></td>
<td>Standard heading at top of document</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;DEVHEADING&gt;Text:</b></td>
<td>Standard heading at top of developer docs</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;TROW&gt;Text: Text:</b></td>
<td>Table row, with two text fields - <b>Note: &lt;TROW&gt; will
automatically continue until a line containing &lt;/table&gt;</b></td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;HOMELINK&gt;:</b></td>
<td>Standard flag link to home page at base of document</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;DOCLINK&gt;:</b></td>
<td>Standard flag links to home page and Documentation top level at base
of document</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;DEVLINK&gt;:</b></td>
<td>Standard flag links to home page and Developers Documentation at base
of document</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;PORTLINK&gt;:</b></td>
<td>Standard flag links to home page and Supported Architectures top level
at base of document</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>&lt;GALLINK&gt;:</b></td>
<td>Standard flag links to home page and Gallery page at base of document<br>
&nbsp;<br></td>
</tr><tr>

<td colspan=2 align=right bgcolor="#f5f5f5"><big><b>Additional pattern
matches&nbsp;</b></big></td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>man pages:</b></td>
<td>([a-zA-Z_][-\w.+]*[\w+])\((\d)(|\.(\w+))(|\+(\W+))\)<br>eg: ls(1)<p>
<i>Note: Can also handle specific architectures and collections</i><br>
eg: (8.pmax), (8+1.4.3), (8.pmax+1.4.3)<p>
<i>Default collection is NetBSD-current.  Available collections are:
"1.3.3", "1.4.3", "1.5", "1.5.1", "current".</i></td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>email addresses:</b></td>
<td>&lt;([-\w.]+@[-\w.]+)&gt;<br>eg: <abs@netbsd.org></td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>pkgsrc references:</b></td>
<td>&lt;PKGSRC&gt;((\w+/|)([^\s&lt;&gt;]+\w))<br>
eg: <PKGSRC>editors/vilearn</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>-current source:</b></td>
<td>&lt;CURRENTSRC&gt;(path)<br>eg: <CURRENTSRC>Makefile<p>
<em>Note: Works with files or directories</em></td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>literal URLs:</b></td>
<td>&lt;URL&gt;(url)<br>eg: <URL>http://www.netbsd.org/</td>
</tr><tr bgcolor="#ffffff">

<td align=right valign=top><b>RFCs:</b></td>
<td>&lt;RFC&gt;([^\s<>]+\w)<br>eg: <RFC>RFC2795</td>

</tr></table>

</td></tr></table>

</center>

<ENTRY>moving-files Renaming or moving files

In order to move or rename files within htdocs, the following procedure is
recommended:

<ul>
 <li>copy the file from the original location to new location</li>
 <li>modify html of the original file:
   <ul>
     <li>include a
         <code>&lt;META HTTP-EQUIV=Refresh CONTENT="5; URL=new-location"&gt;</code>
         tag in the header</li>
     <li>remove all content except the header and the footer</li>
     <li>add a sentence saying that the page moved and hyperlink it to the new
         location</li>
   </ul>
  <li>cvs add the new file</li>
  <li>cvs commit the new file and the changes of the old file at the same
      time, so we have some cvs reference of when and why things moved</li>
</ul>

<ENTRY>flaglinks What is the reasoning behind the flag links with empty.gif?
    Each NetBSD 'flag' links at the base of each page has:
    <ul>
    <li>href containing netbsd-banner with no alt tag
    <li>href containing empty gif with "NetBSD" alt tag and the
        words "Home Page"
    </ul>
    This has the effect of:
    <ul>
    <li>Making the "NetBSD Home Page" link a single link in lynx,
	i.e. not a NetBSD link and a Home Page link.
    <li>In netscape, causing the additional text to be centered and
        aligned "better" w.r.t the graphic.  Without it, at least
        in netscape, they show up at the bottom not centered
        vertically, and abut the graphic (or, if you include spaces,
        include nasty underlined blanks which looks broken to me).
    </ul>
    It's a grotty hack, but it makes things look right.

<ENTRY>webserver How do the pages get to the web server, and when?
    The NetBSD webpages are stored in CVS in the "htdocs" repository.
    For security reasons, the htdocs repository is copied (via rsync)
    to www.netbsd.org each hour, and the a local checkout is done from
    that copy of the repository. The checked out tree can be found in
    "<tt>/NetBSD-www</tt>". The repository is updated and checked out
    every hour, about 40 minutes after the full hour (*:40). If you
    make a commit to htdocs, it will take up to an hour before the
    changes show up.
    <p>

    Note that there are several files like the Gnats database
    (<URL>http://www.netbsd.org/Gnats/), the pkgsrc and source changes
    in Changes/changes*.html and Changes/pkg-changes*.html, the RSS
    files in Changes/rss-*.xml etc. that are not part of htdocs but
    that get generated by various scripts out of cron jobs directly on
    the web server. Check out "htutils/changes/*" to get access to the
    scripts.
    <p>

<SECTION>Adding to specific areas

<ENTRY>adding-gallery-entries Adding to the 'Sites running NetBSD' gallery
If you have a <tt>NETBSD GALLERY ADDITION</tt> email from the <a
href="../gallery/addsite.html">htdocs/gallery/addsite.html</a> page:
<ol>
<li>Ensure you have perl installed
<li>Save the message in your copy/paste buffer 
<li><tt>cd htdocs/gallery</tt>
<li><tt>./addsite.pl</tt>, paste the buffer, add a ^D, and answer '<tt>y</tt>' if it parsed OK.
<li><tt>cvs commit</tt>
</ol>
Alternatively you can manually edit <tt>htdocs/gallery/sites.data</tt>, and
run <tt>make</tt>.

<ENTRY>adding-news-items Adding news items
Most news items go into <a
href="../Changes/">htdocs/Changes/index.list</a> (see note on
<a href="#dotlist-files">.list files</a>).  Changes affecting a
specific port should also be linked to from their htdocs/Port/*/ news section.
<p>
Important code news items should also be noted in the text
<CURRENTSRC>doc/CHANGES
file.

<p>
<h4>Before you do anything with htdocs:</h4>
<ol>
<li>Ensure you have perl installed for the <a href="#dotlist-files">.list
    files</a>.
<li>Check out <tt>htdocs</tt> from the CVS repository.
</ol>

<p>
<h4>To add a change entry:</h4>
<ol>
<li>Edit htdocs/Changes/index.list and search for the first line
    starting &lt;DATE&gt;.
<li>Insert a new line of the form<br>
    <tt>&lt;DATE&gt;<em>tag</em> <em>date</em> - <em>title</em></tt><br>
    where
    <ul>
    <li><em>tag</em> - A lowercase/number/hyphen identifier. eg: 'new-xx-driver'
    <li><em>date</em> - In the form DAY MONTH YEAR. eg: '23 Jan 1999'
    <li><em>title</em> - Freeform text for the entry title - can use \ to
	escape the end of line.
    </ul>
<li>Add the body of the item. manual pages (eg: ls(1)), and email
    addresses (eg: <user@domain>) will be automatically expanded. Feel
    free to use HTML tags, though this is not compulsory.
<li>Run '<tt>make</tt>'
</ol>

<p>
<h4>Adding links from the main pages:</h4>
By running <tt>make</tt> from within htdocs/Changes, you will automatically 
update <a href="../">htdocs/index.html</a> and the index pages of all supported
translations.  No further action on your part is required.
<p>
Alternatively, you can run <tt>make index</tt> from the htdocs toplevel
directory.
<p>
<h4>If you want to add a link from a port specific page:</h4>
<ol>
<li>Edit htdocs/Ports/<em>arch</em>/index.html, and search for the
    '&lt;!-- news --&gt;' block.
<li>Add a new entry to the subsequent list in the form:
<pre>&lt;dt&gt;&lt;b&gt;<em>date</em>:&lt;/b&gt; <em>title</em>
    &lt;dd&gt;<em>body of item</em>
    &lt;p&gt;</pre>
    where
    <ul>
    <li><em>date</em> - Normally as YEAR.MONTH.DATE
    <li><em>title</em> - Freeform (short) text title
    <li><em>body of item</em> - Freeform text for the entry. Can span mutltiple
	lines and may use HTML tags and links.
    </ul>
</ol>

<p>
<h4>Finally:</h4>
<ol>
<li>You may want to <a href="#validate-html">validate the HTML</a> in
    your modified files.
<li>Check in the files - do not forget any <tt>.list</tt> files will
    update the matching <tt>.html</tt>.  The command 'make commit', when
	issued from the htdocs toplevel directory, will commit the main
	index-page, Changes/index.* and all the translations index pages with
	a default message of "NEWS; regen".  If you would like to add a more
	specific message, use 'MSG="Added News regarding FooBar" make
	commit'.</li>
</ol>

<ENTRY>adding-events Adding Events

The main index page also contains links to "Upcoming Events".  These links are
updated much like the <a href="#adding-news-items">News entries</a>:

<ul>
	<li>cd .../htdocs/gallery</li>
	<li>$EDITOR events.list</li>
	<li>make events</li>
</ul>

Since the events are included on all the translations index pages, all these
pages need to be generated and committed as well.  This can be achieved by
issuing the 'make index' command from the htdocs directory.	

<ul>
	<li>cd .../htdocs</li>
	<li>make index</li>
	<li>MSG="Added Event Foo" make commit</li>
</ul>

<ENTRY>adding-mailinglists Adding to/editing the MailingLists page 
If a mailing-list is missing from the
<a href="../MailingLists/">MailingLists</a> page:
<ol>
<li>Edit the htdocs/MailingLists/index.m4 file
<li>Run the makefile in htdocs/MailingLists, it will generate the index.html
<li>Confirm the generated html is good.
<li>commit the index.m4 and index.html files.
</ol>

<ENTRY>consultants Consultants for hire

Before adding an entry to the ``Consultants for hire'' page (<a
href="../gallery/consultants.html">gallery/consultants.html</a>), please ask
that the person in question provides a link back to our homepage and/or
mentions NetBSD on their website.  Needless to say that you should make sure
that the URL given is active and accessible.

</LIST>

<DEVLINK>

<hr>
<address>
  <small>
  <a href="../Misc/feedback.html">(Contact us)</a>
  $NetBSD: htdocs.list,v 1.54 2003/02/01 04:44:33 jschauma Exp $<br>
  <a href="../Misc/disclaimer.html">Copyright &copy; 1994-2003
  The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
