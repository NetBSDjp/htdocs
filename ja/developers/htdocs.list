<html>
<head>
<!-- Copyright (c) 1996, 1997, 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.ORG">
<title>Editing htdocs</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<table>
<tr><td width=150><img src="../images/NetBSD-banner.gif" alt="NetBSD"></td>
<td valign=bottom><h2>Editing htdocs</h2></td></tr>
</table>

<p>
This is intended to become a reference for those wishing to edit htdocs
(the CVS repository for the NetBSD web server).
</p>

<LIST>

<SECTION>General notes on htdocs

<ENTRY>who-can-edit Who can edit htdocs
    Anyone with write access to the NetBSD CVS tree can checkout
    htdocs and make changes, and in fact is encouraged to do so.
    In particular as developers add features and drivers they should
    update the appropriate hardware or port homepage. Use your
    netbsd.org login against cvs.netbsd.org and checkout 'htdocs'.

<ENTRY>what-is-required What is required to edit htdocs
    <ul>
    <li>Read <a href="cvs-repos/cvs_intro.html">the CVS introduction</a>.
    <li>Install <PKGSRC>security/ssh, <PKGSRC>devel/cvs, and ideally
	<PKGSRC>lang/perl5 (for .list and similar files).
    <li>Set your CVSROOT as indicated and '<tt><b>cvs get htdocs</b></tt>.
	(you can get checkout just part of the tree, but it is usually easier
	to work on the entire tree).
    <li>Edit your preferred file, type <tt><b>make</b></tt> if you need to
	regenerate any .html files, <PKGSRC>www/weblint any updated .html
	files, and <tt><b>cvs commit</b></tt>.
    </ul>

<ENTRY>validate-html Validate your HTML
    After making any changes you should run your html through an HTML
    verifier such as <PKGSRC>www/weblint, or better still <a
    href="http://validator.w3.org/">http://validator.w3.org/</a>.
    The URL for a link to an index.html file should not include the
    trailing index.html.
    If you use weblint you may want to add the following to your
    <tt>~/.weblintrc</tt>.
    <pre>	extension Netscape</pre>

<ENTRY>dotlist-files What are .list files, and how to use them
    A <tt>.list</tt> file contains standard HTML with additional special
    tags to simplify formatting. It is processed by <tt><a
    href="../list2html.pl">list2html.pl</a></tt> into the desired .html
    file.
    <p>
    There should be a Makefile in each directory which handles processing
    the .list files into .html, and will recurse into any subdirs
    containing Makefiles.
    <p>
    Continuation lines are understood (useful for the special tags).
    <p>
    If you do not have CVS access and you wish to submit changes to a
    <tt>.list</tt> file the best approach is usually to:
    <ol>
	<li>Download <tt><a href="../list2html.pl">list2html.pl</a></tt>
	<li>Download the appropriate <tt>.list</tt> file from <a
	    href="http://www.netbsd.org/">www.netbsd.org</a>.  This
	    can be accomplished by going to the matching .html file
	    and then replacing the .html with .list in the URL.
	    It should be noted that most non FAQ documents do not
	    have a .list file.  If you're not sure, look at the
	    top of the source for a line indicating if the .html
	    file was auto generated by a .list or similar file.
	<li>Copy the <em>file</em>.list to <em>file</em>.list.orig.
	<li>Edit <em>file</em>.list.
	<li>Run './list2html.pl <em>file</em>.list <em>file</em>.html
	<li><a href="#validate-html">Validate</a> the HTML. (Repeat
	    these three steps as necessary).
	<li>Submit a diff using diff(1)<br>
	    <tt>'<b>diff -u <em>file</em>.list.orig
	    <em>file</em>.list</b>'</tt>.
    </ol>
    <p>
    You should run make before committing.  You will need
    <PKGSRC>lang/perl5 installed.

<p>
<table>
<tr><th colspan=2>Compulsory tags</th></tr>
<TROW>&lt;LIST&gt;:             Include generated list of entries here.
<TROW>&lt;SECTION&gt;Text:      Introduces new section, before DATE or ENTRY
<TROW>&lt;/LIST&gt;:            Tag for end of all special entries
<tr><th colspan=2>Optional tags</th></tr>
<TROW>&lt;DATE&gt;tag date Text: Change entry, expanded to title & added to list
<TROW>&lt;ENTRY&gt;tag Text:    Text expanded to entry title and added to list
<TROW>&lt;ENTRYLINK&gt;url Text: Link added to list, removed from main text
<TROW>&lt;HEADING&gt;Text:      Standard heading at top of document
<TROW>&lt;TROW&gt;Text: Text:   Table row, with two text fields - <b>Note:
				&lt;TROW&gt; will automatically continue
				until a line containing &lt;/table&gt;</b>
<TROW>&lt;HOMELINK&gt;:		Standard flag link to home page at base
				of document
<TROW>&lt;DOCLINK&gt;:		Standard flag links to home page and
				Documentation top level at base of document
<TROW>&lt;DEVLINK&gt;:		Standard flag links to home page and
				developers Documentation at base of document
</table>
<p>
Additional pattern matches:<br>
<table>
<tr><th align=left>man pages</th>
    <td>([a-zA-Z_][-\w.+]*[\w+])\((\d)\)</td><td>eg: ls(1)</td></tr>
<tr><th align=left>email addresses</th>
    <td>&lt;([-\w.]+@[-\w.]+)&gt;</td><td>eg: <abs@netbsd.org></td></tr>
<tr><th align=left>packagesrc references</th>
    <td>&lt;PKGSRC&gt;((\w+/|)([^\s&lt;&gt;]+\w))</td>
    <td>eg: <PKGSRC>editors/vilearn</td></tr>
<tr><th align=left>-current source files or dirs</th>
    <td>&lt;CURRENTSRC&gt;(path)</td>
    <td>eg: <CURRENTSRC>Makefile</td></tr>
<tr><th align=left>literal URLs</th>
    <td>&lt;URL&gt;(url)</td>
    <td>eg: <URL>http://www.netbsd.org/</td></tr>
</table>

<ENTRY>flaglinks What is the reasoning behind the flag links with empty.gif?
    Each NetBSD 'flag' links at the base of each page has:
    <ul>
    <li>href containing netbsd-banner with no alt tag
    <li>href containing empty gif with "NetBSD" alt tag and the
        words "Home Page"
    </ul>
    This has the effect of:
    <ul>
    <li>Making the "NetBSD Home Page" link a single link in lynx,
	i.e. not a NetBSD link and a Home Page link.
    <li>In netscape, causing the additional text to be centered and
        aligned "better" w.r.t the graphic.  Without it, at least
        in netscape, they show up at the bottom not centered
        vertically, and abut the graphic (or, if you include spaces,
        include nasty underlined blanks which looks broken to me).
    </ul>
    It's a grotty hack, but it makes things look right.

<SECTION>Adding to specific areas

<ENTRY>adding-gallery-entries Adding to the 'Sites running NetBSD' gallery
If you have a <tt>NETBSD GALLERY ADDITION</tt> email from the <a
href="../gallery/addsite.html">htdocs/gallery/addsite.html</a> page:
<ol>
<li>Ensure you have perl installed
<li>Save the message to a <tt><em>file</em></tt>
<li><tt>cd htdocs/gallery</tt>
<li><tt>./addsite.pl &lt <em>file</em></tt>, and answer '<tt>y</tt>' if OK.
<li><tt>cvs commit</tt>
</ol>
Alternatively you can manually edit <tt>htdocs/gallery/sites.data</tt>, and
run <tt>make</tt>.

<ENTRY>adding-news-items Adding news items
Most news items go into <a
href="../Changes/">htdocs/Changes/</a> (see note on
<a href="#dotlist-files">.list files</a>). Important changes should
also get a link from the main <a
href="../">htdocs/</a>, and changes affecting a
specific port's from their htdocs/Port/*/ news section.
<p>
Important code news items should also be noted in the text
<CURRENTSRC>doc/CHANGES
file.

<p>
<h4>Before you do anything with htdocs:</h4>
<ol>
<li>Ensure you have perl installed for the <a href="#dotlist-files">.list
    files</a>.
<li>Check out <tt>htdocs</tt> from the CVS repository.
</ol>

<p>
<h4>To add a change entry:</h4>
<ol>
<li>Edit htdocs/Changes/index.list and search for the first line
    starting &lt;DATE&gt;.
<li>Insert a new line of the form<br>
    <tt>&lt;DATE&gt;<em>tag</em> <em>date</em> - <em>title</em></tt><br>
    where
    <ul>
    <li><em>tag</em> - A lowercase/number/hyphen identifier. eg: 'new-xx-driver'
    <li><em>date</em> - In the form DAY MONTH YEAR. eg: '23 Jan 1999'
    <li><em>title</em> - Freeform text for the entry title - can use \ to
	escape the end of line.
    </ul>
<li>Add the body of the item. manual pages (eg: ls(1)), and email
    addresses (eg: <user@domain>) will be automatically expanded. Feel
    free to use HTML tags, though this is not compulsory.
<li>Run '<tt>make</tt>'
</ol>

<p>
<h4>If you want to add a link from the main page:</h4>
<ol>
<li>Edit <a
    href="../">htdocs/</a>, and search for the
    'Breaking news' block, containing items of the form
<pre>    &lt;li&gt;&lt;i&gt;&lt;a href="Changes/#<em>tag</em>"&gt;
	<em>title</em>&lt;/a&gt;&lt;/i&gt;&lt;/li&gt;</pre>
<li>Move the last two lines to the top of the block and update the <em>tag</em>
    and <em>title</em> to match your new entry (may want to abbreviate the
    <em>title</em>).
</ol>

<p>
<h4>If you want to add a link from a port specific page:</h4>
<ol>
<li>Edit htdocs/Ports/<em>arch</em>, and search for the
    '&lt!-- news' block.
<li>Add a new entry to the subsequent list in the form:
<pre>&lt;p&gt; &lt;dt&gt;&lt;b&gt;<em>date</em>:&lt;/b&gt; <em>title</em>
    &lt;dd&gt;<em>body of item</em></pre>
    where
    <ul>
    <li><em>date</em> - Normally as MONTH DAY YEAR
    <li><em>title</em> - Freeform (short) text title
    <li><em>body of text</em> - Freeform text for the entry. Can span mutltiple
	lines and may use HTML tags and links.
    </ul>
</ol>

<p>
<h4>Finally:</h4>
<ol>
<li>You may want to <a href="#validate-html">validate the HTML</a> in
    your modified files.
<li>Checkin the files - do not forget any <tt>.list</tt> files will
    update the matching <tt>.html</tt>.
</ol>

</LIST>

<a href="">Up to <em>Main developers page</em></a>
<hr> 

<DEVLINK>

<hr>
<address>
  <a href="../Misc/feedback.html">(Contact us)</a>
  $NetBSD: htdocs.list,v 1.22 2000/02/22 11:12:36 abs Exp $<br>
  <a href="../Misc/disclaimer.html">Copyright &copy;
    1996, 1997, 1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
</address>

</body>
</html>
