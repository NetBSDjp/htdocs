<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
<!-- Copyright (c) 1994-2003
        The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.org">
<title>NetBSD CVS HOWTO</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<h1><a name="top">NetBSD CVS HOWTO</a></h1>

<p><hr><em>
This document provides some basic information on using CVS with NetBSD.
</em><hr>
<p>
<h2><a name="toc1">1.</a> <a href="#s1">Introduction and Purpose</a></h2>
<ul>
<li><a href="#ss1.1">1.1 What is CVS?</a>
<li><a href="#ss1.2">1.2 Version History</a>
</ul>

<p>
<h2><a name="toc2">2.</a> <a href="#s2">Getting Started</a></h2>
<ul>
<li><a href="#ss2.1">2.1 Install CVS</a>
<li><a href="#ss2.2">2.2 Configure your environment for CVS</a>
<li><a href="#ss2.3">2.3 Make a directory for CVS work</a>
</ul>

<p>
<h2><a name="toc3">3.</a> <a href="#s3">Using CVS</a></h2>
<ul>
<li><a href="#ss3.1">3.1 An example</a>
<li><a href="#ss3.2">3.2 CVS modules</a>
<li><a href="#ss3.3">3.3 Importing a new package</a>
</ul>

<p>
<h2><a name="toc4">4.</a> <a href="#s4">Other Useful CVS Operations</a></h2>
<ul>
<li><a href="#ss4.1">4.1 CVS output</a>
</ul>

<p>
<h2><a name="toc5">5.</a> <a href="#s5">Other Sources of Information</a></h2>
<ul>
<li><a href="#ss5.1">5.1 NetBSD specific</a>
<li><a href="#ss5.2">5.2 CVS specific</a>
</ul>

<p>
Return to the <a href="#top">top</a>.
<p>

<hr>
<h1><a name="s1">1.</a> Introduction and Purpose</h1>
<hr>

<h2><a name="ss1.1">1.1</a> What is CVS?</h2>
   
<p>
CVS stands for Concurrent Versions System.  CVS is a "Source Control"
or "Revision Control" tool 
designed to keep track of source changes made by groups of
developers working on the same files, allowing them to
stay in sync with each other as each individual chooses.
In particular, CVS is the tool used by 
<a href="http://www.NetBSD.org/">The NetBSD Project</a> to manage its
source tree.
<p>
It is important to note that thanks to the "concurrent" part of CVS,
several people can work on things at the same time. There is no
locking of files as with RCS.


<h2><a name="ss1.2">1.2</a> Version History</h2>

<p>
<ul>
<li>August 29, 2003 - Updated to include regenerating developers.html.
<li>December 24, 2002 - update for CVS module reorganisation
<li>October 20, 2001 - href fix for importing packages
<li>March 24, 2001 - Updated to include regenerating supporting_cast.html.
<li>September 20, 1999 - HTML fixes to pass weblint, fixed some typos.
<li>August 30, 1999 - Added more information, fixed some typos.
<li>August 26, 1999 - Original HOWTO written by Dan McMahill
<a href="mailto:dmcmahill@NetBSD.org">&lt;dmcmahill@NetBSD.org&gt</a>
with lots of help from Hubert Feyrer
<a href="mailto:hubertf@NetBSD.org">&lt;hubertf@NetBSD.org&gt</a>
</li>
</ul>

<p>
Return to the <a href="#top">top</a>.
<p>

<hr>
<h1><a name="s2">2.</a> Getting Started</h1>
<hr>
<p>
This section shows the basic steps for installing CVS on your system.

<h2><a name="ss2.1">2.1</a> Install CVS</h2>
<p>
You need to install CVS on your local machine.  It is your machine
that you will do all your work on, not the CVS server.  If you don't
already have CVS installed on your machine, then install
<a
href="ftp://ftp.NetBSD.org/pub/NetBSD/packages/pkgsrc/devel/cvs/README.html">CVS</a>
from the
<a href="../../Documentation/software/packages.html">
package collection
</a>.

<h2><a name="ss2.2">2.2</a> Configure your environment for CVS</h2>
<p>
On your local machine that you plan to use CVS on, add the following
to your <code>.cshrc</code> file if you use 
<code>csh</code> or <code>tcsh</code> as your shell.
<p>
<pre>
    setenv CVSEDITOR vi
    setenv CVSROOT yourusername@cvs.NetBSD.org:/cvsroot
    setenv CVS_RSH ssh
</pre>
<p>
Add the following to your <code>.profile</code> file if you use
<code>sh</code> or <code>bash</code>.
<p>
<pre>
    CVSEDITOR=vi
    CVSROOT=yourusername@cvs.NetBSD.org:/cvsroot
    CVS_RSH=ssh
    export CVSEDITOR
    export CVSROOT
    export CVS_RSH
</pre>

<h2><a name="ss2.3">2.3</a> Make a directory for CVS work</h2>
<p>
I keep all my CVS related work in <code>/usr/cvs</code> on my machine,
but this is just personal preference.  In the rest of this document I
will assume that you have created a <code>/usr/cvs</code> directory
on your machine.  Once again, this is your local machine, not the CVS
server. 

<p>
Return to the <a href="#top">top</a>.
<p>

<hr>
<h1><a name="s3">3.</a> Using CVS</h1>
<hr>
<p>
This section shows the basic steps involved with using CVS.

<h2><a name="ss3.1">3.1</a> An Example</h2>
<p>This section shows how to start with an empty <code>/usr/cvs</code>
directory, add the <code>htdocs/People/</code> module, make a change and then 
commit the change.  The basic steps involved are:
<p>
<pre>
    cd /usr/cvs
    cvs checkout htdocs/People
    cd htdocs/People
    vi developers.xml
    make
    cvs ci developers.xml developers.html
</pre>
<p>
A more detailed explaination of these steps follows.
<p>
<pre>
    cvs checkout htdocs/People
</pre>
<p>
This line told CVS to check out the directory <code>"htdocs/People"</code>
to our local machine.  This means that the most recent version of the
files in <code>htdocs/People</code> are copied from the CVS server
to our local machine.  In addition, <code>CVS</code> directories were
created in <code>/usr/cvs</code>, <code>/usr/cvs/htdocs</code>, and 
<code>/usr/cvs/htdocs/People</code>.  It is important to keep in mind
that unlike a checkout in RCS, a CVS checkout doesn't lock the file.
IE, other developers can still access the checked out file.
<p>
Once we have checked out a directory to our local machine, we don't need 
to do a <code>cvs co</code>, or equivalently <code>cvs checkout</code>,
again for this directory.  If we want to update a previously checked out
directory to the most recent version, we would simply do, for example,
<code>cvs update htdocs/People</code>.
<p>
The next step after checking out the directory (or updating if we had
already checked out the desired module before) was to edit a file.
After all our edits were complete, we did:
<p>
<pre>
    make
</pre>
<p>
This regenerated the <code>developers.html</code> file from the <code>developers.xml</code>.  We then did:
<p>
<pre>
    cvs ci developers.xml developers.html
</pre>
<p>
This command uploaded our changes to the CVS server and updated the
RCS header in the files to reflect the new version.  When you checkin
(commit) a change, you will be prompted to enter a short description
of your changes.
<p>
It should be noted that within the source tree adding new entries and
regenerating files is normally done as two commits.


<h2><a name="ss3.2">3.2</a> CVS Modules</h2>
<p>
In CVS a module can refer to a single file, a directory with several
files, or even an entire directory tree.  
A list of <a href="modules.html"> NetBSD top level CVS modules</a>
details the top level CVS modules in the NetBSD tree. A couple of
other top level modules of particular interest are:

<dl>
  <dt><b>htdocs</b></dt>
  <dd>The NetBSD WWW pages.</dd>

  <dt><b>othersrc</b></dt>
  <dd>Related code that is not part of NetBSD itself.</dd>
</dl>

<p>
For each of the top level modules, you can check out (and later
update) the entire top level, or you can check out (and update) lower
level modules.  For example, to check out the entire
<code>htdocs</code> module, we would do:
<p>
<pre>
    cd /usr/cvs
    cvs checkout htdocs
</pre>
<p>
We could also only get the <code>htdocs/People</code> subdirectory
with
<p>
<pre>
    cd /usr/cvs
    cvs checkout htdocs/People
</pre>
<p>
In these examples, don't forget that you only need to check out a
module once.  For example, if you have already checked out the
<code>htdocs</code> module but want to bring it all up to date, you
would do:
<p>
<pre>
    cd /usr/cvs
    cvs update htdocs
</pre>

<h2><a name="ss3.3">3.3</a> Importing a new package</h2>
<p>
This section has a few supplements to the 
<a href="../pkgsrc/#import">Importing a
New Package</a> instructions.
<p>
Here is an example of adding a newly created  package.
<p>
This example assumes that your CVS stuff is kept in
<code>/usr/cvs</code> and <code>pkgsrc</code> is a subdirectory from
there.  The new package, <code>foo/bar</code> in this case, is in the
directory <code>/usr/cvs/pkgsrc/foo/bar.work</code>.  The steps to
import this package into the source tree are:
<pre>
    cd /usr/cvs/pkgsrc/foo/bar.work
    
    # do the usual testing, pkglint, etc. 
    # don't forget to do 'make makepatchsum' to generate the
    # files/patch-sum file.

    grep TNF /usr/pkgsrc/pkgsrc.txt

    # this command tells me the correct syntax for "cvs import". 
    # (/usr/pkgsrc is a symlink to /usr/cvs/pkgsrc).

    cvs import pkgsrc/foo/bar TNF pkgsrc-base 

    # note it's "bar", not "bar.work"

    cd ../../..
    cvs checkout pkgsrc/foo/bar 

    # this checks out the newly imported package to 
    # see if everything went ok

    cd pkgsrc/foo
    cvs update Makefile
    vi Makefile 
    
    # add bar to the pkgsrc/foo/Makefile

    cvs ci -m 'add & enable bar' Makefile

    # check in the changes to pkgsrc/foo/Makefile

    cd /usr/cvs/pkgsrc/doc
    cvs update CHANGES 

    # this makes sure you have the most up to date CHANGES

    vi CHANGES 

    # make a note of your changes to the foo/bar package

    cvs ci -m 'foo-17.42' CHANGES

    # check in CHANGES</pre>

<p>
Return to the <a href="#top">top</a>.
<p>


<hr>
<h1><a name="s4">4.</a> Other Useful CVS Operations</h1>
<hr>

<h2><a name="ss4.1">4.1</a> CVS output</h2>
<p>
When you perform various CVS tasks, you will see a list of each file
which is involved.  The filename will be preceeded with a single
letter code.  A quick summary of the letters is here:
<p>

<ul>
<li><b>U</b>pdated</li>
<li><b>P</b>atched</li>
<li><b>C</b>onflict</li>
<li><b>M</b>odified (locally)</li>
<li><b>A</b>dded</li>
<li><b>R</b>emoved</li>
<li><b>?</b> (not under CVS control)</li>
</ul>

<p>
Return to the <a href="#top">top</a>.
<p>

<hr>
<h1><a name="s5">5.</a> Other Sources of Information</h1>
<hr>

<h2><a name="ss5.1">5.1</a> NetBSD specific</h2>
<p>
<ul>
<li>pkgsrc <a href="../../Documentation/software/packages.html">home
page</a>.</li>
<li>Useful <a href="/developers/">NetBSD developers information</a>.</li>
<li>Complete 
<a href="../../Documentation/pkgsrc/">pkgsrc documentation</a>.</li>
</ul>
<p>

<h2><a name="ss5.2">5.2</a> CVS specific</h2>

<ul>
<li>The 
<a href="http://www.gnu.org/manual/cvs-1.9/html_mono/cvs.html">
CVS Manual</a>
<li>The <a href="cvs-faq.txt">CVS FAQ</a>
<li><a href="http://www.cyclic.com/">Cyclic Software</a>, the company
that maintains CVS
</ul>

<p>
Return to the <a href="#top">top</a>.
<p>

<hr> 

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../../"><img
        src="../../images/NetBSD-flag.gif" border="0"  
        width="91" height="42" alt=""></a>
  </td><td>
    <a href="../../"><img
        src="../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Home Page</a>
  </td></tr></table>
</td><td>
  <table><tr><td>
    <a href="../../developers/"><img
        src="../../images/NetBSD-flag.gif" border="0"  
        width="91" height="42" alt=""></a>
  </td><td>
    <a href="../../developers/"><img
        src="../../images/empty.gif" border="0"  
        width="1" height="1" alt="NetBSD ">Developer Documentation</a>      
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  <a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">(Contact us)</a>
  $NetBSD: cvs_intro.html,v 1.21 2003/08/29 10:54:20 keihan Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy; 1994-2003
  The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
