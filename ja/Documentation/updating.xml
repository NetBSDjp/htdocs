<?xml version="1.0" encoding="ISO-2022-JP"?>
<!DOCTYPE webpage
PUBLIC "-//NetBSD//DTD Website-based NetBSD Extension//EN"
"http://www.NetBSD.org/XML/htdocs/lang/share/xml/website-netbsd.dtd">

<webpage id="ja-Documentation-updating">
  <config param="desc" value="安定版 NetBSD リリースの更新" />
  <config param="cvstag"
  value="$NetBSD: updating.xml,v 1.9 2006/05/02 14:02:16 kano Exp $" />
  <!-- Based on english version: -->
  <!-- NetBSD: updating.xml,v 1.9 2006/05/02 14:02:16 kano Exp   -->
  <config param="rcsdate" value="$Date: 2006/05/02 14:02:16 $" />
  <head>
    <!-- Copyright (c) 2003-2006
           The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
    <title>安定版 NetBSD リリースの更新</title>
  </head>
  <sect1 role="toc" id="updating-stable">
    <sect2 id="top">

      <sect3 id="current">
        <title>-current を追跡する</title>
        <para>
          -current
          の追跡方法についての資料は、
          <ulink url="current/">この文書</ulink>をご覧ください。
        </para>
      </sect3>

      <sect3 id="update-src">
        <title>ソースを更新する</title>
        <para>
          安定版 (
          <ulink url="../Releases/formal-3.0/">NetBSD 3.0</ulink>
          など) の NetBSD リリースを、本番環境として使っている場合、
          そのリリース向けのセキュリティー上の修正を取り込むために、
          時々ソースを更新のうえシステムまたはカーネルを再構築すべきです。
       </para>

       <para> 
         リリース版のソースの再現や更新は、適切な枝タグを指定して、
         <ulink url="current/#using-anoncvs-over-ssh">anoncvs オーバー
          ssh</ulink>
          を使っておこなうことができます。
          たとえば、
          NetBSD 3.0 リリースのソースをチェックアウトするためには、
          以下のようにします:
        </para>
        <programlisting>
$ cd /usr
$ env CVS_RSH=ssh cvs -d anoncvs@anoncvs.NetBSD.org:/cvsroot co -r netbsd-3-0 -P src</programlisting>

	<note>
          間違ってソースツリーを<emphasis>ダウングレード</emphasis>することのないよう、
	  適切な意図通りの枝タグを選ぶように気を付けてください。
	</note>

        <para>既存のソースツリーを更新するには以下のようにします:</para>

        <programlisting>$ cd /usr/src
$ env CVS_RSH=ssh cvs update -dP</programlisting>

      </sect3>

      <sect3 id="kernel">
        <title>新しいカーネルを構築する</title>
        <para>
          新しいカーネルを構築する方法は、
          <ulink url="kernel/#how_to_build_a_kernel">この文書
          </ulink>
          で説明している方法とほぼ同じですが、
          <code>build.sh</code>
          スクリプトの書式が違うことにご注意ください。
          <code>build.sh</code>
          は、
          NetBSD 1.6 の後で、大幅に変わっています。(NetBSD &gt; 1.6 または
          -current を使っているのでなければ、
          カーネルの構築に
          <code>build.sh</code>
          は
          <emphasis>使えません</emphasis>。)
        </para>
      </sect3>

      <sect3 id="userland">
        <title>ユーザーランドを更新する</title>
        <para>かならず
          <code>build.sh -h</code>
          の説明を見て、詳細は
          <emphasis>UPDATING</emphasis>
          と
          <emphasis>BUILDING</emphasis>
          ファイルで確認するようにしてください─コマンドラインや
          <filename>/etc/mk.conf</filename>
          で指定できるオプションが<emphasis>たくさん</emphasis>あるので、
          これは重要なことです。
          結局は、単一のコマンドに要約されます:
          <code>build.sh distribution</code> (NetBSD 1.6 の場合は
          <code>build.sh -d</code>)
        </para>

        <para>
          これは、ユーザーランド
          <emphasis>すべて</emphasis>
          を更新することになるのに注意してください。
        </para>
      </sect3>

      <sect3 id="parts">
        <title>ソースツリーの一部だけを更新する</title>
        <para>
          セキュリティー勧告が発行され、
          再構築が必要となったライブラリーやアプリケーションだけを構築したい場合、
          最善の選択は、勧告に書かれた説明どおりにすることです。
          一例としては以下のようになります:
        </para>

        <programlisting>
$ cd src
$ env CVS_RSH=ssh cvs update -d -P -r netbsd-3-0 gnu/dist/sendmail/sendmail
$ cd gnu/usr.sbin/sendmail
$ make USETOOLS=no cleandir dependall
$ su
# make USETOOLS=no install</programlisting>

      </sect3>

      <sect3 id="summary">
        <title>簡潔なまとめ</title>
        <itemizedlist>
          <listitem>
            <para>ソースの更新:</para>
            <programlisting>
$ cd /usr/src
$ env CVS_RSH=ssh cvs update -dP</programlisting>

          </listitem>
          <listitem>
            <para>カーネルの再構築:</para>
            <programlisting>
$ cd /usr/src
$ ./build.sh kernel=&lt;KERNEL&gt;
$ su
# mv /netbsd /netbsd.old
# mv /usr/src/sys/arch/&lt;ARCH&gt;/compile/&lt;KERNEL&gt;/netbsd /</programlisting>
          </listitem>
          <listitem>
            <para>ユーザーランドの更新:</para>
            <programlisting>
$ cd /usr/src
$ ./build.sh -h
$ su
# ./build.sh &lt;optional arguments&gt; distribution</programlisting>
          </listitem>
        </itemizedlist>
      </sect3>

    </sect2>
  </sect1>
</webpage>
