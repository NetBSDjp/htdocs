<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<!-- Copyright (c) 1994-2004
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<!--
  ==  created by Jun-ichiro itojun Hagino
  -->
<link rev="made" href="mailto:www@NetBSD.org">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<title>NetBSD Mirror FAQ</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<HEADING>NetBSD Mirror FAQ

<LIST>

<SECTION>FTP Mirror FAQ

<ENTRY>ftp-overview Overview for setting up a NetBSD FTP Mirror
The basic steps for setting up a NetBSD FTP Mirror are:
<p>

<ol>
  <li>Prepare disk space.  See "<a href="#ftp-diskspace">How much disk space
    is needed for a FTP mirror</a>" entry below for information on amount of
    space required.
    <p>

  <li>Retrieve a copy of the NetBSD FTP site contents
    <p>

  <li>Set things up to synchronize the contents of your mirror with
    <tt>ftp.NetBSD.org</tt>.
    <p>

  <li>Send in the information about your mirror to <mirrors@NetBSD.org>.  See
    "<a href="#ftp-contactinfo">Contact information format for FTP
    Mirrors</a>" for details on that.
</ol>

<ENTRY>ftp-diskspace  How much disk space is needed for a FTP mirror?
The amount of disk space needed fluctuates due to things such as
pre-built packages being added, binary snapshots being deprecated,
and new formal releases of NetBSD. At this time (May 2003) a complete
mirror of NetBSD needs about 100 GB and a new release of NetBSD adds
between 10 and 15 GB (including binary packages).

<ENTRY>ftp-retrieve-sync Retrieving/Syncing a copy of the NetBSD FTP site

There are several ways that you can retrieve and sync the files.  Depending on
your personal preference, your network connection, the packages installed on
your systems etc. you may choose one over the other.  Either way, it's
probably a good idea to first run the relevant command by hand and then, when
you have confirmed that everything's working as it should, create a script to
be run by cron(8).
<br><br>
Below you can find some examples of how to keep your local copy in sync.
Simply replace "&lt;FTPROOT&gt;" with the actual root of your ftp server.
<br>
<br>
<ul>
	<li>Using <PKGSRC>net/rsync:<br>
	<pre>
		$ rsync -v -Wartz --delete rsync://rsync.NetBSD.org/NetBSD &lt;FTPROOT&gt;/pub/NetBSD/</pre>
	</li>
	<li>Using <PKGSRC>net/wget:<br>
	<pre>
		$ cd &lt;FTPROOT&gt;
		$ wget -v -xnH -m ftp://ftp.NetBSD.org/pub/NetBSD/</pre>
	</li>
	<li>Using <PKGSRC>net/mirror:<br>
	<pre>
		$ cat &gt; NetBSD.org &lt;&lt;EOF
		package=netbsd
		comment=NetBSD
		site=ftp.NetBSD.org
		remote_dir=/pub/NetBSD
		local_dir=&lt;FTPROOT&gt;/pub/NetBSD
		do_deletes=true
		algorithm=1
		EOF
		$ mirror NetBSD.org</pre>
	</li>
</ul>

<ENTRY>ftp-notes Notes about a NetBSD FTP mirror
As a NetBSD FTP mirror, it's important that you synchronize your
copy of the NetBSD FTP tree regularly.  Otherwise, old and/or
obsolete files may confuse users.
<p>

Also, it might happen that due to an e.g. security issue, file removal
(or another administrative task) may be requested from the NetBSD Project.

<ENTRY>ftp-outage Where should an outage be announced
If your FTP mirror experiences any significant system outage, you should
notify <mirrors@NetBSD.org> as soon as possible so that we can temporarily
redirect your CNAME (if there is one) to a nearby alternative.  Also, you
may wish to send a note about the outage to the <a
href="../MailingLists/#netbsd-users">netbsd-users mailing list</a>.
<p>

If the CNAME for your mirror has been redirected, be sure to let us know
when the situation is rectified, so we can revert the change.

<ENTRY>ftp-contactinfo Contact information format for FTP mirrors
Contact information needs to be submitted to <mirrors@NetBSD.org>.
This information gets added to an internal mirrors database, from
which the mirror-related documentation gets generated.  The
"<tt>contact*</tt>" fields are never made public.  Contact information
for NetBSD FTP mirrors should be sent in the following format:
<p>

<pre>
mirror          *machine name*
country         *location (country) of host*
location        *more specific location (e.g, ``University of Foo'')*
ftp             ftp://ftp.foo-univ.ac.jp/pub/NetBSD/
ftp-host        ftp.foo-univ.ac.jp
ftp-releng	ftp://ftp.foo-univ.ac.jp/pub/NetBSD-daily/
organisation    *organisation name*
contactperson   *contact person's name*
contactemail    *contact person's electronic mail address*
contactkeyid	*contact person's pgp key id*
contactphone    *contact person's telephone number*
contactaddress  *contact person's postal address*
</pre>
<p>

An example submission might look like this.
<p>

<pre>
mirror          netbsd.foo.com
country         Japan
location        Department of Computer Science, Foo University
ftp             ftp://ftp.foo-univ.ac.jp/pub/NetBSD/
ftp-host        ftp.foo-univ.ac.jp
organisation    Foo University
contactperson   Foo Bar
contactemail    Bar@foo-univ.ac.jp
contactkeyid	GA23FG12
contactphone    +81 3 xxxx yyyy
contactaddress  9876 Foo City, Tokyo 1234567 Japan
</pre>
<p>

If the contact information for your mirror ever needs to be changed,
please feel free to let us know at <mirrors@NetBSD.org>.

<ENTRY>ftp-cname How to get ftp.country-code.NetBSD.org
If you would like a ftp.country-code (e.g. ftp.jp) CNAME for your
mirror, please ask <mirrors@NetBSD.org>.  We do not normally do
subdomain delegation, so you cannot run a nameserver for
"country-code.NetBSD.org".

<ENTRY>ftp-teardown If you can no longer provide a FTP mirror
Please let us know at <mirrors@NetBSD.org> so that we can remove your site
from our list and redirect the DNS name to an alternative site.

<SECTION>WWW Mirror FAQ

<ENTRY>www-overview Overview for setting up a NetBSD WWW Mirror
The following is an overview of the recommended procedure for setting
up a NetBSD WWW mirror:
<p>

<ol>
  <li>For setting up a mirror with this procedure, you'll need cvs, ssh, and
    wget.  Both cvs and ssh ship with NetBSD versions after 1.5, and wget
    is available from the <a href="software/packages.html">NetBSD packages
    collection</a> (see net/<PKGSRC>net/wget).  Of course you'll also need
    a web server, such as apache.
    <p>

  <li>Retrieve a copy of the NetBSD WWW site.  See "<a
    href="#www-retrieve">Retrieving a copy of the NetBSD WWW site</a>"
    for instructions on how to do so with anoncvs.
    <p>

  <li>Set things up to synchronize the contents of your mirror with
    <tt>www.NetBSD.org</tt>.  See "<a
    href="#www-sync">Syncing the NetBSD WWW site contents</a>" for
    an example of how to do so using a cron job.
    <p>

  <li>Send in the information about your mirror to <mirrors@NetBSD.org>.  See
    "<a href="#www-contactinfo">Contact information format for WWW
    Mirrors</a>" for details on that.
</ol>

<ENTRY>www-diskspace  How much disk space is needed for a WWW mirror?
The amount of diskspace needed for a complete copy of the htdocs repository is
currently (2004-03) around 85 MB.  The total amount should not vary too much,
but will obviously grow with time.


<ENTRY>www-retrieve Retrieving a copy of the NetBSD WWW site
To retrieve a copy of <tt>www.NetBSD.org</tt> via anoncvs, you
should do:
<p>

<pre>
# su - nbwww
# cd /path/to/htdocs
# env CVS_RSH=ssh CVSROOT=anoncvs@anoncvs.NetBSD.org:/cvsroot \
  cvs checkout -P htdocs
</pre>

<b>Note:</b> "/path/to/htdocs" should be where you want the mirror
of <tt>www.NetBSD.org</tt> to reside.  The directory should be owned by
an e.g. "nbwww" user.

<ENTRY>www-sync Syncing the NetBSD WWW site contents
The best way to do this is to set up a cron job for your e.g. nbwww
user to update the web site at a regular interval using anoncvs
and wget (more on the wget usage below):
<p>

<pre>
# crontab -u nbwww -e
SHELL=/bin/sh
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/pkg/bin
MAILTO=whoever@gets.the.mirror.mail
CVS_RSH=ssh
CVSROOT=anoncvs@anoncvs.NetBSD.org:/cvsroot
0 1 * * * cd /path/to/htdocs && cvs update -dP && wget -nv -xnH -N -Fi mirrors/fetch.html && wget -nv -xnH -N -r -np http://www.NetBSD.org/Gnats/
</pre>

<b>Note:</b> In the suggested contents, you'll want to
change "MAILTO" to reflect who should get the mirror-related mail.
Also, "/path/to/htdocs" should be changed to where your
<tt>www.NetBSD.org</tt> mirror resides.

<ENTRY>www-fetch What is the purpose of htdocs/mirrors/fetch.html
The fetch.html file links to the handful of documents on 
<tt>www.NetBSD.org</tt> that are generated <em>by</em>
<tt>www.NetBSD.org</tt>.  These files get generated daily from
content in the <tt>doc</tt> module of the NetBSD CVS repository.
<p>
In the example cron tab above, you'll see 
"<tt>wget -nv -xnH -NFi mirrors/fetch.html</tt>".  This means that
daily, through wget, these <tt>www.NetBSD.org</tt> created files
will be updated in your copy of the web site contents.

<ENTRY>www-http-1.0 Ensuring HTTP/1.0 clients get the right page
It is much preferred that NetBSD WWW mirror sites run a separate
virtual web server for a <tt>www.NetBSD.org</tt> mirror on a
separate IP address.  This is so that clients using HTTP/1.0 still
get to the correct web site.
<p>

If that's not possible in your set up, then the other solution
for HTTP/1.0 clients would be putting the NetBSD mirror as the 
primary name-based virtual host.

<ENTRY>www-contactinfo Contact information format for WWW mirrors
Contact information needs to be submitted to <mirrors@NetBSD.org>.
This information gets added to an internal mirrors database, from
which the mirror-related documentation gets generated.  The
"<tt>contact*</tt>" fields are never made public.  Contact information
for NetBSD WWW mirrors should be sent in the following format:
<p>

<pre>mirror          *machine name*
country         *location (country) of host*
location        *more specific location (e.g, ``University of Foo'')*
www             *WWW URL*
www-host        *external WWW name*
organisation    *organisation name*
contactperson   *contact person's name*
contactemail    *contact person's electronic mail address*
contactkeyid	*contact person's pgp key id*
contactphone    *contact person's telephone number*
contactaddress  *contact person's postal address*</pre>
<p>

An example submission might look like this.
<p>

<pre>mirror          netbsd.foo-univ.ac.jp
country         Japan
location        Department of Computer Science, Foo University
www             http://netbsd.foo-univ.ac.jp/
www-host        netbsd.foo-univ.ac.jp
organisation    Foo University
contactperson   Foo Bar
contactemail    Bar@foo-univ.ac.jp
contactkeyid	GA23FG12
contactphone    +81 3 xxxx yyyy
contactaddress  9876 Foo City, Tokyo 1234567 Japan</pre>
<p>

If the contact information for your mirror ever needs to be changed,  
please feel free to let us know at <mirrors@NetBSD.org>.

<ENTRY>www-cname How to get www.country-code.NetBSD.org
If you would like a www.country-code (e.g. www.jp) CNAME for your
mirror, please ask <mirrors@NetBSD.org>.  We do not normally do
subdomain delegation, so you cannot run a nameserver for
"country-code.NetBSD.org".

<ENTRY>www-teardown If you can no longer provide a WWW mirror
Please let us know at <mirrors@NetBSD.org> so that we can remove your site
from our list and redirect the DNS name to an alternative site.

<SECTION>CVSweb Mirror FAQ

<ENTRY>cvsweb-overview Overview for setting up a NetBSD CVSweb Mirror
The following is an overview of the recommended procedure for setting
up a NetBSD CVSweb mirror:
<p>

<ol>
  <li>For setting up a mirror with this procedure, you'll need cvs, cvsup, and the
    cvsweb CGI script.  NetBSD 1.6 and above ship with CVS, both
    cvsup and the cvsweb CGI script
    are available from the <a href="software/packages.html">NetBSD packages
    collection</a> (see devel/<PKGSRC>devel/cvsup and www/<PKGSRC>www/cvsweb).  Of course you'll also need
    a web server, such as <PKGSRC>www/apache.
    <p>

  <li>Retrieve a copy of the NetBSD CVS tree.  See "<a
    href="#cvsweb-retrieve">Retrieving a copy of the NetBSD CVS tree</a>"
    for instructions on how to do so with cvsup.
    <p>

  <li>Set things up to synchronize the contents of your mirror with
    the cvsup server.  See "<a
    href="#cvsweb-sync">Syncing the NetBSD CVS tree contents</a>" for
    an example of how to do so using a cron job.
    <p>

  <li>Send in the information about your mirror to <mirrors@NetBSD.org>.  See
    "<a href="#cvsweb-contactinfo">Contact information format for CVSweb
    Mirrors</a>" for details on that.
</ol>

<ENTRY>cvsweb-retrieve Retrieving a copy of the NetBSD CVS tree
To retrieve a copy of the CVS tree via cvsup, you
should do:
<p>

<pre>
# su - cvsweb
# mkdir -p /home/cvsweb/netbsd
# cd /home/cvsweb
</pre>

<b>Note:</b> "/home/cvsweb/netbsd" should be where you want the mirror
of the tree to reside.  The directory should be owned by
an e.g. "cvsweb" user. Create an "supfile" using your editor (For examples, see 
<a href="netbsd-supfile">netbsd-supfile</a>).
Please take a look at the list of available public cvsup servers, you'll find the list <a href="../mirrors/index.html#cvsup">here</a>.
<pre>
# cvsup -g -L 2 netbsd-supfile
</pre>
<ENTRY>cvsweb-sync Syncing the NetBSD CVS tree contents
The best way to do this is to set up a cron job for your e.g. cvsweb
user to update the tree at a regular interval using cvsup:
<p>

<pre>
# crontab -u cvsweb -e
SHELL=/bin/sh
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/pkg/bin
MAILTO=whoever@gets.the.mirror.mail
0 1 * * * cvsup -g /home/cvsweb/netbsd-supfile
</pre>

<b>Note:</b> In the suggested contents, you'll want to
change "MAILTO" to reflect who should get the mirror-related mail.

<ENTRY>cvsweb-cgi How to setup the cvsweb CGI script
Take a look at the cvsweb.conf and be sure to edit the following options:
<pre>
@CVSrepositories = (
        'netbsd'  => ['NetBSD',           '/home/cvsweb/netbsd'],
);

$mancgi = "http://netbsd.gw.com/cgi-bin/man-cgi?%s+%s+NetBSD-current";
</pre>
<p>
Place cvsweb.cgi in your web servers' cgi-bin directory and be sure to
edit it to point to your cvsweb.conf.

<ENTRY>cvsweb-http-1.0 Ensuring HTTP/1.0 clients get the right page
It is much preferred that NetBSD CVSweb mirror sites run a separate
virtual web server for a CVSweb mirror on a
separate IP address.  This is so that clients using HTTP/1.0 still
get to the correct web site.
<p>

If that's not possible in your set up, then the other solution
for HTTP/1.0 clients would be putting the NetBSD mirror as the 
primary name-based virtual host.

<ENTRY>cvsweb-contactinfo Contact information format for CVSweb mirrors
Contact information needs to be submitted to <mirrors@NetBSD.org>.
This information gets added to an internal mirrors database, from
which the mirror-related documentation gets generated.  The
"<tt>contact*</tt>" fields are never made public.  Contact information
for NetBSD CVSweb mirrors should be sent in the following format:
<p>

<pre>
mirror          *machine name*
country         *location (country) of host*
location        *more specific location (e.g, ``University of Foo'')*
cvsweb          *CVSweb URL*
cvsweb-host     *external CVSweb name*
organisation    *organisation name*
contactperson   *contact person's name*
contactemail    *contact person's electronic mail address*
contactkeyid	*contact person's pgp key id*
contactphone    *contact person's telephone number*
contactaddress  *contact person's postal address*
</pre>
<p>

An example submission might look like this.
<p>

<pre>
mirror          netbsd.foo-univ.ac.jp
country         Japan
location        Department of Computer Science, Foo University
cvsweb          http://netbsd.foo-univ.ac.jp/cgi-bin/cvsweb.cgi/
cvsweb-host     cvsweb.netbsd.foo-univ.ac.jp
organisation    Foo University
contactperson   Foo Bar
contactemail    Bar@foo-univ.ac.jp
contactkeyid	GA23FG12
contactphone    +81 3 xxxx yyyy
contactaddress  9876 Foo City, Tokyo 1234567 Japan
</pre>
<p>

If the contact information for your mirror ever needs to be changed,  
please feel free to let us know at <mirrors@NetBSD.org>.

<ENTRY>cvsweb-cname How to get cvsweb.country-code.NetBSD.org
If you would like a cvsweb.country-code (e.g. cvsweb.jp) CNAME for your
mirror, please ask <mirrors@NetBSD.org>.  We do not normally do
subdomain delegation, so you cannot run a nameserver for
"country-code.NetBSD.org".

<ENTRY>cvsweb-teardown If you can no longer provide a CVSweb mirror
Please let us know at <mirrors@NetBSD.org> so that we can remove your site
from our list and redirect the DNS name to an alternative site.

</LIST>

<DOCLINK>

<hr>
<address>
  <small>
  <a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">(Contact us)</a>
  $NetBSD: mirror.list,v 1.42 2004/03/03 16:44:57 jschauma Exp $<br>
  <a href="../Misc/disclaimer.html">Copyright &copy; 1994-2004
  The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
