<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<!-- Copyright (c) 1994-2003
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<!--
  ==  created by Jun-ichiro itojun Hagino
  -->
<link rev="made" href="mailto:www@JP.NetBSD.org">
<link rel="shortcut icon" href="../../favicon.ico" origlink="/favicon.ico" type="image/x-icon">
<title>NetBSD Mirror FAQ</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<HEADING>NetBSD ミラー FAQ

<LIST>

<SECTION>FTP ミラー FAQ

<ENTRY>ftp-overview NetBSD FTP ミラー立ち上げのあらまし
NetBSD FTP ミラーの立ち上げの基本的な手順は、以下のとおりです:
<p>

<ol>
  <li>ディスクスペースを用意します。必要な容量については、
    「<a href="#ftp-diskspace">FTP ミラーに必要なディスク容量はどれくらいか
    </a>」の項目を見てください。
    <p>

  <li>NetBSD FTP サイトのコンテンツのコピーを持ってきます
    <p>

  <li>あなたのミラーのコンテンツを <tt>ftp.NetBSD.org</tt>
    と同期を取るようにします。
    <p>

  <li>あなたのミラーに関する情報を <mirrors@NetBSD.org> へ送ります。
    これについての詳細は「<a href="#ftp-contactinfo">FTP ミラー用
    コンタクトインフォメーションのフォーマット</a>」を見てください。
</ol>

<ENTRY>ftp-diskspace  FTP ミラーに必要なディスク容量はどれくらいか
必要な総ディスク容量は、コンパイル済パッケージの追加、
バイナリースナップショットの消去、 NetBSD の新しい公式リリースなどによって
変動します。 2003 年 5 月現在、 NetBSD の完全なミラーには約 100 GB
が必要であり、これは NetBSD の新しいリリース版が出ると 10 〜 15 GB
(バイナリーパッケージを含む) ほど増えます。

<ENTRY>ftp-retrieve-sync NetBSD FTP サイトのコンテンツを取得する/同期を取る

ファイルの取得や同期を行なう方法はいくつかあります。どの方法を使うかは、
あなたの個人的な趣味や、ネットワーク接続、システムに導入されたパッケージ
などによるでしょう。どの方法を取るにせよ、最初に適切なコマンドを手で打って実行して、
きちんと動作することを確認してから、 cron(8) 用のスクリプトを作るようにするのが、
おそらくよいでしょう。
<br><br>
以下に、取得したコピーを同期させる方法の例をいくつか掲げます。
"&lt;FTPROOT&gt;" は、あなたの ftp サーバーのルートディレクトリーに置き換えてください。
<br>
<br>
<ul>
	<li><PKGSRC>net/rsync を使う場合:<br>
	<pre>
		$ rsync -v -Wartz --delete rsync://rsync.NetBSD.org/NetBSD &lt;FTPROOT&gt;/pub/NetBSD/</pre>
	</li>
	<li><PKGSRC>net/wget を使う場合:<br>
	<pre>
		$ cd &lt;FTPROOT&gt;
		$ wget -v -xnH -m ftp://ftp.NetBSD.org/pub/NetBSD/</pre>
	</li>
	<li><PKGSRC>net/mirror を使う場合:<br>
	<pre>
		$ cat &gt; NetBSD.org &lt;&lt;EOF
		package=netbsd
		comment=NetBSD
		site=ftp.NetBSD.org
		remote_dir=/pub/NetBSD
		local_dir=&lt;FTPROOT&gt;/pub/NetBSD
		do_deletes=true
		algorithm=1
		EOF
		$ mirror NetBSD.org</pre>
	</li>
</ul>

<ENTRY>ftp-notes NetBSD FTP ミラーに関する注意事項
NetBSD FTP ミラーなのですから、定期的にあなたの NetBSD FTP ツリーの
同期をとる必要があります。そうしないと、古いファイル、
現在は使用されていないファイルのせいで、ユーザーは困惑するかもしれません。
<p>

また、たとえばセキュリティー上の問題などにより、プロジェクトから
ファイルの削除 (または他の管理作業) を要求されることもあります。

<ENTRY>ftp-outage サービスの停止期間をどこに連絡する必要があるか
あなたの FTP ミラーが、何らかの影響をおよぼすようなシステム停止をする場合は、
あなた用の CNAME (がある場合) を近隣の代替サイトに一時的に振り替えられるように
するため、できるだけ早く <mirrors@NetBSD.org> に連絡すべきです。
また、停止の注意を <a
href="../MailingLists/#netbsd-users">netbsd-users メーリングリスト</a>
にも送るべきかもしれません。
<p>

あなたのミラーの CNAME を振り替えた場合は、元に戻すことができるよう、
いつ復旧するかを私たちにお知らせください。

<ENTRY>ftp-contactinfo FTP ミラー用コンタクトインフォメーションのフォーマット
コンタクトインフォメーションを <mirrors@NetBSD.org> に提出する必要があります。
この情報は、内部のミラーデータベースに追加され、このデータベースをもとに
ミラー関係の文書が作られます。
"<tt>contact*</tt>" の項目は公開されることはありません。 NetBSD FTP
ミラー用コンタクトインフォメーションは、以下のフォーマットで
送付してください:
<p>

<pre>
mirror          *マシン名*
country         *ホストのある場所(国)*
location        *詳細な場所(例えば、Foo 大学)*
ftp             ftp://ftp.foo-univ.ac.jp/pub/NetBSD/
ftp-host        ftp.foo-univ.ac.jp
ftp-releng	ftp://ftp.foo-univ.ac.jp/pub/NetBSD-daily/
organisation    *組織名*
contactperson   *担当者の名前*
contactemail    *担当者の電子メールアドレス*
contactphone    *担当者の電話番号*
contactaddress  *担当者の郵政省メールアドレス*
</pre>
<p>

たとえば以下のように書きます。
<p>

<pre>
mirror          netbsd.foo.com
country         Japan
location        Department of Computer Science, Foo University
ftp             ftp://ftp.foo-univ.ac.jp/pub/NetBSD/
ftp-host        ftp.foo-univ.ac.jp
organisation    Foo University
contactperson   Foo Bar
contactemail    Bar@foo-univ.ac.jp
contactphone    +81 3 xxxx yyyy
contactaddress  9876 Foo City, Tokyo 1234567 Japan
</pre>
<p>

あなたのミラーのコンタクトインフォメーションが変わったような場合は、
お気軽に <mirrors@NetBSD.org> までお知らせください。

<ENTRY>ftp-cname ftp.country-code.NetBSD.org の取得方法
あなたのミラーで ftp.country-code のような CNAME (例: ftp.jp)
を使いたい場合は、 <mirrors@NetBSD.org> までお尋ねください。
ただし、通常はサブドメインの委譲をおこなわないので、
「country-code.NetBSD.org」のためのネームサーバーをたちあげる事はできません。

<ENTRY>ftp-teardown FTP ミラーの提供ができなくなった場合
あなたのミラーをリストから削除し、当該 DNS 名を代替サイトに振り替えますので、
<mirrors@NetBSD.org> までお知らせください。

<SECTION>WWW ミラー FAQ

<ENTRY>www-overview NetBSD WWW ミラー立ち上げのあらまし
以下は、NetBSD WWW ミラーの立ち上げにあたって推奨される手順の
概観です。
<p>

<ol>
  <li>この手順に沿ってミラーを立ち上げる場合、 cvs、 ssh、 wget が必要です。
    cvs と ssh は 1.5 以降のバージョンの NetBSD に附属しており、また、
    wget は <a href="software/packages.html">NetBSD パッケージコレクション</a>
    から利用可能です (net/<PKGSRC>net/wget 参照) 。もちろん、 apache
    のような web サーバーも必要です。
    <p>

  <li>NetBSD WWW サイトのコピーを持ってきます。 anoncvs
    を使った取得方法の説明は、「<a
    href="#www-retrieve">NetBSD WWW サイトのコピーを取得する</a>」
    を見てください。
    <p>

  <li>あなたのミラーのコンテンツを <tt>www.NetBSD.org</tt>
    と同期を取るようにします。 cron ジョブを使った同期方法の例は「<a
    href="#www-sync">NetBSD WWW サイトコンテンツの同期をとる</a>」
    を見てください。
    <p>

  <li>あなたのミラーに関する情報を <mirrors@NetBSD.org> へ送ります。
    これについての詳細は「<a href="#www-contactinfo">WWW ミラー用
    コンタクトインフォメーションのフォーマット</a>」を見てください。
</ol>

<ENTRY>www-retrieve NetBSD WWW サイトのコピーを取得する
<tt>www.NetBSD.org</tt> のコピーを anoncvs を使って取得するには、
以下のようにします:
<p>

<pre>
# su - nbwww
# cd /path/to/htdocs
# env CVS_RSH=ssh CVSROOT=anoncvs@anoncvs.NetBSD.org:/cvsroot \
  cvs checkout -P htdocs
</pre>

<b>注意:</b> ここで "/path/to/htdocs" は <tt>www.NetBSD.org</tt>
のミラーを置こうとしているディレクトリーです。このディレクトリーは、
たとえば "nbwww" ユーザーの所有にすべきです。

<ENTRY>www-sync NetBSD WWW サイトコンテンツの同期をとる
同期をとるための一番よい方法は、 cron ジョブを設定して、たとえば nbwww
ユーザーで anoncvs と wget を使って定期的に web サイトを更新することです
(wget の使い方の詳細は下記のとおり) :
<p>

<pre>
# crontab -u nbwww -e
SHELL=/bin/sh
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/pkg/bin
MAILTO=whoever@gets.the.mirror.mail
CVS_RSH=ssh
CVSROOT=anoncvs@anoncvs.NetBSD.org:/cvsroot
0 1 * * * cd /path/to/htdocs && cvs update -dP && wget -nv -xnH -N -Fi mirrors/fetch.html && wget -nv -xnH -N -r -np http://www.NetBSD.org/Gnats/
</pre>

<b>注意:</b> この例示のなかの "MAILTO" は、ミラー関連のメールを
受け取るユーザーのものに書き換えてください。
また、 "/path/to/htdocs" は <tt>www.NetBSD.org</tt> のミラーの
置き場所に書き換えます。

<ENTRY>www-fetch htdocs/mirrors/fetch.html の目的
この fetch.html ファイルは、 <tt>www.NetBSD.org</tt> 上にある、
<tt>www.NetBSD.org</tt> <em>によって</em>生成される文書群に
リンクしています。これらのファイルは、 NetBSD CVS リポジトリーの
<tt>doc</tt> モジュールの内容をもとに毎日生成されています。
<p>
上記の cron tab の例に、
"<tt>wget -nv -xnH -NFi mirrors/fetch.html</tt>" というのがあります。
これは、毎日 wget を使って、あなたの web サイトコンテンツのコピー内の、
これら <tt>www.NetBSD.org</tt> で生成されるファイルを更新するためのものです。

<ENTRY>www-http-1.0 HTTP/1.0 クライアントが適切なページを見られるよう保証する
NetBSD WWW ミラーサイトは、 <tt>www.NetBSD.org</tt> ミラー用の
バーチャル web サーバーを専用の IP アドレス上で運用することが強く望まれます。
こうすることで、 HTTP/1.0 を使うクライアントでも正しく web サイトを
見られるからです。
<p>

そのように設定することができない場合、 HTTP/1.0 クライアントに対する
別の解決法は、 NetBSD ミラーをプライマリーのネームベースのバーチャルホスト
にすることです。

<ENTRY>www-contactinfo WWW ミラー用コンタクトインフォメーションのフォーマット
コンタクトインフォメーションを <mirrors@NetBSD.org> に提出する必要があります。
この情報は、内部のミラーデータベースに追加され、このデータベースをもとに
ミラー関係の文書が作られます。
"<tt>contact*</tt>" の項目は公開されることはありません。 NetBSD WWW
ミラー用コンタクトインフォメーションは、以下のフォーマットで
送付してください:
<p>

<pre>mirror          *マシン名*
country         *ホストのある場所(国)*
location        *詳細な場所(例えば、Foo 大学)*
www             *WWW URL*
www-host        *external WWW name*
organisation    *組織名*
contactperson   *担当者の名前*
contactemail    *担当者の電子メールアドレス*
contactphone    *担当者の電話番号*
contactaddress  *担当者の郵政省メールアドレス*</pre>
<p>

たとえば以下のように書きます。
<p>

<pre>mirror          netbsd.foo-univ.ac.jp
country         Japan
location        Department of Computer Science, Foo University
www             http://netbsd.foo-univ.ac.jp/
www-host        netbsd.foo-univ.ac.jp
organisation    Foo University
contactperson   Foo Bar
contactemail    Bar@foo-univ.ac.jp
contactphone    +81 3 xxxx yyyy
contactaddress  9876 Foo City, Tokyo 1234567 Japan</pre>
<p>

あなたのミラーのコンタクトインフォメーションが変わったような場合は、
お気軽に <mirrors@NetBSD.org> までお知らせください。

<ENTRY>www-cname www.country-code.NetBSD.org の取得方法
あなたのミラーで www.country-code のような CNAME (例: www.jp)
を使いたい場合は、 <mirrors@NetBSD.org> までお尋ねください。
ただし、通常はサブドメインの委譲をおこなわないので、
「country-code.NetBSD.org」のためのネームサーバーをたちあげる事はできません。

<ENTRY>www-teardown WWW ミラーの提供ができなくなった場合
あなたのミラーをリストから削除し、当該 DNS 名を代替サイトに振り替えますので、
<mirrors@NetBSD.org> までお知らせください。

<SECTION>CVSweb ミラー FAQ

<ENTRY>cvsweb-overview NetBSD CVSweb ミラー立ち上げのあらまし
以下は、NetBSD CVSweb ミラーの立ち上げにあたって推奨される手順の
概観です。
<p>

<ol>
  <li>この手順に沿ってミラーを立ち上げる場合、 cvs、 cvsup、 cvsweb CGI
    スクリプトが必要です。 NetBSD 1.6 以降には CVS が標準で附属しており、また、
    cvsup と cvsweb CGI スクリプトは <a href="software/packages.html">NetBSD
    パッケージコレクション</a>から利用可能です (devel/<PKGSRC>devel/cvsup と www/<PKGSRC>www/cvsweb 参照) 。もちろん、 <PKGSRC>www/apache
    のような web サーバーも必要です。
    <p>

  <li>NetBSD CVS ツリーのコピーを持ってきます。 cvsup
    を使った取得方法の説明は、「<a
    href="#cvsweb-retrieve">NetBSD CVS ツリーのコピーを取得する</a>」
    を見てください。
    <p>

  <li>あなたのミラーのコンテンツを cvsup サーバーと同期を取るようにします。
    cron ジョブを使った同期方法の例は「<a
    href="#cvsweb-sync">NetBSD CVS ツリーコンテンツの同期をとる</a>」
    を見てください。
    <p>

  <li>あなたのミラーに関する情報を <mirrors@NetBSD.org> へ送ります。
    これについての詳細は「<a href="#cvsweb-contactinfo">CVSweb ミラー用
    コンタクトインフォメーションのフォーマット</a>」を見てください。
</ol>

<ENTRY>cvsweb-retrieve NetBSD CVS ツリーのコピーを取得する
CVS ツリーのコピーを cvsup を使って取得するには、
以下のようにします:
<p>

<pre>
# su - cvsweb
# mkdir -p /home/cvsweb/netbsd
# cd /home/cvsweb
</pre>

<b>注意:</b> ここで "/home/cvsweb/netbsd" は CVS ツリーのミラーを
置こうとしているディレクトリーです。このディレクトリーは、
たとえば "cvsweb" ユーザーの所有にすべきです。エディターを使って
"supfile" ファイルを作ります (書き方の例は、
<a href="../../Documentation/netbsd-supfile" origlink="netbsd-supfile">netbsd-supfile</a> を見てください) 。
ファイル中の cvsup-server-hostname は、利用可能な公開 cvsup サーバーの一覧の中から選んで書き換えてください。サーバーの<a href="../mirrors/index.html#cvsup">一覧はこちらにあります</a>。
<pre>
# cvsup -g -L 2 netbsd-supfile
</pre>
<ENTRY>cvsweb-sync NetBSD CVS ツリーコンテンツの同期をとる
同期をとるための一番よい方法は、 cron ジョブを設定して、たとえば cvsweb
ユーザーで cvsup を使って定期的に CVS ツリーを更新することです:
<p>

<pre>
# crontab -u cvsweb -e
SHELL=/bin/sh
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/pkg/bin
MAILTO=whoever@gets.the.mirror.mail
0 1 * * * cvsup -g /home/cvsweb/netbsd-supfile
</pre>

<b>注意:</b> この例のなかの "MAILTO" は、ミラー関連のメールを
受け取るユーザーのものに書き換えてください。

<ENTRY>cvsweb-cgi cvsweb CGI スクリプトの設定方法
cvsweb.conf ファイルを見て、以下の各オプションを書き換えておきます:
<pre>
@CVSrepositories = (
        'netbsd'  => ['NetBSD',           '/home/cvsweb/netbsd'],
);

$mancgi = "http://netbsd.gw.com/cgi-bin/man-cgi?%s+%s+NetBSD-current";
</pre>
<p>
cvsweb.cgi を web サーバーの cgi-bin ディレクトリーに置いて、 cvsweb.conf
を参照するように cvsweb.cgi を書き換えてください。

<ENTRY>cvsweb-http-1.0 HTTP/1.0 クライアントが適切なページを見られるよう保証する
NetBSD CVSweb ミラーサイトは、 CVSweb ミラー用の
バーチャル web サーバーを専用の IP アドレス上で運用することが強く望まれます。
こうすることで、 HTTP/1.0 を使うクライアントでも正しく web サイトを
見られるからです。
<p>

そのように設定することができない場合、 HTTP/1.0 クライアントに対する
別の解決法は、 NetBSD ミラーをプライマリーのネームベースのバーチャルホスト
にすることです。

<ENTRY>cvsweb-contactinfo  CVSweb ミラー用コンタクトインフォメーションのフォーマット
コンタクトインフォメーションを <mirrors@NetBSD.org> に提出する必要があります。
この情報は、内部のミラーデータベースに追加され、このデータベースをもとに
ミラー関係の文書が作られます。
"<tt>contact*</tt>" の項目は公開されることはありません。 NetBSD CVSweb
ミラー用コンタクトインフォメーションは、以下のフォーマットで
送付してください:
<p>

<pre>
mirror          *マシン名*
country         *ホストのある場所(国)*
location        *詳細な場所 (例えば、Foo 大学)*
cvsweb          *CVSweb URL*
cvsweb-host     *external CVSweb name*
organisation    *組織名*
contactperson   *担当者の名前*
contactemail    *担当者の電子メールアドレス*
contactphone    *担当者の電話番号*
contactaddress  *担当者の郵政省メールアドレス*
</pre>
<p>

たとえば以下のように書きます。
<p>

<pre>
mirror          netbsd.foo-univ.ac.jp
country         Japan
location        Department of Computer Science, Foo University
cvsweb          http://netbsd.foo-univ.ac.jp/cgi-bin/cvsweb.cgi/
cvsweb-host     cvsweb.netbsd.foo-univ.ac.jp
organisation    Foo University
contactperson   Foo Bar
contactemail    Bar@foo-univ.ac.jp
contactphone    +81 3 xxxx yyyy
contactaddress  9876 Foo City, Tokyo 1234567 Japan
</pre>
<p>

あなたのミラーのコンタクトインフォメーションが変わったような場合は、
お気軽に <mirrors@NetBSD.org> までお知らせください。

<ENTRY>cvsweb-cname cvsweb.country-code.NetBSD.org の取得方法
あなたのミラーで cvsweb.country-code のような CNAME (例: cvsweb.jp)
を使いたい場合は、 <mirrors@NetBSD.org> までお尋ねください。
ただし、通常はサブドメインの委譲をおこなわないので、
「country-code.NetBSD.org」のためのネームサーバーをたちあげる事はできません。

<ENTRY>cvsweb-teardown CVSweb ミラーの提供ができなくなった場合
あなたのミラーをリストから削除し、当該 DNS 名を代替サイトに振り替えますので、
<mirrors@NetBSD.org> までお知らせください。

</LIST>

<DOCLINK>

<hr>
<address>
  <small>
  (連絡先 - <a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">英語</a>,
       <a href="mailto:www@JP.NetBSD.org">日本語:
       www@JP.NetBSD.org</a>)<br>
  $NetBSD: mirror.list,v 1.40 2003/12/10 15:20:31 jschauma Exp $<br>
  <a href="../Misc/disclaimer.html">Copyright &copy; 1994-2003
  The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
