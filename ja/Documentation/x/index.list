<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<!-- Copyright (c) 1994-2002
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<link rel="shortcut icon" href="../../../favicon.ico" origlink="/favicon.ico" type="image/x-icon">
<title>NetBSD Documentation: The X Window System</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<HEADING>X Window System

<LIST>

<SECTION>X の実行

<ENTRY>wsmouse XFree でマウスを動作させる方法は ?
<p> デフォルトの wscons コンソールドライバーを使っていると仮定しますが、
XF86Config ファイルの "Pointer" セクションで、マウスのプロトコルとデバイスが
正しく設定されているか確認してください:
</p>
    
<PRE>
Section "Pointer"
   ###Protocol       "PS/2"                    # Linux
   ###Device         "/dev/mouse"              # Linux
   ##Protocol        "busmouse"                # NetBSD 1.4.x
   ##Device          "/dev/pms0"               # NetBSD 1.4.x
   Protocol          "wsmouse"                 # NetBSD 1.5 or later
   Device            "/dev/wsmouse"            # NetBSD 1.5 or later
EndSection
</PRE>

<p>wscons を使わない場合 (1.4.x ではこれがデフォルト) 、
PS/2 マウスでは /dev/pms0 と "busmouse" プロトコルを使います</p>

<p>古いカーネル用に "PS/2" プロトコルもまだサポートされていますが、
この場合、そのカーネルの opms マウスドライバーと "/dev/pms0" デバイスを
使う必要があります。これは wscons プロトコルをサポートしない
(XFree V4 や、 Linux/FreeBSD の X サーバーのバイナリーのような)
X サーバー用に使えます。
</p>



<ENTRY>x-keyboard-maps X でのキーボード配列を 'US' から変更する
	XFree 3.x は、デフォルトでは英語キーボード配列を使います。これを、
	たとえばドイツ語に変えるには、 XF86Config ファイルに次のように
	書きます:

<PRE>
#       XkbDisable
#       XkbKeymap   "xfree86(us)"

        XkbModel        "pc102"
        XkbLayout       "de" XkbVariant      "nodeadkeys"
</PRE>

	XFree 4.x で、たとえばドイツ語キーボードにするためには、 XF86Config
	の "InputDevices" セクションに下記のように書きます:

<pre>
	Options		"XkbLayout"	"de"
</pre>

	wscons 下でのコンソールにおけるキーボードの設定は、
	<a href="../wscons/#keyboard-maps">別ページで</a>説明しています。

<ENTRY>x-keyboard-nocaps Caps キーをもうひとつの Control キーにする方法は

	(NetBSD 1.l5 に附属している) XFree 3.x では、
	caps-lock キーを 2 個目の control キーとして使いたい場合は
	``<TT>XkbOptions "ctrl:nocaps"</TT>'' を追加します。
	キーボードの "Windows" キーを使いたければ、 ``<TT>XkbModel "pc105"</TT>''
	に差し替えて、使えるようにすることができます。
	<P>

	XFree 4.x では設定ファイルの書式が異なります。こちらでは、

<pre>
	Option "XkbOptions" "ctrl:nocaps"
</pre>

	を XF86Config ファイルの "InputDevice" セクションに書きます。
	<p>
	
<ENTRY>xf86_corrupts_on_rage_128 Rage 128 でアクセラレートしていると XF86_SVGA でのグリフが乱れる
これを修正するため、 2000-01-13 以降の xsrc を用意してください (このほか、PR
<a href="http://www.NetBSD.org/cgi-bin/query-pr-single.pl?number=9171">xsrc/9171</a>
のパッチを適用する必要があります) 。
そして、 XF86Config の Device セクションで
<blockquote>Option "xaa_no_color_exp"</blockquote> を使います。

<ENTRY>slow_when_compiling NetBSD 1.3.x でコンパイルすると X が非常に遅い
NetBSD 1.3 シリーズ用の
<a href="ftp://ftp.netbsd.org/pub/NetBSD/misc/patches/1.3schedpatch">パッチ</a>
があり、これは、コンパイルや他のタスクの実行中の
X 下でのパフォーマンスの相互の影響を大幅に改善します。

<ENTRY>bypassing_xdm xdm をバイパスする方法
xdm(1) を有効にしているが、 root パスワードがなく、
利用可能な仮想コンソールがない (あるいはお使いのポートでは未サポートである)
など、何らかの理由でログインできない場合は、ブートメッセージ後の xdm
スタートの兆しが見えた直後に ^C を押すか、または以下のようにすることができます:
<ul>
<li>シングルユーザーモードでブート<br>
    普通は、ブートコマンドの最後に '-s' を追加すればよいです。
<li>シェルの起動<br>
    シェルを尋ねられたら <tt>ENTER</tt> を押します。
<li>fsck(8) と mount(8) を使ってディスクのチェックとマウント<br>
    <tt>fsck -p ; mount -vat ffs</tt>
<li>変数に端末の種類を設定<br>
    <tt>TERM=<em>vt100</em> ; export TERM</tt><br>
    注意: 'pc3' や 'sun' など、別の端末の種類にする必要があるかもしれません。
<li>問題の修正<br>
    /etc/rc.conf を編集して xdm を使わないようにし、 '<tt>passwd</tt>' で
    root のパスワードの設定をするなど、必要な修正をします。
</ul>

<ENTRY>startx_not_found '<b><tt>startx</tt></b>' すると <tt>startx: Command not found.</tt> と文句を言われる。なぜ ?
X のバイナリーの場所をシェルの <tt>path</tt> 変数に加える必要があります。
<tt>csh</tt> 系のシェルでは、 <tt>.cshrc</tt> ファイルの <tt>path</tt> を
設定する行に <tt>/usr/X11R6/bin</tt> を加えます。
<tt>sh</tt> 系のシェルでは、 <tt>.profile</tt> を編集する必要があります。


<ENTRY>xinit_not_found X が動かない - '<b>xinit: not found</b>'
/usr/X11R6/bin を path に入れてください。
root で '<b><tt>set path = ( $path /usr/X11R6/bin )</tt></b>' を
<tt>/etc/csh.cshrc</tt> に追加し、新たなシェルを起動してください。

<ENTRY>startx_fails startx が失敗する -'<b>X connection to: 0.0 broken</b>'
この場合、エラーメッセージを見るために、次のようにして起動してください:
<ul>
<li>使用しているシェルが csh(1) または <PKGSRC>shells/tcsh の場合:
<pre>	startx &gt;& ~/x.log</pre>
<li>使用しているシェルが sh(1), ksh(1) 等の場合:
<pre>	startx &gt; ~/x.log 2&gt;&amp;1</pre>
</ul>
そして、~/x.log を見てください

<ENTRY>shared_libraries_and_x X プログラムが '<b>lib<em>XXXX</em>.so.<em>NN</em>: No such file...</b>'と言って起動できない
root で <tt>/etc/ld.so.conf</tt> を編集し、この行を追加してください:
<pre>
    /usr/X11R6/lib
</pre>
同時にこの行も含んでいることも確認した方がいいでしょう:
<pre>
    /usr/pkg/lib
</pre>
<em>(追加プログラムを足すのに
<a href="../software/packages.html">NetBSD
パッケージ</a>を<b>使っています</B>よね?)</em><br>
その後 "<b><tt>ldconfig -v</tt></b>" を実行すると、出力の中から
この形式の行を見つけられるでしょう: 'Adding /usr/X11R6/lib/libXIE.so.6.0'.
<p>
<b>共有ライブラリーってなんですか?</b><br>
ディスクとメモリーを節約するために、ほとんどの NetBSD のポーティングでは
'共有ライブラリー' を用います。
これによって、複数のプログラム (xterm, fvwm2, etc) が利用する
各ライブラリー (たとえば libXmu.so.6.0) は、一度だけメモリーに読み込まれる
ことになります。
標準のシステム共有ライブラリーは /usr/lib にありますが、NetBSD は
追加のライブラリー (X のアプリケーション用など) のありかを知る必要が
あります。そのためには '<tt>/etc/ld.so.conf</tt>' に追加をします。

<ENTRY>xconsole コンソール表示 ('su'などの) が X の表示をこわす
システムは何かが起こったこと ('su'など) を示すためコンソールに出力を
行います。
このコンソール出力を表示させるための、xconsole(1) あるいは 'xterm -C' プ
ログラムを起動するようにしてください。
<p>
以下を有効にしてカーネルをコンパイルする必要があるかもしれません:
<pre>   options  UCONSOLE  # allow anyone to steal the virtual console</pre>
詳しくは
<a href="../kernel/#how_to_build_a_kernel">カーネルの作り方</a>
を参照してください。
<p>
もしあなたが root でログインしていて、うっとうしい <tt>portmap</tt>
の注意を受けているのであれば、このメッセージを出さないようにする方法の
<a href="../misc/#portmap-messup">FAQ 項目</a>を見るのがいいかもしれません。

<ENTRY>wheel-mouse マウスのホイールを使えるようにする方法は?
Microsoft IntelliMouse、 Logitech Wheel Mouse (cordless our not) 、
またはこれらに似たスクロールホイールのあるマウスを使っていて、
NetBSD でそのホイールを使いたい場合、
まず "pmsi" ドライバーを含むカーネルを作り、
"wsmouse" がこれを使うようにします。次のようなものが
dmesg(1) の出力中に含まれるはずです:
<pre>
pmsi0 at pckbc0 (aux slot)
wsmouse0 at pmsi0
</pre>
(NetBSD 1.5.2 以前に附属している) XFree86 3.x を使っている場合は、
<tt>/etc/XF86Config</tt> の内容に下記を含めるようにしてください:
<pre>
Section "Pointer"
    Protocol    "wsmouse"
    Device      "/dev/wsmouse"
    ZAxisMapping 4 5
EndSection
</pre>
XFree86 4.x を使っている場合は、 <tt>/etc/X11/XF86Config</tt>
の内容に下記を含めるようにしてください:
<pre>
Section "InputDevice"
    Identifier  "Mouse0"
    Driver      "mouse"
    Option      "Protocol"      "wsmouse"
    Option      "Device"        "/dev/wsmouse"
    Option      "Buttons"       "5"
    Option      "ZAxisMapping"  "4 5"
EndSection
</pre>
xterm をスクロールさせるならこれだけで十分です。他のアプリケーションでは、
~/.Xdefaults を編集する必要があります。利用可能な多くのアプリケーション
について、詳しくは
<a href="http://koala.ilog.fr/colas/mouse-wheel-scroll/">Colas Nahaboo の X マウスでホイールスクロールなページ</a>
を見てください。

<ENTRYLINK>http://www.xfree86.org/support.html XFree86 Documentation

<ENTRY>which_version 私が使っている XFree86 のバージョンは何?
実行中の X サーバーのバージョンを簡単に調べるには、 xdpyinfo(1)
が使えます。たとえば次のようにします:
<pre>
$ xdpyinfo | grep release
vendor release number:    335
</pre>
XFree86 の場合、これはサーバーのバージョンが 3.3.5 であることを表します。

<ENTRY>anti_aliased NetBSD と XFree86 4 上でのアンチエイリアスフォントの設定方法

<b>注意</b>: xpkgwedge を使っている場合は、以下の説明中のパスを適宜読み替えてください
<p>
<ol>
<li>以下の各パッケージを <a href="../software/packages.html">pkgsrc</a> からインストールします:
	<ul>
		<li><PKGSRC>fonts/ms-ttf</li>
		<li><PKGSRC>fonts/mkfontscale</li>
                <li><PKGSRC>fonts/fontconfig</li>
	</ul>
</li>
<li>フォントのヒント情報を設定します:
	<ul>
		<li><tt>mkfontscale /usr/X11R6/lib/X11/fonts/TrueType</tt></li>
		<li><tt>mkfontdir /usr/X11R6/lib/X11/fonts/TrueType</tt></li>
	</ul>
	これで、 TrueType フォントディレクトリー内に 'fonts.dir' と
	'fonts.scale' ができたはずです。
</li>
<li>X サーバーの構成:
	<ul>
		<li>"Module" セクション内に、以下の記述があることを確認します:
<pre><tt>
		Load "type1"
		Load "freetype"
</tt></pre>
		</li>
		<li>"Files" セクション内の、フォントパスの順序を確認します。
               TrueType と Type1 用のフォントパスが、
               それ以外のものより先にあることを確認します:
<pre><tt>
		FontPath   "/usr/X11R6/lib/X11/fonts/local/"
		FontPath   "/usr/X11R6/lib/X11/fonts/TrueType/"
		FontPath   "/usr/X11R6/lib/X11/fonts/Type1/"
		FontPath   "/usr/X11R6/lib/X11/fonts/misc/"
		FontPath   "/usr/X11R6/lib/X11/fonts/75dpi/:unscaled"
		FontPath   "/usr/X11R6/lib/X11/fonts/100dpi/:unscaled"
		FontPath   "/usr/X11R6/lib/X11/fonts/75dpi/"
		FontPath   "/usr/X11R6/lib/X11/fonts/100dpi/"

</tt></pre>
		</li>
	</ul>
</li>
<li>Xft の設定 -- /usr/X11R6/lib/X11/XftConfig ファイルの例を以下に示します:
<pre><tt>
##### Example XftConfig
dir "/usr/X11R6/lib/X11/fonts/TrueType"
dir "/usr/X11R6/lib/X11/fonts/Type1"
# LCD ディスプレイを使っている場合は、次の行のコメントを外します
#match edit rgba = rgb;
match any family == "fixed"             edit family =+ "mono";
includeif       "~/.xftconfig"
match any family == "Times"             edit family += "Times New Roman";
match any family == "Helvetica"         edit family += "Verdana";
match any family == "Courier"           edit family += "Courier New";
match any family == "serif"             edit family += "Times New Roman";
match any family == "sans"              edit family += "Verdana";
match
        any family == "mono"
        all slant == roman
        all weight < bold
edit
        family += "monotype.com";
match any family == "mono"              edit family += "Courier New";
match any family == "Charter"           edit family += "Bitstream Charter";
match any family == "Bitstream Charter" edit family =+ "Charter";
match any family == "Lucidux Serif"     edit family += "LuciduxSerif";
match any family == "LuciduxSerif"      edit family =+ "Lucidux Serif";
match any family == "Lucidux Sans"      edit family += "LuciduxSans";
match any family == "LuciduxSans"       edit family =+ "Lucidux Sans";
match any family == "Lucidux Mono"      edit family += "LuciduxMono";
match any family == "LuciduxMono"       edit family =+ "Lucidux Mono";
match any family == "Comic Sans"        edit family += "Comic Sans MS";
match any family == "Comic Sans MS"     edit family =+ "Comic Sans";
match any family == "Trebuchet"         edit family += "Trebuchet MS";
match any family == "Trebuchet MS"      edit family =+ "Trebuchet";
match any family == "Monotype"          edit family =+ "Monotype.com";
match any family == "Andale Mono"       edit family += "Monotype.com";
match any family == "Monotype.com"      edit family =+ "Andale Mono";
##### End of XftConfig

</tt></pre>
</li>
<li>fontconfig を利用するアプリケーション用のフォントキャッシュを再構築します:
<pre><tt>
	fc-cache -v
</tt></pre>
これにはかなり時間がかかりますので (PII 366 マシンで最大 20 分程度)、
辛抱して待ってください。
</li>
<li>これで完了です。 X サーバーを再起動して、この構成を確認してください:
<pre><tt>
	xterm -ls -fg gray -bg black -ls -fa "Courier New Bold" -fs 10
</tt></pre>
</li>
</ol>
このアンチエイリアスフォント Mini-Howto は、 Jared D. McNeill によるものです。



<SECTION>プログラムのコンパイル

<ENTRY>compile_fails_xm コンパイルに失敗する - 'unable to locate libXm'
Xm は標準の X11 環境に入っていません。これは商用の GUI である
<a href="http://www.opengroup.org/desktop/motif/">Motif</a> の一部です。<p>
Motif のフリーな実装である
<a href="http://www.lesstif.org/">Lesstif</a> も利用できます。
これは <a
href="../software/packages.html">NetBSD パッケージ</a>の中に
x11/<PKGSRC>x11/lesstif として含まれています。

<ENTRY>compile_fails_xpm コンパイルに失敗する - 'unable to locate xpm.h' または '-lXpm: no match'
xpm.h は X の PixMap ライブラリーの一部で、カラーアイコンを作るために
多くのプログラムで使われています。
これは <a
href="../software/packages.html">NetBSD パッケージ</a>の中に
graphics/<PKGSRC>graphics/xpm として含まれています。

<ENTRY>compile_basic コンパイルでリンクに失敗する: Undefined symbol '_XOpenDisplay'
サードパーティー製のソフトウェアの場合、
<a href="../software/packages.html">NetBSD
パッケージコレクション</a>で利用可能なバージョンを確認すべきです。
あなたが書いたコードの場合、必要な X ライブラリーをリンクするようにしなければ
なりません。この場合は、リンク行の末尾に <code>-L/usr/X11R6 -lX11</code>
を追加してください。

</LIST>

<DOCLINK>

<hr>
<address>
  <small>
  (連絡先 - <a href="../../Misc/feedback.html">英語</a>,
       <a href="mailto:www@JP.NetBSD.ORG">日本語:
       www@JP.NetBSD.ORG</a>)<br>
  $NetBSD: index.list,v 1.30 2002/12/31 18:44:24 jschauma Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy; 1994-2002
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
