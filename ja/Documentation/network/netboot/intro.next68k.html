<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
<!-- Copyright (c) 1998-2002
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.ORG">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<title>Introduction (next68k-specific), Diskless NetBSD HOW-TO</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<a href="intro.html">Previous</a> |
<a href="bootpd.html">Next</a> |
<a href="./">Table of Contents</a>

<hr>

<h1>Introduction (next68k-specific), Diskless NetBSD HOW-TO</h1>

<h2>NeXT Firmware procedures</h2>
<dl><dt><dd>
<big><b>Which NeXT machines can netboot</b></big>
<p>

All NeXT workstations can boot over their network interface.  A network
boot-strap procedure can be started by entering the appropriate ROM
monitor command.
<p>

<big><b>Obtaining an IP address and downloading the boot loader</b></big>
<p>

NeXT workstations first try to acquire an IP address using the Internet
Bootstrap Protocol (BOOTP) or the Dynamic Host Configuration Protocol
(DHCP) in BOOTP-compatible mode.  
When using BOOTP, the bootpd server uses the ethernet address
of the machine to determine its IP address and a bootloader filename.
If the BOOTP request is successful, the firmware in the NeXT expects to
be able to download a second-stage boot program via the <a
href="tftpd.html">TFTP protocol</a>. It will do this by setting up a
TFTP connection to the server that answered the earlier BOOTP request,
and asking for the file returned by the BOOTP request.  The second-stage
boot program then loads the kernel using NFS.
<p>

You can find a suitable second-stage boot program in <tt>/usr/mdec/boot</tt>
in the NetBSD/next68k distribution. This boot program will then load
the <tt>netbsd</tt> kernel.
</dd></dl>

<h2>Firmware commands</h2>
<dl><dt><dd>
To get to the ROM Monitor prompt, press the <tt>command</tt> and the backquote
key on the keypad (<tt>`</tt>) after the system has completed the power on self 
test and before it starts to boot an operating system.
<p>
The firmware command to load over the network is <tt><b>ben</b></tt>.
Use the following syntax to boot NetBSD:
<p>

<ul>
<li>`<tt><b>ben()<em>kern_name</em></b></tt>', where
<tt><b><em>kern_name</em></b></tt> is the name of the kernel to boot,
usually `<tt><b>netbsd</b></tt>'
</ul>
<p>

Other arguments can be passed to the boot loader by specifying them on
the end of the command line.
<p>

To make booting over the network the default, use the <tt><b>p</b></tt>
command.  At the first prompt, enter `<tt><b>en()netbsd</b></tt>' as
the boot command.  It is also useful to answer yes to "verbose test
mode", so that the monitor displays the boot progress.  For example:
<pre>NeXT&gt;<b>p</b>
boot command: sd()? <b>en()netbsd</b>
DRAM tests:  yes? <b>yes</b>
perform power-on system test:  yes? <b>yes</b>
        sound out tests:  yes? <b>yes</b>
        SCSI tests:  yes? <b>yes</b>
        loop until keypress:  no?  <b>no</b>
        verbose test mode:  no?  <b>yes</b>
boot extended diagnostics:  no?  <b>no</b>
serial port A is alternate console:  no?  <b>yes</b>
allow any ROM command even if password protected:  no?  <b>no</b>
allow boot from any device even if password protected:  no?  <b>no</b>
allow optical drive #0 eject even if password protected:  yes?  <b>yes</b>
enable parity cehcking if parity memory is present:  no?  <b>no</b>
</pre>
</dd></dl>

<h2>BOOTP notes</h2>
<dl><dt><dd>
NeXT machines can use BOOTP or DHCP to determine their IP address and
other boot information.  When using BOOTP, be sure to set the <em>vendor
magic</em> field in the <tt><b>bootpd</b></tt> server's
<tt><b>/etc/bootptab</b></tt> to <em>auto</em>, or else the NeXT will
ignore the BOOTP response from the server.  The equivalent DHCPD field is to
set <tt>always-reply-rfc1048 false;</tt>.
</dd></dl>

<h2>Begin setting things up (suggested order):</h2>
<dl><dt><dd>
<ol>
<li><a href="bootpd.html"><tt>bootpd</tt></a> or 
    <a href="dhcpd.html"><tt>dhcpd</tt></a>
<li><a href="tftpd.html"><tt>tftpd</tt></a>
<li><a href="nfs.html"><tt>nfs</tt></a>
<li><a href="files.html">client filesystem</a>
<li><a href="finish.html">finishing up</a>
</ol>
</dd></dl>

<hr>

<a href="intro.html">Previous</a> |
<a href="bootpd.html">Next</a> |
<a href="./">Table of Contents</a>

<hr> 

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../../../"><img
        src="../../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a> 
  </td><td>
    <a href="../../../"><img
        src="../../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Home Page</a>
  </td></tr></table>
</td><td>
  <table><tr><td> 
    <a href="../../../Documentation/"><img
        src="../../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a>
  </td><td>
    <a href="../../../Documentation/"><img
        src="../../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Documentation top level</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  <a href="../../../Misc/feedback.html">(Contact us)</a>
  $NetBSD: intro.next68k.html,v 1.12 2002/12/24 17:02:36 jschauma Exp $<br>
  <a href="../../../Misc/disclaimer.html">Copyright &copy;
    1998-2002
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
