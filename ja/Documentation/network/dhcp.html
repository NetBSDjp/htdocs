<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html lang="ja">
<head>

<!-- DO NOT EDIT THIS FILE. EDIT 'dhcp.list' AND RUN 'make' -->

<!-- Copyright (c) 1994-2004
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-2022-JP">
<link rev="made" href="mailto:www@jp.NetBSD.org">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<title>NetBSD DHCP HOWTO</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">
<table><tr><td>
    <a href="../../Misc/disclaimer.html#bsd-daemon"><img
     align="middle" src="../../../images/BSD-daemon.jpg" origlink="../../images/BSD-daemon.jpg" border="0"
     width=146 height=129 alt="BSD daemon"></a>
  </td><td align=center>
    <h1>NetBSD ドキュメンテーション:</h1>
    <h1>DHCP How-To</h1>
</td></tr></table>
<p>

<h2><a name="top">DHCP について</a></h2>
<ul>
<li>
<a href="#introduction">紹介と目的</a></li>
<li>
<a href="#what_is_dhcp">DHCPとは何か</a></li>
<li>
<a href="#who_needs_dhcp">DHCPはどのような人にとって有用か</a></li>
<li>
<a href="#more_info_sources">より詳細な情報の所在</a></li>
</ul>
<h2>DHCP クライアントの設定</h2>
<ul>
<li>
<a href="#configure_dhcp">DHCP のコンフィギュレーション</a></li>
<li>
<a href="#enable_dhcp">DHCP を有効にする。</a></li>
<li>
<a href="#keep_resolv_conf">dhclient が /etc/resolv.conf を攻撃するのを抑止する方法</a></li>
</ul>
<h2>DHCP サーバーの設定</h2>
<ul>
<li>
<a href="#configure_dhcpd">DHCPD のコンフィギュレーション</a></li>
<li>
<a href="#enable_dhcpd">DHCPD を有効にする</a></li>
<li>
<a href="#touch">dhcpd.leases ファイルの作成</a></li>
</ul>


<hr>
<h2>DHCP について</h2><hr>
<p><h3>
<a name="introduction">紹介と目的</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

このドキュメントの目的は、DHCPのクライアントとサーバーを NetBSDオペ
レーティングシステムにおいて設定する方法を説明することです。


</dd></dl>
<p><h3>
<a name="what_is_dhcp">DHCPとは何か</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
   

DHCPはDynamic Host Configuration Protocolの略です。
それによって、ホストコンピューターの
ネットワーク設定を動的に行うことがで
きます。
基本的なアイディアは以下の通り:
<ul>
<li>DHCPクライアントが起動された時、そのコンピューターには最初はIPアドレスが割当てられていない。
<li>クライアントはそのネットワーク上の任意のDHCPサーバーに対してブロードキャストメッセージを発行する。
<li>やりとりが行われ、DHCPサーバーはクライアントにIPアドレスを割当てる。
サーバーはまた、その他の重要なネットワーク設定パラメーター(例えば、ネームサーバーのアドレスなど)も通知する。
</ul>

</dd></dl>
<p><h3>
<a name="who_needs_dhcp">DHCPはどのような人にとって有用か</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

多くのインターネット・サービス・プロバイダ (ISP) は ISP が
動的に IP アドレスを割り振り、またその他の情報を通知できるようにする
ために、顧客に対して DHCP クライアントを使用するように要求します。
別の使い道は、一つ以上のネットワークに接続する可能性のあるラップトップコンピューターです。
例えば、ラップトップはオフィスと自宅の両方でネットワークに接続されることがあります。
この場合、異なる2つのネットワークに接続するために手動で設定を変更し直す必要がないので、
DHCPを使うのがぴったりと言えます。この場合は、オフィスと自宅の両方に DHCP サーバーが
存在し、ラップトップは DHCP のクライアントである事が必要です。

</dd></dl>
<p><h3>
<a name="more_info_sources">より詳細な情報の所在</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

一般的な DHCP に関するより詳細な情報は、
<a href="http://www.cis.ohio-state.edu/cgi-bin/rfc/rfc1541.html"><b>RFC 1541</b></a>, 
Request for Comments document for the Dynamic Host Configuration Protocol (DHCP)
を参照して下さい。
また、包括的な
<a href="http://www.dhcp-handbook.com/dhcp_faq.html">DHCP FAQ</a>
もあります。

</dd></dl>
<hr>
<h2>DHCP クライアントの設定</h2><hr>
この節では、NetBSDにおけるDHCPクライアントの設定方法について説明します。

<p><h3>
<a name="configure_dhcp">DHCP のコンフィギュレーション</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

DHCP のクライアントの設定は <code>/etc/dhclient.conf</code>
ファイルを使っておこないますが、このファイルがなくても DHCP
はちゃんと動作します。詳細は <tt><a href="http://man.NetBSD.org/man/dhclient.conf+5+NetBSD-current">dhclient.conf(5)</a></tt> と
<tt><a href="http://man.NetBSD.org/man/dhcp-options+5+NetBSD-current">dhcp-options(5)</a></tt> を参照してください。典型的な
<code>/etc/dhclient.conf</code> を以下に示します。


<pre>
Send host-name "myname.my.domain";                 &lt;=== ここに
                                                        ホスト名を書く
send dhcp-client-identifier "myident";             &lt;=== ここにホスト
                                                        識別子を書く
							(これは myname と同じ
							 であることが多い).
request subnet-mask, broadcast-address, routers,
    domain-name-servers;

timeout 30;
retry 60;
select-timeout 5;

script "/sbin/dhclient-script";

lease {
  interface "sn0";                               &lt;=== ここにインターフェース
                                                      デバイスを書く
  option host-name "myname.my.domain";           &lt;=== ここに
                                                      ホスト名を書く
  option subnet-mask 255.255.255.0;
  option domain-name "my.domain";                &lt;=== ここに
                                                      ドメイン名を書く
  option domain-name-servers 127.0.0.1;
  renew 2 2000/1/12 00:00:01;
  rebind 2 2000/1/12 00:00:01;
  expire 2 2000/1/12 00:00:01;
}
</pre>


</dd></dl>
<p><h3>
<a name="enable_dhcp">DHCP を有効にする。</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

<code>/etc/rc.conf</code> を編集し、'<code>dhclient</code>' 行を
'<code>dhclient=YES</code>' となるように変更します。デフォルトでは、
DHCP の要求は、繋がっている全ネットワークインターフェースに送られます。
1 枚の、あるいは一部のネットワークカードで DHCP を使いたいだけの場合は、
'<code>dhclient_flags</code>' 行に DHCP 設定をおこなう
ネットワークインターフェースのリストを追加します。例えば
'<code>dhclient_flags="ae1"</code>'
とします。

次回のリブート時にマシンは自動的に DHCP クライアントとして設定されます。
リブートせずに DHCP を有効にするには、コマンド
'<code>sh /etc/rc.d/dhclient start</code>' を実行して下さい。


</dd></dl>
<p><h3>
<a name="keep_resolv_conf">dhclient が /etc/resolv.conf を攻撃するのを抑止する方法</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

通常、 dhclient は DHCP サーバーからの情報を /etc/resolv.conf
に上書きします。そうしたくない稀な状況では、
/etc/dhclient-enter-hooks に適切にフックを書いておくことで、
これを抑止できます:

<pre>
# <b>cat /etc/dhclient-enter-hooks</b>
make_resolv_conf() {
        echo "doing nothing to resolv.conf"
} </pre>

さらなる情報は <a href="http://man.NetBSD.org/man/dhclient-script+8+NetBSD-current">dhclient-script(8)</a> マニュアルページを参照してください。
<p>


</dd></dl>
<hr>
<h2>DHCP サーバーの設定</h2><hr>
この節では DHCP サーバーの設定方法について説明します。
あなたの LAN で動的にアドレスを割り当てたい場合にのみ
DHCP サーバーが必要であることに注意して下さい。
詳細は <tt><a href="http://man.NetBSD.org/man/dhcpd+8+NetBSD-current">dhcpd(8)</a></tt>, <tt><a href="http://man.NetBSD.org/man/dhcpd.conf+5+NetBSD-current">dhcpd.conf(5)</a></tt>, 
<tt><a href="http://man.NetBSD.org/man/dhcp-options+5+NetBSD-current">dhcp-options(5)</a></tt> を参照して下さい。


<p><h3>
<a name="configure_dhcpd">DHCPD のコンフィギュレーション</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

DHCP サーバーの設定は <code>/etc/dhcpd.conf</code> ファイルに記述します。
もし、このファイルがなければ作成して下さい。
このファイルはカスタマイズすることが必要です。
特に、ホスト名やイーサネットインターフェースを変更することを忘れないようにしてください。
典型的な <code>/etc/dhcpd.conf</code> を以下に示します。 この例では、7つの
アドレスが、DHCP クライアント用に確保されます。確保されるアドレスは 192.168.0.2 から
192.168.0.8 です。DHCP サーバーはクライアントに対して、使用すべき IP アドレス、ネットマスク、
ルーター、ネームサーバー とドメイン名を通知します。

<pre>
# Setting DHCPD global parameters
allow unknown-clients;

# Set parameters for the 192.168.0.0/24 subnet.
subnet 192.168.0.0 netmask 255.255.255.0 {
range 192.168.0.2 192.168.0.8;                &lt;=== ここに割り当て可能な
                                                   IP アドレスの範囲を書く
default-lease-time 604800;                    &lt;=== デフォルトの貸与時間(単位は秒)。
                                                   クライアントが明示的に要求してこない
                                                   場合に用いられます。
max-lease-time 604800;                        &lt;=== 最大貸与時間
option subnet-mask 255.255.255.0;             &lt;=== クライアントに通知するネットマスク
option domain-name-servers 1.2.3.4, 1.2.3.5;  &lt;=== ネームサーバーの IP アドレスの
                                                   リストをここに書く
option domain-name "your.domain.name";
option routers 192.168.0.1;                   &lt;=== クライアントが使用すべきルーターの
                                                   リスト
}
</pre>

</dd></dl>
<p><h3>
<a name="enable_dhcpd">DHCPD を有効にする</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

<code>/etc/rc.conf</code> を編集し、'<code>dhcpd</code>' 行を
'<code>dhcpd=YES</code>' となるように変更します。全ネットワークインターフェースで
DHCP 要求へのサービスをしたいわけでない場合には、
'<code>dhcpd_flags</code>'行に DHCPD が動作する
ネットワークインターフェースのリストを追加します。例えば
'<code>dhcpd_flags="-q ae1"</code>'
とします。


</dd></dl>
<p><h3>
<a name="touch">dhcpd.leases ファイルの作成</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
dhcpd は /var/db/dhcpd.leases ファイルを必要とします。
'<code>touch /var/db/dhcpd.leases</code>' してファイルを作ります。


</dd></dl>
<hr>

<a href="./"><em>NetBSD ドキュメンテーション: ネットワーク</em></a>へ戻る
<hr>

<table width="100%"><tr><td>
<table border="0" summary="Footer navigation"><tr>
<td class="foothome"><span class="foothome"><a href="../../"><img src="../../../images/NetBSD-flag.png" origlink="../../images/NetBSD-flag.png" alt="" border="0" width="90" height="90"></a></span></td>
<td class="foothome">
<span class="foothome"><a href="../../">ホームページ</a></span><br>
</td>
</tr></table>
</td><td>
<table border="0" summary="Footer navigation"><tr>
<td class="foothome"><span class="foothome"><a href="../../Documentation/"><img src="../../../images/NetBSD-flag.png" origlink="../../images/NetBSD-flag.png" alt="" border="0" width="90" height="90"></a></span></td>
<td class="foothome">
<span class="foothome"><a href="../../Documentation/">Documentation top level</a></span><br>
</td>
</tr></table>

</td></tr></table>

<hr>
<address>
  <small>
  (連絡先 - <a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">英語</a>,
       <a href="mailto:www@jp.NetBSD.org">日本語:
       www@jp.NetBSD.org</a>)<br>
  $NetBSD: dhcp.list,v 1.16 2004/03/20 21:39:48 snj Exp $<br>
  <!-- based on english translation: -->
  <!-- NetBSD: dhcp.list,v 1.17 2004/08/27 23:55:44 hubertf Exp   -->
  <a href="../../Misc/disclaimer.html">Copyright &copy; 1994-2004
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
