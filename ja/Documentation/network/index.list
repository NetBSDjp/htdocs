<html>
<head>
<!-- Copyright (c) 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<title>The NetBSD Networks FAQ</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<HEADING>NetBSD ネットワーキングの基礎

このページは作成中ですので、
<a href="../../Misc/feedback.html">コメントや提案</a>を歓迎します。

<LIST>
<h2>Other links</h2>
<!--
If you add entries here, please add them to ../index.html as well.
Note that the relative URL path needs to be modified.
-->
<ul>
  <li><a href="wavelan.html">Lucent WaveLAN を用いたワイヤレスネットワーキング</a>
  <li><a href="netboot/">HOWTO ディスクレスマシンのネットブート</a>
  <li><a href="http://coombs.anu.edu.au/~avalon/ip-filter.html">IP-Filter</a> を
      用いた<a href="http://radon.static.net/~armenb/ipnat.html">ネットワーク
      アドレス変換 (Network Address Translation, NAT) FAQ</a>
  <li><a href="dhcp.html">DCHP クライアントとサーバー設定の HOWTO</a>.
  <li><a href="http://rfhs8012.fh-regensburg.de/~feyrer/NetBSD/NWF/">
      NetBSD/amiga のためのネットワーキング FAQ ガイド</a>
  <li><a href="ipv6/">IPv6 ネットワーキング FAQ</a>.
  <li><a href="ipsec/">IPsec FAQ</a>.
  <li><a href="http://www.macbsd.com/macbsd/howto/index.html">
      PPP、クロスコンパイル、その他の HOWTO</a>
  <li><a href="http://www.obfuscation.org/ipf/ipf-howto.txt">IP Filter ベースの防火壁 HOWTO</a>
</ul>

<SECTION>Networking FAQ

<ENTRY>getting_started 始めよう
NetBSD のインストール手順は基本的なネットワークの設定を含んでおり、
標準的なワークステーション構成の設定を行います。
この設定は NetBSD の多くのネットワークの機能を利用するために拡張することができます。
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li><a href="http://www.cis.ohio-state.edu/htbin/rfc/rfc1918.htmlRFC">RFC 1918</a>
	   (<a href="ftp://ftp.nic.ad.jp/jpdoc/rfc-jp/rfc1918-jp.txt">和訳</a>)
             - プライベート・インターネットのアドレス割り当て
      </ul>
</ul>

<ENTRY>configuration_files  ネットワーク設定ファイル
ネットワークの設定は、テキスト形式の設定ファイルによって
設定します。
<ul>
  <li>/etc/rc.conf - rc.conf(5) 
      システムの初期化時に、ネットワークサービスを含む
      システムサービスを自動的に開始するための設定。
  <li>/etc/hosts - hosts(5) もっとも基本的なホスト名とIPアドレスの対応表。
  <li>/etc/myname - そのホストの FQDN (ドメイン名のついたホスト名)。
  <li>/etc/mygate - デフォルトゲートウェイ。通常は /etc/rc.conf に記述する方がよい。また、
      routed(8) を使用することもできる。
  <li>/etc/ifconfig.{<em>IF</em>}. - 
      ネットワークインタフェース <em>IF</em> の設定。
      システムの初期化時、ネットワークインタフェースを
      設定するために <em>/etc/netstart</em>で用いられる。
  <li>/etc/ifaliases - ifaliases(5)
      一つのインタフェースには一つ以上の IP アドレス (alias) を割り当て
      ることができる。
      ここで記述された alias は、システムの初期化時に <em>/etc/netstart</em>
      で用いられる。
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>configuration_programs  ネットワーク設定プログラム
二つの重要なネットワーク設定プログラムがネットワークスタートアップ
スクリプト (/etc/netstart) で使われています。これらは使用中のネットワークの
設定を手動で変更するのに使うこともできます。

<ul>
  <li>ifconfig(8) - ネットワークインタフェースの設定を変更、参照する。
  <li>route(8) - ネットワークルーティングテーブルを操作する。
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>adding_a_host  ネットワークに新しいホストを追加する
新たにネットワークに接続するホストでは、インタフェースを、
そのローカル・ネットワーク上のアドレスに設定することが最低限必要です。
NetBSD のインストール中にネットワークの情報を与えると、
新しいホストはすぐにネットワークに接続され、
その IP アドレスでアクセスできるようになります。
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>naming_a_host  ネットワークの新しいホストを名づける
IP アドレスと同じようにホスト名でのアクセスを可能にするには、
新しいホスト名とその IP アドレスをネットワーク設定ファイルに
追加します。それにはいくつかの方法があります;

<ol>
  <li>/etc/hosts: hosts(5) 
      少数のホストからなる小さなネットワークでは、
      ホスト名と IP の対応を、各ホストの /etc/hosts ファイルに
      手でコピーすることができるでしょう。
      <p>
      <em>/etc/hosts:</em><br>
      <samp>
      192.168.1.2  host2.mydomain.org.au host2<br>
      </samp>
      <p>
  <li>yp(8) を使うと /etc/hosts ファイルと同等な情報を、ネットワーク上で
      自動的に共有できるようになります。(hosts にある情報だけではなく
      他のファイルにある情報も共有できます)。
  <li>DNS: ホスト名の対応をネームサーバー named(8)
      経由でアクセスするゾーンファイルで集中管理します。
      (DNS ファイルの設定や管理についての多くのドキュメントが
      <a href="http://www.dns.net/dnsrd/docs/">www.dns.net</a>
      にあります)。
      <p>
      <em>正引きゾーンファイルのエントリー</em><br>
      <samp>
      host2  A     192.168.1.2
      </samp>
      <p>
      <em>逆引きゾーンファイルのエントリー</em><br>
      <samp>
      2      PTR   host2.mydomain.org.au.
      </samp>
</ol>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>internetworking  インターネットワーキング
あなたのネットワーク (一つのホストから成るかもしれません) を
他のネットワークにつなぐ場合、少なくとも一つのホストを
二つのネットワーク間のゲートウェイとして動作させなくてはなりません。
ゲートウェイホストは二つのネットワークインタフェースを持っており、
それぞれを各ネットワークについて設定します。

<ul>
  <li>二つ目のイーサネットのインタフェース設定ファイルを作成する
      (/etc/ifconfig.{<em>interface</em>}) 。
      <p>
      <em>/etc/ifconfig.we1</em><br>
      <samp>
      192.168.2.30 netmask 0xffffff00 media 10base2/BNC
      </samp>
      <p>
  <li>新しいインタフェースを有効にする為にリブートする。
  <li>IP パケットフォワーディングを有効にします。カーネルを
      "options GATEWAY" をつけて compile してもいいですし、
      ブートのたびに例えば /etc/rc.local から "sysctl -w
      net.inet.ip.forwarding=1" を実行してもいいでしょう。
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>ppp  PPPによるインターネットワーキング
pppd(8)
を用いるとシリアルポート (モデムの有無にかかわらず) 上に特殊な
ネットワークインタフェースを作成できます。

<p>

PPP のセットアップには多くの方法があります。あなたの ISP に接続するのに
適した一つの簡単な方法は;
<ol>
  <li>ピアーオプションファイルを作成する
      <p>
      <em>/etc/ppp/peers/myisp</em><br>
      <samp>
      # Example pppd options <br>
      # Specific for myisp <br>
      /dev/tty01<br>
      local_IP_address:remote_IP_address<br>
      connect '/usr/sbin/chat -v -f /etc/ppp/peers/myisp.chat'<br>
      defaultroute<br>
      persist<br>
      ipparam myisp<br>
      asyncmap 0<br>
      noauth
      </samp>
      <p>
  <li>デバイスオプションファイルを作成する
      <p>
      <em>/etc/ppp/options.{ttyname}</em><br>
      <samp>
      # Example pppd options <br>
      # Specific for ttyname <br>
      lock<br>
      crtscts<br>
      57600<br>
      modem<br>
      </samp>
      <p>
  <li>チャットファイルを作成する
      <p>
      <em>/etc/ppp/peers/myisp.chat</em><br>
      <samp>
      # Example chat file <br>
      # Specific for myisp<br>
      ABORT BUSY ABORT 'NO CARRIER' ""<br>
      \da\ptz0 OK<br>
      \da\ptdt8887776655 CONNECT<br>
      </samp>
      <p>
  <li>コネクションを確立する;
      <p>
      <samp>
      pppd call myisp
      </samp>
      <p>
  <li>変数をセットする
      <p>
      <samp>
      ppp_peers="myisp"
      </samp>
      を /etc/rc.conf rc.conf(5)
      に書いておくとブート時に自動的にコネクションが確立するようになります。
</ol>

イーサネットインタフェースと異なり、<em>/etc/ifconfig.{interface}</em>
ファイルを PPP インタフェースに作成する必要はありません。
<p>
デマンドダイアル ppp を使用していて、特定のトラフィック(例えば xntpd(8) の
ntp のトラフィック)でリンクが確立されないようにしたいならば、
pppd.conf ファイル中で <tt>active-filter</tt> を使うことができます:
<pre>	active-filter   'not udp port ntp'</pre>

<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>chat(8) - Automated conversational script
        <!-- http://www.macbsd.com/macbsd/howto/pppnat
             How to setup PPP for multiple ISP's, including
             IP-NAT and DNS setup. -->
      </ul>
</ul>

<ENTRY>pppleased 専用線を用いた pppd の設定
専用線とは固定された2点間 link の事です。
この場合、NetBSD での設定は非常に簡単です。
サーバーで次のような <em>/etc/ppp/options</em> を作成します:
<p>
     <blockquote>
     /dev/tty00<br> 
     57600<br>
     noauth<br>
     crtscts<br>
     passive<br>
     &lt;local_IP_address&gt;:&lt;remote_IP_address&gt;<br>
     debug<br>
     netmask 255.255.255.255<br>
     proxyarp<br>
     </blockquote>
<p>
&lt;local_IP_address&gt; と &lt;remote_IP_address&gt; は使用するネットワーク上の
適切なものに変更する必要があります。(&lt;local_IP_address&gt; は
イーサネットと同じでも構いませんが、&lt;remote_IP_address&gt; は
イーサネットのセグメントで有効なアドレスである必要があります)。
<p>
クライアントで次のような <em>/etc/ppp/options</em> を作成します:
<p>
     <blockquote>
     /dev/tty00<br>
     57600<br>
     noauth<br>
     crtscts<br>
     defaultroute<br>
     debug<br>
     </blockquote>
<p>
両方の設定中にあらわれる /dev/tty00 は適切なシリアルポート名に変更して下さい。

<ENTRY>isdn4bsd	ISDN カードを用いたインターネットワーキング
<a href="http://www.freebsd-support.de/i4b/">isdn4bsd</a> パッケージを
用いると、
<a href="../../Ports/alpha/index.html">NetBSD/alpha</a>,
<a href="../../Ports/amiga/index.html">NetBSD/amiga</a>,
<a href="../../Ports/atari/index.html">NetBSD/atari</a> と
<a href="../../Ports/i386/index.html">NetBSD/i386</a>
で、DSS1 (European protocol) exchange に基づく
ISDN ネットワークカードを用いることができます。
これを用いるためには、パッケージに付属の使用説明書にしたがって、
カーネルのソースにパッチを当て、ISDN サポートを含む新しいカーネルを
作成するとともに、いくつかのコントロールプログラムを生成する必要が
あります。
<p>このパッケージは未だベータテストの段階であることに注意して下さい。
<p>また、これは ISDN カードに対するもので、ISDN モデムには適用されないことにも
注意して下さい。ISDN モデムは <a href="#ppp">通常のモデムと同様</a>に
使用できるはずです。

<ENTRY>simplenat	簡単な NAT の設定

ローカルネットワーク(例えば 10.0.0.0/24) に接続されているホストから
NetBSD マシンをルーターとして使用するために、ネットワークアドレス変換
(Network Address Translation, NAT) を設定するには、次のようにすれば
いいでしょう: <P>

<OL>
<LI>クライアントでは、NAT マシンをデフォルトルータとして指定します。
        (NetBSD を使用しているならば、/etc/rc.conf に
	<TT>defaultrouter="<I>a.b.c.d</I>"</TT> を加えてください。
        ここで、<TT><I>a.b.c.d</I></TT> は内部向の IP アドレス
        (つまり、10.0.0.0 ネットワークのアドレス) を意味します)。
<LI>NAT マシンで、まずカーネルが ipfilter オプションが有効になっているかを
        確認してください:
<PRE>
options         PFIL_HOOKS    	        # pfil(9) packet filter hooks
pseudo-device   ipfilter                # IP filter (firewall) and NAT
</PRE>

<LI>以下の内容を /etc/ipf.conf(5) に書きます:
<PRE>
pass in from any to any
pass out from any to any
</PRE>

<LI>以下の内容を /etc/ipnat.conf(5) に書きます:
<PRE>
map ppp0 10.0.0.0/24 -> 0/32 proxy port ftp ftp/tcp
map ppp0 10.0.0.0/24 -> 0/32 portmap tcp/udp 40000:60000
map ppp0 10.0.0.0/24 -> 0/32
</PRE>

<LI> /etc/rc.conf で設定を有効にします:
<PRE>
ipfilter=YES                                    # uses /etc/ipf.conf
ipnat=YES                                       # uses /etc/ipnat.conf
</PRE>

<LI> /etc/rc.local で ipv4 パケットフォワーディングを有効にします:
<PRE>
sysctl -w net.inet.ip.forwarding=1
</PRE>

<LI> リブートします。

<LI> デバッグには ping(8) と tcpdump(1) を使って下さい。
</OL>

<ENTRY>maintenance  メンテナンス
<ul>
  <li>監視 - 便利なツール
      <ul>
        <li>ifconfig(8) - ネットワークインタフェースのパラメーターの設定と表示
        <li>route(8) - ルーティングテーブルの操作
        <li>ping(8) - ICMP ECHO_REQUEST パケットをネットワークホストに送る
        <li>traceroute(8) - パケットがネットワークホストに到達するルートを表示
        <li>tcpdump(1) - ネットワークインタフェース上のトラフィックを選択して表示
        <li>netstat(1) - ネットワーク状態の表示
        <li>systat(8) 'systat netstat' - ネットワーク接続を動的に表示
      </ul>
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li><PKGSRC>net/mrtg - This utility from the packages collection
			lets you monitor your network activity graphically.
      </ul>
</ul>

<ENTRY>security  セキュリティー
<ul>
  <li>/etc/hosts.{allow,deny}: 
      tcp-wrappers (hosts_access(5))
      の設定ファイル。マスターデーモン
      inetd(8)
      に組み込まれている。
  <li>もし、ネットワークアドレス変換 (NAT ときには IP マスカレードとも呼ばれます)
      も含んだ完全な防火壁が必要ならば、NetBSD 付属の IPfilter を
      使用して下さい。
      IP filter の <a href="http://coombs.anu.edu.au/ipfilter/">ホームページ</a>を
      参照してください。
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>The <a href="http://www.cert.org/">CERT* Coordination Center</a>
            studies Internet security vulnerabilities.
        <li><a href="http://www.cert.org/tech_tips/root_compromise.html">
            Steps for Recovering from a UNIX Root Compromise</a>
        <li><a href="http://www.obfuscation.org/ipf/ipf-howto.txt">IP Filter
            に基づいた防火壁 HOWTO</a>
      </ul>
</ul>

<ENTRY>appletalk  Appletalk を使う
NetBSD は unix マシンと appletalk マシンをイーサネット (localtalk では
ありません) で通信を可能にする '<PKGSRC>net/netatalk' をサポートしています。
これは MacOS マシンが NetBSD マシンを介してファイルシステムを読んだり
プリンターを用いたり、NetBSD マシンが appletalk プリンターに印刷したり
することができます。必要なソースは NetBSD の<a href="../software/packages.html">Packages
Collection</a>から利用可能です。

<ENTRY>new_bind  BIND バージョン 8 への変更
NetBSD 1.4 以降では、異なる設定ファイルフォーマットを用いる
BIND バージョン 8 を使用しています。named の一次設定ファイルの名前は
named.boot から named.conf に変更されました。次のようにすれば、
古い設定ファイルを変更することができます:
<samp>
/usr/sbin/named-bootconf &lt; named.boot &gt; named.conf
</samp>
<p>
古いバージョンの BIND (version 4) を使い続けたいのならば、
<PKGSRC>net/bind4 パッケージが準備されています。また、
named.conf(5) man ページはプログラム自身よりも
新しくなっていることに注意してください。そのため、
いくつかの機能は、ドキュメントには書かれていますが
実装されていません。

<ENTRY>kerberos Kerberos
Kerberos 認証システムについての情報は、
下記のリンクを参照してください。
<p>
<ul>
<li><a href="http://web.mit.edu/kerberos/www/">MIT Kerberos</a>
<li><a href="http://www.pdc.kth.se/kth-krb/">KTH Kerberos</a>
<li><a href="http://www.avana.net/~jtruitt/ferret/kerberos.html">Meta information (Links)</a>
</ul>

<SECTION>Network の問題

<ENTRY>unable-to-ping 他のホスト名に ping できない
    もし、他のマシンに IP アドレスで ping ("<tt><b>ping
    -n <em>W.X.Y.Z</em></b></tt>") できるのに、ホスト名ではできないのならば、
    resolv.conf(5) に問題がある可能性があります。nameservers が正しく
    設定されているか、サーバーからの応答があるかどうかを確認してください。

<ENTRY>connection-delays 接続に 30秒くらいかかる
    これは通常以下の理由によります。
    <ol>
    <li>resolv.conf(5) の設定が間違っているために、指定したネームサーバーからの
        レスポンスがなく、ホスト名探索がタイムアウトを起こしている。
    <li>リモートのメールサーバーが、あなたのマシン上の identd(8) に
        接続しようとしているのに、 tcp の 113 番ポートへの
        パケットがレスポンスすることなく落されるように ipf(8) が
        設定されている。
    </ol>

<ENTRY>t-online Gotchas for german ISP T-Online
	ドイツの ISP T-Online へダイアルインで入る場合、
	正しいユーザー名と、独自のチャットスクリプトについての 2 点について、
	大変トリッキーな事柄があります。一般的な ppp の設定方法の説明は
	<a href="#ppp">上記</a>を参照してください。
	<p>

	<ol>
	<li> T-Online のログイン名は、三つの部分を
	     つなぎ合わせたものになっています:
	     <p>

	     <ol>
	     <li> Anschlu&szlig;kennung: 12 桁の数字
   	          (<i>AAAAAAAAAAAA</i>)、たとえば 000120123456
	     <li> T-Online Nr: 12 桁の数字 (<i>TTTTTTTTTTTT</i>)、
   	          たとえば 3200123456。しばしば
	          "32" で始まります; 12 桁より少ない場合は、
	          '#' を加えます)
	     <li> Mitbenutzer-Nummer、 大抵は "0001" (<i>MMMM</i>)、
   	          たとえば 0001
             </ol>
	     <p>
             すると、ログイン名は、この三つの部分を何も挟まずに
	     一行に並べたもの ("<i>AAAAAAAAAAAATTTTTTTTTTTTMMMM</i>") 、
	    たとえば 0001201234563200123456#0001 になります。
	    これを PPP オプションファイルの "<tt>user</tt>" 行に書きます。
	     <p>
	<li> チャットスクリプトでは、モデムが <tt>CONNECT</tt> を知らせてきてから、
	     "<tt>.</tt>" を送るように注意する必要があります:

<pre>
ABORT BUSY    '' AT
              OK ATZ
              OK ATL1
              OK ATD0191011
              CONNECT <u>'.'</u>
</pre>
	     この最後のドットがないと、最初の LCP ConfReq frame を送出後、
	     T-Online ダイアルインサーバーからの返答なしに、
	     すぐに接続が切られることがあります。
             <p>
	</ol>

	さらなる情報について、 (ドイツ語の) リンクをいくつか示します
	(これらのほとんどは NetBSD 向けではありませんが、
	心配は無用です─他の Unix-like オペレーティングシステムで
	うまく使える手法は、普通は NetBSD でもうまくいきます):
	<p>

	<ul>
        <li> <a href="http://www.albert-rommel.de/ppp.htm">PPP-Zugang
   	          zu <font color="#FF00FF">T</font>-Online</a>
        <li> <a href="http://home.t-online.de/home/Diedrich.Ehlerding/besonderheiten.html">Netzzugang bei <font color="#FF00FF">T</font>-Online: esonderheiten und Einschr&auml;nkungen</a> 
	<li> <a href="http://sdb.suse.de/sdb/de/html/toppp.html">SuSE:
	     T-Online Zugang mit PPP</a>
	<li> <a
	     href="http://sdb.suse.de/sdb/de/html/t_online3.html">SuSE:
	     T-Online: Verbindung wird nicht aufgebaut</a>
	<li> <a
   	          href="http://sdb.suse.de/sdb/de/html/toppp_files.html">SuSE: PPP-Files f&uuml;r T-Online</a>
	</ul>

</LIST>

<DOCLINK>

<hr>
<address>
  <a href="../../Misc/feedback.html">(Contact us)</a>
  $NetBSD: index.list,v 1.29 2000/08/02 21:32:02 hubertf Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy;
    1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
</address>

</body>
</html>
