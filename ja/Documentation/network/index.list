<html>
<head>
<!-- Copyright (c) 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.ORG">
<title>The NetBSD Networks FAQ</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<HEADING>Basic NetBSD Networking

このページは作成中ですので、
<a href="../../Misc/feedback.html">コメントや提案</a>を歓迎します。

<LIST>
<h2>Other links</h2>
<!--
If you add entries here, please add them to ../index.html as well.
Note that the relative URL path needs to be modified.
-->
<ul>
  <li><a href="wavelan.html">Wireless networking using the Lucent WaveLAN</a>
  <li><a href="netboot/index.html">HOWTO Netboot a diskless machine</a>
  <li><a href="http://radon.static.net/~armenb/ipnat.html">Network
      Address Translation (NAT) FAQ</a>, using
      <a href="http://coombs.anu.edu.au/~avalon/ip-filter.html">IP-Filter</a>.
  <li><a href="dhcp.html">HOWTO setup DHCP clients and servers</a>.
  <li><a href="http://rfhs8012.fh-regensburg.de/~feyrer/NetBSD/NWF/">
      NetBSD/amiga Guide to Networking FAQ</a>
  <li><a href="ipv6/index.html">IPv6 Networking FAQ</a>.
  <li><a href="http://www.macbsd.com/macbsd/howto/index.html">
      PPP, cross compiling, and other HOW-TOs</a>
</ul>

<SECTION>Networking FAQ

<ENTRY>getting_started 始めよう
NetBSD のインストール手順は基本的なネットワークの設定を含んでおり、
標準的なワークステーション構成の設定を行います。
この設定は NetBSD の多くのネットワークの機能を利用するために拡張することができます。
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li><a href="http://www.cis.ohio-state.edu/htbin/rfc/rfc1918.htmlRFC">RFC 1918</a>
	   (<a href="ftp://ftp.nic.ad.jp/jpdoc/rfc-jp/rfc1918-jp.txt">和訳</a>)
             - プライベート・インターネットのアドレス割り当て
      </ul>
</ul>

<ENTRY>configuration_files  ネットワーク設定ファイル
ネットワークの設定は、テキスト形式の設定ファイルによって
設定します。
<ul>
  <li>/etc/rc.conf - rc.conf(5) 
      システムの初期化時に、ネットワークサービスを含む
      システムサービスを自動的に開始するための設定。
  <li>/etc/hosts - hosts(5) もっとも基本的なホスト名とIPアドレスの対応表。
  <li>/etc/myname - そのホストの FQDN (ドメイン名のついたホスト名)。
  <li>/etc/mygate - default gateway. Usually better put in /etc/rc.conf, or
      you can run routed(8).
  <li>/etc/ifconfig.{<em>IF</em>}. - 
      ネットワークインタフェース <em>IF</em> の設定。
      システムの初期化時、ネットワークインタフェースを
      設定するために <em>/etc/netstart</em>で用いられる。
  <li>/etc/ifaliases - ifaliases(5)
      一つのインタフェースには一つ以上の IP アドレス (alias) を割り当て
      ることができる。
      ここで記述された alias は、システムの初期化時に <em>/etc/netstart</em>
      で用いられる。
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>configuration_programs  ネットワーク設定プログラム
二つの重要なネットワーク設定プログラムがネットワークスタートアップ
スクリプト (/etc/netstart) で使われています。これらは使用中のネットワークの
設定を手動で変更するのに使うこともできます。

<ul>
  <li>ifconfig(8) - ネットワークインタフェースの設定を変更、参照する。
  <li>route(8) - ネットワークルーティングテーブルを操作する。
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>adding_a_host  ネットワークに新しいホストを追加する
新たにネットワークに接続するホストでは、インタフェースを、
そのローカル・ネットワーク上のアドレスに設定することが最低限必要です。
NetBSD のインストール中にネットワークの情報を与えると、
新しいホストはすぐにネットワークに接続され、
その IP アドレスでアクセスできるようになります。
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>naming_a_host  ネットワークの新しいホストを名づける
IP アドレスと同じようにホスト名でのアクセスを可能にするには、
新しいホスト名とその IP アドレスをネットワーク設定ファイルに
追加します。それにはいくつかの方法があります;

<ol>
  <li>/etc/hosts: hosts(5) 
      少数のホストからなる小さなネットワークでは、
      ホスト名と IP の対応を、各ホストの /etc/hosts ファイルに
      手でコピーすることができるでしょう。
      <p>
      <em>/etc/hosts:</em><br>
      <samp>
      192.168.1.2  host2.mydomain.org.au host2<br>
      </samp>
      <p>
  <li>yp(8) を使うと /etc/hosts ファイルと同等な情報を、ネットワーク上で
      自動的に共有できるようになります。(hosts にある情報だけではなく
      他のファイルにある情報も共有できます)。
  <li>DNS: ホスト名の対応をネームサーバー named(8)
      経由でアクセスするゾーンファイルで集中管理します。
      (DNS ファイルの設定や管理についての多くのドキュメントが
      <a href="http://www.dns.net/dnsrd/docs/">www.dns.net</a>
      にあります)。
      <p>
      <em>正引きゾーンファイルのエントリー</em><br>
      <samp>
      host2  A     192.168.1.2
      </samp>
      <p>
      <em>逆引きゾーンファイルのエントリー</em><br>
      <samp>
      2      PTR   host2.mydomain.org.au.
      </samp>
</ol>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>internetworking  インターネットワーキング
あなたのネットワーク (一つのホストから成るかもしれません) を
他のネットワークにつなぐ場合、少なくとも一つのホストを
二つのネットワーク間のゲートウェイとして動作させなくてはなりません。
ゲートウェイホストは二つのネットワークインタフェースを持っており、
それぞれを各ネットワークについて設定します。

<ul>
  <li>二つ目のイーサネットのインタフェース設定ファイルを作成する
      (/etc/ifconfig.{<em>interface</em>}) 。
      <p>
      <em>/etc/ifconfig.we1</em><br>
      <samp>
      192.168.2.30 netmask 0xffffff00 media 10base2/BNC
      </samp>
      <p>
  <li>新しいインタフェースを有効にする為にリブートする。
  <li>Enable IP packet forwarding.  You can either compile a kernel
      with "options GATEWAY", or you can "sysctl -w
      net.inet.ip.forwarding=1" each time your machine boots, e.g.,
      from /etc/rc.local.
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>placeholder
      </ul>
</ul>

<ENTRY>ppp  PPPによるインターネットワーキング
pppd(8)
を用いるとシリアルポート (モデムの有無にかかわらず) 上に特殊な
ネットワークインタフェースを作成できます。

<p>

PPP のセットアップには多くの方法があります。あなたの ISP に接続するのに
適した一つの簡単な方法は;
<ol>
  <li>ピアーオプションファイルを作成する
      <p>
      <em>/etc/ppp/peers/myisp</em><br>
      <samp>
      # Example pppd options <br>
      # Specific for myisp <br>
      /dev/tty01<br>
      local_IP_address:remote_IP_address<br>
      connect '/usr/sbin/chat -v -f /etc/ppp/peers/myisp.chat'<br>
      defaultroute<br>
      persist<br>
      ipparam myisp<br>
      asyncmap 0<br>
      noauth
      </samp>
      <p>
  <li>デバイスオプションファイルを作成する
      <p>
      <em>/etc/ppp/options.{ttyname}</em><br>
      <samp>
      # Example pppd options <br>
      # Specific for ttyname <br>
      lock<br>
      crtscts<br>
      57600<br>
      modem<br>
      </samp>
      <p>
  <li>チャットファイルを作成する
      <p>
      <em>/etc/ppp/peers/myisp.chat</em><br>
      <samp>
      # Example chat file <br>
      # Specific for myisp<br>
      ABORT BUSY ABORT 'NO CARRIER' ""<br>
      \da\ptz0 OK<br>
      \da\ptdt8887776655 CONNECT<br>
      </samp>
      <p>
  <li>コネクションを確立する;
      <p>
      <samp>
      pppd call myisp
      </samp>
      <p>
  <li>変数をセットする
      <p>
      <samp>
      ppp_peers="myisp"
      </samp>
      を /etc/rc.conf rc.conf(5)
      に書いておくとブート時に自動的にコネクションが確立するようになります。
</ol>

イーサネットインタフェースと異なり、<em>/etc/ifconfig.{interface}</em>
ファイルを PPP インタフェースに作成する必要はありません。
<p>
If you are using demand dial ppp and do not wish certain traffic to
bring up the link (for example xntpd(8) ntp traffic), you can use
<tt>active-filter</tt> in your ppd.conf file:
<pre>	active-filter   'not udp port ntp'</pre>

<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>chat(8) - Automated conversational script
        <li><a href="http://www.macbsd.com/macbsd/howto/pppnat/">
            How to setup PPP for multiple ISP's, including IP-NAT and DNS setup.</a>
      </ul>
</ul>

<ENTRY>pppleased Setting up pppd to use a leased line
A leased line is a fixed point-to-point link.  Setting this up under NetBSD is
a very simple process.  On the server build an <em>/etc/ppp/options</em> like
this:
<p>
     <blockquote>
     /dev/tty00<br> 
     57600<br>
     noauth<br>
     crtscts<br>
     passive<br>
     &lt;local_IP_address&gt;:&lt;remote_IP_address&gt;<br>
     debug<br>
     netmask 255.255.255.255<br>
     proxyarp<br>
     </blockquote>
<p>
You need to change &lt;local_IP_address&gt; and &lt;remote_IP_address&gt; to
the appropriate values for your network (&lt;local_IP_address&gt; can be the
same as your ethernet, &lt;remote_IP_address&gt; must be one valid addr for
your ethernet segment).
<p>
On the client build an <em>/etc/ppp/options</em> with:
<p>
     <blockquote>
     /dev/tty00<br>
     57600<br>
     noauth<br>
     crtscts<br>
     defaultroute<br>
     debug<br>
     </blockquote>
<p>
On both sides adjust /dev/tty00 to the name of your serial port.

<ENTRY>isdn4bsd	Inter-networking with ISDN cards
The <a href="http://www.freebsd-support.de/i4b/">isdn4bsd</a> package enables
<a href="../../Ports/alpha/index.html">NetBSD/alpha</a>,
<a href="../../Ports/amiga/index.html">NetBSD/amiga</a>,
<a href="../../Ports/atari/index.html">NetBSD/atari</a> and
<a href="../../Ports/i386/index.html">NetBSD/i386</a>
to use ISDN networking cards connected to DSS1 (European protocol)
exchanges.  For this, you need to patch your kernel sources according
to the instructions that come with the package, build a new kernel
with the ISDN support compiled in and also build some control
programs.
<p>Note that this package is still considered to be in the beta test
phase.
<p>Also note that this is about ISDN cards, not about ISDN modems. The latter
should be usable <a href="#ppp">like normal modems.</a>

<ENTRY>simplenat	A simple NAT setup

To allow hosts that you have on your local network (say: 10.0.0.0/24)
use your NetBSD machine as router, and setup Network Address Translation
(NAT), do the following:
<P>

<OL>
<LI> On your clients, use the NAT machine as default router (put
	<TT>defaultrouter="<I>a.b.c.d</I>"</TT> into their /etc/rc.conf if
	they run NetBSD, where <TT><I>a.b.c.d</I></TT> is the internal
	IP number (from the 10.0.0.0 net, i.e.)).
<LI> On your NAT machine, first make sure your kernel has ipfilter
	enabled:
<PRE>
options         PFIL_HOOKS    	        # pfil(9) packet filter hooks
pseudo-device   ipfilter                # IP filter (firewall) and NAT
</PRE>

<LI> Put this into your /etc/ipf.conf(5):
<PRE>
pass in from any to any
pass out from any to any
</PRE>

<LI> Put this into your /etc/ipnat.conf(5):
<PRE>
map ppp0 10.0.0.0/24 -> 0/32 proxy port ftp ftp/tcp
map ppp0 10.0.0.0/24 -> 0/32 portmap tcp/udp 40000:60000
map ppp0 10.0.0.0/24 -> 0/32
</PRE>

<LI> Enable everything in your /etc/rc.conf:
<PRE>
ipfilter=YES                                    # uses /etc/ipf.conf
ipnat=YES                                       # uses /etc/ipnat.conf
</PRE>

<LI> Reboot.

<LI> Use ping(8) and tcpdump(1) to debug.
</OL>

<ENTRY>maintenance  メンテナンス
<ul>
  <li>監視 - 便利なツール
      <ul>
        <li>ifconfig(8) - ネットワークインタフェースのパラメーターの設定と表示
        <li>route(8) - ルーティングテーブルの操作
        <li>ping(8) - ICMP ECHO_REQUEST パケットをネットワークホストに送る
        <li>traceroute(8) - パケットがネットワークホストに到達するルートを表示
        <li>tcpdump(1) - ネットワークインタフェース上のトラフィックを選択して表示
        <li>netstat(1) - ネットワーク状態の表示
        <li>systat(8) 'systat netstat' - ネットワーク接続を動的に表示
      </ul>
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li><PKGSRC>net/mrtg - This utility from the packages collection
			lets you monitor your network activity graphically.
      </ul>
</ul>

<ENTRY>security  セキュリティー
<ul>
  <li>/etc/hosts.{allow,deny}: 
      tcp-wrappers (hosts_access(5))
      の設定ファイル。マスターデーモン
      inetd(8)
      に組み込まれている。
</ul>
<ul>
  <li><h3>参考:</h3>
      <ul>
        <li>The <a href="http://www.cert.org/">CERT* Coordination Center</a>
            studies Internet security vulnerabilities.
        <li><a href="http://www.cert.org/tech_tips/root_compromise.html">
            Steps for Recovering from a UNIX Root Compromise</a>
      </ul>
</ul>

<ENTRY>appletalk  Appletalk を使う
NetBSD は unix マシンと appletalk マシンをイーサネット (localtalk では
ありません) で通信を可能にする '<PKGSRC>net/netatalk' をサポートしています。
これは MacOS マシンが NetBSD マシンを介してファイルシステムを読んだり
プリンターを用いたり、NetBSD マシンが appletalk プリンターに印刷したり
することができます。必要なソースは NetBSD の<a href="../software/packages.html">Packages
Collection</a>から利用可能です。

<ENTRY>new_bind  Converting to BIND version 8
As of NetBSD 1.4, we are now using BIND version 8, which uses a
different configuration file format.  The primary named config file
has changed names from named.boot to named.conf.  You can convert your
old configuration files like this:
<samp>
/usr/sbin/named-bootconf &lt; named.boot &gt; named.conf
</samp>
<p>
If you prefer to continue to use the old version of BIND (version 4),
there is a <PKGSRC>net/bind4 package.  Also be aware that the man
page for named.conf(5) is slightly newer than the program itself, so
there are a few features that are documented but not implemented.

<SECTION>Network problems

<ENTRY>unable-to-ping Unable to ping other hostnames
    If you can ping(8) another machine by IP address ("<tt><b>ping
    -n <em>W.X.Y.Z</em></b></tt>"), but not by hostname, then there
    is probably a problem with your resolv.conf(5) file. Check your
    nameservers are set correctly and responding.

<ENTRY>connection-delays Connections seem to have a 30 second delay
    This is usually either:
    <ol>
    <li>Incorrect resolv.conf(5) causing hostname lookups to timeout
	against non responding nameservers,
    <li>Remote mail servers attempting to connect back to your local
	hosts identd(8) while ipf(8) has been configured to drop packets
	to tcp port 113 without sending any response.
    </ol>

</LIST>

<DOCLINK>

<hr>
<address>
  <a href="../../Misc/feedback.html">(Contact us)</a>
  $NetBSD: index.list,v 1.22 2000/02/15 14:34:46 abs Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy;
    1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
</address>

</body>
</html>
