<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>

<!-- DO NOT EDIT THIS FILE. EDIT 'bootcd.list' AND RUN 'make' -->

<!-- Copyright (c) 2000-2002
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<link rel="shortcut icon" href="../../favicon.ico" origlink="/favicon.ico" type="image/x-icon">
<title>NetBSD Bootable CD ROM HOWTO</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">
<table><tr><td>
    <a href="../Misc/disclaimer.html#bsd-daemon"><img
     align="middle" src="../../images/BSD-daemon.jpg" origlink="../images/BSD-daemon.jpg" border="0"
     width=146 height=129 alt="BSD daemon"></a>
  </td><td align=center>
    <h1>NetBSD ドキュメンテーション:</h1>
    <h1>ブート可能な CD ROM の作成方法</h1>
</td></tr></table>
<p>

<h2><a name="top">Overview</a></h2>
<ul>
<li>
<a href="#introduction">概要と目的</a></li>
</ul>
<h2>CD イメージを作成する</h2>
<ul>
<li>
<a href="#alphaimage">NetBSD/alpha</a></li>
<li>
<a href="#i386image">NetBSD/i386</a></li>
<li>
<a href="#macppcimage">NetBSD/macppc</a></li>
<li>
<a href="#pmaximage">NetBSD/pmax</a></li>
<li>
<a href="#sparcimage">NetBSD/sparc</a></li>
<li>
<a href="#sparc64image">NetBSD/sparc64</a></li>
<li>
<a href="#sun2image">NetBSD/sun2</a></li>
<li>
<a href="#sun3image">NetBSD/sun3</a></li>
<li>
<a href="#vaximage">NetBSD/vax</a></li>
<li>
<a href="#multiimage">複数のマシン</a></li>
</ul>
<h2>CD イメージの検査</h2>
<ul>
<li>
<a href="#netbsd_mountimage">NetBSD の場合</a></li>
<li>
<a href="#linux_mountimage">Linux の場合</a></li>
<li>
<a href="#solaris_mountimage">Solaris の場合</a></li>
</ul>
<h2>CD を焼く</h2>
<ul>
<li>
<a href="#cdrecord">cdrecord を使う場合(U*nix)</a></li>
<li>
<a href="#winrecord">Windows を使う場合</a></li>
<li>
<a href="#macrecord">MacOS を使う場合</a></li>
</ul>


<hr>
<h2>Overview</h2><hr>
<p><h3>
<a name="introduction">概要と目的</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

このドキュメントでは、ブート可能な NetBSD CD ROM の作成方法を
説明します。

</dd></dl>
<hr>
<h2>CD イメージを作成する</h2><hr>CD ROM を作成するためには、まず CD のイメージを作成する必要があります。
このイメージを、最初にハードディスク上に(最大でも 650 MB 程度)ファイル
として保存し、その後 CD に焼きます。

このセクションでは、<tt>mkisofs</tt> が使用可能であることを前提として
います。もし、NetBSD マシン上に CD イメージを作るのなら、
<a href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/cdrecord/README.html">cdrecord</a>
パッケージを使い、
<tt>mkisofs</tt> をインストールすることができます。

以下の例では、<tt>/cdsources</tt> ディレクトリーがシステム上に存在し、
その中にCD ROM に焼く全てのファイルが含まれているものとします。
インストール CD を作成するためのお勧めのレイアウトは、
<a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.5.2/">ftp.netbsd.org</a>
のディレクトリー構造です。例えば:
<pre>
  /cdsources/i386/.....
  /cdsources/sparc/.....
</pre>


<p><h3>
<a name="alphaimage">NetBSD/alpha</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD/alpha 用のブート可能な CD ROM を作成するためには、二つの手順が
必要です。最初に CD に焼くファイルの ISO 9660 イメージを作成します。
このイメージのルートディレクトリーには、二番目のブートプログラムとカーネル
が存在しなければなりません。蛇足ですが、一番目のブートプログラムは次の
手順で必要となります。ブートプログラムとカーネルを正しいディレクトリーに
置くために、以下の作業をおこなってください。
<pre>
  cd /cdsources/alpha/binary/sets
  tar -zxvf base.tgz ./usr/mdec/boot ./usr/mdec/bootxx_cd9660
  mv -f ./usr/mdec/boot /cdsources/boot
  mkdir /tmp/mdec.alpha
  mv -f ./usr/mdec/bootxx_cd9660 /tmp/mdec.alpha/bootxx_cd9660
  rmdir ./usr/mdec
  cd /cdsources/alpha/installation/instkernel
  cp -f netbsd.gz /cdsources/netbsd.gz
</pre>
さて、ISO 9660 イメージを作成しましょう。
<pre>
  mkisofs -o output.iso -l -J -r -L /cdsources
</pre>
次に、NetBSD/alpha のディスクと CD ROM のブートストラップソフトウェア
を、<tt><a href="http://man.netbsd.org/cgi-bin/man-cgi?installboot+8.alpha+NetBSD-current">installboot(8)</a></tt> を使いインストールします。以下のコマンド
を実行してください:
<pre>
  installboot -v output.iso /tmp/mdec.alpha/bootxx_cd9660 
</pre>
このコマンドを NetBSD/alpha マシン上で実行するか、alpha 用の installboot
プログラムを、現在、使用中のシステム上でコンパイルする必要があることに
注意してください。alpha 用の installboot プログラムは、NetBSD/i386 上で
コンパイル、実行できるはずです。

</dd></dl>
<p><h3>
<a name="i386image">NetBSD/i386</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
このセクションでは、NetBSD/i386 のブート可能な CD ROM を作成する方法
を説明します。ここでとりあげる例は、NetBSD-1.5.2/i386 インストール CD
を作成する方法です。 <tt>/cdsources</tt> ディレクトリーがシステム上に存在
し、その中にすべてのファイルが含まれており、そのディレクトリー構造は
<a
href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.5.2/i386/">NetBSD-1.5.2/i386</a>
と同じものとします。CD に焼きたいファイルによって内容はかわりますが、
重要なのは、ブート可能なイメージとして使用される
<tt>/cdsources/i386/installation/floppy/boot-big.fs</tt> が存在することです。

CD イメージを作るために以下のコマンドを実行します:
<pre>
  mkisofs -o output.iso -b i386/installation/floppy/boot-big.fs \ 
           -c boot.catalog -l -J -r -L /cdsources
</pre>
これで、<tt>output.iso</tt> ファイルが作成されます。このファイルが CD 
のイメージです。オプションは以下の通りです:
<ul>
<li><tt>-b i386/installation/floppy/boot-big.fs</tt> -- ブートイメージを指定します。
<li><tt>-c boot.catalog</tt> -- ブートカタログを作成します。
<li><tt>-l</tt> -- 長いファイル名(32 文字)を許可します。
<li><tt>-J</tt> -- Joliet 拡張を含みます。
<li><tt>-r</tt> -- ファイルのパーミッションをセットします。
<li><tt>-L</tt> -- 「.」で初まるファイル名を許可します。
<li><tt>/cdsources</tt> -- ディレクトリー
<tt>/cdsources</tt> が CD イメージのルートであることを指定します。
</ul>

</dd></dl>
<p><h3>
<a name="macppcimage">NetBSD/macppc</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD でサポートされている macppc 機種はすべて、 CD ROM の最初の
セッションからブートすることができます。ブート可能な CD の作り方は、
その機種の持つ Open Firmware のバージョンによって異なります。お使いのシステムの
Open Firmware バージョンとサポート状況については <a
href="../Ports/macppc/models.html">NetBSD/macppc 機種対応ページ</a>
を参照してください。

<p>ここでは、お使いのシステム上に <tt>/cdsources/</tt>
ディレクトリーがあり、そこに
<a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.6/macppc/"
>NetBSD-1.6/macppc</a> の全ファイルとディレクトリー構造が含まれているものとします。
本当に必要な内容は、その CD で何をしたいかによって異なります。

<p><tt>/cdsources/</tt> には、 <tt>ofwboot.xcf</tt> (macppc ブートローダー)
とカーネル (全機種に対応した ramdisk ベースのインストールカーネル
<tt>netbsd.GENERIC_MD</tt> をおすすめします) を含めるようにしてください。

<pre>
  cd /cdsources
  cp macppc/binary/kernel/netbsd.GENERIC_MD.gz netbsd.gz
  cp macppc/installation/ofwboot.xcf .
</pre>

NetBSD/macppc 公式 ISO イメージは、特殊な技巧を使うことによって、
サポートされている全機種でブート可能になっています。これについて知りたければ
<tt><a href="http://cvsweb.netbsd.org/bsdweb.cgi/basesrc/distrib/cdrom/"
>src/distrib/cdrom</a></tt> を参照してください。

<p>Open Firmware 1.0.5、 1.1.22 または 2.0.x のシステム用の CD イメージを作るには、
以下のコマンドを使います:

<pre>
  mkisofs -o output.iso -l -J -r -L /cdsources
</pre>

<p>Open Firmware 2.4 または 3 のシステム用の CD イメージを作るには、
以下のコマンドを使います:

<pre>
  mkisofs -o output.iso -hfs -part -l -J -r -L /cdsources
</pre>

<p>CD を焼いたら、 Open Firmware がその CD ROM からブートローダー
を見つけられることを確認してください (FAQ の
<a href="../Ports/macppc/faq.html#ofw-dir-listing">ディスク上のファイルのリストを
(Open Firmware で) 出す方法は?</a> を参照) 。 Open Firmware
はブートファイルの大文字小文字を区別して扱うため、これは重要です。
ほとんどの (すべてではないにせよ) Open Firmware 1.0.5、 1.1.22、 2.0.x システムは
ブートローダーが <tt>OFWBOOT.XCF</tt> であることを想定しており、 Open Firmware 3
はこれを適切に <tt>ofwbot.xcf</tt> であるとみなします。

<p>この CD からブートするには Open Firmware に入る必要があり、
単に "<tt>c</tt>" キーを押し続けてもブートできないことをお忘れなく。

</dd></dl>
<p><h3>
<a name="pmaximage">NetBSD/pmax</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD/pmax は、FFS または ISO9660 CD ROM からブートすることができます。
このセクションでは ISO 9660 CD ROM を作成します。注意してほしいのは、
bootxx_cd9660 プログラムは NetBSD-1.4.x <em>以降</em> でないと追加
されないという事です。もし、NetBSD-1.4.x を使用するのであれば、-current 
スナップショットから <tt>boot.pmax</tt>、<tt>installboot</tt>、そして 
<tt>bootxx_cd9660</tt> を持ってきてください。ソースから作成する場合は、
1999 年 11 月 <em> 以降 </em> のものである事を確認してください。

NetBSD/pmax 用のブート可能な CD ROM を作成するためには二つの手順が
必要です。最初に、CD に焼くファイルの ISO 9660 イメージを作成します。
このイメージのルートディレクトリーには、二番目のブートプログラムとカーネル
が存在しなければなりません。蛇足ですが、一番目のブートプログラムは次の
手順で必要となります。ブートプログラムとカーネルを正しいディレクトリーに
置くために、以下の作業をおこなってください。
<pre>
  cd /cdsources/pmax/binary/sets
  tar -zxvf base.tgz ./usr/mdec/boot.pmax ./usr/mdec/bootxx_cd9660
  mv -f ./usr/mdec/boot.pmax /cdsources/boot.pmax
  mkdir /tmp/mdec.pmax
  mv -f ./usr/mdec/bootxx_cd9660 /tmp/mdec.pmax/bootxx_cd9660
  rmdir ./usr/mdec

  cd /cdsources/pmax/binary/kernel
  cp -f install.gz /cdsources/netbsd.pmax.gz
  gunzip /cdsources/netbsd.pmax.gz
</pre>
さて、ISO 9660 イメージを作成しましょう。
<pre>
  mkisofs -o output.iso -l -J -r -L /cdsources
</pre>
次に、NetBSD/pmax のディスクと CD ROM のブートストラップソフトウェア
を、<tt><a href="http://man.netbsd.org/cgi-bin/man-cgi?installboot+8.pmax+NetBSD-current">installboot(8)</a></tt> を使いインストールします。以下のコマンド
を実行してください:
<pre>
  /usr/mdec/installboot -v output.iso /usr/mdec/bootxx_cd9660 
</pre>
二番目の手順は、NetBSD/pmax 上で実行する必要があります。ただし、イメージ
をローカルマシン上で作成していない場合は、リモートマシン上の ISO イメージ
を NetBSD/pmax マシンに NFS マウントすることも可能です。NetBSD-1.5.1 以降
では、NetBSD/pmax installboot プログラムを他の NetBSD アーキテクチャー上
でコンパイルすることができます。これにより、pmax 以外のマシンを使いブート
可能イメージを作成することが可能になります。

</dd></dl>
<p><h3>
<a name="sparcimage">NetBSD/sparc</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD/sparc 用のブート可能な CD ROM を作成するためには、三つの手順が
必要です。最初に CD に焼くファイルの、ほぼ完全な ISO 9660 イメージを
作成します。例えば:
<pre>
  mkisofs -o output.iso -l -J -r -L /cdsources
</pre>
次にブート可能なフロッピーのイメージを入手します。NetBSD-1.5.2/sparc
用のイメージは <a
href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.5.2/sparc/installation/bootfs/boot.fs.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.5.2/sparc/installation/bootfs/boot.fs.gz</a>
にあります。

最後に ISO イメージを、(a) sun disklabel が先頭になり、(b) オリジナルの
イメージが一番後になるように、(c)そして、ブートローダーのために disklabel 
中のオフセットとサイズを正しい値に書きかえます。<tt>mksunbootcd</tt> 
プログラムを使い、この作業をおこないます。もし、<tt>mksunbootcd</tt> 
がインストールされていなければ、
<a href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/mksunbootcd/README.html">mksunbootcd</a> パッケージを使用し、インストールすること
ができます。もし、NetBSD 以外のシステム上にイメージを作っているのなら、
そのシステム上で <tt>mksunbootcd</tt> をコンパイルすることもできます。
ソースは <a href="ftp://ftp.netbsd.org/pub/NetBSD/misc/mksunbootcd/">
ftp://ftp.netbsd.org/pub/NetBSD/misc/mksunbootcd/</a> にあります。

<tt>mksunbootcd</tt> は以下のように使います:
<pre>
  mksunbootcd output.iso boot.fs boot.fs boot.fs
</pre>
この例では、sun4、sun4c、sun4m システムでブートするために、ブート
可能イメージとして同じものを 3回指定しています。もし、マシン毎に
異なるブート可能イメージを使う必要がある場合や、これらに加えて
sun2、 sun3、 sun3x 用のブート可能イメージもある場合は、以下のようにしてください。
<pre>
  mksunbootcd output.iso boot-sun4.fs boot-sun4c.fs boot-sun4m.fs boot-sun3.fs
</pre>

<tt>mksunbootcd</tt> は <tt>output.iso</tt> ファイルを書きかえるので、
複数回実行しないでください。

なお、この手順は、NFS マウントされたディレクトリー上でも実行できます。
例えば、ISO イメージがリモートマシン上にある場合でも、それを NetBSD 
マシンにマウントし、ネットワークに負荷をかける事なく、<tt>mksunbootcd</tt> 
を実行することができます。

</dd></dl>
<p><h3>
<a name="sparc64image">NetBSD/sparc64</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
現在、CD からの NetBSD/sparc64 のブートはサポートされていません。
しかし、この問題は sparc64 の TODO リストにのっていますし、ハードウェア的
には CD からのブートをサポートしています。

</dd></dl>
<p><h3>
<a name="sun2image">NetBSD/sun2</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD/sun2 用のブート可能な CD ROM を作成するためには、この下の
NetBSD/sun3 用のブート可能な CD ROM の作成手順に従います。これで、
sun2 と sun3 システム両方でブートできる単一の CD ROM イメージができあがります。

<p>
<em>オプション:</em> 下記の手順に従う際には、 ISO 9660 イメージ書き込み前に
sun2 miniroot
(<tt>/cdsources/sun2/installation/miniroot.fs.gz</tt>) とバイナリーセット
(<tt>/cdsources/sun2/binary/sets/*.tgz</tt>) 
を伸長しておいたほうがよいです。そうするかどうかはあなたの自由ですし、 ISO 9660
イメージの容量も大きくなりますが、 sun2 上での伸長は非常に遅いので、
インストールにかかる時間を節約することができます。

</dd></dl>
<p><h3>
<a name="sun3image">NetBSD/sun3</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD/sun3 用のブート可能な CD ROM を作成するためには、三つの手順が
必要です。こうすることで、 NetBSD/sun2 でもブート可能な CD ROM ができます。

<p>
最初に CD に焼くファイルの、ほぼ完全な ISO 9660 イメージを
作成します。例えば:
<pre>
  mkisofs -o output.iso -l -J -r -L /cdsources
</pre>
次にブート可能な ffs イメージを作ります。今のところ、このイメージは
リリースには含まれませんので、自分で用意する必要があります。

<pre>
  mkdir /tmp/boot-sun3
  cd /tmp/boot-sun3
  gzip -cd &lt; /cdsources/sun2/binary/kernel/netbsd.RAMDISK.gz &gt; netbsd.sun2
  ln netbsd.sun2 vmunix
  gzip -cd &lt; /cdsources/sun3/binary/kernel/netbsd.RAMDISK.gz &gt; netbsd.sun3
  gzip -cd &lt; /cdsources/sun3/binary/kernel/netbsd.RAMDISK3X.gz &gt; netbsd.sun3x
  tar xzvf /cdsources/sun3/binary/sets/base.tgz ./usr/mdec
  mv usr/mdec/ufsboot .
  mv usr/mdec/bootxx /tmp/bootxx.sun3
  rm -rf /tmp/boot-sun3/usr

  echo /set type=file uname=root gname=wheel mode=0755 &gt; /tmp/boot-sun3.spec
  echo . type=dir &gt;&gt; /tmp/boot-sun3.spec
  echo ufsboot mode=0644 &gt; /tmp/boot-sun3.spec
  /bin/ls netbsd* vmunix &gt;&gt; /tmp/boot-sun3.spec

  makefs -t ffs -B be -F /tmp/boot-sun3.spec /tmp/boot-sun3.fs /tmp/boot-sun3

  installboot -v -m sun3 /tmp/boot-sun3.fs /tmp/bootxx.sun3 ufsboot
</pre>

最後に ISO イメージを、(a) sun disklabel が先頭になり、(b) オリジナルの
イメージが一番後になるように、(c)そして、ブートローダーのために disklabel 
中のオフセットとサイズを正しい値に書きかえます。<tt>mksunbootcd</tt> 
プログラムを使い、この作業をおこないます。もし、<tt>mksunbootcd</tt> 
がインストールされていなければ、
<a href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/mksunbootcd/README.html">mksunbootcd</a> パッケージを使用し、インストールすること
ができます。もし、NetBSD 以外のシステム上にイメージを作っているのなら、
そのシステム上で <tt>mksunbootcd</tt> をコンパイルすることもできます。
ソースは <a href="ftp://ftp.netbsd.org/pub/NetBSD/misc/mksunbootcd/">
ftp://ftp.netbsd.org/pub/NetBSD/misc/mksunbootcd/</a> にあります。

<tt>mksunbootcd</tt> は以下のように使います:
<pre>
  mksunbootcd output.iso /tmp/boot-sun3.fs 
</pre>
<tt>mksunbootcd</tt> は sparc システム用のブート可能 CD ROM イメージの
作成にも使われます。以下のようにすることで、 sparc、 sun2、 sun3
および sun3x でブート可能な CD ROM を作ることができます:
<pre>
  mksunbootcd output.iso boot-sun4.fs boot-sun4c.fs boot-sun4m.fs boot-sun3.fs
</pre>

このブート可能ファイルシステムの順序は、必要に応じて好きなように
変えることができます; これは、単に各ファイルシステムのパーティション番号を
変えるだけです。このため、パーティション番号を必要に応じて変えることで、
PROM の <tt>b</tt> または <tt>boot</tt> コマンドで、そのアーキテクチャー用の
適切なファイルシステムでブートするようになります。

<p>
<tt>mksunbootcd</tt> は <tt>output.iso</tt> ファイルを書きかえるので、
複数回実行しないでください。

<p>
なお、この手順は、NFS マウントされたディレクトリー上でも実行できます。
例えば、ISO イメージがリモートマシン上にある場合でも、それを NetBSD 
マシンにマウントし、ネットワークに負荷をかける事なく、<tt>mksunbootcd</tt> 
を実行することができます。

</dd></dl>
<p><h3>
<a name="vaximage">NetBSD/vax</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD/vax は、FFS または ISO 9660 CD ROM からブートすることができます。
このセクションでは、ISO 9660 CD ROM を作成します。この機能は NetBSD-1.5 
までは追加されない事に注意してください。

NetBSD/vax 用のブート可能な CD ROM を作成するためには二つの手順が
必要です。最初に、CD に焼くファイルの ISO 9660 イメージを作成します。
このイメージのルートディレクトリーには、二番目のブートプログラムとカーネル
が存在しなければなりません。蛇足ですが、一番目のブートプログラムは
二番目の手順で必要となります。ブートプログラムとカーネルを正しい
ディレクトリーに置くために、以下の作業をおこなってください。
<pre>
  cd /cdsources/vax/binary/sets
  tar -zxvf base.tgz ./usr/mdec/boot ./usr/mdec/xxboot
  mv -f ./usr/mdec/boot /cdsources/boot.vax
  mkdir /tmp/mdec.vax
  mv -f ./usr/mdec/xxboot /tmp/mdec.vax/xxboot
  rmdir ./usr/mdec

  cd /cdsources/vax/binary/kernel
  cp -f netbsd.INSTALL.gz /cdsources/netbsd.vax.gz
  gunzip -f /cdsources/netbsd.vax.gz
</pre>
さて、ISO 9660 イメージを作成しましょう。
<pre>
  mkisofs -o output.iso -l -J -r -L /cdsources
</pre>
次に、NetBSD/vax のディスクと CD ROM のブートストラップソフトウェア
を、<tt><a href="http://man.netbsd.org/cgi-bin/man-cgi?installboot+8.vax+NetBSD-current">installboot(8)</a></tt> を使いインストールします。
<tt><a href="http://man.netbsd.org/cgi-bin/man-cgi?installboot+8.vax+NetBSD-current">installboot(8)</a></tt> コマンドは以下のように使います:
<pre>
  /usr/mdec/installboot -v output.iso /usr/mdec/xxboot
</pre>
二番目の手順は、NetBSD/vax 上で実行する必要があります。ただし、イメージ
をローカルマシン上で作成していない場合は、リモートマシン上の ISO イメージ
を NetBSD/vax マシン に NFS マウントすることも可能です。あるいは、NetBSD/vax 
installboot プログラムを他の NetBSD アーキテクチャー上でコンパイルすること
ができます。


</dd></dl>
<p><h3>
<a name="multiimage">複数のマシン</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
以下の手順で、alpha、i386、pmax、sparc でブート可能な一枚の CD を
作成しています。また、 macppc、 vax や
sun2、 sun3、 sun3x でブート可能な CD を作ることも可能です。
複数のアーキテクチャーでブート可能な CD を作成するためには、以下の
手順を順番に実行してください。この順番は重要なので注意してください。
<ul>
<li>それぞれのマシンのセクションに記述されている、カーネルやブート
プログラムなどを含む必要なファイルがすべてそろっていることを確認
してください。
<li><tt>cdsources</tt> ディレクトリーの適当な場所に <tt>mdec.pmax</tt>
ディレクトリーを作ってください。そして、pmax <tt>bootxx_cd9660</tt> を
そこに置いてください。例えば、
<tt>/cdsources/usr/mdec.pmax/bootxx_cd9660</tt>.
<li><tt>cdsources</tt> ディレクトリーの適当な場所に <tt>mdec.vax</tt>
ディレクトリーを作ってください。そして、vax <tt>xxboot</tt> を
そこに置いてください。例えば、
<tt>/cdsources/usr/mdec.vax/xxboot</tt>.
macppc <tt>ofwboot.xcf</tt> ブートローダーを <tt>/cdsources</tt> に置いてください。
<li>i386 のブート可能なイメージを作成します。
<pre>
  sh
  mkisofs -v -v -o output.iso -b i386/installation/floppy/boot-big.fs \ 
           -c boot.catalog -l -J -r -L /cdsources 2&gt;&1 | tee /tmp/mkisofs.log
  exit
</pre>
<tt>-v</tt> フラグが二度必要な事に注意してください。 Open Firmware 3 macppc
モデル上でブート可能 CD を作る場合は、 <tt>mkisofs</tt> の引数に
<tt>-hfs -part</tt> を含めるようにしてください。
<li>sparc および sun2/sun3 の bootblock をインストールするために、
<tt>mksunbootcd</tt> を NetBSD/sparc マシン上で実行してください。あるいは、
<a href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/mksunbootcd/README.html">mksunbootcd</a>
パッケージを、別の NetBSD マシンにインストールしてください。
<pre>
  mksunbootcd output.iso boot-sun4.fs boot-sun4c.fs boot-sun4m.fs boot-sun3.fs
</pre>
<li> pmax 用のブートブロックをインストールするために、pmax の
<tt> <a href="http://man.netbsd.org/cgi-bin/man-cgi?installboot+8.pmax+NetBSD-current">installboot(8)</a></tt> を NetBSD/pmax 上で実行してください。
(あるいは、pmax installboot プログラムを他の NetBSD-1.5 以降のマシン上で
コンパイルし、実行してください。)
NetBSD/alpha ブートプログラムと共存するために、pmax ブートプログラム
は、ISO ファイルシステムにインストールしなければならない事に注意して
ください。pmax installboot プログラムにブートプログラムの場所を知ら
せるために、mkisofs の実行ログファイルを調べる必要があります。
<pre>
  grep "usr/mdec.pmax/bootxx_cd9660" /tmp/mkisofs.log
</pre>
以下のように出力されるはずです:
<pre>
  148017 148020 cdsources/usr/mdec.pmax/bootxx_cd9660
</pre>
最初の数字(この場合、148017)が、installboot プログラムに渡す必要のある
ISO ブートブロックです。さて、installboot プログラムを実行しましょう:
<pre>
  installboot -i 148017 -v output.iso /tmp/mdec.pmax/bootxx_cd9660
</pre>
<tt> <a href="http://man.netbsd.org/cgi-bin/man-cgi?installboot+8.vax+NetBSD-current">installboot(8)</a></tt> を NetBSD/vax 上で実行してください。
(あるいは、vax installboot プログラムを他の NetBSD-1.5 以降のマシン上で
コンパイルし、実行してください。)
NetBSD/alpha ブートプログラムと共存するために、vax ブートプログラム
は、ISO ファイルシステムにインストールしなければならない事に注意して
ください。vax installboot プログラムにブートプログラムの場所を知ら
せるために、mkisofs の実行ログファイルを調べる必要があります。
<pre>
  grep "usr/mdec.vax/xxbootxx" /tmp/mkisofs.log
</pre>
以下のように出力されるはずです:
<pre>
  148017 148020 cdsources/usr/mdec.vax/xxboot
</pre>
最初の数字(この場合、148017)が、installboot プログラムに渡す必要のある
ISO ブートブロックです。さて、installboot プログラムを実行しましょう:
<pre>
  installboot -i 148017 -v output.iso /tmp/mdec.vax/xxboot
</pre>
<li> alpha のブートブロックをインストールするために、
<tt><a href="http://man.netbsd.org/cgi-bin/man-cgi?installboot+8.alpha+NetBSD-current">installboot(8)</a></tt> を NetBSD/alpha マシン上で実行してください。
alpha と sun のチェックサムの同期をとるためのオプション <tt>-s</tt> 
が含まれている事を確認してください。
<pre>
  installboot -vs output.iso /tmp/mdec.alpha/bootxx_cd9660
</pre>
</ul>

</dd></dl>
<hr>
<h2>CD イメージの検査</h2><hr>今さっき作ったファイルシステムの検査のために、CD イメージをマウントする
ことができます。

<p><h3>
<a name="netbsd_mountimage">NetBSD の場合</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
以下のようにして、CD イメージをマウントします:
<pre>
  vnconfig -c vnd0 output.iso
  mount -t cd9660 /dev/vnd0c /mnt
</pre>
i386 システム上では、<tt>/dev/vnd0c</tt> でなく <tt>/dev/vnd0d</tt> を
指定しないといけない事に注意してください。
これで /mnt へ cd し、新しく作った CD イメージを調べる事ができます。
イメージをアンマウントするためには、以下のようにしてください:
<pre>
  umount /mnt 
  vnconfig -u vnd0
</pre>

</dd></dl>
<p><h3>
<a name="linux_mountimage">Linux の場合</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
Linux も同様の機能をもっています。CD イメージをマウントするためには:
<pre>
  mount -t iso9660 -o ro,loop=/dev/loop0 output.iso /mnt
</pre>
そして、CD イメージをアンマウントするためには:
<pre>
  umount /mnt
</pre>

</dd></dl>
<p><h3>
<a name="solaris_mountimage">Solaris の場合</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
Solaris 8 以降では、CD イメージをマウントできるそうです。詳細や
マウント方法は、Solaris の man page <tt>lofiadm</tt> を参照して
ください。
<P>
古いバージョンの Solaris では、Joerg Schilling の書いた
<tt>fbk</tt> ドライバーを使うとよいでしょう。<tt>fbk</tt> ドライバーは
<a href="ftp://ftp.fokus.gmd.de/pub/unix/kernel/fbk/">ftp://ftp.fokus.gmd.de/pub/unix/kernel/fbk/</a> にあります。
インストールの方法は、<tt>fbk</tt> のドキュメントを参照してください。
<tt>fbk</tt>がインストールされていれば、以下のコマンドで ISO 9660 イメージ
をマウントすることができます:
<pre>
  mount -F fbk -o ro,type=hsfs /dev/fbk0:output.iso  /mnt
</pre>
そして、CD イメージをアンマウントする時は:
<pre>
  umount /mnt
</pre>

</dd></dl>
<hr>
<h2>CD を焼く</h2><hr>
<p><h3>
<a name="cdrecord">cdrecord を使う場合(U*nix)</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
<tt>cdrecord</tt> は、CD イメージを CD に焼くために使用されます。
<tt>cdrecord</tt> は、もちろん
<a href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/cdrecord/README.html">cdrecord</a>
パッケージに含まれます。

<tt>cdrecord</tt> の使用方法の例は以下の通りです:
<pre>
  cdrecord -v speed=4 dev=/dev/cd1c output.iso
</pre>
CD ライターの速度とデバイス名(i386 の場合、<tt>/dev/cd1d</tt>でしょう)を、
適切なものに置き換えてください。

</dd></dl>
<p><h3>
<a name="winrecord">Windows を使う場合</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
ISO 9660 イメージを CD に書き込むための Windows 用のプログラムは
いくつか存在します。このセクションでは、特定のプログラムをお勧め
することはせずに、プログラムの紹介だけにとどめておきます。
<ul>
<li><a href="http://www.goldenhawk.com/cdrwin.htm">CDRWIN</a>.
商用ソフトウェア。(i386 で)ブート可能 ISO 9660 イメージを作成し、
CD に書き込む事が可能です。
<li><a href="http://www.goldenhawk.com/freeware.htm">FILE2CD</a>.
ISO 9660 イメージを CD に書きこむことのできるフリーウェア。
<li><a
href="http://www.adaptec.com/products/overview/ecdc.html">
Adaptec Easy CD Creator Deluxe</a>。商用ソフトウェア。
<li>Adaptec Easy CD Creator。多くの Windows 用のCD ライターに附属しています。
</ul>

</dd></dl>
<p><h3>
<a name="macrecord">MacOS を使う場合</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
ISO 9660 イメージを CD に書き込むための MscOS 用のプログラムは
いくつか存在します。このセクションでは、特定のプログラムをお勧め
することはせずに、プログラムの紹介だけにとどめておきます。
<ul>
<li><a
href="http://www.adaptec.com/products/overview/toast.html">
Adaptec Toast</a>。商用ソフトウェア。
</ul>


</dd></dl>
<hr>

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../"><img
	src="../../images/NetBSD-flag.gif" origlink="../images/NetBSD-flag.gif" border="0"
	width="91" height="42" alt=""></a>
  </td><td>
    <a href="../"><img
	src="../../images/empty.gif" origlink="../images/empty.gif" border="0"
	width="1" height="1" alt="NetBSD ">ホームページ</a>
  </td></tr></table>
</td><td>
  <table><tr><td>
    <a href="../Documentation/"><img
	src="../../images/NetBSD-flag.gif" origlink="../images/NetBSD-flag.gif" border="0"
	width="91" height="42" alt=""></a>
  </td><td>
    <a href="../Documentation/"><img
	src="../../images/empty.gif" origlink="../images/empty.gif" border="0"
	width="1" height="1" alt="NetBSD ">Documentation top level</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  (連絡先 - <a href="../Misc/feedback.html">英語</a>,
       <a href="mailto:www@JP.NetBSD.ORG">日本語:
       www@JP.NetBSD.ORG</a>)<br>
  $NetBSD: bootcd.html,v 1.9 2002/07/22 22:11:01 kano Exp $<br>
  <a href="../Misc/disclaimer.html">Copyright &copy; 2000-2002
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
