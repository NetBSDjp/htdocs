<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>

<!-- DO NOT EDIT THIS FILE. EDIT 'index.list' AND RUN 'make' -->

<!-- Copyright (c) 1994-2004
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<!--
  ==  Originally by Chris Jones
  -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-2022-JP">
<link rev="made" href="mailto:www@jp.NetBSD.org">
<link rel="shortcut icon" href="../../../favicon.ico" origlink="/favicon.ico" type="image/x-icon">
		<title>WSCONS FAQ</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<table><tr><td>
    <a href="../../Misc/disclaimer.html#bsd-daemon"><img
     align="middle" src="../../../images/BSD-daemon.jpg" origlink="../../images/BSD-daemon.jpg" border="0"
     width=146 height=129 alt="BSD daemon"></a>
  </td><td align=center>
    <h1>NetBSD ドキュメンテーション:</h1>
    <h1>NetBSD wscons FAQ</h1>
</td></tr></table>
<p>

<h2><a name="top">wscons コンソールドライバー</a></h2>
<ul>
<li>
<a href="#wscons">wscons とは何ですか?</a></li>
<li>
<a href="#enablingwscons">どうすれば wscons と仮想端末を有効にできますか?</a></li>
<li>
<a href="#keyboard-maps">キーボードのマッピングを 'US' 以外のものに変更する</a></li>
<li>
<a href="#keyboard-speed">どうすればキーボードのリピート速度を変えられますか?</a></li>
<li>
<a href="#screen0">"WSDISPLAYIO_ADDSCREEN: Device busy"</a></li>
<li>
<a href="#colors">どうしたらテキストの表示色を変更できますか?</a></li>
<li>
<a href="#muxdevices">どうすれば wscons の "mux" デバイスを使えるようになりますか?</a></li>
<li>
<a href="#mouseres">どうすればマウスの解像度を変更できますか?</a></li>
<li>
<a href="#fontedit">フォントエディターはありますか?</a></li>
<li>
<a href="#moused">どうすればシリアルマウスを使えるようになりますか?</a></li>
<li>
<a href="#wsmoused">どうすればマウスコンソールサポートが有効になりますか?</a></li>
</ul>


<hr>
<h2>wscons コンソールドライバー</h2><hr>
<p><h3>
<a name="wscons">wscons とは何ですか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
wscons は、NetBSD のプラットフォーム独立なワークステーションコンソール
ドライバーです。これを書いている現在、すべてのプラットフォームで、wscons
がサポートされているわけではありません。しかし、サポートプラットフォーム
は、日々増え続けています。wscons は 古い i386 pcvt ドライバーのすべての
機能(そして追加の機能も)をそなえるはずです。ただし、厳密なケーパビリティー
はハードウェアに依存します。

</dd></dl>
<p><h3>
<a name="enablingwscons">どうすれば wscons と仮想端末を有効にできますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
現時点では、 macppc、 mac68k、 alpha などといった
ビットマップのみのスクリーン上では仮想端末はサポートされていません。
<p>
サポートされているシステムでは、インストール過程において、
これらをセットアップするようになっています。手動でおこなう場合の
手順は、以下のとおりです:
<ul>
<li>/etc/rc.conf の "wscons" を "yes" に変更してください。
<li>/etc/wscons.conf を編集し、ログインのために有効にしたいスクリーンが
作成されている事を確認してください(一番目のスクリーン、screen 0 は常に
存在することに注意してください)。
<li>/etc/ttys の ttyE{1,2,3} を "off" から "on" に変更してください。
<li>リブートするか、以下のようにタイプしてください。
<blockquote>
sh /etc/rc.d/wscons<br>
kill -1 1<br>
</blockquote>
</ul>
Ctrl-Alt-{F1,F2,F3,F4}を使用し、仮想端末を切りかえることができます。

</dd></dl>
<p><h3>
<a name="keyboard-maps">キーボードのマッピングを 'US' 以外のものに変更する</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
   "<tt>wsconsctl</tt>" を使用してください。例えば、フランスのキーボード
   マッピングを選択する場合、"<b><tt>wsconsctl -w encoding=fr</tt></b>"
   を実行してください。キーボードのマッピングの一覧は、
   <a href="http://cvsweb.NetBSD.org/bsdweb.cgi/src/sys/dev/wscons/wsksymdef.h?rev=HEAD&amp;content-type=text/x-cvsweb-markup">/sys/dev/wscons/wsksymdef.h</a> にあります。一般的なマッピング
   を以下にあげておきます。
    <ul>
	<li><tt>de</tt>
	<li><tt>dk</tt>
	<li><tt>es</tt>
	<li><tt>fr</tt>
	<li><tt>it</tt>
	<li><tt>jp</tt>
	<li><tt>sv</tt>
	<li><tt>uk</tt>
	<li><tt>us</tt>
    </ul>
    <p>
    他にも、マッピングを変更するために使うバリアントがいくつかあります。
    <ul>
       <li><tt>dvorak</tt>
       <li><tt>swapctrlcaps</tt>
       <li><tt>iopener</tt>
    </ul>
    <p>
    「dvorak」は Dvrok キーボードレイアウトを使用します。「swapctrlcaps」
    は Caps Lock と左側のコントロールキーをいれかえます。「iopener」は
    Netpliance の非標準のキーボードレイアウトのためのものです。これは
    F1 をエスケイプに、F2 から F12 を F1 から F11 に割りあてます。
    これらは「us.iopener」のように、ドットとバリアント名を追加し、他の
    マップと結合することができます。「us.dvorak.swapctrlcaps」のように、
    複数のバリアントを結合することも可能です。ただし、すべての組み合わせが
    可能なわけではありません。
    <p>
    カーネルに組みこまれるデフォルト値を、<pre> options PCKBD_LAYOUT=KB_<em>エンコーディング
    </em></pre> を追加することにより、変更することができます。
    この <em>エンコーディング</em> は、上記のリストのエントリー
    を大文字にしたものです(例えば、<tt>PCKBD_LAYOUT=KB_FR</tt>)。
    バリアントは、ビット論理和で指定できます
    (eg: <tt>PCKBD_LAYOUT=KB_US|KB_SWAPCTRLCAPS</tt>)。
    <P>

    もし、あなたのお気に入りのキーマップがサポートされていなかったら、
    キーマップを作成するために、
    <a href="http://cvsweb.NetBSD.org/cgi-bin/cvsweb.cgi/src/sys/dev/wscons/wsksymdef.h"><tt>sys/dev/wscons/wsksymdef.h</tt></a> と
    <a href="http://cvsweb.NetBSD.org/cgi-bin/cvsweb.cgi/src/sys/dev/pckbc/wskbdmap_mfii.c"><tt>sys/dev/pckbc/wskbdmap_mfii.c</tt></a>
    を調べるとよいでしょう。修正依頼の PR を、あなたの変更と一緒に <a href="../../Misc/send-pr.html#submitting">send-pr</a> することを忘れないでください。そうすれば、他の人もそのキーマップを使用することができます。
    <p>
    独自のキーマップを実装する他の方法が
    <a href="http://www.NetBSD.org/cgi-bin/query-pr-single.pl?number=10976">PR 10976</a>に、後でロードされるファイルに記述されたロシア語のキーマップ定義が
    記述されています。ハンガリー語のキーマップが
    <a href="http://www.NetBSD.org/cgi-bin/query-pr-single.pl?number=11457">PR 11457</a> にあります。また、
    メーリングリストのアーカイブに <a href="http://mail-index.NetBSD.org/regional-de/2004/02/07/0009.html">i386 用スイス系ドイツ語と HP Jornada 720 用ドイツ語のキーマップ</a>もあります。
    <p>

    X 環境下でのキーボードのレイアウトの設定については
    <a href="../x/#x-keyboard-maps">ここ</a>に記述してあります。

</dd></dl>
<p><h3>
<a name="keyboard-speed">どうすればキーボードのリピート速度を変えられますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

<p>キーボードのリピート速度は <b><tt>wsconsctl</tt></b> ユーティリティー
を使って変えることができます。関係する変数はふたつあります:
ひとつは <code>repeat.del1</code> で、リピートが始まるまでの時間を指定します。
もうひとつは <code>repeat.deln</code> で、 (リピートが始まってからの)
反復間隔を設定します。</p>

<p>例を見てみましょう。キーボードの速度を変えたい状況であると仮定します。
コマンドラインで、以下のように変えることができます:</p>

<dl>
  <dd>wsconsctl -w repeat.del1=300<br>
  <dd>wsconsctl -w repeat.deln=40<br>
</dl>

<p>このほか、システム起動時に自動的にこの変更をするようにしたければ、
<code>/etc/wscons.conf</code>
ファイルに以下の内容を書き加えておくという方法もあります: </p>

<dl>
  <dd>setvar repeat.del1=300<br>
  <dd>setvar repeat.deln=40<br>
</dl>

</dd></dl>
<p><h3>
<a name="screen0">"WSDISPLAYIO_ADDSCREEN: Device busy"</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
普通、このエラーメッセージは、wsconscfg がすでに存在するスクリーンを
追加しようとした時に表示されます。この現象は /etc/wscons.conf に
<code> screen 0 </code>という行が存在する時にだけおこります。なぜなら
カーネルは、screen 0 を常にコンソールデバイスとして割り当てるからです。
このメッセージは無害ですが、<code>screen 0</code> の行を削除(または、
コメントアウト)すれば表示されなくなります。

</dd></dl>
<p><h3>
<a name="colors">どうしたらテキストの表示色を変更できますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

<p>カーネルメッセージのテキストの色と背景色は、
カーネルコンフィグファイルで以下のように設定することで変更できます。
</p> 

<pre>
options WS_KERNEL_FG=WSCOL_xxx
options WS_KERNEL_BG=WSCOL_xxx
</pre>

<p>この色の値 <tt>WSCOL_xxx</tt> は、
src/sys/dev/wscons/wsdisplayvar.h で定義されています。</p>

<p>NetBSD 2.0G (NetBSD 2.0 より後の -current) からは、
表示の見た目のいろいろなカスタマイズが簡単にできるようになりました:
通常のメッセージ表示の色、カーネルメッセージ表示の色や、
画面周囲の縁取りの色を変えられます。</p>

<p>これらの詳細はすべて、カーネルオプションと <a href="http://man.NetBSD.org/man/wsconsctl+8+NetBSD-current">wsconsctl(8)</a>
ユーティリティーのどちらからでも変えられます; デフォルトの GENERIC
カーネルのオプションでは、 <a href="http://man.NetBSD.org/man/wsconsctl+8+NetBSD-current">wsconsctl(8)</a> による方法が使えるようになっているので、
カーネルの再構築をしたくなければこちらを使うのがよいでしょう。</p>

<p>以下に示すオプションを <a href="http://man.NetBSD.org/man/wsconsctl+8+NetBSD-current">wsconsctl(8)</a> を通じて設定可能です:</p>

<ul>
<li><b>border</b>: 画面の縁取りの色です。対応するカーネルオプションは
<code>WSDISPLAY_BORDER_COLOR</code> です。</li>

<li><b>msg.default.attrs</b>: 通常のコンソールメッセージ表示の属性です。
対応するカーネルオプションは <code>WS_DEFAULT_COLATTR</code>
と <code>WS_DEFAULT_MONOATTR</code> です
(前者はカラーディスプレイ用、後者はモノクロディスプレイ用です)。</li>

<li><b>msg.default.bg</b>: 通常のコンソールメッセージ表示の背景色です。
対応するカーネルオプションは <code>WS_DEFAULT_BG</code> です。

<li><b>msg.default.fg</b>: 通常のコンソールメッセージ表示の色です。
対応するカーネルオプションは <code>WS_DEFAULT_FG</code> です。

<li><b>msg.kernel.attrs</b>: カーネルメッセージおよび警告表示の属性です。
対応するカーネルオプションは
<code>WS_KERNEL_COLATTR</code> と <code>WS_KERNEL_MONOATTR</code> です
(前者はカラーディスプレイ用、後者はモノクロディスプレイ用です)。</li>

<li><b>msg.kernel.bg</b>: カーネルメッセージおよび警告表示の背景色です。
対応するカーネルオプションは
<code>WS_KERNEL_BG</code> です。

<li><b>msg.kernel.fg</b>: カーネルメッセージおよび警告表示の色です。
対応するカーネルオプションは
<code>WS_KERNEL_FG</code> です。
</ul>

<p>色として指定できるのは、 black, red, green, brown, blue,
magenta, cyan, white です。属性は、 reverse, hilit, blink, underline
のいずれか一つまたは複数をコンマで区切ります。</p>

<p>たとえば、古い Amstrad マシンの一つの表示をエミュレートするには、
以下のようにします:</p>

<dl>
    <dd>wsconsctl -d -w border=blue msg.default.bg=blue
    msg.default.fg=white msg.default.attrs=hilit</dd>
</dl>

<p>あるいは、カーネルメッセージを赤にするには、以下のようにします:</p>

<dl>
    <dd>wsconsctl -d -w msg.kernel.fg=red</dd>
</dl>

<p>なお、これより前のバージョンの NetBSD では、これらの機能の一部しか使えませんので注意してください;
具体的には、カーネルメッセージの表示色を、
上述のカーネルオプションを使った方法で変えられるだけです。
さらに、すべてのドライバーがこの機能に対応しているわけではありませんので、
どのアーキテクチャーででも意図どおりの結果が得られるとは限りません。</p>


</dd></dl>
<p><h3>
<a name="muxdevices">どうすれば wscons の "mux" デバイスを使えるようになりますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
wscons の "mux" デバイスは、一つ以上の wskbd、wsmouse デバイスからの入力
ストリームを多重化します。多重化された wsmouse デバイスのためのデバイスは
/dev/wsmouse です。そして、wskbd デバイスのためには /dev/wskbd が用意されて
います。もし、X サーバーが hardwiring なポインティングデバイスでなく、
/dev/wsmouse を使用するように設定されている場合、wsmouse 互換のすべての
ポインティングデバイスを使うことができます。また、二つ以上のポインティング
デバイスを同時に使用することができます。
<p>
以下の手順で使用可能になります。
<p>
<ol>
<li>カーネルのコンフィギュレーションと再構築
    <ul>
    <li>カーネルのコンフィグのすべての "wsmouse* at ..." 行に、オプション
        "mux 0" を追加してください(例えば、<b>wsmouse* at ums? mux 0</b>)。
    <li>カーネルのコンフィグのすべての "wskbd* at ..." 行に、上の例と同じ
        ようにオプション "mux 1" を追加してください。
    <li>カーネルのコンフィグに "<b>pseudo-device wsmux 2</b>" が定義されて
        いることを確認してください。
    <li>カーネルを再構築します。もし、再構築の方法を知らなければ、詳細な説明が
      <a href="../kernel/">Kernel FAQ</a>
        にあります。
    </ul>

<p>
<li>/dev/wsmouse と /dev/wskbd を作成してください。
    <ul>
    <li>root になり /dev に cd し、"./MAKEDEV wsmux" を実行してください。
        もし、うまくいかなければ、手でデバイスを /dev ディレクトリーに
        作成してください。
        <dl>
        <dd>mknod wsmouse c 65 0<br>
        <dd>mknod wskbd c 65 1<br>
        <dd>chown root:wheel wsmouse wskbd<br>
        <dd>chmod 600 wsmouse wskbd<br>
        </dl>
    </ul>

<p>
<li>X を使用しているのであれば、/etc/XF86Config を編集してください。
    <ul>
    <li> XF86Config の残りの部分が正しく設定されているのであれば、
         "Pointer" セクションのプロトコルとデバイス行を、以下のように
         変更するだけです。
    <dl>
    <dd>Protocol "wsmouse"<br>
    <dd>Device "/dev/wsmouse"<br>
    </dl>
    </ul>
</ol>

<p>
これらの手順をすべておこなえば、ラップトップの組み込みポインティング
デバイスを常に使用することができます。そして、後で接続した USB マウスを、
カーネルの再構築や X サーバーの再スタートなしで使うことができます。

</dd></dl>
<p><h3>
<a name="mouseres">どうすればマウスの解像度を変更できますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

PS/2 マウスを使用しているのであれば、以下のコマンドでうまくいくでしょう。
<i>nnn</i> は、0 から 100 までの整数です。
<dl>
<dd>wsconsctl -m -w resolution=<i>nnn</i>
</dl>


</dd></dl>
<p><h3>
<a name="fontedit">フォントエディターはありますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

コンソール用のフォントとしてロード可能なフォントが、
<tt>/usr/share/wscons/fonts</tt>の中にいくつか存在します。これらの
フォントを編集したいのであれば、<a href="ftp://ftp.NetBSD.org/pub/NetBSD/packages/pkgsrc/sysutils/pcvt-utils/README.html">pcvt-utils</a> の中にある
古い pcvt ユーティリティーを使用することができます。
<p>


</dd></dl>
<p><h3>
<a name="moused">どうすればシリアルマウスを使えるようになりますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

wsmouse デバイス (wscons の一部) は、シリアルマウスを直接にはサポートしません。
<a href="http://man.NetBSD.org/man/moused+8+NetBSD-current">moused(8)</a> デーモンは、生のシリアルマウスデータを受け取ると、
wsmouse イベントに変換したうえで wscons イベントキューに送り込みます。
この結果、シリアルマウスは wsmouse によって抽象化された層を経由して
使用可能になります。
<p>

典型的な使い方は <tt>moused -p /dev/tty00</tt> です。こうすると、
一つ目のシリアルポートに接続されたマウスの種類を判別し、
データ読み込みを開始します。 <a href="http://man.NetBSD.org/man/moused+8+NetBSD-current">moused(8)</a> に、もっといろいろな例が載っています。


</dd></dl>
<p><h3>
<a name="wsmoused">どうすればマウスコンソールサポートが有効になりますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>

マウスコンソールサポートは、 NetBSD 1.6B から、 <a href="http://man.NetBSD.org/man/wsmoused+8+NetBSD-current">wsmoused(8)</a> デーモン経由で
利用可能になりました。このプログラムは、 wscons コンソールで
マウスポインターを使った <i>コピー &amp; ペースト</i> 機能を提供します。
<p>

現在、この機能は、 wscons の裏側で <a href="http://man.NetBSD.org/man/vga+1+NetBSD-current">vga(1)</a> ビデオドライバーを使っている
アーキテクチャーすべてで使えます。具体的には、 alpha、 arc、 bebox、 cats、
hp700、 i386 と prep です。
<p>

<a href="http://man.NetBSD.org/man/wsmoused+8+NetBSD-current">wsmoused(8)</a> を使うための手順は以下のとおりです
(マニュアルページに、さらに情報があります):

<ol>
  <li>カーネルコンフィギュレーションファイルで <code>WSDISPLAY_CHARFUNCS</code>
  を有効にして、カーネルを再構築、インストールします。</li>

  <li>/etc/ttys を書き換えます: /dev/console を無効にして、 /dev/ttyE0
  を有効にします; これは wsmoused が利用します。</li>

  <li>必要に応じて、 /etc/wscons.conf を書き換えて <code>screen 0</code>
  (/dev/ttyE0) を有効にします。</li>

  <li>/etc/rc.conf に <code>wsmoused=yes</code> を書き加えます。 X Window System
  を使っている場合は、このファイルに <code>wsmoused_flags="-X 4"</code>
  も書いておくのがよいでしょう; これで、どのコンソールで X11
  が走っているかがデーモンに知らされます。</li>

  <li>再起動し、お楽しみください!</li>
</ol>

</dd></dl>
<hr>

<table width="100%"><tr><td>
<table border="0" summary="Footer navigation"><tr>
<td class="foothome"><span class="foothome"><a href="../../"><img src="../../../images/NetBSD-flag.png" origlink="../../images/NetBSD-flag.png" alt="" border="0" width="90" height="90"></a></span></td>
<td class="foothome">
<span class="foothome"><a href="../../">ホームページ</a></span><br>
</td>
</tr></table>
</td><td>
<table border="0" summary="Footer navigation"><tr>
<td class="foothome"><span class="foothome"><a href="../../Documentation/"><img src="../../../images/NetBSD-flag.png" origlink="../../images/NetBSD-flag.png" alt="" border="0" width="90" height="90"></a></span></td>
<td class="foothome">
<span class="foothome"><a href="../../Documentation/">Documentation top level</a></span><br>
</td>
</tr></table>

</td></tr></table>

<hr>
<address>
  <small>
  (連絡先 - <a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">英語</a>,
       <a href="mailto:www@jp.NetBSD.org">日本語:
       www@jp.NetBSD.org</a>)<br>
  $NetBSD: index.html,v 1.22 2005/02/07 16:46:14 kano Exp $<br>
  <!-- based on english translation: -->
  <!-- NetBSD: index.list,v 1.26 2004/09/02 00:39:04 hubertf Exp   -->
  <a href="../../Misc/disclaimer.html">Copyright &copy; 1994-2004
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
