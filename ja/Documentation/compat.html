<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>

<!-- DO NOT EDIT THIS FILE. EDIT 'compat.list' AND RUN 'make' -->

<!-- Copyright (c) 2000
        The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<title>NetBSD Binary Emulation</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<table><tr><td>
    <a href="/Misc/daemon-copy.html"><img
     align="middle" src="/images/BSD-daemon.jpg" border="0"
     width=146 height=129 alt="BSD daemon"></a>
  </td><td align=center>
    <h1>NetBSD ドキュメンテーション:</h1>
    <h1>Binary Emulation in NetBSD</h1>
</td></tr></table>
<p>

<h2><a name="top">バイナリーエミュレーション</a></h2>
<ul>
<li>
<a href="#what">バイナリーエミュレーションとは何ですか? なぜ存在するのですか?</a></li>
<li>
<a href="#compat">他にどのようなバイナリー互換性がありますか?</a></li>
<li>
<a href="#how">どのように動作するのですか?</a></li>
<li>
<a href="#which">どのシステムのバイナリーを動かす事ができますか?</a></li>
<li>
<a href="#performance">性能はどうでしょうか?</a></li>
<li>
<a href="#considerations">他に注意すべき事がありますか?</a></li>
<li>
<a href="#ports">私のマシンでは、どの OS のエミュレーションが可能ですか?</a></li>
<li>
<a href="#applications">どのようなアプリケーションが動作するのでしょうか?</a></li>
<li>
<a href="#problems">どのようなアプリケーションが動作 <b>しない</b>のでしょうか?</a></li>
</ul>


<hr>
<h2>バイナリーエミュレーション</h2><hr>
<p><h3>
<a name="what">バイナリーエミュレーションとは何ですか? なぜ存在するのですか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
多くの Unix ソフトウェアはソースコード形式で配布されます。これは、作者
が C (あるいは他の言語)のプログラムコードを提供し、インストール時に、
ローカルマシンで実行するための実行可能ファイルを生成するためにコンパイ
ラーを使うことを意味します。ソースコードとインストレーションユーティリ
ティを注意深く書けば、さまざまな種類のオペレーティングシステム上で、同
一のプログラムを構築することができます。
<p>ソースコードは企業秘密を含んでいることがあるため、商用ソフトウェア
ベンダーはソースコードの配布をおこなわない傾向があります。商用ベンダー
は、通常、直接実行可能なプログラムを配布します。ベンダー内部でコンパイ
ルをおこない、機密が簡単に洩れないバイナリーファイルを配布します。
<p>この結果、ベンダーはサポートするオペレーティングシステムのためにマ
ンパワーを費やさざるをえません。通常、保守のためのテストをおこない、そ
して、コンパイルとテストのためにすくなくとも一人の人間が必要です。
<p>このことは、オペレーティングシステムと消費者が使いたいと思っている
アプリケーションを結びつけます。ある消費者は、彼らが使っているオペレー
ティングシステムがサポートされていないので、アプリケーションを使うのを
あきらめるかもしれません。また、ある消費者は、いくつかの絶対に必要なア
プリケーションのために、サポート済みのオペレーティングシステムを使わな
ければならないかもしれません。
<p>バイナリーエミュレーションは、この強制的な結び付きを取り除きます。

</dd></dl>
<p><h3>
<a name="compat">他にどのようなバイナリー互換性がありますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
知っておく価値のあるもうひとつの互換性の仕様があります。NetBSD は同じ 
CPU を使用する NetBSD マシン間で、同一のバイナリーオブジェクトファイル
フォーマットを使用します。もし、NetBSD sun3 上でバイナリーを作成した場
合、そのバイナリーを NetBSD amiga、NetBSD mac68k、NetBSD mvme68k、
NetBSD next68k 等の上で実行することができます。しかしながら、そのバイ
ナリーを Intel プロセッサー系のマシン上で実行することはできません。

</dd></dl>
<p><h3>
<a name="how">どのように動作するのですか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
Unix と Unix 風のシステムは、二つの重要な部分、カーネルとそれ以外で構
成されています。カーネルは、デバイスやセキュリティ、マシンのリソースを
使うプログラムを管理します。通常、カーネルはカーネルシステムコールを 
経由し、他のプログラムへサービスを提供します。例えば、ファイルをOPEN 
するプログラムの場合、プログラムはカーネルの OPEN 関数をコールします。
カーネルはその要求を許可あるいは拒否し、プログラムが処理を継続するのに
必要な情報をかえします。
<p>すべての Unix と Unix 風のシステムは、よく似たシステムコールの集合
を提供しています。(例えば、OPEN はすべてのシステムに存在します)
<br>システム間でのシステムコールの一番の違いはシステムコールにわたされ
るパラメーターのフォーマットでしょう。(NetBSD の OPEN は、ファイル名、
フラグ、モードをわたします)&nbsp;システム間で、システムコールの名前
が異なる場合もあります。NetBSD システム上で Linux の実行可能ファイルを
実行する場合、プログラムがシステムコールを実行する度に、カーネルは適切
な NetBSD のシステムコールへのマッピングや、必要なパラメータの並べ変え、
再フォーマットをおこないます。
<p>もう一つの重要な問題は、実行可能ファイルのフォーマットが異なる事で
す。すべての他のオペレーティングシステムは、バイナリーを保存するのに異
なるヘッダー、マジッククッキー、hunks、その他を使った異なるファイルフォー
マットを使用しています。NetBSD が、ネイテイブにサポートしているのは 
a.out か ELF (アーキテクチャーとバージョンに依存します。NetBSD は、ポー
ト毎のスケジュールに従って ELF に移行中です)です。他に、b.out、COFF、
ECOFF、ieee695、PE、SOM、XCOFF という実行可能フォーマットをサポートし
ています。NetBSD のエミュレーションは、これらの実行可能フォーマットを
エミュレーションされるシステム上でどのように扱えば良いかを知っています。
<p>異なるシステムでは、システムコールは異なった方法でアクセスされます
し、パラメーターも異なる方法でわたされます。例えば、AmigaOS では、他の
アドレスレジスターやデータレジスタ内のデータによって指されている関数へ
のポインターを含むテーブルのインデックスが使用されます。他のオペレーティ
ングシステムは他の方法、トラップ、テーブル、レジスター、スタック等を使
用しています。そして、これはバイナリエミュレーションによって処理されます。
<p>最後になりますが、実行可能ファイルがコンパイルされた CPU と、実行す
るシステムの CPU が一致していることは非常に重要です。システムコールと
比較すると、実行可能ファイルは 低レベルの CPU インストラクションで構成
されています。したがって、SCO Unix バイナリー(Intel 386 シリーズ CPU) 
は、NetBSD i386 上で動作します。しかし、NetBSD Amiga (Motorola 680x0 CPU)
上で動作させる事はできません。これをおこなうためには、もっと複雑な変換
システムが必要です。そして、これはアプリケーションの性能に大きな影響を
あたえます。

</dd></dl>
<p><h3>
<a name="which">どのシステムのバイナリーを動かす事ができますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
一般的には、NetBSD と同じハードウェア上で動作する unix オペレーティン
グシステム用のバイナリーを動かすことができます。それぞれのポートでサポー
トされているバイナリーのフォーマットのリストと、成功例が、
<a href="#ports">このページの一番最後</a>から選択できるプラットフォーム
固有のページにあります。
</dd></dl>
<p><h3>
<a name="performance">性能はどうでしょうか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
余計なオーバーヘッドは、エミュレートされるシステムコールから NetBSD の
ネイテイブなシステムコールへのマッピングと、必要ならパラメータの再フォー
マットにかかる時間だけです。したがって、非常に、非常に高性能です。大雑
把な見積もりでは、最大で 1-2% の性能への大きな影響があります。もし、あ
なたが 2% を大きな影響と考えるならですが。これは、プログラムが使用して
いるシステムコールに依存して変化します。ほとんどのマッピングは、実際に
システムコールが実行される時間の 1% 未満でしょう。

</dd></dl>
<p><h3>
<a name="considerations">他に注意すべき事がありますか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
同じタイプの CPU、システムコールのマッピング以外にも考慮しなければな
らない事があります。多くの Unix システムは共有ライブラリーをサポートし
ています。これは、コンパイル済みのプログラムには、すべての関数が含まれ
ていないという事を意味しています。(これはプログラムのサイズを小さくで
きるという事でもあります)。しかし、このせいで、外部のライブラリーは、
プログラムがコンパイルされた時に使っていたものと一致していなければなり
ません(こまかな変更は関係ありません)。バイナリーエミュレーションでプロ
グラムを実行したい場合、「file」コマンドを使用し、スタティックリンクか
ダイナミックリンクかを調べる事ができます。
<p>% file qwsv
<br>qwsv: BSD/OS i386 compact demand paged executable
<p>% file arp
<br>arp: NetBSD/i386 demand paged dynamically linked executable
<p>「dynamically linked」と表示された場合、スタティックにリンクされて
いないという事を意味しています。フリーに配布されている Unix システム
用の共有オブジェクトのライブラリーは、NetBSD pkgsrc を使い /compat 
ディレクトリにインストールされます。スタティックにリンクされたバイナリー
を実行する場合には、共有ライブラリーは必要ありません。
<p>商用のシステムの場合は、自分自身でライブラリーを用意する必要があり
ます。一覧を得るためには man -k compat&nbsp; を参照してください。イン
ストールの手順については、man compat_os を参照してください:
<p>% man -k compat
<br>compat_freebsd (8) - setup procedure for running FreeBSD binaries
<br>compat_linux (8) - setup procedure for running Linux binaries
<br>compat_sunos (8) - setup procedure for m68k and sparc architectures
<br>compat_svr4 (8) - setup procedure for running SVR4/iBCS2 binaries
<br>compat_ultrix (8) - setup procedure for Ultrix compatibility on mips
and vax

</dd></dl>
<p><h3>
<a name="ports">私のマシンでは、どの OS のエミュレーションが可能ですか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD は、さまざまな CPU とハードウェア上で動作します。機種固有の
情報については、以下のリストを参照してください。もし。これ以外の
エミュレーションについての情報を知っていたら、どうか <a 
href="../Misc/feedback.html">私達に教えてください</a>。
<p>
<big><b>alpha</b></big><p>
	<ul>
	<li>Linux(Alpha)</li>
	<li>OSF/1</li>
	</ul>
<p>
<big><b>amiga</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>arc</b></big><p>
<big><b>arm26</b></big><p>
<big><b>arm32</b></big><p>
<big><b>atari</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>bebox</b></big><p>
<big><b>cobalt</b></big><p>
<big><b>dreamcast</b></big><p>
<big><b>hp300</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>hpcmips</b></big><p>
<big><b>hpcsh</b></big><p>
<big><b>i386</b></big><p>
	<ul>
	<li>BSDI (BSDI 3.x バイナリーまで)</li>
	<li>FreeBSD(x86) (a.out と ELF バイナリー)</li>
	<li>IBCS2 システム
	<ul>
	<li>Interactive Unix</li>
	<li>SCO Unix</li>
	<li>SCO Xenix</li>
	</ul></li>
	<li>Linux(x86)</li>
	<li>Solaris(x86)</li>
	</ul>
<p>
<big><b>luna68k</b></big><p>
<big><b>mac68k</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>macppc</b></big><p>
<big><b>mipsco</b></big><p>
<big><b>mvme68k</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>news68k</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>newsmips</b></big><p>
<big><b>next68k</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>ofppc</b></big><p>
<big><b>pc532</b></big><p>
<big><b>pmax</b></big><p>
<big><b>prep</b></big><p>
<big><b>sandpoint</b></big><p>
<big><b>sgimips</b></big><p>
<big><b>sh3</b></big><p>
<big><b>sparc</b></big><p>
	<ul>
	<li>SunOS(sparc)</li>
	<li>Solaris(sparc)</li>
	</ul>
<p>
<big><b>sparc64</b></big><p>
<big><b>sun3</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>
<p>
<big><b>vax</b></big><p>
<big><b>x68k</b></big><p>
	<ul>
	<li>Amiga Unix (SVR4)</li>
	<li>HPUX(68k)</li>
	<li>Linux(m68k)</li>
	<li>SunOS(68k)</li>
	</ul>

</dd></dl>
<p><h3>
<a name="applications">どのようなアプリケーションが動作するのでしょうか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD は、さまざまな CPU とハードウェア上で動作します。機種固有の情報
については、以下のリストを参照してください。もし。これ以外のアプリケー
ションについての情報を知っていたら、どうか <a href="../Misc/feedback.html">
私達に教えてください</a>。
<p>
<big><b>alpha</b></big><p>
<big><b>amiga</b></big><p>
<big><b>arc</b></big><p>
<big><b>arm26</b></big><p>
<big><b>arm32</b></big><p>
<big><b>atari</b></big><p>
<big><b>bebox</b></big><p>
<big><b>cobalt</b></big><p>
<big><b>dreamcast</b></big><p>
<big><b>hp300</b></big><p>
<big><b>hpcmips</b></big><p>
<big><b>hpcsh</b></big><p>
<big><b>i386</b></big><p>
	<ul>
	<li>Acroread - Linux(x86)</li>
	<li>翻訳の王様 POWER+ - Linux(x86)</li>
	<li>Mozilla - FreeBSD(x86)</li>
	<li>Mozilla - Linux(x86)</li>
	<li>Netscape - BSDI(x86)</li>
	<li>Netscape - Linux(x86)</li>
	<li>Netscape - Solaris(x86)</li>
	<li>Perforce - FreeBSD(x86)</li>
	<li>Realplayer 5, 7 - Linux(x86)</li>
	<li>sqlplus Oracle クライアント - Solaris(x86)</li>
	<li>StarOffice 5.1a - Linux(x86) (NetBSD 1.5 か -current が必要)</li>
	<li>WordPerfect 8 - Linux(x86)</li>
	</ul>
<p>
<big><b>luna68k</b></big><p>
<big><b>mac68k</b></big><p>
<big><b>macppc</b></big><p>
<big><b>mipsco</b></big><p>
<big><b>mvme68k</b></big><p>
<big><b>news68k</b></big><p>
<big><b>newsmips</b></big><p>
<big><b>next68k</b></big><p>
<big><b>ofppc</b></big><p>
<big><b>pc532</b></big><p>
<big><b>pmax</b></big><p>
<big><b>prep</b></big><p>
<big><b>sandpoint</b></big><p>
<big><b>sgimips</b></big><p>
<big><b>sh3</b></big><p>
<big><b>sparc</b></big><p>
	<ul>
	<li>Acroread3 - SunOS(sparc)</li>
	<li>Netscape - Solaris(sparc)</li>
	</ul>
<p>
<big><b>sparc64</b></big><p>
<big><b>sun3</b></big><p>
<big><b>vax</b></big><p>
<big><b>x68k</b></big><p>

</dd></dl>
<p><h3>
<a name="problems">どのようなアプリケーションが動作 <b>しない</b>のでしょうか?</a>
<font size="-1">(<a href="#top">top</a>)</font>
</h3><dl><dt><dd>
NetBSD は、さまざまな CPU とハードウェア上で動作します。機種固有の情報
については、以下のリストを参照してください。もし。これ以外のアプリケー
ションについての情報を知っていたら、どうか <a href="../Misc/feedback.html">
私達に教えてください</a>。
<p>
いくつかのケースでは、アプリケーションは、初期の NetBSD のリリースでサ
ポートされていないエミュレーションレイヤーの機能を必要とします。通常こ
れは、他の OS が新しいシステムコールを実装し、アプリケーションの作者が
それを使うようにアプリケーションを変更した時におこります。以下のリスト
で、「サポートされていないもっとも新しいバージョン」と書かれているアプ
リケーションは、それ以降の NetBSD のリリースで動作します。
<p>
<big><b>alpha</b></big><p>
<big><b>amiga</b></big><p>
<big><b>arc</b></big><p>
<big><b>arm26</b></big><p>
<big><b>arm32</b></big><p>
<big><b>atari</b></big><p>
<big><b>bebox</b></big><p>
<big><b>cobalt</b></big><p>
<big><b>dreamcast</b></big><p>
<big><b>hp300</b></big><p>
<big><b>hpcmips</b></big><p>
<big><b>hpcsh</b></big><p>
<big><b>i386</b></big><p>
<ul>
<li>eWnn(日本語/英語 翻訳) - Linux(x86) (Mule 2.3 が必要、SEGV)</li>
<li>翻訳魂 (日本語/英語 翻訳) - Linux(x86)</li>
<li>一太郎 ARK for Java (日本語ワードプロセッサー) - Linux(x86) (JSDK1.2.2 が必要)</li>
<li>Objectivity - Linux(x86) (データベース作成時に coredump)</li>
<li>Oracle - Linux(x86) (インストール時に SEGV)</li>
<li>Shade Preview - Linux(x86) (たぶん RedHat の共有ライブラリーが必要)</li>
<li>StarOffice 5.1a - Linux(x86) (NetBSD 1.4.x では未対応)</li>
<li>VMWare</li>
<li>Wnn6 Ver3 - Linux(x86) (必要な symlink がオープンできない)</li>
</ul>
<p>
<big><b>luna68k</b></big><p>
<big><b>mac68k</b></big><p>
<big><b>macppc</b></big><p>
<big><b>mipsco</b></big><p>
<big><b>mvme68k</b></big><p>
<big><b>news68k</b></big><p>
<big><b>newsmips</b></big><p>
<big><b>next68k</b></big><p>
<big><b>ofppc</b></big><p>
<big><b>pc532</b></big><p>
<big><b>pmax</b></big><p>
<big><b>prep</b></big><p>
<big><b>sandpoint</b></big><p>
<big><b>sgimips</b></big><p>
<big><b>sh3</b></big><p>
<big><b>sparc</b></big><p>
<ul>
<li>Acroread4 - Solaris(sparc)</li>
</ul>
<p>
<big><b>sparc64</b></big><p>
<big><b>sun3</b></big><p>
<big><b>vax</b></big><p>
<big><b>x68k</b></big><p>

</dd></dl>
<hr>

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../"><img
	src="/images/NetBSD-flag.gif" border="0"
	width="91" height="42" alt=""></a>
  </td><td>
    <a href="../"><img
	src="/images/empty.gif" border="0"
	width="1" height="1" alt="NetBSD ">ホームページ</a>
  </td></tr></table>
</td><td>
  <table><tr><td>
    <a href="../Documentation/"><img
	src="/images/NetBSD-flag.gif" border="0"
	width="91" height="42" alt=""></a>
  </td><td>
    <a href="../Documentation/"><img
	src="/images/empty.gif" border="0"
	width="1" height="1" alt="NetBSD ">Documentation top level</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  <a href="../Misc/feedback.html">(Contact us)</a>
  $NetBSD: compat.html,v 1.4 2001/02/24 11:20:42 yyamano Exp $<br>
  <a href="../Misc/disclaimer.html">Copyright &copy;
    2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
