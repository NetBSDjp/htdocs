<?xml version="1.0"?>
<!DOCTYPE webpage
 PUBLIC "-//NetBSD//DTD Website-based NetBSD Extension//EN"
        "http://www.NetBSD.org/share/xml/website-netbsd.dtd">

<webpage id="ports-news68k-faq">
<config param="desc" value="NetBSD/news68k Frequently Asked Questions"/>
<config param="cvstag" value="$NetBSD: faq.xml,v 1.3 2009/09/19 21:27:37 snj Exp $"/>
<config param="rcsdate" value="$Date: 2009/09/19 21:27:37 $"/>
<head>

<!-- Copyright (c) 2002-2007
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->

<title>NetBSD/news68k Frequently Asked Questions</title>
</head>


<sect1 role="toc">
<title>NetBSD/news68k Frequently Asked Questions</title>

<sect2 id="general">
<title>General Questions</title>

<sect3 id="serial_console">
<title>How can I set up a serial console?</title>
<para>
First, turn off DIP switches 1-3 to specify to use serial console
for the PROM monitor.
(See <ulink url="#dip_sw">DIP switch descriptions</ulink> for details)</para>
<para>
The NEWS machines use CH0 port for serial console, with
9600bps, 8 bit char, no parity and 1 stop bit.
</para>
<para>
Serial ports of news1400/1500/1600/1700 use ordinary 25P D-sub connectors,
so you just need a null modem cable.
</para>
<para>
news1200 uses female 9P D-sub connectors.
It has the same pin layout with PCs, though they have male 9P connectors.
</para>
<para>
See the <ulink url="../../docs/Hardware/Misc/serial.html">NetBSD Serial 
Port Primer</ulink> for more information.
</para>
</sect3>
<sect3 id="dead_nvram">
<title>My NEWS does not print anything to console!</title>
<para>
The NEWS machines use the MK48T02 NVRAM chip, which is also used
in the SPARCstation machines. If the NVRAM battery is dead,
the machine won't boot properly.
</para>
<para>
What you need to do, both with a new NVRAM, or one with a dead battery is
to press the POWER/RESET buttons in the following order to force
the PROM monitor to re-initialize the NVRAM:
</para>

<itemizedlist>
 <listitem><para>Press and hold POWER button</para></listitem>
 <listitem><para>Press RESET, while still holding POWER</para></listitem>
 <listitem><para>Release RESET first</para></listitem>
 <listitem><para>And then release POWER</para></listitem>
</itemizedlist>

<para>
Unlike SPARCstations, you don't have to restore any data
like the ethernet MAC address.
The MAC address is stored in ROM on NEWS,
and only thing you have to set is the time of the day for the clock.
</para>

<para>
If you are going to replace the dead NVRAM, the
<ulink url="http://www.squirrel.com/squirrel/sun-nvram-hostid.faq.html">
Sun NVRAM/hostid page</ulink> has lots of useful information about
the chips. Maybe you could try to
<ulink url="http://www.squirrel.com/squirrel/sun-nvram-hostid.faq.html#attach">
attach a new battery onto the NVRAM</ulink>, but on some NEWS models the NVRAM
might be soldered to the mainboard without a socket <code>:-(</code>
</para>
</sect3>

<sect3 id="dip_sw">
<title>How should I set the DIP switches?</title>
<para>
news68k machines have one block of 8 dip switches:
</para>

<table id="console_settings">
<tgroup cols="1">
<thead>
<row>
  <entry>Switch 1,2,3</entry>
  <entry>console settings</entry>
</row>
</thead>
<tbody>
<row>
 <entry><code>OFF,OFF,OFF</code></entry>
 <entry>ANSI terminals (i.e., serial console)</entry>
</row>
<row>
 <entry><code>OFF,OFF,ON </code></entry>
 <entry>NWB-512 monochrome bitmap console</entry>
</row>
<row>
 <entry><code>ON ,OFF,OFF</code></entry>
 <entry>NWB-225A color bitmap console</entry>
</row>
<row>
 <entry><code>ON ,ON ,ON </code></entry>
 <entry>newer framebuffers which support autoselection functions
     (NWS-251, NWB-514, etc.)</entry>
</row>
</tbody>
</tgroup>
</table>

<table id="boot_device">
<tgroup cols="1">
<thead>
<row>
  <entry>Switch 4</entry>
  <entry>boot device</entry>
</row>
</thead>
<tbody>
<row>
 <entry><code>OFF</code></entry>
 <entry>boot from SCSI disk: <code>hd()</code></entry>
</row>
<row>
 <entry><code>ON</code></entry>
 <entry>boot from floppy disk: <code>fh()</code></entry>
</row>
</tbody>
</tgroup>
</table>

<table id="autoboot">
<tgroup cols="1">
<thead>
<row>
  <entry>Switch 5</entry>
  <entry>autoboot</entry>
</row>
</thead>
<tbody>
<row>
 <entry><code>OFF</code></entry>
 <entry>PROM monitor</entry>
</row>
<row>
 <entry><code>ON</code></entry>
 <entry>auto boot</entry>
</row>
</tbody>
</tgroup>
</table>

<table id="diagnostic">
<tgroup cols="1">
<thead>
<row>
  <entry>Switch 6</entry>
  <entry>diagnostic (?)</entry>
</row>
</thead>
<tbody>
<row>
 <entry><code>OFF</code></entry>
 <entry>Diag off (default)</entry>
</row>
<row>
 <entry><code>ON</code></entry>
 <entry>Diag on</entry>
</row>
</tbody>
</tgroup>
</table>

<table id="unused">
<tgroup cols="1">
<thead>
<row>
  <entry>Switch 7,8</entry>
  <entry>unused</entry>
</row>
</thead>
<tbody>
<row>
 <entry>default off</entry>
</row>
</tbody>
</tgroup>
</table>

</sect3>

<sect3 id="power_off">
<title>How can I turn off the machine other than by unplugging the cable?</title>
<para>
Just press the RESET button (without POWER),
or use the <code>"off"</code> command on the PROM prompt.
</para>
</sect3>

<sect3 id="bootfd">
<title>NetBSD/news68k install floppy does not boot</title>
<para>
There are some reports that some news1500 machines cannot boot
the install floppy because of read errors.
It might be caused by a bug in the PROM monitor or boot loader,
but could be actual media errors. Try cleaning up your drive and
booting several times with several disks.
</para>
</sect3>

<sect3 id="level_3_int">
<title>Kernel prints <code>"level 3 interrupt:"</code> forever after boot with power cycle</title>
<para>
Some old versions of PROM monitors do not initialize framebuffers
in expansion slots properly when serial console is specified,
which leads to the framebuffer causing spurious interrupts.
</para>

<para>
The workaround is to reset the machine (using the POWER+RESET method mentioned
above) with bitmap console settings once, and then reset again with serial
console.
</para>
</sect3>

<sect3 id="coexist_news_os">
<title>Can I install both NetBSD and NEWS-OS in the same disk?</title>
<para>
It is not well tested and not recommended, but yes, it is possible.
</para>
<para>
NetBSD/news68k can recognize NEWS-OS disklabels and mount NEWS-OS disks,
but once NetBSD modifies the NEWS-OS disklabel, NEWS-OS cannot recognize them.
It is recommended to install each OS on its own disk.
</para>
</sect3>
</sect2>

<sect2 id="prom_questions">
<title>PROM monitor Questions</title>

<sect3 id="prom_command">
<title>What commands can I use at the PROM prompt?</title>
<para>
The <code>help</code> command will show all the commands.
On a NWS-1750 it says:</para>
<programlisting>
NEWS&gt; help
bf [.{b|w|l}] &lt;bgn&gt; {&lt;end&gt;|:&lt;cnt&gt;} &lt;data&gt;               : Block Fill
bm &lt;bgn&gt; {&lt;end&gt;|:&lt;cnt&gt;} &lt;dest&gt;                          : Block Move
bo [&lt;dev&gt;]                                              : BOot
bp [&lt;addr&gt; [:&lt;cnt&gt;]] ...                                : BreakPoint set
cp &lt;src_dev&gt; &lt;bgn&gt;:&lt;cnt&gt; &lt;dst_dev&gt; &lt;dest&gt;               : CoPy
format {fd|fh}                                          : FORMAT floppy
go [&lt;addr&gt; [&lt;bkpt&gt; [:&lt;cnt&gt;]]]                           : GO to user program
help                                                    : display this
md [.{b|w|l}] [&lt;bgn&gt; [{&lt;end&gt;|:&lt;cnt&gt;}]]                  : Memory Display
ms [.{b|w|l}] [&lt;addr&gt; [&lt;data&gt;]]                         : Memory Set
mu                                                      : Memory Usage
nobp [&lt;addr&gt;] ...                                       : NO BreakPoint
off                                                     : turn power OFF
rc                                                      : Re-assign Console
rd [{dreg|areg|preg|creg|mreg}] ...                     : Register Display
rr                                                      : Register Reset
rs [&lt;reg&gt; [&lt;data&gt;]]                                     : Register Set
set [&lt;var&gt;[=&lt;value&gt;]]                                   : SET variable
st [:&lt;cnt&gt;]                                             : Stack back Trace
tr [:&lt;cnt&gt;] [branch] [{dreg|areg|preg|creg|mreg}]       : instruction TRace
vers                                                    : VERSion number
NEWS&gt;
</programlisting>
<para>
Other machines might print these messages differently,
but they should be mostly the same.
</para>
<para>
For the boot command, you can specify the following options:</para>
<table id="boot_options">
<tgroup cols="1">
<tbody>
<row>
 <entry><code>bo</code></entry>
 <entry>boot from default device (usually <code>sd0</code>)</entry>
</row>
<row>
 <entry><code>bo /1</code></entry>
 <entry>boot with <code>RB_ASKNAME</code>
 (i.e., ask for root device before mountroot)</entry>
</row>
<row>
 <entry><code>bo /2</code></entry>
 <entry>boot with <code>RB_SINGLE</code>
 (i.e., go to single-user mode)</entry>
</row>
<row>
 <entry><code>bo fh()</code></entry>
 <entry>boot from 1.44M floppy</entry>
</row>
<row>
 <entry><code>bo hd(1)</code></entry>
 <entry>boot from SCSI disk with ID 1</entry>
</row>
<row>
 <entry><code>bo /2 hd()/netbsd.0 </code></entry>
 <entry>boot <code>"netbsd.0"</code> on <code>sd0</code> in single-user mode</entry>
</row>
</tbody>
</tgroup>
</table>
</sect3>

<sect3 id="netboot">
<title>Can NetBSD/news68k boot via network?</title>
<para>
No, not yet.
</para>
<para>
The PROM monitor of news68k machines uses "remote disk (rd)"
for diskless boot, but it is only supported by NEWS-OS and
there is no documentation about it.
</para>
<para>
<code>rd_rpc.h</code> or <code>rd_srq.h</code> in NEWS-OS might be helpful,
but currently no one is working on it.
</para>
</sect3>
</sect2>

<sect2 id="hardware_questions">
<title>Hardware Questions</title>

<sect3 id="spec">
<title>What are the specs of my NEWS?</title>
<para>
See this
<ulink url="http://katsu.watanabe.name/doc/sonynews/model.html">
page of SONY NEWS specifications</ulink>.
It is written in Japanese, but still has lots of good information for
non-Japanese readers.
</para>
</sect3>

<sect3 id="memory">
<title>Which type of SIMM can be used for my NEWS?</title>
<para>
For news1600/1700 machines, 30pin 1M SIMMs with 9 chips
can be used to upgrade to 16M bytes.
SIMMs with 3 chips or SIMMs without parity cannot be used.
To upgrade from 16M to 32M, the optional memory board is required.
</para>
<para>
For news1400/1500 machines, 30pin 1M SIMMs with 8 or 9 chips can be used
(these machines don't use the parity bit).
SIMMs with 2 or 3 chips cannot be used.
</para>
</sect3>

<sect3 id="news1800">
<title>Is there any hope to support NWS-18x0 models?</title>
<para>
Unfortunately, there are many barriers to supporting news1800 machines.
news1800 models have dual 68030 CPUs. One is a main processor, and another is
an "I/O Processor". All devices (tty, ethernet, SCSI, etc.) are connected to
the IOP, but there is little information about how to handle them.
NEWS-OS provides a special module for the IOP called "MRX",
and it is loaded by the PROM at boot time from the root directory.
</para>
<para>
Some people have asked for NEWS device information from Sony,
and Sony once had planned to open their NEWS-OS sources.
But there were many problems with source license issues,
and the NEWS development division in Sony had already been dissolved, so
no one could resolve the issues officially.
</para>
</sect3>

<sect3 id="news800">
<title>How about NWS-8xx and NWS-7xx models?</title>
<para>
The one problem is that news800 models also use an I/O processor,
which is mentioned in the above entry.
Another problem is that news800 uses m68020 and Sony's own MMU, not Motorola's
m68851 MMU. news700 also has an original MMU like news800.
There is little information about it, either.
</para>
</sect3>
</sect2>

<sect2 id="other_info">
<title>Other sources of information</title>

<sect3 id="other_info_nbsd">
<title>Other sources of information from NetBSD.org</title>

<itemizedlist>
<listitem><para><ulink url="http://ftp.NetBSD.org/pub/NetBSD/NetBSD-&release.latest;/news68k/INSTALL.html">
    NetBSD/news68k &release.latest; install notes</ulink> - supported hardware and how to
    install.</para></listitem>
<listitem><para><ulink url="../../mailinglists/#port-news68k">port-news68k mail list</ulink>
    (<ulink url="http://mail-index.NetBSD.org/port-news68k/">archive</ulink>)
    - if you have any additional questions please subscribe.</para></listitem>
<listitem><para><ulink url="../newsmips/history.html">History of NEWS machines</ulink>
    - A brief history of machines running NetBSD/newsmips and NetBSD/news68k.</para></listitem>
<listitem><para><ulink url="../../docs/Hardware/Misc/serial.html">NetBSD Serial 
Port Primer</ulink></para></listitem>
<listitem><para><ulink url="../../docs/">General NetBSD Documentation</ulink>
    - for questions not specific to NetBSD/news68k.</para></listitem>
</itemizedlist>
</sect3>
</sect2>

</sect1>
</webpage>
