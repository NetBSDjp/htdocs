<?xml version="1.0"?>
<!DOCTYPE webpage
  PUBLIC "-//NetBSD//DTD Website-based NetBSD Extension//EN"
    "http://www.NetBSD.org/XML/htdocs/lang/share/xml/website-netbsd.dtd">

<webpage id="ports-next68k-faq">
<config param="desc" value="NetBSD FAQ"/>
<config param="cvstag" value="$NetBSD: faq.xml,v 1.3 2009/09/19 21:37:45 snj Exp $"/>
<config param="rcsdate" value="$Date: 2009/09/19 21:37:45 $"/>

<head>
  <title>NetBSD/next68k: Frequently Asked Questions</title>
</head>

<sect1 role="toc">
Here are some frequently asked questions (and frequently given
answers!) about NetBSD/next68k.

<sect2 id="Booting">
<title>Booting</title>

<sect3 id="rom-monitor">
<title>How do I get to the ROM Monitor or the debugger?</title>
<para>
You can get to the ROM monitor or break into the debugger (once the
NetBSD kernel is running) at any time by hitting both
<emphasis role="bold">COMMAND</emphasis> and the backquote (<code>`</code>)
key above the <code>7</code> on the numeric keypad.
</para>
</sect3>

<sect3 id="reset">
<title>How do I reset the system without pulling the plug?</title>
<para>
This is a hard reset -- it does not sync the filesystems first.  Press
the <emphasis>left</emphasis> <emphasis role="bold">COMMAND</emphasis>-<emphasis role="bold">ALTERNATE</emphasis>-<emphasis role="bold"><code>*</code></emphasis> keys (where 
the <code>*</code> key is to the right of the <code>/</code> on the numeric keypad).
</para>
</sect3>

<sect3 id="netboot-how">
<title>How do I netboot?</title>
<para>
This is now covered in the INSTALL notes.
There is also a section of the <ulink
url="../../docs/network/netboot/">Diskless NetBSD HOW-TO</ulink> devoted
to <ulink
url="../../docs/network/netboot/intro.next68k.html">netbooting
NetBSD/next68k</ulink>.  
</para>
</sect3>

<sect3 id="boot-disk1">
<title>How do I boot from a second hard drive or CD-ROM?</title>
<para>
The ROM Monitor <code>bsd()</code> command defaults to booting from the 
lowest SCSI ID drive which is usually the internal hard drive at ID 0.  
To boot from the next SCSI hard drive, you would use <code>bsd(1,0,0)</code> 
which will boot from the next highest SCSI ID drive -- <emphasis>not
necessarily SCSI ID 1</emphasis>.
</para>

<table border="1" cellpadding="5" id="bootcommandtable">
<tr><th>SCSI ID</th><th>boot command</th></tr>
<tr><td>0</td><td><code>bsd()</code></td></tr>
<tr><td>2</td><td><code>bsd(1,0,0)</code></td></tr>
<tr><td>6</td><td><code>bsd(2,0,0)</code></td></tr>
</table>

<para>
Only turbo NeXT systems can boot directly from a CD-ROM.  Non-turbo 
models need to load the bootloader from a floppy, SCSI hard drive, or 
over the network.
</para>
</sect3>

<sect3 id="monitor-commands">
<title>What can I do in the ROM Monitor?</title>
<para>
From the ROM Monitor prompt, type <code><emphasis role="bold">?</emphasis></code> to get a listing of 
the possible commands and <code><emphasis role="bold">p</emphasis></code> to configure the system.
Additionally, pressing the <code>Power</code> key will let you power down
the system.
</para>

<para>
To boot from a SCSI disk, type <code><emphasis role="bold">bsd()</emphasis></code>.  To boot from the 
ethernet, type <code><emphasis role="bold">ben()netbsd</emphasis></code>.
</para>
<para/>
<programlisting>
                        NeXT ROM Monitor 2.5 (v66)

CPU MC68040 25 MHz, memory 100 nS
Backplane slot #0
Ethernet address:  0:0:f:0:fb:90
Memory size 40 MB
NeXT&gt;<emphasis role="bold">?</emphasis>
NeXT ROM monitor commands:
        p  inspect/modify configuration parameters
        a [n]  open address register
        m  print memory configuration
        d [n]  open data register
        r [regname]  open processor register
        s [systemreg]  open system register
        e [lwb] [alist] [format]  examine memory location addr
        ec  print recorded system error codes
        ej [drive #]  eject optical disk (default = 0)
        eo  (same as above)
        ef [drive #]  eject floppy disk (default = 0)
        c  continue execution at last pc location
        b [device[(ctrl,unit,part)] [filename] [flags]]  boot from device
        S [fcode] open function code (address space)
        R [radix]  set input radix
Notes:
        [lwb] select long/word/byte length (default = long).
        [alist] is starting address or list of addresses to cyclically examine
        Examine command, eith no arguments, uses last [alist]
Copyright (c) 1988-1990 NeXT Inc

NeXT&gt;<emphasis role="bold">p</emphasis>
boot command: sd()? <emphasis role="bold">en()netbsd</emphasis>
DRAM tests:  yes? <emphasis role="bold">yes</emphasis>
perform power-on system test:  yes? <emphasis role="bold">yes</emphasis>
        sound out tests:  yes? <emphasis role="bold">yes</emphasis>
        SCSI tests:  yes? <emphasis role="bold">yes</emphasis>
        loop until keypress:  no?  <emphasis role="bold">no</emphasis>
        verbose test mode:  no?  <emphasis role="bold">yes</emphasis>
boot extended diagnostics:  no?  <emphasis role="bold">no</emphasis>
serial port A is alternate console:  no?  <emphasis role="bold">yes</emphasis>
allow any ROM command even if password protected:  no?  <emphasis role="bold">no</emphasis>
allow boot from any device even if password protected:  no?  <emphasis role="bold">no</emphasis>
allow optical drive #0 eject even if password protected:  yes?  <emphasis role="bold">yes</emphasis>
enable parity checking if parity memory is present:  no?  <emphasis role="bold">no</emphasis>
</programlisting>
</sect3>
</sect2>

<sect2 id="Hardware">
<title>Hardware</title>

<sect3 id="connections">
<title>How do the keyboard, mouse, and monitor connect to the NeXT hardware?</title>
<para>
For monochrome systems (NeXT Computer, NeXTcube, NeXTstation, NeXTcube 
Turbo, and NeXTstation Turbo) without a NeXTdimension board, a 19 pin 
cable connects the system to the mono MegaPixel Display.  The cable 
carries power for the monitor, video for the monitor, sound in and out, 
and the keyboard/mouse connector.  The keyboard plugs into the monitor, 
and the mouse plugs into the keyboard.
</para>

<para>
For color systems (NeXTstation Color and NeXTstation Color Turbo) a funky
"Y-Cable" connects the system to a soundbox and to a monitor.  The monitor
end of the cable is a 13W3 connector.  You can use any multisync monitor
(with the appropriate adapter) or a fixed frequency monitor supporting the
appropriate refresh rate.  NeXTstation Color supports 68 Hz refresh at
1280x1024.  NeXTstation Color Turbo supports 72 Hz refresh. The soundbox
provides the additional functionality of the mono MegaPixel Display (sound
in and out and keyboard/mouse connector).  The keyboard plugs into the 
soundbox, and the mouse plugs into the keyboard.
</para>

<para>
For cube systems with a NeXTdimension board, the refresh rate is 68 Hz.
If the cube is using a mono MegaPixel Display in addition to the 
NeXTdimension driven display, a simple 13W3 cable is used to connect the 
monitor to the NeXTdimension.  If the cube is not using a mono MegaPixel 
Display, you must use a "Y-cable" and a soundbox connected to the 
NeXTdimension board.
</para>
</sect3>

<sect3 id="adb">
<title>Differentiating ADB and non-ADB keyboards and mice</title>
<para>
Currently, only non-ADB keyboards and mice are supported.
</para>
<para>
Non-ADB keyboards use a mini-DIN connector with 5 pins.  Non-ADB keyboards
have a black power key between the brightness and volume keys.  Non-ADB
mice use a mini-DIN 8 connector.  Non-ADB mice are rectangular.  All NeXT
hardware supports these peripherals with the original mono MegaPixel
Display (N4000 or N4000A) or a non-ADB soundbox (serial number prefix 
ABN).  The ADB monitor and soundbox cables will work with non-ADB 
monitors and soundboxes.  Non-ADB monitor cables (part numbers 150 or 1532)
and soundbox cables (part number 2286) only work with non-ADB monitors 
and soundboxes.
</para>
<para>
ADB cables have mini-DIN 4 connectors. ADB NeXT keyboards have a flat
green power button.  ADB NeXT mice are rounded.  Apple Macintosh ADB
keyboards and mice should also work.  ADB peripherals are only supported
on NeXT hardware with ROM version v.74 (most turbo systems and some later 
non-turbo systems).  You also need a newer mono MegaPixel Display 
(N4000B) or ADB soundbox (serial number prefix ADD).  Additionally, you need
an ADB monitor cable (part numbers 4534 or 4535) or an ADB soundbox cable
(part number 4536).
</para>
<para>
Black Hole, Inc. has a 
<ulink url="http://blackholeinc.com/images/set1/nextadbnonadb.gif">graphic</ulink> 
depicting the differences.  ChannelU also has a
<ulink url="http://www.channelu.com/Turbo/NeXT/mousekeysound.html">webpage</ulink>
with pictures of these devices.
</para>
</sect3>

<sect3 id="no-monitor">
<title>How do I run my NeXT headless?</title>
<para>
From <ulink
url="http://www.peanuts.org/faq-serve/cache/189.html">The Peanut's Archive
FAQ</ulink>.  Also, see this 
<ulink url="http://mail-index.NetBSD.org/port-next68k/1998/06/30/0000.html">post</ulink>
describing how to build a better switch.
</para>

<para>
The procedure is to just touch pins 6 and GND on the DB-19 NeXT monitor
out with a 470 Ohm resistor (450 is the actual resistance, but 470 ohms
is more commonly found in resistors).  The touching with the resistor
will be momentary, you shouldn't try to set up a resistor so that it's
always touching.
</para>

<para>
Pin 6 is the power sense, and pins 13-19 (and the DB shell) are the
GND.  Just say "pin 19", it may be easier.
There's a pinout diagram of the DB-19 in the NeXT Users Reference
Manual, as well as <ulink url="#monitor-pinout">below</ulink>.
</para>

<para>
If you have an old Cube (serial number below AAK0016370),
the power supply needs to have more power
drawn from it than an 030 (and 040?) board uses to stay on.
So: On the DB-19, attach a Power Resistor (20 Ohm, at least 20 Watt)
between pins 12 and GND. (Pin 12 is -12V, pin 13 works well for GND).
Then just "momentarily touch" the 470 ohm resistor as described above,
and you're set. The 20 Ohm resistor draws enough to keep the power supply
happy - just don't touch it (*HOT!* ;-) 
</para>

<para>
To power off, type "halt -p" as root on the machine
(either through a terminal connected to port A, or over the
ethernet connection). 
</para>

<para>
Also, you need to use the NeXT keyboard to set up the <ulink 
url="#rom-monitor">ROM 
Monitor</ulink>. The important ones are: 
</para>

<para/>

<itemizedlist>
    <listitem>Wait until keypress? N</listitem>
    <listitem>Sound out tests? N</listitem>
    <listitem>Port A as alternate Console? Y
        (if you have one, it's nice)</listitem>
    <listitem>Verbose mode? N (this may need to be N to work)</listitem>
</itemizedlist>
</sect3>

<sect3 id="serial-console">
<title>How do I build a serial console cable?</title>
<para>
See the <ulink url="../../docs/Hardware/Misc/serial.html">NetBSD Serial 
Port Primer</ulink> for more information.
</para>
</sect3>

<sect3 id="monitor-pinout">
<title>What is the pinout of the monitor cable?</title>
<para>
The NeXT monitor cable is a very strange DB19 connector.  You won't
find any of these outside for special order shops. The cable, as seen
from the back of the machine:
</para>

<programlisting>
        10                  1
      _________________________
      \  o o o o o o o o o o  /
       \  o o o o o o o o o  /
        ---------------------
        19                11 
</programlisting>

<orderedlist>
	<listitem> +12V</listitem>
	<listitem> -12V</listitem>
	<listitem> MON CLK</listitem>
	<listitem> MON DATA OUT</listitem>
	<listitem> MON DATA IN</listitem>
	<listitem> MON PWR SWITCH</listitem>
	<listitem> NC</listitem>
	<listitem> VSYNC</listitem>
	<listitem> HSYNC</listitem>
	<listitem> VIDEO</listitem>
	<listitem> +12V</listitem>
	<listitem> -12V</listitem>
	<listitem> GND</listitem>
	<listitem> GND</listitem>
	<listitem> GND</listitem>
	<listitem> GND</listitem>
	<listitem> GND</listitem>
	<listitem> GND</listitem>
	<listitem> GND</listitem>
</orderedlist>

</sect3>
</sect2>


<sect2 id="other-sources">
<title>Other sources of information</title>

  <sect3 id="The-peanuts.org-NEXTSTEP/OpenStep-FAQ">
  <title><ulink url="http://www.peanuts.org/peanuts/GeneralData/Documents/faq/NeXTFAQ-html/NeXTFAQ.txt">
    The peanuts.org NEXTSTEP/OpenStep FAQ</ulink></title>
    (see section 5 on black hardware)
  </sect3>
  <sect3 id="NeXT-Hardware-FAQs">
  <title><ulink url="http://www.lrz-muenchen.de/~heller/NeXT/NeXT.html">NeXT
    Hardware FAQs</ulink></title>
  </sect3>
  <sect3 id="about-NetBSD's-platform-independent-workstation-console-driver">
  <title><ulink url="../../docs/guide/en/chap-cons.html#chap-cons-wscons">The wscons documentation</ulink>
  </title>
  About NetBSD's platform-independent workstation console driver.
  </sect3>
  <sect3 id="NetBSD-HOW-TO">
  <title><ulink url="../../docs/network/netboot/">Diskless
      NetBSD HOW-TO</ulink></title>
  </sect3>
  <sect3 id="NetBSD-Serial-Port-Primer">
  <title><ulink url="../../docs/Hardware/Misc/serial.html">NetBSD
    Serial Port Primer</ulink></title>
  </sect3>
</sect2>

<parentsec url="./" text="NetBSD/next68k Port Page" />

</sect1>
</webpage>
