<?xml version="1.0"?>
<!DOCTYPE webpage
 PUBLIC "-//NetBSD//DTD Website-based NetBSD Extension//EN"
        "http://www.NetBSD.org/XML/htdocs/lang/share/xml/website-netbsd.dtd">

<webpage id="ports-hpcmips-howto-use">
<config param="desc" value="NetBSD/hpcmips User How-To page"/>
<config param="cvstag" value="$NetBSD: howto-use.xml,v 1.1 2007/06/09 13:32:14 dsieger Exp $"/>
<config param="rcsdate" value="$Date: 2007/06/09 13:32:14 $"/>
<head>
<!-- Copyright (c) 2000-2003
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->

<title>NetBSD/hpcmips User How-To page</title>
</head>


<sect1 role="toc">
<sect2 id="about1">
<sect3 id="about">
<title>About this page</title>
<para>
This page contains information that current and potential users of
NetBSD/hpcmips can use to help them set up and maintain their
systems.
</para>
</sect3>
</sect2>


<sect2>
<title>Getting started with NetBSD/hpcmips</title>

<sect3 id="overview-start">
<title>Overview of how to start NetBSD/hpcmips</title>
<para>
You need at least 2 files to start NetBSD/hpcmips:
</para>

<variablelist>
  <varlistentry>
    <term><filename>pbsdboot.exe</filename></term>
    <listitem>bootloader runs on WindowsCE environment.</listitem>
  </varlistentry>
  <varlistentry>
    <term>a netbsd kernel</term>
  </varlistentry>
</variablelist>

<para>
On pbsdboot pull-down menu, select hardware type and path to kernel.
pbsdboot passes hardware information (framebuffer information, etc.) to kernel.
The kernel will use all the Windows CE memory as RAM,
so you MUST backup all of your data stored in CE memory before booting.
Click Boot to load the kernel.
</para>
</sect3>

<sect3 id="overview-filesystem">
<title>filesystem overview</title>
<para>
You have a choice of filesystems:
</para>

<variablelist>
  <varlistentry>
  <term>filesystem on Compact Flash Cards or ATA Cards</term>
  <listitem>need a DOS partition for pbsdboot.exe and a NetBSD partition</listitem>
  </varlistentry>
  <varlistentry>
    <term>filesystem on SCSI/IDE disk</term>
    <listitem>
      NetBSD/hpcmips supports PCMCIA SCSI Card such as SlimSCSI, so you
      can make your file system on SCSI disks. Recommended for
      developers.
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>filesystem on NFS Server</term>
    <listitem>
      <para>During boot:</para>
      <para>NetBSD/hpcmips finds pcmcia Ethernet Card</para>
      <para>gets an IP address via dhcp server</para>
      <para>finds NFS server </para>
      <para>mounts / partition from NFS server</para>
    </listitem>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="cf-recomen">
<title>Do I need to purchase a CF or ATA card? If so - got any recommendations?</title>
<variablelist>
  <varlistentry>
    <term>for typical users we recommend 128M CF.</term>
    <listitem>base+kern+etc+comp works fine</listitem>
  </varlistentry>
  <varlistentry>
    <term>80M-96M CF</term>
    <listitem>base+kern+etc - basic NetBSD system available in your pocket.</listitem>
  </varlistentry>
  <varlistentry>
    <term>less than 64M CF</term>
    <listitem>base+kern+etc  - if you delete large unused files</listitem>
  </varlistentry>
  <varlistentry>
    <term>15M CF</term>
    <listitem>north pole for living - for those who like a challenge</listitem>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="prep-hwsupport">
<title>Finding out if your system is supported by NetBSD/hpcmips</title>
<para>
Check <ulink url="../hpcmips/#supported">Supported Machines</ulink>
listing.
</para>
</sect3>


<sect3 id="prep-cardsupport">
<title>Supported CF and PCMCIA cards</title>
<variablelist>
  <varlistentry>
    <term>NetBSD <ulink url="http://projects.NetBSD.org/cgi-bin/hw.cgi">Supported
      hardware database</ulink> is available.  Select PCMCIA and query/add
      database.  NetBSD users build this database.</term>
  </varlistentry>
  <varlistentry>
    <term>See NetBSD <ulink url="../../Hardware/pcmcia.html">Machine-independent
      PCMCIA drivers</ulink>.</term>
  </varlistentry>
  <varlistentry>
    <term>Compact Flash Storage:</term>
    <listitem>
      <para>over 48M CF SanDisk</para>
      <para>note:on z50 Extreme Memory Compact Flash EM-CF/128/P (PQI FLASH DISK
	1201N)sometimes chokes and hangs the z50, especially under heavy
	"disk" load.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>PCMCIA Devices cards:</term>
    <listitem>
      <para>NE2000 compatible corega Ether PCC-T</para>
      <para>3com 3C589*</para>
      <para>Lucent/Agere WaveLAN/Orinoco wireless NIC</para>
      <para>Socket Communications, Inc. Standard LP-E CF+ (EA2900-117)</para>
      <para>Xircom CF Ethernet card</para>
      <para><ulink url="http://www.tdk.co.jp/tjbda01/bda11100.htm">TDK LAC-CF010 CF
	Ethernet Card </ulink></para>
      <para>3com 3C1 : gets MAC address via ep driver, but does not transmit any
	packets. Broken.</para>
      <para>NTT DoCoMo Paldio 611S (Japan:PHS include CF Modem I/F)</para>
      <para><ulink url="http://www.linkease.com.tw/thing/dn_boy.htm">DN-boy</ulink></para>
      <para><ulink url="http://www.planex.co.jp/product/drive/rxindex.htm">eXtreme
	drive</ulink></para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>Adaptec SlimSCSI 1460 (APA-1460)</term>
  </varlistentry>
  <varlistentry>
    <term>Apricorn EZ-GIG Expansion Card</term>
  </varlistentry>
  <varlistentry>
    <term>Callunacard CT260T2</term>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="prep-get">
<title>Getting the NetBSD/hpcmips distribution</title>
<variablelist>
  <varlistentry>
    <term>check <ulink
    url="ftp://ftp.NetBSD.org/pub/NetBSD/NetBSD-1.6.1/hpcmips/">ftp://ftp.NetBSD.org/pub/NetBSD/NetBSD-1.6.1/hpcmips/</ulink></term>
    <listitem>
      <para> binary/sets:NetBSD/hpcmips binary such as base.tgz, comp.tgz.. </para>
      <para>installation:pbsdboot.exe.gz and netbsd.gz</para>
      <para>source:source files</para>
      <para>place pbsdboot.exe and netbsd on your CF card and run pbsdboot.exe to
	start netbsd installation kernel (includes sysinst). You can
      boot netbsd.gz without unzipping it if space is tight.</para>
    </listitem>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="prep-getbooter">
<title>Getting the NetBSD/hpcmips boot loader (pbsdboot.exe)</title>
<para>
Download from <ulink
url="ftp://ftp.NetBSD.org/pub/NetBSD/arch/hpcmips/pocketbsd/pbsdboot/">pbsdboot
download directory</ulink>.
Pbsdboot.exe is compiled for WindowsCE 2.00.
Use Pbsdboot1.exe for Windows CE 1.01.
Pbsdboot.exe is updated to use color maps for 8 bit frame
buffer machines. Now we can use 256 colors, though we
don't know about details of video controller chip.
(We actually do not know about the video chips at all.)
</para>

<para>Because Windows CE 1.0 does not support color map at all,
the pbsdboot can not support both CE 1.0 and 2.0 with single
binary. Thus pbsdboot.exe is compiled for CE 2.0 or later. You
should use pbsdboot1.exe for CE 1.0.
</para>
</sect3>


<sect3 id="prep-kernel">
<title>Getting the NetBSD/hpcmips kernel </title>
<variablelist>
  <varlistentry>
    <term>pbsdboot hook up NetBSD/hpcmips kernel file.</term>
    <listitem>
      <para>GENERIC kernel is <ulink url="ftp://ftp.NetBSD.org/pub/NetBSD/NetBSD-1.6.1/hpcmips/binary/kernel/">here</ulink>. </para>
      <para><ulink url="ftp://ftp.NetBSD.org/pub/NetBSD/NetBSD-1.6.1/hpcmips/binary/kernel/">kernel image for TX3912 machine is here</ulink>.</para>
      <para><ulink
      url="ftp://ftp.NetBSD.org/pub/NetBSD/NetBSD-1.5.3/hpcmips/binary/kernel/">kernel image for TX3922 machine is here</ulink>.</para>
    </listitem>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="ms_partition">
<title>Accessing Microsoft partitions</title>
<para>
To access your MS-DOS WinCE partition, read <ulink url="../i386/faq.html#ms_partition">Accessing Microsoft partitions</ulink>.
</para>
</sect3>


<sect3 id="prep-cfpart">
<title>Preparing a Compact Flash card with a NetBSD partition</title>
<para>
<ulink url="install.txt">Creating a file system on Compact Flash</ulink>.  
</para>
</sect3>


<sect3 id="prep-cfnopart">
<title>Preparing a Compact Flash card without a NetBSD partition</title>
<para>
TODO
</para>
</sect3>


<sect3 id="prep-support">
<title>Getting support from mailing lists</title>
<itemizedlist>
  <listitem><ulink url="../../MailingLists/#port-hpcmips">NetBSD/hpcmips mailing list
      (English language)</ulink></listitem>
  <listitem><ulink url="http://www.jp.NetBSD.org/ja/JP/ml.html#port-hpcmips-ja">NetBSD/hpcmips
      mailing list (Japanese language)</ulink></listitem>
</itemizedlist>
</sect3>


<sect3 id="key-map">
<title>keyboard mapping control</title>
<variablelist>
  <varlistentry>
    <term>Swap CTRLCAPS </term>
    <listitem>wsconsctl -w encoding=jp.swapctrlcaps</listitem>
  </varlistentry>
  <varlistentry>
    <term>Muhenkan key to Function 10 (for MGL2 switch window)</term>
    <listitem>wsconsctl -w map+="keysym Muhenkan = F10"</listitem>
  </varlistentry>
  <varlistentry>
    <term>Henkan key to Function 9 (for MGL2 change window)</term>
    <listitem>wsconsctl -w map+="keysym Henkan = F9"</listitem>
  </varlistentry>
</variablelist>
</sect3>
</sect2>

<sect2>
<title>pbsdboot.exe: the NetBSD/hpcmips boot loader</title>

<sect3 id="booter-background">
<title>What is the NetBSD/hpcmips boot loader (pbsdboot.exe)?</title>
<para>
TODO
</para>
</sect3>

<sect3 id="booter-options">
<title>NetBSD/hpcmips boot loader options</title>
<variablelist>
  <varlistentry>
    <term>Boot loader from Windows CE </term>
    <listitem>Boot loader from Windows CE environment called "pbsdboot.exe" is
	available from <ulink
	url="ftp://ftp.NetBSD.org/pub/NetBSD/arch/hpcmips/pocketbsd/pbsdboot/">ftp.NetBSD.org</ulink>.</listitem>
  </varlistentry>
  <varlistentry>
    <term>Boot loader Options</term>
    <listitem>
    <para><emphasis role="bold">-d</emphasis>      break into the kernel debugger</para>
    <para><emphasis role="bold">-m</emphasis>      use miniroot in memory</para>
    <para><emphasis role="bold">-s</emphasis>      single user mode</para>
    <para><emphasis role="bold">-h</emphasis>      use serial console</para>
    <para><emphasis role="bold">-a</emphasis>      ask for name:kernel ask root device (such as wd0a),
	dump device (such as wd0b), filesystem (such as ffs).  To change root
	device on Slim SCSI card/IDE PCMCIA card, use this option and set root
	device to sd0/wd.</para>
    <para><emphasis role="bold">-b=DEV</emphasis>  change boot device to DEV(wd0, sd0, nfs etc.)</para>
    </listitem>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="booter-console">
<title>Booting the kernel with a serial console</title>
<variablelist>
  <varlistentry>
    <listitem>On pbsdboot, check &amp; set these parameter:</listitem>
  </varlistentry>
  <varlistentry>
    <listitem>Options: h</listitem>
  </varlistentry>
  <varlistentry>
    <listitem>Serialport on</listitem>
  </varlistentry>
  <varlistentry>
    <listitem>Connect your terminal with 9600bps, 8bit, non-parity, VT100 mode</listitem>
  </varlistentry>
  <varlistentry>
    <term>pbsdboot frame buffer type setting</term>
    <listitem>
      <para>D8_FF : white type on black screen </para>
      <para>D8_00 : black type on white screen</para>
    </listitem>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="booter-quickboot">
<title>Automatically booting into NetBSD</title>
<para>
To skip touch panel calibration, power on with shift+power key.
Some systems will automatically run <filename>\Storage
Card\AutoRun\<replaceable>XXXXXX</replaceable>\Autorun.exe</filename> 
where <replaceable>XXXXXX</replaceable> is the CPU family.  However,
that isn't true for all systems. Also the exact path is from memory
and may be slightly incorrect.
</para>

<variablelist>
  <varlistentry>
    <term>CASIO Cassiopeia:</term>
    <listitem> <filename>\CE\R4100\AutoRun.exe</filename> </listitem>
  </varlistentry>
</variablelist>
</sect3>


<sect3 id="booter-everex-quickboot">
<title>One-button boot on the Everex Freestyle</title>
<para>
Everex Freestyle systems can be configured to start the boot loader
at the press of a button!
To set up one-button boot loader invocation, place a copy of
<code>pbsdboot.exe</code> in the root directory of an FAT file system on
a compact flash, with the name <code>voiceapp.exe</code>.
</para>

<para>
To boot, just push the Freestyle "Record" button.
PHILIPS Nino312 can use this method.
</para>
</sect3>

</sect2>
</sect1>

<parentsec url="./" text="NetBSD/hpcmips Port Page"/>
</webpage>

