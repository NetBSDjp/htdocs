<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Website XSL Stylesheet V2.6.0">
<link rel="home" href="../../../." title="Welcome to The NetBSD Project: Of course it runs NetBSD.">
<link rel="up" href="../../../ja/ports/macppc/." title="NetBSD/macppc">
<link rel="previous" href="../../../ja/ports/macppc/nvedit.html" title="NetBSD/macppc nvedit HOW-TO">
<link rel="next" href="../../../ja/ports/macppc/x11.html" title="NetBSD/macppc X11 FAQ">
<link rel="first" href="../../../ja/ports/macppc/faq.html" title="NetBSD/macppc よくある質問">
<link rel="last" href="../../../ja/ports/macppc/oldfaq.html" title="NetBSD/macppc 過去のよくある質問">
<link rel="stylesheet" href="../../../global.css" type="text/css">



<title>NetBSD/macppc パーティショニング HOW-TO</title>
</head>
<body class="website"><div class="webpage">
<a name="ja-ports-macppc-partitioning"></a><div id="top"><a href="#mainContent" class="doNotDisplay doNotPrint">本文へ飛ぶ。</a></div>
<div id="header">
<div class="topNavigation">
<span>» </span><a href="../../../docs/guide/en/">
	  ガイド</a> |
	<a href="http://man.NetBSD.org/">マニュアルページ</a> |
	<a href="../../../ja/mailinglists/">
	  メーリングリスト</a>と
	<a href="http://mail-index.NetBSD.org/">記事</a> |
	<a href="http://cvsweb.NetBSD.org/">CVS リポジトリー</a> |
	バグの<a href="http://www.NetBSD.org/cgi-bin/sendpr.cgi?gndb=netbsd">報告</a>
	と
	<a href="../../../ja/support/query-pr.html">
	 照会</a> |
	<a href="../../../ja/docs/software/packages.html">
	  ソフトウェアパッケージ
	</a>
</div>
<div class="centralHeader">
<a href="../../../ja/"><img alt='NetBSD プロジェクト "Of course it runs NetBSD"' width="506" height="90" src="../../../images/NetBSD-headerlogo.png"></a><div class="headerTools"><div id="headerSearch">
<div id="header-cse-search-form" style="width: 24%;">Google custom search</div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script><script type="text/javascript"> 
                  google.load('search', '1', {language : 'en'});
                  google.setOnLoadCallback(function() {
                    var header_customSearchControl = new google.search.CustomSearchControl('006277936787196004968:mbdhrauy1wm');
                    header_customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
                    var header_options = new google.search.DrawOptions();
                    header_options.enableSearchboxOnly("http://google.com/cse?cx=006277936787196004968:mbdhrauy1wm");    
                    header_customSearchControl.draw('header-cse-search-form', header_options);
                  }, true);
                </script><link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css">
</div></div>
</div>
<div class="navBar">
<span class="doNotDisplay">
	  案内:
	</span><a href="../../../ja/">
	  ホーム</a> | 
	<a href="../../../ja/about/">
	  概要</a> | 
	<a href="../../../ja/gallery/">
	  展示室</a> | 
	<a href="../../../ja/releases/">
	  ダウンロード</a> | 
	<a href="../../../ja/docs/">
	  ドキュメンテーション</a> | 
	<a href="../../../ja/support/">
	  サポート</a> | 
	<a href="../../../ja/community/">
	  コミュニティー</a> | 
	<a href="../../../ja/ports/">
	  機種</a>
</div>
</div>
<div id="content"><div class="fullWidth"><div class="rowOfBoxes">
<h1>NetBSD/macppc パーティショニング HOW-TO</h1>
<div class="sect1" title="文書の概要">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="preface"></a>文書の概要</h2></div></div></div>
  

  <p>
    この文書は、 4 個の部分に分かれています:
  </p>

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><a class="ulink" href="#intro" target="_top">はじめに (パーティションについて理解する)</a></li>
<li class="listitem">ディスクのパーティショニング
    <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<a class="ulink" href="#drive-setup" target="_top">Drive Setup を使ったパーティショニング</a> (Mac OS 9)</li>
<li class="listitem">
<a class="ulink" href="#disk-utility" target="_top">Disk Utility を使ったパーティショニング</a> (Mac OS X)</li>
<li class="listitem">
<a class="ulink" href="#pdisk" target="_top"><code class="code">pdisk</code> と <code class="code">newfs</code>
      を使ったパーティショニング</a> (Mac OS 9, Mac OS X, Darwin, NetBSD,  Linux)</li>
</ul></div>
    </li>
<li class="listitem"><a class="ulink" href="#msdos" target="_top">共有 MS-DOS ファイルシステムの作成</a></li>
<li class="listitem"><a class="ulink" href="#nomenclature" target="_top">パーティション命名規則</a></li>
</ol></div>

  <p>
    <span class="emphasis"><em>注意: Linux の <code class="code">pdisk</code> コマンドは、 NetBSD/macppc 用のフラグを
    適切に設定しません。ディスクが Linux の <code class="code">pdisk</code> を使って
    パーティション分割済みの場合は、 NetBSD の <code class="code"><a class="ulink" href="#pdisk" target="_top">pdisk</a></code> を使い、パーティションを消してから
    NetBSD のルートおよびスワップパーティションを作り直す必要があります。</em></span>
  </p>
</div>
<div class="sect1" title="はじめに (パーティションについて理解する)">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="intro"></a>はじめに (パーティションについて理解する)</h2></div></div></div>
  

  <p>
    この文書では、 NetBSD/macppc と Mac OS を使うためにディスクを分割する
    方法を詳しく説明します。お使いのマシンのあるディスクから
    あるオペレーティングシステムをブートできるかどうかは、そのマシンの
    <a class="ulink" href="faq.html#ofw-version" target="_top">Open Firmware</a> のバージョンに依ります。
    全体としての目標は、 Open Firmware が理解することのでき (さらに、
    そこからブートでき) 、かつ、 NetBSD カーネルが理解することができて
    ルートパーティションとして使うことができるような Apple Partition Map を作成することです。
  </p>

  <p>
    4 個のディスク分割用のツールがあります: Apple の Drive Setup
    (Mac OS 9)、 Apple の Disk Utility (Mac OS X)、 NetBSD の <a href="http://netbsd.gw.com/cgi-bin/man-cgi?pdisk+8+NetBSD-5.1+i386">pdisk(8)</a>
    (全 OS)、そして、 NetBSD の <a href="http://netbsd.gw.com/cgi-bin/man-cgi?disklabel+8+NetBSD-5.1+i386">disklabel(8)</a> (NetBSD/macppc のみ) です。
    最初の 2 個のツール (Drive Setup と Disk Utility) は Apple が
    Mac OS と共に配布しており、ブート可能な Mac OS インストール CD
    に含まれています。これらを使って、
    ディスクのパーティション分割、ファイルシステム作成、 Mac OS ブートローダー
    (Mac OS 用語ではディスクドライバー) のインストールをすることができます。
  </p>

  <p>
    <code class="code">pdisk</code> プログラムはコマンドラインプログラムで、ほとんどの
    unix-like システム (特に、 PowerPC ベースの Macintosh や互換機で動くシステム)
    上でコンパイルおよび実行することができます。このプログラムでできることは、
    ディスクのパーティション分割だけです─ブートローダーのインストールや
    ファイルシステムの作成をすることはできません。
  </p>

  <p>
    NetBSD の <code class="code">disklabel</code> は、 NetBSD 方式の
    <a href="http://netbsd.gw.com/cgi-bin/man-cgi?disklabel+5+NetBSD-5.1+i386">disklabel(5)</a> を作成します。上述の 3 種のツールとは異なり、
    これでできることは、疑似的な Apple Partition Map の作成だけです (それゆえ、
    この <code class="code">disklabel</code> を使って Mac OS がブート可能なディスクを作ることはできません)。
    ですが、これで十分です。 Open Firmware の一部のバージョンでは、
    ブートローダーをインストールするのに <code class="code">disklabel</code> を使う必要があります。
    なお、 <code class="code">disklabel</code> は NetBSD インストーラーのパーティションツールとしても使われています。
  </p>

  <p>
    以下の表で、 "yes" はそのディスクがブート可能であることを、 "mount only" は OS
    がディスク上のパーティションのマウントは可能だがそこからのブートはできないことを、
    "no" は OS がパーティションのマウントもディスクからのブートもできないことを意味します。
  </p>

  <p>
    <span class="bold"><strong>Open Firmware 1.0.5 または 2.0.x:</strong></span>
  </p>

  <div class="informaltable">
  <table border="1">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td><span class="bold"><strong>OS</strong></span></td>
<td><span class="bold"><strong>Drive Setup</strong></span></td>
<td><span class="bold"><strong>Disk Utility</strong></span></td>
<td><code class="code"><span class="bold"><strong>pdisk</strong></span></code></td>
<td><code class="code"><span class="bold"><strong>disklabel</strong></span></code></td>
</tr>
<tr>
<td><span class="bold"><strong>NetBSD</strong></span></td>
<td>mount only</td>
<td>mount only</td>
<td>mount only</td>
<td>yes</td>
</tr>
<tr>
<td><span class="bold"><strong>Mac OS 9</strong></span></td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td><span class="bold"><strong>Mac OS X および Darwin</strong></span></td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td><span class="bold"><strong>Linux</strong></span></td>
<td>yes</td>
<td>yes?</td>
<td>yes</td>
<td>no</td>
</tr>
</tbody>
</table>
</div>
<p><span class="bold"><strong>Open Firmware 2.4 または 3:</strong></span></p>
<div class="informaltable">
  <table border="1">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td><span class="bold"><strong>OS</strong></span></td>
<td><span class="bold"><strong>Drive Setup</strong></span></td>
<td><span class="bold"><strong>Disk Utility</strong></span></td>
<td><code class="code"><span class="bold"><strong>pdisk</strong></span></code></td>
<td><code class="code"><span class="bold"><strong>disklabel</strong></span></code></td>
</tr>
<tr>
<td><span class="bold"><strong>NetBSD</strong></span></td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td><span class="bold"><strong>Mac OS 9</strong></span></td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td><span class="bold"><strong>Mac OS X および Darwin</strong></span></td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td><span class="bold"><strong>Linux</strong></span></td>
<td>yes</td>
<td>yes?</td>
<td>yes</td>
<td>no</td>
</tr>
</tbody>
</table>
</div>

<p>
  Apple パーティションマップは、パーティション情報を、番号の付けられたリスト
  (通常はディスク上の場所の順序) の形で保持しています。最初のブートローダーが納まる
  パーティション "ゼロ" は Open Firmware 1.0.5 または 2.0.x の機種向けのものです。
  パーティションマップ自体はパーティション番号 1 です。 Mac OS 9 の入ったディスクでは、
  通常、パーティション 2 から 8 まではドライバー用に予約されています。
  ユーザーが定義したパーティション (HFS、 HFS+、 UFS、 NetBSD などなど) は、
  パーティション 9 (Mac OS 9 のディスク) または 2 (Mac OS 9 のないディスク) からになります。
</p>

<p>
  マシンを NetBSD/macppc でブートさせるためのコマンドを決める際に、
  Open Firmware は Apple パーティションマップの番号を使うことを留意しておいてください。
  <a class="ulink" href="#pdisk" target="_top"><code class="code">pdisk</code></a> を使うと、 Apple パーティションマップを、
  (どの方法で作られたパーティションマップであっても) プリントアウトできます。
</p>

<p>
  若干混乱を招いていますが、 NetBSD/macppc は、文字 'a' から 'h' という
  独自のパーティション命名規則を使っています。ルートパーティションは、
  (Apple パーティションマップの位置とは関係なく) パーティション 'a' になります。
  スワップパーティションはパーティション 'b' です。パーティション 'c' は、
  ディスク全体を表します。 '/usr' パーティションは (もしあれば) パーティション 'g' です。
  それ以外のパーティションは、残りの文字が充てられます。
</p>

<p>
  もっと筋道だった説明は、後述の
  <a class="ulink" href="#nomenclature" target="_top">パーティション命名規則</a>の節を見てください。
</p>

<p>
  あなたが取り扱う可能性のあるファイルシステムは、実に多岐にわたります。
  簡単に説明しますと、 HFS は 80 年代から使われてきた Apple 旧来のファイルシステムです。
  HFS+ (「拡張」ファイルシステムともいう) は HFS の拡張版で、より大きな容量の
  ファイル (やファイルシステム) を使うことができ、 unix 的なファイル所有者や
  パーミッションを持つことができます。 HFS+ は、 Mac OS &gt;  8.1 (Mac OS X を含む)
  での推奨ファイルシステム型です。 UFS は、古き良き BSD FFS の、 NeXT 由来の
  Apple 版です。 MS-DOS (FAT ともいう) は、 MS-DOS/Windows プラットフォームで
  標準化されているファイルシステムです。 BSD FFS は、 80 年代からほとんどの
  BSD unix-like OS (NetBSD も含む) で使われてきた標準的なファイルシステムです。
  ext2fs は linux で最も一般的なファイルシステムです。
</p>

<p>
  他の OS と共有するパーティションを用意するかどうか、
  検討したい方もいるでしょう。もっとも互換性の高いフォーマットは MS-DOS FAT
  ですが、機能が足りません (パーミッションや、よい修復ツールなどです)。
  残念ながら NetBSD は Macintosh HFS および HFS+ システムをネイティブでは
  まだサポートしていません。 NetBSD-current では Apple の UFS を完全にサポートしています。
  以下に早見表を掲げます:
</p>

<div class="informaltable">
  <table border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td>フォーマット</td>
<td>Mac OS 8.1-9.x</td>
<td>Mac OS X および Darwin</td>
<td>NetBSD</td>
<td>Linux</td>
</tr>
<tr>
<td>Apple HFS</td>
<td>yes</td>
<td>yes</td>
<td>
<a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/packages/pkgsrc/sysutils/hfsutils/README.html" target="_top">hfstools</a>
 </td>
<td>yes(1)</td>
</tr>
<tr>
<td>Apple HFS+</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>read-only(2)</td>
</tr>
<tr>
<td>Apple UFS</td>
<td>no</td>
<td>yes</td>
<td>-current</td>
<td>read-only</td>
</tr>
<tr>
<td>MS-DOS FAT</td>
<td>File Exchange</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>BSD FFS</td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>read-only</td>
</tr>
<tr>
<td>Linux ext2fs</td>
<td>no</td>
<td>yes(3)</td>
<td>yes</td>
<td>yes</td>
</tr>
</tbody>
</table>
</div>

<p>1 - 安定している
<a class="ulink" href="http://www.mars.org/home/rob/proj/hfs/" target="_top">hfsutils</a>、 または
実験的なカーネルサポートを使用します。
</p>
<p>2 - 実験的な
<a class="ulink" href="http://ftp.penguinppc.org/projects/hfsplus/" target="_top">hfsplus</a> utils、
または実験的な
<a class="ulink" href="http://sourceforge.net/projects/linux-hfsplus" target="_top">linux-hfsplus</a>
カーネルモジュールを使用します。</p>
<p>3 - 非常に実験的な
<a class="ulink" href="http://sourceforge.net/projects/ext2fsx/" target="_top">Ext2 Filesystem</a>
カーネル拡張を使用します。</p>

<p>
  Mac OS 9 と共有可能なパーティションを作りたければ、 HFS
  パーティションを作り、あとで MS-DOS フォーマットへ変換するのがよいです。
  ディスクを分割してから<a class="ulink" href="#msdos" target="_top">共有 MS-DOS ファイルシステムの作成</a>
  を見てください。
</p>

<p>
  Classic Mac OS のことは気にしないのであれば、おそらく UFS
  が最良の選択肢です。 Mac OS X か Darwin で UFS パーティションを作り、
  -current NetBSD を使うようにするだけです。 UFS は次の NetBSD
  メジャーリリースではサポートされる予定です (つまり 1.6.x 枝ではサポートされません)。
</p>

<p>
  パーティショニングは、ドライブの内容を消去しますので、
  分割しようとするディスクをすべてバックアップしてください。
  あなたが使おうとしているツールの説明に従ってください。
</p>

<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<a class="ulink" href="#drive-setup" target="_top">Drive Setup を使ったパーティショニング</a> (Mac OS 9)</li>
<li class="listitem">
<a class="ulink" href="#disk-utility" target="_top">Disk Utility を使ったパーティショニング</a> (Mac OS X)</li>
<li class="listitem">
<a class="ulink" href="#pdisk" target="_top"><code class="code">pdisk</code> と <code class="code">newfs</code>
 を使ったパーティショニング</a> (Mac OS 9, Mac OS X, Darwin, NetBSD,  Linux)</li>
<li class="listitem">
<code class="code"><a href="http://netbsd.gw.com/cgi-bin/man-cgi?disklabel+8+NetBSD-5.1+i386">disklabel(8)</a></code> は、 <a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/NetBSD-5.1/macppc/INSTALL.html" target="_top">
 NetBSD 5.1 インストールノート</a>のやり方に従うと、 <code class="code">sysinst</code>
 インストーラーが作成します。</li>
</ul></div>
</div>
<div class="sect1" title="Drive Setup を使ったパーティショニング (Mac OS 9)">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="drive-setup"></a>Drive Setup を使ったパーティショニング (Mac OS 9)</h2></div></div></div>
  

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p>
	Drive Setup はバージョン 1.8.1 以降が必要です。このバージョンは
	Mac OS 9.0 に附属のバージョンです。バージョンがわからない場合は、
	(訳註: Finder で) Drive Setup を選び、 <code class="code">File</code> メニューから
	<code class="code">Get Info</code> します。
      </p>

      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/drive-setup.gif" width="354" alt="drive setup"></span>

      <p>
	古いバージョンの Mac OS をお使いの場合、
	<a class="ulink" href="http://docs.info.apple.com/article.html?artnum=60791" target="_top">Mac OS 
	9.0.4</a> (12.2 MB)、
	<a class="ulink" href="http://docs.info.apple.com/article.html?artnum=75103" target="_top">Mac OS 9.1</a>
	 (71 MB)、
	<a class="ulink" href="http://docs.info.apple.com/article.html?artnum=120030" target="_top">Mac OS
	9.2.1</a> (82 MB)、または
	<a class="ulink" href="http://docs.info.apple.com/article.html?artnum=75186" target="_top">Mac OS 
	9.2.2</a> (21.3 MB) アップデートをダウンロードできます。
	これらには、使えるバージョンの Drive Setup が含まれています。
	これらは大きな Mac OS アップデートであり、 500 KB の Drive Setup
	アプリケーションの入手のために、メガバイト級のディスクイメージを
	ダウンロードする必要があることに注意してください。
	Apple は、最近のバージョンの Drive Setup を単体では提供していません。
      </p>

      <p>
	また、
	<a class="ulink" href="http://www.opensource.apple.com/projects/darwin/1.4/release.html" target="_top">Darwin 
	インストーラー</a>にも、使えるバージョンの Drive Setup が含まれます。
	オペレーティングシステム一式を含んでいるため、 Darwin も巨大 (120.7 MB)
	です。
      </p>

      <p>
	ディスクイメージを開き、 Drive Setup をハードドライブ、 RAM ディスク、
	Zip ディスク、フロッピーディスク等にコピーします (Drive Setup
	はディスクイメージからは実行できません) 。
      </p>
    </li>
<li class="listitem">
      <p>
	Drive Setup を最初に走らせると、次のような画面が出ます。
	ここで、再分割しようとするドライブを選びます。
      </p>

      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/drive-selection.gif" width="328" alt="select a drive"></span>

      <p>
	再分割するドライブを選び、 <code class="code">Initialize...</code> ボタンをクリックします。
	すると別のダイアログが出ます。 <code class="code">Custom Setup...</code>
	ボタンをクリックします。
      </p>

      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/initialize.gif" width="330" alt="initialize"></span>
    </li>
<li class="listitem">
      <p>
	使う予定のパーティションの数を選びます。おそらく、少なくとも
	5 パーティションは必要でしょう。インストールノートの提示を参照してください。
      </p>

      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/custom-setup.gif" width="480" alt="custom setup"></span>

      <p>
	パーティション数を変えると、 <code class="code">Volumes</code> の情報はすべて消えるので、
	まず最初に <code class="code">Partitioning Scheme</code> を選んでください。
      </p>
    </li>
<li class="listitem">
      <p>
	各 <code class="code">Volumes</code> ごとに、 <code class="code">Volume Info</code> にある <code class="code">Type:</code>
	と <code class="code">Size:</code> を、インストールノートに提示されているように設定します。
      </p>
      
      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/custom-type.gif" width="480" alt="custom type"></span>

      <p>
	<code class="code">Volumes</code> の移動には <code class="code">TAB</code> キーが使えます。
      </p>
    </li>
<li class="listitem">
      <p>
	設定が済むと、次のようになるはずです (Mac OS パーティション名は、
	後ほど Finder から設定します):
      </p>
      
      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/suggested-layout.gif" width="480" alt="suggested layout"></span>

    </li>
<li class="listitem">
      <p>
	<code class="code">OK</code> ボタンをクリックします。すると、
	変更について確認を求めてきます。
      </p>
      <p>
	<span class="emphasis"><em>ここまでくると、やり直せません ! ここで、確認に同意すると、
	ドライブの内容はすべて消去されます</em></span>
      </p>
    </li>
<li class="listitem">
      <p>
	パーティショニングと HFS(+) パーティションの作成が済むと、
	最初の画面に戻ります。
      </p>

      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/drivesetup-done.gif" width="328" alt="after partitioning"></span>

      <p>
	注意: <code class="code">A/UX</code> パーティションは Mac OS からはアクセスできません。
      </p>
    </li>
<li class="listitem">
      <p>
	Drive Setup での作業は完了し、 Drive Setup を終了できます。
	これで、 Finder から、 HFS(+) パーティションの名前を変更できます。
	Open Firmware 1.0.5 または 2.0.x の機種では、これで完了です─
	インストールノートに従い、作業を続けてください。
      </p>

      <p>
	Open Firmware 2.4 または 3 の機種では、ディスクを NetBSD ブート可能に
	するために、もう一段階必要です。
      </p>

      <p>
	<code class="code">ofwboot.xcf</code> (ブートローダー) と、 <code class="code">netbsd.GENERIC_MD.gz</code>
	または <code class="code">netbsd.ram.gz</code> (インストーラー) を、 HFS(+) パーティションの
	ひとつにコピーする必要があります。これらのファイルは
	<code class="code">バイナリー</code>モードでダウンロードしてあることを確認しておいてください。
      </p>
    </li>
</ol></div>
</div>
<div class="sect1" title="Disk Utility を使ったパーティショニング (Mac OS X)">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="disk-utility"></a>Disk Utility を使ったパーティショニング (Mac OS X)</h2></div></div></div>
  

  <p>
    Mac OS X の Disk Utility プログラムは NetBSD パーティションを直接作ることは
    できませんが、最終的に NetBSD パーティションを作る方法はあります。
    Disk Utility の利点は、 Mac OS X インストール CD から利用可能なことです。
    Disk Utility が作成可能なのは、 "Mac OS Extended" (HFS+)、 "Mac OS Standard"
    (HFS)、 "UNIX File System" (UFS) および "Free Space" パーティションのみです。
  </p>

  <p>
    NetBSD/macppc -current カーネルは UFS パーティションを使うことができ、
    ルートパーティションであっても使うことができます。現状、通常の NetBSD
    A/UX-形式で利用可能なパーティションが存在しない場合に、 NetBSD/macppc
    は UFS パーティションがルートであるとの仮定をするようにはなっていません。
    NetBSD に、どのパーティション (たとえば "e") が UFS であるとみなすかを
    教えてやる必要や、<a class="ulink" href="faq.html#dash-a" target="_top">ルートデバイス</a>が UFS
    であることを指定したカーネルを作る必要があるかもしれません。
  </p>

  <p>
    これでは足りないという場合、 Disk Utility で Mac OS HFS+ を作り、
    NetBSD 用に free space を残しておくという使い方ができます。
    あとは <a class="ulink" href="#pdisk" target="_top"><code class="code">pdisk</code></a> を使って NetBSD
    パーティションを作る必要があります。
  </p>

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p>
	Disk Utility を起動します。インストール CD から使う場合は "Install" メニューにあります。
	Mac OS X から使う場合は /Applications/Utilities/Disk Utility を開きます。
      </p>
    </li>
<li class="listitem">
      <p>
	ここで認証が必要かもしれません。ウィンドウ左下で "Click the lock to make
	changes." といわれた場合は、錠前をクリックしてパスワードを入力します
	(管理者用のアカウントを使っていますよね?)。
      </p>
    </li>
<li class="listitem">
      <p>
	左側のパネルで、ディスクを選びます。 "Partition" タブを
	クリックします。 "Volume Scheme" (つまり、必要なパーティション数)
	を選びます。
      </p>
    </li>
<li class="listitem">
      <p>
	パーティションの名前、フォーマットとサイズを設定します。ヒント:
	推奨より小さいパーティションを作るには、サイズ欄に数字を入れ、それを
	パーティションサイズにするため enter キーを押します。 "Mac OS Extended"
	HFS+ パーティションの最小サイズは 4 MB です。例えば、筆者の 2 パーティションの
	ディスク (<code class="code">ofwboot.xcf</code> 用の小さい HFS パーティションと NetBSD 用の大きな
	UFS パーティション) では、このようになります:
      </p>

      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/diskutil-hfs.gif" width="705" alt="small HFS partition"></span>
      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/diskutil-ufs.gif" width="705" alt="large NetBSD UFS partition"></span>
      
    </li>
<li class="listitem">
      <p>
	Mac OS 9 のディスクドライバーをどこにインストールするか選択します。
	今後  Mac OS 9 かそれより前から、このディスクのパーティションのどれかへ
	アクセスするつもりがある場合、これが唯一の機会です。ここでボタンをクリック
	しなかった場合、 Mac OS 9 からは HFS パーティションにすらアクセスできなくなります。
      </p>
    </li>
<li class="listitem">
      <p>
	OK をクリックして先へ進みます。
      </p>
    </li>
<li class="listitem">
      <p>
	これで Disk Utility 抜けて結構です。作業は終わりました。これで、
	Finder から HFS(+) や UFS パーティションの名前を変えられます。 Open Firmware
	1.0.5 または 2.0.x の機種の場合、これで完了です─ INSTALL ノートに従って
	作業を続けてください。
      </p>

      <p>
	Open Firmware 2.4 または 3 の機種で、このディスクを NetBSD のブートに
	使えるようにする場合は、さらに以下の手順を踏む必要があります。
      </p>

      <p>
	<code class="code">ofwboot.xcf</code> (NetBSD 用のブートローダー) を、ドライブの HFS(+)
	パーティションのひとつにコピーする必要があります。 <code class="code">netbsd.GENERIC_MD.gz</code>
	を UFS パーティションにコピーします (これは HFS(+)
	パーティションに置いておくこともできますが)。これらのファイルは
	<code class="code">バイナリー</code>モードでダウンロードしてあることを確認しておいてください。
      </p>

      <p>
	UFS をルートパーティションに使うために -current カーネルが必要であること、
	NetBSD がこのパーティションをパーティション "a" であると認識しない可能性があることに注意してください。
      </p>
    </li>
</ol></div>
</div>
<div class="sect1" title="pdisk と newfs を使ったパーティショニング (Mac OS 9, Mac OS X, Darwin, NetBSD, Linux)">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="pdisk"></a>
    <code class="code">pdisk</code> と <code class="code">newfs</code> を使ったパーティショニング
    (Mac OS 9, Mac OS X, Darwin, NetBSD, Linux)
  </h2></div></div></div>
  

  <p>
    コマンドラインの <code class="code">pdisk</code> ユーティリティーは、ディスク上の Apple
    パーティションマップの閲覧と修正に使われます。 NetBSD、 Mac OS X、 Darwin
    はいずれも、 <code class="code">pdisk</code> でパーティション分割されたディスクをマウント可能です。
    Mac OS 9 およびそれ以前は、これをマウントするには特別なドライバーのインストールが
    必要です (<a class="ulink" href="#drive-setup" target="_top">Drive Setup</a> と <a class="ulink" href="#disk-utility" target="_top">Disk
    Utility</a> 参照)。 <code class="code">pdisk</code> は、 Open Firmware 2.4 または 3 の機種で
    NetBSD、 Mac OS X、 Darwin のブート可能なパーティションマップを作成可能です。
  </p>

  <p>
    さらに、 <code class="code">pdisk</code> は別のユーティリティーで作ったパーティションマップの修正や、
    単にディスクのパーティションマップのリストを見るためにも使えることがおわかりでしょう。
    ディスクのパーティションマップのリストを見たいだけの場合は、
    1 から 4 までの手順に従ってください。
  </p>

  <p>
    始める前に、パーティショニングに関していくらか警告しておきます:
  </p>

  <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
      <p>
	(Mac OS ユーティリティーで作ったパーティションマップを単に修正するのではなく)
	パーティションマップを <code class="code">pdisk</code> で一から作った場合、このディスク上の
	パーティションは Mac OS 9 およびそれ以前からはアクセスできなくなります。
      </p>
    </li>
<li class="listitem">
      <p>
	Mac OS X、 Darwin や Linux のネイティブな <code class="code">pdisk</code> では、
	NetBSD A/UX-形式のパーティションを作ることはできません。
      </p>
    </li>
<li class="listitem">
      <p>
	Mac OS 9 の <code class="code">pdisk</code> は、やや旧式のものであり、
	以下の説明とは若干異なる動作をすることがありますが、それでも使用可能です。
      </p>
    </li>
<li class="listitem">
      <p>
	Mac OS X および Darwin では、使用中のドライブに <code class="code">pdisk</code>
	パーティションマップを書き込むことができません。つまり、ブートドライブの
	分割し直しはできないということです。別のディスクからブートして作業してください
	(または、 <a class="ulink" href="http://charlessoft.com/" target="_top">BootCD</a> 等のツールでブート可能な CD を作ってください)。
      </p>
    </li>
</ul></div>

  <p>
    <code class="code">pdisk</code> によってリストされるパーティション番号は、 Open Firmware
    が使っているものと同じものです。 Open Firmware 2.4 または 3 の機種で
    ディスクをブート可能にしようとする場合は、 <code class="code">Apple_HFS</code>
    パーティションに <code class="code">ofwboot.xcf</code> を置くことと、 <code class="code">Apple_UNIX_SVR2</code>
    または <code class="code">Apple_UFS</code> パーティションを NetBSD
    ルートパーティションにすることを忘れないでください。
  </p>

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<p><code class="code">pdisk</code> を入手する。</p>
    <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
	<p>NetBSD -current では、 <code class="code">/sbin/pdisk</code></p>
      </li>
<li class="listitem">
	<p>
	  NetBSD 1.6.x では、 <a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/netbsd-pdisk/netbsd-pdisk.macppc-1-6" target="_top">
	  ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/netbsd-pdisk/netbsd-pdisk.macppc-1-6
	</a>
	</p>
	<pre class="programlisting"># <span class="bold"><strong>chmod 755 netbsd-pdisk.macppc-1-6</strong></span></pre>
      </li>
<li class="listitem">
	<p>
	  Mac OS X 10.2.5 (Mac OS X 10.1.5 でも動作することがわかっています) では、 <a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/netbsd-pdisk/netbsd-pdisk.macos-10-2" target="_top">
	  ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/netbsd-pdisk/netbsd-pdisk.macos-10-2</a>
	</p>
	<pre class="programlisting"># <span class="bold"><strong>chmod 755 netbsd-pdisk.macos-10-2</strong></span></pre>
      </li>
<li class="listitem">
	<p>
	  Mac OS 9 では、 <a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/macos-utils/pdisk.sea.hqx" target="_top">
	  ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/macos-utils/pdisk.sea.hqx</a>
	</p>
	<p>
	  アーカイブを伸長し、<code class="code">pdisk ppc</code> を実行する
	</p>
      </li>
<li class="listitem">
	<p>
	  それ以外 (Mac OS X、 Darwin、 Linux) では、 <a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/netbsd-pdisk/netbsd-pdisk.src.20030424.tgz" target="_top">
	  ftp://ftp.NetBSD.org/pub/NetBSD/arch/macppc/netbsd-pdisk/netbsd-pdisk.src.20030424.tgz</a>
	</p>
	<pre class="programlisting"># <span class="bold"><strong>tar xzf netbsd-pdisk.src.20030424.tgz</strong></span>
# <span class="bold"><strong>make</strong></span></pre>
      </li>
</ul></div>
    </li>
<li class="listitem">
      <p>
	閲覧またはパーティション再分割しようとしているディスクのデバイス名を
	調べます。パーティション再分割する場合は、そのディスクのマウントされている
	パーティションはすべてアンマウントします。
      </p>

      <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
	  <p>NetBSD:</p>
 <pre class="programlisting"># <span class="bold"><strong>dmesg | grep \[sw\]d\[0-9\]</strong></span>
# <span class="bold"><strong>umount /mountpoint</strong></span></pre>
	</li>
<li class="listitem">
	  <p>
	    Mac OS 9:
	  </p>
	  <p>
	    ディスクのアイコンをゴミ箱に捨てます。
	    <code class="code">pdisk ppc</code> を開き、<code class="code"><span class="bold"><strong>L</strong></span></code> をタイプしてディスク、その偽名、
	    パーティションを列挙させます
	  </p>
	</li>
<li class="listitem">
	  <p>
	    Mac OS X および Darwin:
	  </p>
 <pre class="programlisting"># <span class="bold"><strong>/usr/sbin/diskutil list</strong></span>
# <span class="bold"><strong>/usr/sbin/disktool -u disk2</strong></span></pre>
	</li>
<li class="listitem">
	  <p>
	    Linux:
	  </p>
<pre class="programlisting"># <span class="bold"><strong>dmesg | grep \[hs\]d\[a-g\]</strong></span>
# <span class="bold"><strong>umount /mountpoint</strong></span></pre>
	</li>
</ul></div>
    </li>
<li class="listitem">
      <p>
	<code class="code">pdisk /dev/<span class="emphasis"><em>disk-device</em></span></code> を実行します。ここで
	<span class="emphasis"><em>disk-device</em></span> は以下のようになります:
      </p>
      <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">NetBSD では <code class="code">/dev/sd2c</code> ("<code class="code">c</code>" パーティションを使用)</li>
<li class="listitem">Mac OS X および Darwin では <code class="code">/dev/disk2</code> (パーティション名は指定しない)</li>
<li class="listitem">Linux では <code class="code">/dev/hdc</code> (パーティション名は指定しない)</li>
</ul></div>

<pre class="programlisting">  # <span class="bold"><strong>./pdisk /dev/disk2</strong></span>
  Edit /dev/disk2 -
  Command (? for help): <span class="bold"><strong>?</strong></span>
  Notes:
    Base and length fields are blocks, which vary in size between media.
    The base field can be &lt;nth&gt;p; i.e. use the base of the nth partition.
    The length field can be a length followed by k, m, g or t to indicate
    kilo, mega, giga, or tera bytes; also the length can be &lt;nth&gt;p; i.e. use
    the length of the nth partition.
    The name of a partition is descriptive text.
  
  Commands are:
    C    (create with type also specified)
    c    create new partition (standard unix root)
    d    delete a partition
    h    help
    i    initialize partition map
    n    (re)name a partition
    P    (print ordered by base address)
    p    print the partition table
    q    quit editing
    r    reorder partition entry in map
    s    change size of partition map
    t    change a partition's type
    w    write the partition table</pre>
    </li>
<li class="listitem">
      <p>
	作業対象のディスクが正しいか、再確認します。 Apple
	パーティションマップがすでにあれば、大丈夫なはずです。
      </p>

<pre class="programlisting">  Command (? for help): <span class="bold"><strong>P</strong></span>

  Partition map (with 512 byte blocks) on '/dev/disk0'
   #:                type name             length   base    ( size )
   1: Apple_partition_map Apple                63 @ 1      
   2:      Apple_Driver43*Macintosh            56 @ 64     
   3:      Apple_Driver43*Macintosh            56 @ 120    
   4:    Apple_Driver_ATA*Macintosh            56 @ 176    
   5:    Apple_Driver_ATA*Macintosh            56 @ 232    
   6:      Apple_FWDriver Macintosh           512 @ 288    
   7:  Apple_Driver_IOKit Macintosh           512 @ 800    
   8:       Apple_Patches Patch Partition     512 @ 1312   
   9:          Apple_Free                     192 @ 1824   
  10:           Apple_UFS shared          1700000 @ 2016    (830.1M)
  11:           Apple_HFS macos            408788 @ 1702016 (199.6M)
  12:          Apple_Free                       8 @ 2110804

  Device block size=512, Number of Blocks=2110812 (1.0G)
  DeviceType=0x0, DeviceId=0x0
  Drivers-
  1:  23 @ 64, type=0x1
  2:  36 @ 120, type=0xffff
  3:  21 @ 176, type=0x701
  4:  34 @ 232, type=0xf8ff</pre>

      <p>
	もし Apple パーティションマップ (APM) がなければ、エラーが出ますし、
	新しいパーティションを作る前に APM の初期化が必要です。
      </p>

<pre class="programlisting">  Command (? for help): <span class="bold"><strong>P</strong></span>
  No partition map exists
  Command (? for help): <span class="bold"><strong>i</strong></span>
  read failed
  Command (? for help): <span class="bold"><strong>P</strong></span>

  Partition map (with 512 byte blocks) on '/dev/rdisk2'
   #:                type name    length   base    ( size )
   1: Apple_partition_map Apple       63 @ 1      
   2:          Apple_Free Extra  2110749 @ 64      (1.0G)

  Device block size=512, Number of Blocks=2110812 (1.0G)
  DeviceType=0x0, DeviceId=0x0</pre>
    </li>
<li class="listitem">
      <p>
	未使用パーティションを削除し、新しいパーティションを作ります。
	<code class="code">Apple_Free</code> パーティションは、自動的に未使用領域に計上されますので、
	削除する必要はありません。
      </p>

      <p>
	<code class="code">P</code> コマンドでパーティションの一覧を表示し、
	正しくパーティションを削除したか確認します。
      </p>
<pre class="programlisting">  Command (? for help): <span class="bold"><strong>d</strong></span>
  Partition number: <span class="bold"><strong>9</strong></span></pre>

      <p>
	作成される有用なパーティション型には、以下のようなものがあります:
      </p>
      
      <div class="informaltable">
	<table border="1">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td><code class="code">Apple_HFS</code></td>
<td>HFS および HFS+ パーティション (<a class="ulink" href="#msdos" target="_top">共有
	    MS-DOS</a> パーティションもこれ)</td>
</tr>
<tr>
<td><code class="code">Apple_UFS</code></td>
<td>UFS パーティション</td>
</tr>
<tr>
<td><code class="code">Apple_UNIX_SVR2</code></td>
<td>NetBSD および Linux 用の A/UX-形式パーティション</td>
</tr>
</tbody>
</table>
      </div>

<pre class="programlisting">  Command (? for help): <span class="bold"><strong>C</strong></span>
  First block: <span class="bold"><strong>2p</strong></span>
  Length in blocks: <span class="bold"><strong>100m</strong></span>
  Name of partition: <span class="bold"><strong>Zathras</strong></span>
  Type of partition: <span class="bold"><strong>Apple_HFS</strong></span>
  Command (? for help): <span class="bold"><strong>C</strong></span>
  First block: <span class="bold"><strong>3p</strong></span>
  Length in blocks: <span class="bold"><strong>800m</strong></span>
  Name of partition: <span class="bold"><strong>netbsd</strong></span>
  Type of partition: <span class="bold"><strong>Apple_UNIX_SVR2</strong></span>
  Available partition slices for Apple_UNIX_SVR2:
    a   root partition
    b   swap partition
    c   do not set any bzb bits
    g   user partition
  Other lettered values will create user partitions
  Select a slice for default bzb values: <span class="bold"><strong>a</strong></span>
  Command (? for help): <span class="bold"><strong>C</strong></span>
  First block: <span class="bold"><strong>4p</strong></span>
  Length in blocks: <span class="bold"><strong>4p</strong></span>
  Name of partition: <span class="bold"><strong>swap</strong></span>
  Type of partition: <span class="bold"><strong>Apple_UNIX_SVR2</strong></span>
  Available partition slices for Apple_UNIX_SVR2:
    a   root partition
    b   swap partition
    c   do not set any bzb bits
    g   user partition
  Other lettered values will create user partitions
  Select a slice for default bzb values: <span class="bold"><strong>b</strong></span>
  Command (? for help): <span class="bold"><strong>P</strong></span>

  Partition map (with 512 byte blocks) on '/dev/rdisk0'
   #:                type name     length   base    ( size )
   1: Apple_partition_map Apple        63 @ 1      
   2:           Apple_HFS Zathras  204800 @ 64      (100.0M)
   3:     Apple_UNIX_SVR2 netbsd  1638400 @ 204864  (900.0M) S0 RUFS k0  /
   4:     Apple_UNIX_SVR2 swap     267548 @ 1843264 (130.6M) S1  SFS k0  (swap)

  Device block size=512, Number of Blocks=2110812 (1.0G)
  DeviceType=0x0, DeviceId=0x0</pre>
    </li>
<li class="listitem">
      <p>
	新しいパーティションを書き出し、 pdisk を終了します。
      </p>

<pre class="programlisting">  Command (? for help): <span class="bold"><strong>w</strong></span>
  Writing the map destroys what was there before. Is that okay? [n/y]: <span class="bold"><strong>y</strong></span>
  Command (? for help): <span class="bold"><strong>q</strong></span></pre>
    </li>
<li class="listitem">
      <p>
	新しいファイルシステムを作ります。
      </p>
      <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
	  <p>
	    NetBSD は、ルートおよびユーザーパーティションとして固有のファイルシステム
	    (FFS) しか作ることができません。 UFS、 HFS、 HFS+ や、フロッピーサイズ以外の MS-DOS
	    ファイルシステムを直接作ることはできません。 HFS ファイルシステムの作成には <a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/packages/pkgsrc/sysutils/hfsutils/README.html" target="_top">
	    hfstools</a> を使うことができます。
	  </p>

	  <pre class="programlisting"># <span class="bold"><strong>newfs /dev/sd2a</strong></span>
# <span class="bold"><strong>hformat /dev/sd2e</strong></span></pre>
	</li>
<li class="listitem">
	  <p>
	    Mac OS 9 は、リブートすると HFS と HFS+ ファイルシステムの作成を要求してきます。
	    リブート後、 OS は新しいパーティションマップを認知し、このパーティションに
	    ファイルシステムがないことを警告して、ファイルシステムを作るよう求めてきます。
	    共有 MS-DOS パーティションのフォーマット方法は、
	    <a class="ulink" href="#msdos" target="_top">共有 MS-DOS ファイルシステムの作成</a> を見てください。
	  </p>
	</li>
<li class="listitem">
	  <p>
	    Mac OS X および Darwin は、 UFS、 HFS+ および HFS パーティションを作ることができます。
	    NetBSD FFS やフロッピーサイズ以外の MS-DOS ファイルシステムをコマンドラインユーティリティーを使って
	    作ることはできません。 Mac OS 8.0 やそれ以前を使うことを考えない限り、
	    (拡張ではない通常の) HFS パーティションは必要ないはずです。
	  </p>
	  <pre class="programlisting"># <span class="bold"><strong>newfs_hfs /dev/disk2s2</strong></span></pre>
	  <p>
	    (for HFS+)
	  </p>
	  <pre class="programlisting"># <span class="bold"><strong>newfs /dev/disk2s5</strong></span></pre>
	  <p>
	    (for UFS)
	  </p>
	</li>
<li class="listitem">
	  <p>
	    Linux は、ルート用の Linux 固有のファイルシステム (ext2fs)、スワップ、
	    ユーザーパーティションおよび MS-DOS ファイルシステムを作ることしかできません。
	    UFS、 HFS および HFS+ を直接作ることはできません。 HFS ファイルシステムは、 <a class="ulink" href="ftp://ftp.NetBSD.org/pub/NetBSD/packages/pkgsrc/sysutils/hfsutils/README.html" target="_top">
	    hfstools</a> を使って作ることができます。
	  </p>
<pre class="programlisting"># <span class="bold"><strong>mkfs -t ext2 /dev/hdc2</strong></span>
# <span class="bold"><strong>mkdosfs /dev/hdc3</strong></span>
# <span class="bold"><strong>hformat /dev/hdc5</strong></span></pre>
	</li>
</ul></div>
    </li>
<li class="listitem">
      <p>
	新しいファイルシステムをマウントします。
      </p>
      <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
	  <p>
	    NetBSD (FFS でも UFS でも同じコマンドを使います):
	  </p>
<pre class="programlisting"># <span class="bold"><strong>mount /dev/sd2a /mnt</strong></span>
# <span class="bold"><strong>hmount /dev/sd2e</strong></span></pre>
          <p>
	    (virtual mount)
	  </p>
	</li>
<li class="listitem">
	  <p>
	    Mac OS X および Darwin:
	  </p>
<pre class="programlisting">  # <span class="bold"><strong>/sbin/autodiskmount -v</strong></span>
  ** /dev/rdisk2s2
  FILESYSTEM CLEAN; SKIPPING CHECKS
  ** /dev/rdisk2s5
  QUICKCHECK ONLY; FILESYSTEM CLEAN
  Mounted ufs /dev/disk0s5 on /Volumes/untitled
  DiskDev    Type   FileSys  Fixed Write Volume Name      Mounted On      
  disk2s2    ???    hfs      yes   yes   untitled         /Volumes/untitled
  disk2s5    ???    ufs      yes   yes   untitled         /Volumes/untitled 1
  disk0s10   ???    hfs      yes   yes   OSX              /</pre>
	</li>
<li class="listitem">
	  <p>
	    Linux:
	  </p>
	  <pre class="programlisting"># <span class="bold"><strong>mount -t ufs -o ufstype=44bsd,ro /dev/hdc1 /mnt/netbsd</strong></span></pre>
	  <p>(BSD FFS)</p>
<pre class="programlisting"># <span class="bold"><strong>mount -t ufs -o ufstype=openstep,ro /dev/hdc2 /mnt/macosx</strong></span></pre>
<p>
 (OSX UFS)
</p>
<pre class="programlisting"># <span class="bold"><strong>hmount /dev/hdc3</strong></span></pre>
<p>(hfsutils の仮想的な mount)</p>
<pre class="programlisting"># <span class="bold"><strong>mount -t hfs /dev/hdc3 /mnt/macos</strong></span></pre>
<p>(実験的なカーネル内 HFS)</p>
<pre class="programlisting"># <span class="bold"><strong>hpmount /dev/hdc4</strong></span></pre>
<p>(hfsplus utils の仮想的な mount)</p>
<pre class="programlisting"># <span class="bold"><strong>mount -t hfsplus -o ro /dev/hdc4 /mnt/macosx</strong></span></pre>
<p>(実験的なカーネル内 HFS+)</p>
<pre class="programlisting"># <span class="bold"><strong>mount -t ext2 /dev/hdc5 /mnt/linux</strong></span></pre>
<p>(linux ext2fs)</p>
	</li>
</ul></div>
    </li>
<li class="listitem">
      <p>
	Open Firmware 1.0.5 または 2.0.x の機種では、
	<code class="code">netbsd.GENERIC_MD.gz</code> (インストーラー) を FFS または UFS
	パーティションにコピーしておくとよいでしょう。このファイルのダウンロードは
	<code class="code">バイナリー</code>モードでダウンロードしてあることを確認しておいてください。
	ブートするためにはさらに <code class="code">ofwboot.xcf</code> を別のところからロードする必要があります。
      </p>

      <p>
	Open Firmware 2.4 または 3 の機種で、このディスクから NetBSD
	がブート可能なようにするためには、 <code class="code">ofwboot.xcf</code> (ブートローダー)
	をHFS(+) パーティションのひとつにコピーする必要があります。 NetBSD から行なうには
	<code class="code">hcopy</code> コマンドを使います。 <code class="code">netbsd.GENERIC_MD.gz</code> (インストーラー)
	を FFS または UFS パーティションにコピーします (これは HFS(+)
	パーティションに置いておくこともできますが)。これらのファイルは
	<code class="code">バイナリー</code>モードでダウンロードしてあることを確認しておいてください。
      </p>

      <p>
	UFS をルートパーティションに使うために -current カーネルが必要であること、
	NetBSD がこのパーティションをパーティション "a" であると認識しない可能性があることに注意してください。
      </p>
    </li>
</ol></div>
</div>
<div class="sect1" title="共有 MS-DOS ファイルシステムの作成">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="msdos"></a>共有 MS-DOS ファイルシステムの作成</h2></div></div></div>
  

  <p>
    すべての OS で利用可能な、 MS-DOS フォーマットのパーティションを作ることができます。
    古い Mac OS ではこれを自動的にマウントしますし、 
    unix-like OS (NetBSD、 Linux、 Darwin、 Mac OS X) では
    <code class="code">mount_msdos</code> コマンドを使ってマウントできます。
    以下に、最も素直な方法の手順を概説します。
  </p>

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p>
	ハードドライブのパーティションを切り、 MS-DOS 用に HFS
	パーティション (type <code class="code">Apple_HFS</code>) を確保しておきます。
      </p>
    </li>
<li class="listitem">
      <p>
	次に、 Mac OS 8.1-9.x をブートし、
	<a class="ulink" href="http://hyperarchive.lcs.mit.edu/cgi-bin/NewSearch?key=disk+charmer&amp;search=&amp;sp=sp" target="_top">
	  Disk Charmer</a> または
	  <a class="ulink" href="http://www.versiontracker.com/moreinfo.fcgi?id=1253" target="_top">DiskCharmer</a>
	  を入手し、 MS-DOS ファイルシステムを作るよう設定します。
	  設定画面は次のようになるはずです:
      </p>

      <span class="inlinemediaobject"><img src="../../../images/ports/macppc/diskcharmer.gif" width="405" alt="screenshot of DiskCharmer"></span>
    
    </li>
<li class="listitem">
      <p>
	パーティションを DiskCharmer のウィンドウ上にドラッグします。すると、
	最初に作った HFS パーティションを消去し、そこに MS-DOS ファイルシステムを
	作る前に、プロンプトが出ます。
      </p>
    </li>
<li class="listitem">
      <p>
	これで、古い Mac OS をブートしたら、このパーティションが PC Exchange
	または File Exchange (これの呼び名は Mac OS のバージョンによります)
	によって自動的にマウントされるようになりました。
      </p>

      <p>Mac OS X、 Linux や NetBSD をブートしたときは、次のコマンドを実行します:</p>

      <pre class="programlisting">mkdir -p /msdos.filesystem;/sbin/mount_msdos -m 777 /dev/disk0s11 /msdos.filesystem</pre>

      <p>
	ここで <code class="code">/msdos.filesystem</code> はあなたが決めたマウントポイント、
	<code class="code">/dev/disk0s11</code> はそのパーティションのデバイス名です。あるいは、
	NetBSD や Linux では、 <code class="code">/etc/fstab</code> に項目を追加して、
	このファイルシステムがいつもマウントされるようにもできます。
      </p>
    </li>
<li class="listitem">
      <p>
	Mac OS X や Darwin で MS-DOS ファイルシステムを自動的にマウントする
	ためには、 System Startup ファイル群を作成する必要があります。
	<a class="ulink" href="http://www.darwinfo.org/howto/SystemStarter_HOWTO.shtml" target="_top">SystemStarter
	HOWTO</a> が、スタートアップファイル群の作成方法を学ぶうえでのよい参考資料と
	なるでしょう。 <code class="code">autodiskmount</code> を使った方法もおそらくあるのでしょうが、
	ここで説明する方法でうまくいきます。唯一の欠点は、 MS-DOS ファイルシステムが
	Classic 環境では扱えないことです。
	以下に例を示します:
      </p>

      <div class="orderedlist"><ol class="orderedlist" type="a">
<li class="listitem">
	  <pre class="programlisting"># <span class="bold"><strong>mkdir -p /Library/StartupItems/MountMSDOS</strong></span></pre>
	</li>
<li class="listitem">
	  <p>
	    以下の内容を持つファイル
	    <code class="code">/Library/StartupItems/MountMSDOS/StartupParameters.plist</code>
	    を作成します:
	  </p>
<pre class="programlisting">{
  Description     = "Mount MSDOS partitions";
  Provides        = ("Manual MSDOS partitions");
  Requires        = ("Disks");
  OrderPreference = "None";
  Messages =
  {
    start = "Mounting MSDOS partitions";
    stop  = "Unmounting MSDOS partitions";
  };
}</pre>
	</li>
<li class="listitem">
	  <p>
	    以下の内容を持つファイル
	    <code class="code">/Library/StartupItems/MountMSDOS/MountMSDOS</code>
	    を作成します:
	  </p>
	  <pre class="programlisting">#!/bin/sh

. /etc/rc.common

##
# Manually mount HFS partition with MS-DOS filesystem
##

ConsoleMessage "Mount MS-DOS partitions"

##
# Mount your filesystems manually.
##
mount_msdos /dev/disk0s11 /Volumes/Thingies</pre>
	</li>
<li class="listitem">
  <pre class="programlisting"># <span class="bold"><strong>chown -R root /Library/StartupItems/MountMSDOS</strong></span>
# <span class="bold"><strong>chmod a+rx /Library/StartupItems/MountMSDOS/MountMSDOS</strong></span></pre>
	</li>
</ol></div>
    </li>
</ol></div>
</div>
<div class="sect1" title="パーティション命名規則">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="nomenclature"></a>パーティション命名規則</h2></div></div></div>
  

  <p>
    NetBSD/macppc を使うときに、あなたが関わるであろうパーティション特定方式は
    三種類あります。各方式は、ディスク上のパーティション位置は変わらないにもかかわらず、
    異なるやり方でパーティションの順序を変えます。
    方式によっては、一部のパーティションを隠します。
  </p>

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p>
	<span class="bold"><strong>ディスク上の実際の順序 (0
	から最大のパーティション番号まで):</strong></span>
      </p>
      <p>
	これは、 Open Firmware や、 Mac OS X と Darwin の <code class="code">/dev/diskXsY</code>
	デバイスファイルが使っている方式です。パーティションの順序は、
	Drive Setup や pdisk や NetBSD のパーティショニングツールにおける順序
	そのままです。この方式によるパーティション一覧は、各 OS で <a class="ulink" href="partitioning.html#pdisk" target="_top">pdisk</a> を使ってプリントアウトできます。
      </p>

      <div class="informaltable">
	<table border="1">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td>0</td>
<td>最初の段階のブートローダーのために予約された、特別な "パーティション"。</td>
</tr>
<tr>
<td>1</td>
<td>Apple パーティションマップ。</td>
</tr>
<tr>
<td>2 から ~8</td>
<td>Mac OS のツールでフォーマットされたドライブでは、 Mac OS 9 ドライバー
	    のために予約されている。そうでない場合は、ユーザーが作ったパーティション。</td>
</tr>
<tr>
<td>~9 から ~15</td>
<td>ユーザーが作ったパーティション、
	    配置はディスクの物理的な位置の順。</td>
</tr>
</tbody>
</table>
      </div>
    </li>
<li class="listitem">
      <p>
	<span class="bold"><strong>Mac OS で見えるパーティション (Finder
	上のパーティション名による):</strong></span>
      </p>
      <p>
	Drive Setup でパーティションの群を作ったかもしれませんが、
	この Mac OS で見えるパーティションだけが Finder で表示されます。
      </p>

      <p>
	Mac OS 9 以前で見えるパーティションは、 HFS、 HFS+ または MS-DOS フォーマット
	でフォーマットされたものだけです。 Mac OS X 以降で見えるパーティションは、
	HFS、 HFS+、 UFS および MS-DOS (NetBSD の 4.2BSD FFS では <span class="emphasis"><em>ありません</em></span>)
	でフォーマットされたものだけです。
      </p>
    </li>
<li class="listitem">
      <p>
	<span class="bold"><strong>NetBSD で見えるパーティション (<code class="code">disklabel</code> で見られるとおりの
	a から h までの文字):</strong></span>
      </p>
      <p>
	NetBSD は、自分が処理しやすいような形にパーティションを並べ替えます。
	<code class="code"><a href="http://netbsd.gw.com/cgi-bin/man-cgi?disklabel+8+NetBSD-5.1+i386">disklabel(8)</a></code> で得られる <code class="code">fstype</code> は、
	Apple パーティションマップのフラグによっており、パーティション上の実際の
	ファイルシステム (NetBSD FFS、 Apple HFS や MS-DOS) によってはいません。
	特に、 MS-DOS フォーマットのパーティションは、それが<a class="ulink" href="#msdos" target="_top">
	共有 MS-DOS ファイルシステムの作成</a>の方法で作られた場合、
	<code class="code">HFS</code> パーティションに見えます。
      </p>

      <div class="informaltable">
	<table border="1">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td>a</td>
<td>"A/UX Root" パーティション、ディスク上の順序とは無関係</td>
</tr>
<tr>
<td>b</td>
<td>"A/UX Swap" パーティション、ディスク上の順序とは無関係</td>
</tr>
<tr>
<td>c</td>
<td>ディスク全体 (最初のセクターから最後のセクターまで)</td>
</tr>
<tr>
<td>d-f</td>
<td>最初のほうにある A/UX 以外のパーティション (普通はユーザー HFS(+) パーティション)</td>
</tr>
<tr>
<td>g</td>
<td>(作ってあれば) "A/UX User" パーティション、ディスク上の順序とは無関係</td>
</tr>
<tr>
<td>h</td>
<td>さらにある A/UX 以外のパーティション (普通はユーザー HFS(+) パーティション)</td>
</tr>
</tbody>
</table>
      </div>
    </li>
</ol></div>

  <p>
    そして、たとえば以下は PowerBook (FireWire) に Drive Setup
    で作成したものです:
  </p>

  <div class="informaltable">
    <table border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td><span class="bold"><strong>Mac OS</strong></span></td>
<td><span class="bold"><strong>OF/OSX</strong></span></td>
<td><span class="bold"><strong>NetBSD</strong></span></td>
<td><span class="bold"><strong>Comment</strong></span></td>
<td><span class="bold"><strong>Apple Partition Map type</strong></span></td>
<td><span class="bold"><strong>disklabel fstype</strong></span></td>
</tr>
<tr>
<td> </td>
<td>0</td>
<td> </td>
<td>bootloader</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td> </td>
<td>1</td>
<td> </td>
<td>Partition map</td>
<td>Apple_partition_map Apple</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td>2</td>
<td> </td>
<td>Mac OS driver</td>
<td>Apple_Driver43*Macintosh</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td>3</td>
<td> </td>
<td>Mac OS driver</td>
<td>Apple_Driver43*Macintosh</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td>4</td>
<td> </td>
<td>Mac OS driver</td>
<td>Apple_Driver_ATA*Macintosh</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td>5</td>
<td> </td>
<td>Mac OS driver</td>
<td>Apple_Driver_ATA*Macintosh</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td>6</td>
<td> </td>
<td>Mac OS driver</td>
<td>Apple_FWDriver Macintosh</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td>7</td>
<td> </td>
<td>Mac OS driver</td>
<td>Apple_Driver_IOKit Macintosh</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td>8</td>
<td> </td>
<td>Mac OS driver</td>
<td>Apple_Patches Patch Partition</td>
<td>unknown</td>
</tr>
<tr>
<td>Untitled</td>
<td>9</td>
<td>d</td>
<td>Mac OS 9 boot partition</td>
<td>Apple_HFS untitled</td>
<td>HFS</td>
</tr>
<tr>
<td>Untitled 2</td>
<td>10</td>
<td>e</td>
<td>Mac OS X boot partition</td>
<td>Apple_HFS untitled 2</td>
<td>HFS</td>
</tr>
<tr>
<td>Untitled 3</td>
<td>11</td>
<td>f</td>
<td>MS-DOS <a class="ulink" href="#msdos" target="_top">shared partition</a>
</td>
<td>Apple_HFS untitled 3</td>
<td>HFS</td>
</tr>
<tr>
<td> </td>
<td>12</td>
<td>a</td>
<td>NetBSD boot partition</td>
<td>Apple_UNIX_SVR2 A/UX Root</td>
<td>4.2BSD</td>
</tr>
<tr>
<td> </td>
<td>13</td>
<td>b</td>
<td>NetBSD swap</td>
<td>Apple_UNIX_SVR2 Swap</td>
<td>swap</td>
</tr>
<tr>
<td> </td>
<td>14</td>
<td>g</td>
<td>unused disk space</td>
<td>Apple_Free Extra</td>
<td>unknown</td>
</tr>
<tr>
<td> </td>
<td> </td>
<td>c</td>
<td>NetBSD whole disk</td>
<td> </td>
<td>unused</td>
</tr>
</tbody>
</table>
  </div>

  <p>
    インストール後、 HFS パーティションのひとつである "Untitled" (
    Open Firmware のパーティションは 9、 NetBSD のパーティションは d) に
    <code class="code">ofwboot.xcf</code> が、 A/UX パーティションのひとつ (Open Firmware
    のパーティションは 12、 NetBSD のパーティションは a) には NetBSD
    カーネルがあり、ブートのためのコマンドは次のようになります:
  </p>

  <pre class="programlisting">boot hd:9,ofwboot.xcf hd:12</pre>
</div>
<hr>
<em><a href="./">NetBSD/macppc ポートのページ</a></em> に戻る</div></div></div>
<div class="navfoot"></div>
<div id="footer"><center>
<span class="footfeed"><a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">
	  連絡</a> |
      </span><span class="footcopy"><a href="../../../ja/about/disclaimer.html">
      免責事項</a> |

      <span class="copyright">Copyright © 1994-2012 The NetBSD Foundation, Inc. </span>ALL RIGHTS RESERVED.<br>NetBSD<sup>®</sup> は The NetBSD
	Foundation, Inc. の登録商標です。</span>
</center></div>
</div></body>
</html>
