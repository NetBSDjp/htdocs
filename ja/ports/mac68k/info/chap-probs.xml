<!-- $NetBSD: chap-probs.xml,v 1.1 2007/06/09 13:32:36 dsieger Exp $ -->
<!-- Based on english version: -->
<!-- NetBSD: chap-probs.xml,v 1.1 2007/06/09 13:32:36 dsieger Exp   -->

<chapter id="chap-probs">
  <title>既知の問題と解決策</title>

  <sect1 id="intro">
    <title>はじめに</title>
    <para>このセクションはバグ情報ではありません。work-around (ad hoc な回避策)
    が存在するシステムの制限についてなどです。</para>
  </sect1>

  <sect1 id="scsi">
    <title>SCSI に関連する問題</title>
    <para>たくさんのユーザーが、NetBSD でのファイルシステムの破壊を報告していま
    す。症状は、原因不明のハングや多数のファイルが実行バイナリファイルから
    デバイスファイルへ変更されてしまうことなどです。この問題は他の製品より
    も Quantum 製ドライブでよく起きるようです。これは '030 CPU を搭載した 
    Mac で ncrscsi ドライバーを使用中にのみ起こります。</para>

    <para>厳密にはこれは ncrscsi ドライバーのバグですが、回避策があります。それは 
    sbc SCSI ドライバーを使用したカーネルへ切り替えることです。そのようなカー
    ネルのいくつかは次の URL から入手できます: <ulink
    url="ftp://ftp.NetBSD.org/pub/NetBSD/arch/mac68k/new/">ftp://ftp.NetBSD.org/pub/NetBSD/arch/mac68k/new/</ulink></para>
  </sect1>

  <sect1 id="installer">
    <title>インストール中 <quote>Error
    on SCSIRead(), #5</quote> というエラーで Installer が死んでしまう</title>
    <para>Installer の最新バージョン(執筆時点で 1.1g)でも、未だ大容量ドライブの
    パーティション(1G 超)の取り扱いに問題があります。この問題は Quantum
    Fireball ドライブで最も頻繁に起きるようですが(このドライブに限った話で
    はないと考えますが)、鍵はドライブの最初の 1G を超えた部分にパーティショ
    ン(とくに大きいもの)があること、さらに配付セットのうち大きいものをその
    ようなパーティションへ書き込んでいることのようです(小さなセット、例え
    ば etc では問題は起きないが base では問題が起きるようです)。似たような
    バグが以前修正されましたが、この問題とは若干異るようです。</para>

    <para>回避策はいくつかあります。まず、Installer に割り当てるメモリー量をできる
    だけ増やすこと。次は NetBSD パーティションを、ディスクの初めの方へ移動
    すること(なるべく近くへ)。もしこれでもダメな場合は、まずできるところま
    で Installer を使って配付セットをインストールし、その後 Installer の 
    Mini-Shell で配付ファイルを NetBSD パーティションへコピーします。最後
    に、NetBSD をブートして配付セットを NetBSD 上でインストールします。</para>
  </sect1>

  <sect1 id="boot-hang">
    <title>Ethernet やビデオカードを認識するところでブートがハングする問題</title>
    <para>この問題は通常 Ethernet とビデオカードの衝突が原因です。ひとつ考えられ
    る解決は、カードのスロットを入れ換えてみることですが、もしそれでダメな
    場合、なくても済む方のカードを抜いてブートしてみてハングしなくなるかど
    うか試してください。</para> 

    <para>もしブートがハングするのがビデオカードだけのせいだった場合、カーネルが
    正しくビデオカードの割り込みをクリアしていないことが考えられます。これ
    を修正するのに必要な情報を見つけ出すための HOWTO があります:</para>

    <para><ulink url="http://www.macbsd.com/macbsd/howto/video.html">http://www.macbsd.com/macbsd/howto/video.html</ulink></para>

    <para>正しい情報によって、カードを取り外すことなくブートするようにカーネルを
    変更することができます。</para>
  </sect1>

  <sect1 id="mkfs">
    <title>Mkfs 1.4 がドライブの最後のパーティションを認識する際の問題</title>
    <para>この問題の症状は、NetBSD 用に変換したいパーティションを作ったにもかか
    わらず、Mkfs 1.4 がそのパーティションを認識しない、というものです。</para>

    <para>この問題は、パーティションマップの「ひとつ違い」(off-by-one)エラーによっ
    て生じます。このエラーは、いくつかのハードディスクフォーマットソフトウェ
    ア(最新版 Apple HD SC セットアップも含む)がパーティションマップを作成
    するときに、パーティションエントリー数として実際のパーティションの数より
    も一個少い数をディスクに書き込むのが原因です。これにより Mkfs 1.4 が最
    後のパーティションエントリーを無視します(これは正しい動作です。というの
    はこのドライブは正しくフォーマットされた可能性もあるからです)。</para>

    <para>解決するには Mkfs を 1.45 以上にアップグレードします。もし Mkfs 1.45 
    以降が見つからない場合、ふたつの選択肢があります。まず、パーティション
    マップを正しく作成するフォーマットソフトウェアを使うか、またはパーティ
    ションマップの最後に、NetBSD で使わないパーティションを作成します。も
    し Mac OS パーティションをとっておくつもりなら、そのパーティションを最
    後のパーティションにするのがとてもいい考えです。そうではなくディスクス
    ペースを無駄にしたくない場合はサイズ 1KB のスクラッチ(scratch)パーティ
    ションを最後に作る方がよいでしょう。</para>
  </sect1>  
</chapter>


