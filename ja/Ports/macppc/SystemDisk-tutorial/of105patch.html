<html>
<head>
<!-- Copyright (c) 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<meta http-equiv=content-type content="text/html; charset=iso-2022-jp">
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<title>NetBSD/macppc Open Firmware 1.0.5 パッチ</title>
<meta name="DESCRIPTION" content="NetBSD, the right choice for your Power Macintosh desktop or server.  Elegant, powerful, portable, secure: Of course it runs NetBSD.">
<meta name="KEYWORDS" content="Power Macintosh, PowerPC, PowerMac, NetBSD, BSD, 4.4BSD, linux">
</head>
<body bgcolor="#FFFFFF" text="#000000">

<h2 align=center>
<font color="#FF0000">NetBSD/macppc
Open Firmware 1.0.5 パッチ</font>
</h2>

ここでは、 <tt><FONT COLOR="green">output-device</font> /chaos/control</tt>
を使う Open Firmware 1.0.5 のマシン (即ち PowerMacintosh 7300 - 8600) 
上の若干の軽微な問題を直すために、
Apple 社の System Disk ユーティリティーにパッチを当てる方法を説明します。
これは、 Copland 開発者による<a href="http://lppcfom.sourceforge.net/fom-serve/cache/378.html">
投稿</a>と、 port-macppc メーリングリストの Monroe Williams による<a
href="http://mail-index.netbsd.org/port-macppc/2000/03/21/0002.html">
投稿</a>に基づいています。


<ol>
<p><li><h3>MacOS の起動</h3>
  MacOS 8.0 以降が必要です。
  <p>
  もし MacOS 8.0 以降がなければ、
  <a href="http://download.info.apple.com/Apple_Support_Area/Apple_Software_Updates/English-North_American/Macintosh/System/Mac_OS_8.1_Update/Disk_Tools_PPC.img.bin">Disk
  Tools PPC.img</a> を Apple のサイトからダウンロードします。
  これは MacOS 8.1 のブートフロッピーです。このフロッピーからブートして
  System Disk のフロッピーと入れ換えるか、
  あるいは、フロッピーのファイルをハードディスクにコピーします。
  <p>
  MacOS をブートするたびに、
  Open Firmware のすべての設定 (nvram を含む)
  がデフォルト値に戻されますので注意してください。
<p><li><h3>ダウンロード</h3>
  <a href="ftp://ftp.apple.com/developer/macosxserver/utilities/SystemDisk2.3.1.smi.bin">
  ftp://ftp.apple.com/developer/macosxserver/utilities/SystemDisk2.3.1.smi.bin</a>
  <p>MacBinary から自動マウントディスクイメージへの変換のため、
  StuffIt Expander (または別のユーティリティー) が必要です。
<p><li><h3>ディスクイメージのマウント</h3>
  ディスクイメージを開いてデスクトップにマウントすると、
  イメージ中に <tt>System Disk</tt> ユーティリティーがあります。
<p><li><h3>NVRAM へのパッチ当て (容易な方法)</h3>
  もしあなたが System Disk 2.3.1 を使っているなら、この ResCompare 
<a href="/Ports/macppc/SystemDisk-tutorial/systemdisk-of105-patch.hqx">System Disk 2.3.1 OF105
  patch.hqx</a>をダウンロードして下さい。
  このプログラムは、 640x480 60Hz (Open Firmware がサポートしている、
  見たところ唯一の解像度) のビデオを正確に設定し、常に同期する様に
  若干の遅延を加えるためのパッチをあなたの System Disk に当てるでしょう。
<p><li><h3>NVRAM へのパッチ当て (上級者向けの方法)</h3>
  次の URL から ResEdit をダウンロードして伸張して下さい。
  <a href="http://download.info.apple.com/Apple_Support_Area/Apple_Software_Updates/English-North_American/Macintosh/Utilities/ResEdit_2.1.3.sea.bin">
  http://download.info.apple.com/Apple_Support_Area/Apple_Software_Updates/English-North_American/Macintosh/Utilities/ResEdit_2.1.3.sea.bin
  </a>
  もしあなたが System Disk 2.3.1 を持っているなら、 ResEdit に System Disk
  アプリケーションをにドラッグして、 <tt>OFpt</tt> リソースの ID
  128 を開いて下さい。
  別のバージョンの System Disk では、 <tt>OFtc</tt> リソースを開いて、
  いずれの ID があなたの Power Macintosh のモデルに対応するか
  判断する必要があります。
<p>
  当該 <tt>OFpt</tt> リソースの、大きく長い文字列の終わりに
  <a href="/Ports/macppc/SystemDisk-tutorial/of105patch.txt">次の内容</a>をペーストして下さい。
  (ペーストした）文字列の末尾に、キャリッジリターンがあることを確認して下さい。
  そうしないと System Disk が「最後のラインが突然に終わる」と不平を言うでしょう。
  最初の <tt>\</tt> にも注意してください。これは Apple 社製のパッチ
  (先に開いた <tt>OFpt</tt> リソース) の最後の行の終わり
  (<tt>unselect-dev</tt>) に続けて書きます。

<pre>\
dev /bandit/gc/via-cuda\
' write value &amp;W\
: -&amp;We &amp;W swap - execute ;\
: P1 4D8 -&amp;We false 548 -&amp;We ;\
&amp;W FC + ' P1 BLpatch\
: P2 0C 2 ms ;\
&amp;W E0 + ' P2 BLpatch device-end
</pre>

<cite>このブロックは、 via-cuda ドライバーがビデオコントローラのクロックを
準備しろと言われてからデバイスを設定するまでに十分な時間が与えられないバグを
修正します。</cite>
<p>
このパッチの著者は、ドライブが回転する前に起動しようとするマシンのため
のパッチも作りました。
しかしながら、 nvram が、 System Disk のパッチの他に、これらの両方のパッチ
を入れるのに十分な大きさを持っていない様に思われます。
けれどもこのパッチが本当に必要とされるかどうかは明確ではありません。
それで、あなたは上記のブロックの代わりに大きく長い文字列の終わりに
<a href="/Ports/macppc/SystemDisk-tutorial/of105patch2.txt">次の物</a>をペーストするべきかも知れません。
  (ペーストした）文字列の末尾に、キャリッジリターンがあることを確認して下さい。
  そうしないと System Disk が「最後のラインが突然に終わる」と不平を言うでしょう。
  最初の <tt>\</tt> にも注意してください。これは Apple 社製のパッチ
  (先に開いた <tt>OFpt</tt> リソース) の最後の行の終わり
  (<tt>unselect-dev</tt>) に続けて書きます。

<pre>\
: wBoot\
begin\
 boot-device ['] $boot catch drop\
 .&quot; -Waiting for boot-device&quot; cr\
 d# 500 ms\
key? until\
;
</pre>

<p>
<cite>このブロックは、標準的な起動コマンドの変わりに、
ディスクが回転するまで待つと言うことを FORTH 言語で定義します。
これは、標準での「コンピュータの画面が何時まで待っても黒いまま」問題を
回避します。</cite>
<p>
これは、起動コマンドとして <tt>boot</tt> の代わりに
<tt>wBoot</tt> を使用する必要があることを意味します。
(起動コマンドは Advanced Options 画面で設定します)

<p><li><h3>保存、実行、保存</h3>
  ResEdit の変更を保存して終了して下さい。
  変更された System Disk プログラムを実行して、
  <tt>Power User (Open Firmware)</tt> をクリックして下さい。
  そして、新しい nvram の内容を保存するために <tt>Save</tt> ボタンをクリックして下さい。

</ol>
<p>

<hr>
<a href="../">Up to <em>NetBSD/macppc Port Page</em></a>
<hr>

<table width="100%"><tr>
<td>    
  <table><tr>
  <td>
    <a href="../../../">
    <img src="../../../../images/NetBSD-banner.gif" border=0 alt=""></a>
  </td><td>
    
    <a href="../../../"> 
    <img src="../../../../images/empty.gif" border=0
     alt="NetBSD ">ホームページ</a>
    
  </td>
  </tr></table>
</td><td>
  <table><tr>
  <td>
    <a href="../../../Ports/">  
    <img src="../../../../images/NetBSD-banner.gif" border=0 alt=""></a>
  </td><td>
    
    <a href="../../../Ports/">
    <img src="../../../../images/empty.gif" border=0
     alt="NetBSD ">対応アーキテクチャー</a> 
    
  </td> 
  </tr></table> 
</td>
</table>

<hr>
<address>
  <small>
  www@JP.NetBSD.ORG<br>
  $NetBSD: of105patch.html,v 1.8 2000/10/22 01:38:21 dent Exp $<br>
  <a href="/Misc/disclaimer.html" origlink="../../../Misc/disclaimer.html">Copyright &copy;
    1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
