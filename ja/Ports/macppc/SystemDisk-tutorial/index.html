<html>
<head>
<!-- Copyright (c) 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<meta http-equiv=content-type content="text/html; charset=iso-2022-jp">
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<title>NetBSD/macppc System Disk チュートリアル</title>
<meta name="DESCRIPTION" content="NetBSD - あなたの Power Macintosh をデスクトップやサーバーで使うよい選択。美しく、強力、移植性、 secure: もちろん NetBSD です。">
<meta name="KEYWORDS" content="Power Macintosh, PowerPC, PowerMac, NetBSD, BSD, 4.4BSD, linux">
</head>
<body bgcolor="#FFFFFF" text="#000000">

<h2 align=center>
<font color="#FF0000">NetBSD/macppc 
System Disk チュートリアル</font>
</h2>

ここでは、 PowerMacintosh コンピューターで NetBSD/macppc を使うため、
Apple の System Disk ユーティリティーを使って Open Firmware を
設定する方法を簡潔に述べます。
この MacOS ユーティリティーは、 Open Firmware のコマンドラインでできる
ほとんどすべてのことが、より簡単にできます。
<a href="ftp://ftp.netbsd.org/pub/NetBSD/arch/macppc/macos-utils/bootvars/">
Boot Variables</a>
という古いプログラムもあり、いくつかのオプションが追加されています。
しかし、 Boot Variables はバグのある OF バージョンへのパッチを含まないため、
System Disk をおすすめします。

<ol>
<p><li><h3>MacOS のブート</h3>
  MacOS 8.0 以降が必要です。
  <p>
  もし MacOS 8.0 以降がなければ、
  <a href="http://download.info.apple.com/Apple_Support_Area/Apple_Software_Updates/English-North_American/Macintosh/System/Mac_OS_8.1_Update/Disk_Tools_PPC.img.bin">
  Disk Tools PPC.img</a> を Apple のサイトからダウンロードします。
  これは MacOS 8.1 のブートフロッピーです。このフロッピーからブートして
  System Disk のフロッピーと入れ換えるか、
  あるいは、フロッピーのファイルをハードディスクにコピーします。
  <p>
  古いマシン (OF 1.0.5) では、 MacOS をブートするたびに、
  Open Firmware のすべての設定 (nvram を含む)
  がデフォルト値に戻されますので注意してください。
<p><li><h3>ダウンロード</h3>
  <a href="ftp://ftp.apple.com/developer/macosxserver/utilities/SystemDisk2.3.1.smi.bin">
  ftp://ftp.apple.com/developer/macosxserver/utilities/SystemDisk2.3.1.smi.bin</a>
  <p>MacBinary から自動マウントディスクイメージへの変換のため、
  StuffIt Expander (または別のユーティリティー) が必要です。 

<p><li><h3>ディスクイメージのマウントと System Disk の実行</h3>
  ディスクイメージを開いてデスクトップにマウントすると、
  イメージ中に <tt>System Disk</tt> ユーティリティーがあります。
  このプログラムを実行します:
  <p>
  <img src="/Ports/macppc/SystemDisk-tutorial/systemdisk1.gif" origlink="systemdisk1.gif" alt="System Disk のスクリーンショット">

<p><li><h3>NVRAM パッチ</h3>
  <tt>Save</tt> ボタンをクリックすると、そのマシンに必要な nvram
  パッチをインストールしますが、 PowerMacintosh 7300 - 8600 の
  ビデオタイミングの小修正はインストールされません。 
  これについては、 <a href="of105patch.html">OF 1.0.5 パッチ</a>を別に用意してあります。

<p><li><h3>Advanced Options</h3>
  もし、自動的に <tt>Power User (Open Firmware)</tt> が選択されなければ、
  手動で選択します。
  <tt>Advanced Options</tt> をクリックします:
  <p>
  <img src="/Ports/macppc/SystemDisk-tutorial/systemdisk2.gif" origlink="systemdisk2.gif" alt="Advanced Options のスクリーンショット">

<p><li><h3>Input Device/Output Device</h3>
  内蔵ビデオが Open Firmware に対応していれば、 System Disk
  は自動的にデバイス名を決定し、
  (Open Firmware でシリアルポートをデフォルトで使うようになっていても)
  それを display として選択するので注意してください。
  <p>
  これは Open Firmware のプロンプトで次のようにタイプして設定することも
  できます。:
  <pre>setenv input-device kbd
setenv output-device screen</pre>
  ここで <tt>kbd</tt> と <tt>screen</tt> は、そのマシンの適切なデバイス名
  あるいはその別名です。
  <p>もし (<i>USB シリアルアダプターではなく</i>) シリアルポートがあれば、
  Open Firmware との対話にモデムポートを使うために、
  <tt>input-device</tt> と <tt>output-device</tt> の両方を ttya と
  することができます。

<p><li><h3><tt>Stop Boot at Open Firmware prompt</tt></h3>
  このボタンを押すと、起動のさい、直接 OF と対話できるようになります。
  こうすることで Open Firmware を使うたびに Command-Option-O-F を
  押し続ける必要はなくなります。
  これは OF プロンプトで次のようにタイプすることと同じです。:
  <pre>setenv auto-boot? false</pre>

<p><li><h3><tt>Boot device</tt> 項目</h3>
  もちろん、この項目は、どのデバイスからブートするかを選ぶものです。
  これは OF プロンプトで次のようにタイプすることと同じです。:
  <pre>setenv boot-device scsi/sd@0:0</pre>
  <p>次のような値を取ります:

<table border>
<tr><th align="left"><tt>fd:0</tt></th>
<th align="left">フロッピードライブ</th></tr>

<tr><th align="left"><tt>enet:0</tt></th>
<th align="left">OF バージョン &gt; 3.0 の機種のイーサネット</th></tr>

<tr><th align="left"><tt>enet</tt></th>
<th align="left">OF バージョン &lt; 3.0 の機種のイーサネット</th></tr>

<tr><th align="left"><tt>scsi-int/sd@<font color="#FF0000">3</font>:<font
  color="#00FF00">0</font></tt></th>
<th align="left">初期の PCI PowerMacの内蔵 SCSI</th></tr>

<tr><th align="left"><tt>scsi-ext/sd@<font color="#FF0000">3</font>:<font
  color="#00FF00">0</font></tt></th>
<th align="left">複数の SCSI バスを持つ後期の PowerMac の外付け SCSI</th></tr>

<tr><th align="left"><tt>scsi/sd@<font color="#FF0000">3</font>:<font
  color="#00FF00">0</font></tt></th>
<th align="left">SCSI (複数の SCSI バスを持つ場合は、どちらか確定できないでしょう)</th></tr>

<tr><th align="left"><tt>ata/ata-disk@<font color="#0000FF">0</font>:<font
  color="#00FF00">0</font><br>
  ata/ATA-Disk@<font color="#0000FF">0</font>:<font
  color="#00FF00">0</font><br>
  ide0/disk@<font color="#0000FF">0</font>:<font
  color="#00FF00">0</font><br>
  ide1/disk@<font color="#0000FF">0</font>:<font
  color="#00FF00">0</font><br>
  hd:<font color="#00FF00">0</font><br>
  cd:<font color="#00FF00">0</font><br>
  zip:<font color="#00FF00">0</font><br>
</tt></th>
<th align="left">IDE ドライブ。 内蔵 IDE を持つ初期の機種では、
スレーブのデバイスからのブートの可否は不明</th></tr>
</table>
<p>
SCSI の <font color="#FF0000">3</font> は、ブートデバイスの SCSI ID です。
伝統的に、 SCSI CD-ROM の ID は 3 、
内蔵ハードディスクドライブの ID は 0 、 SCSI Zip ドライブは 5 か 6 です。
<p>
IDE の <font color="#0000FF">0</font> は、マスターとスレーブの別
(マスターは 0 、スレーブは 1) です。 
内蔵 IDE を持つ初期の機種で、スレーブのデバイスからブートできるかは不明です。
<p>
<font color="#00FF00">0</font> はブートしようとするパーティションです。
NetBSD ディスクラベルを持つディスク (1.4.2 以前のインストールツールで
作られた、あるいは、配布されているブートフロッピー) では、
0 は "full disk" です。
Apple partition map を持つディスクでは、
NetBSD パーティションのパーティション番号
(若い番号は MacOS ブートローダ用に予約されているため、たいていは 5 以上)
を使います。
<p>
後期の機種では "whole disk" パーティションからはブートできず、
HFS 、 MS-DOS または ISO9660 パーティションから
ブートローダーかカーネルを探す必要がありますので注意してください。

<p><li><h3><tt>Boot File</tt></h3>
  この項目は、ブートしようとするファイル名です。
  これは、 "whole disk" パーティションを使わない
  (カーネルやブートローダーが HFS 、 MS-DOS または ISO9660
  のパーティションにある) 場合に使います。
  これは OF プロンプトで次のようにタイプすることと同じです。:
  <pre>setenv boot-file ofwboot.elf</pre>

  次のような値を取ります:
<table border>
<tr><th align="left"><tt>netbsd-GENERIC</tt></th>
<th>カーネル (ブートローダーを使わない)<br>
    ELF バイナリーに対応した OF バージョン &gt; 3.0 の機種でのみ有効</th></tr>

<tr><th align="left"><tt>ofwboot.elf</tt></th>
<th>ELF ブートローダー<br>
    ELF バイナリーに対応した OF バージョン &gt; 3.0 の機種でのみ有効</th></tr>

<tr><th align="left"><tt>ofwboot.xcf</tt></th>
<th>XCOFF ブートローダー<br>
    XCOFF バイナリーに対応した OF バージョン &lt; 3.0 の持つ機種でのみ有効</th></tr>
</table>

<p><li><h3>保存と再起動</h3>
  OK をクリックして、 Advanced Options の変更を反映させます。
  Save をクリックして、
  Open Firmware の設定の変更と NVRAM のパッチを書き込みます。
  再起動します。

</ol>
<p>

<hr>
<a href="../">Up to <em>NetBSD/macppc Port Page</em></a>
<hr>

<table width="100%"><tr>
<td>    
  <table><tr>
  <td>
    <a href="../../../">
    <img src="/images/NetBSD-banner.gif" origlink="../../../images/NetBSD-banner.gif" border=0 alt=""></a>
  </td><td>
    
    <a href="../../../"> 
    <img src="/images/empty.gif" origlink="../../../images/empty.gif" border=0
     alt="NetBSD ">ホームページ</a>
    
  </td>
  </tr></table>
</td><td>
  <table><tr>
  <td>
    <a href="../../../Ports/">  
    <img src="/images/NetBSD-banner.gif" origlink="../../../images/NetBSD-banner.gif" border=0 alt=""></a>
  </td><td>
    
    <a href="../../../Ports/">
    <img src="/images/empty.gif" origlink="../../../images/empty.gif" border=0
     alt="NetBSD ">対応機種</a> 
    
  </td> 
  </tr></table> 
</td>
</table>

<hr>
<address>
  <small>
  www@JP.NetBSD.ORG<br>
  $NetBSD: index.html,v 1.7 2000/10/22 01:38:21 dent Exp $<br>
  <a href="../../../Misc/disclaimer.html">Copyright &copy;
    1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
