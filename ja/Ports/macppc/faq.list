<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<!-- Copyright (c) 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<meta http-equiv="Content-Type" content="text/html; charset=iso-2022-jp">
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<title>NetBSD/macppc Frequently Asked Questions</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<h1>NetBSD/macppc よくある質問</h1>

NetBSD/macppc に関するよくある質問 (と回答)
をいくつか掲げます。
<p>

この FAQ は作成作業中です。さらなる情報、質問、回答があれば、
<a href="mailto:port-macppc@NetBSD.org">port-macppc@NetBSD.org</a> までメールを
(訳註: 英語で) 送ってください。

<LIST>

<h2>以下の関連情報も見てください:</h2>
<ul>
    <li><a href="SystemDisk-tutorial/">NetBSD/macppc System Disk
        チュートリアル</a>
    <li><a href="models.html">NetBSD/macppc 機種対応ページ</a>
    <li><a href="nvedit.html">NetBSD/macppc nvedit HOW-TO</a>、
        NVRAMRC の内容の編集方法の案内
    <li><a href="partitioning.html">NetBSD/macppc パーティショニング HOW-TO</a>
    <li><a href="x11.html">NetBSD/macppc X11 FAQ</a>
    <li><a href="../../Documentation/elf.html">NetBSD ELF FAQ</a>
    <li>NetBSD のプラットフォーム独立なワークステーションコンソールドライバー
	についての <a href="../../Documentation/wscons/">wscons
	FAQ</a> 。
</ul>
<p>

<h2>さらに追加情報を提供しています:</h2>
<ul>
<li><a
href="ftp://ftp.NetBSD.ORG/pub/NetBSD/NetBSD-1.5.2/macppc/INSTALL.html">
    NetBSD 1.5.2 インストールノート</a> - 対応ハードウェアとインストール方法。
<li><a href="../../MailingLists/#port-macppc"> port-macppc メーリングリスト</a>
    - さらなる質問があれば講読してください。
<li><a
href="../../Documentation/network/netboot/">Diskless NetBSD HOW-TO</a>.
<li><a href="../../Documentation/Hardware/Misc/serial.html">NetBSD
シルアルポート入門</a>
<li><a href="../../Documentation/">NetBSD 一般のドキュメンテーション</a>
    - NetBSD/macppc 特有でない質問向け。
</ul>
<p>



<SECTION>一般的な問題・質問


<ENTRY>boot-trouble NetBSD がブートできません。助けて !
残念ながら、この問題にはいくつか原因があります。これは実際には、
私たちの望んだことではなく、大抵は、対応機種の多様さや、
Apple が発表せずに行なったラインの変更のせいです。

<p>まず最初に、お使いの<a href="models.html">機種</a>が対応しているかどうか
確かめてください。それから、あなたは<i>実際に</i>インストールノートを
ひととおり読み、また、あなたの機種のものと違う Open Firmware バージョン向けの
指示は無視しましたか? さらに、この FAQ 項目をひととおり読んでみて、
それでもまだ NetBSD をブートできないようなら、
<a href="mailto:port-macppc@netbsd.org">port-macppc@netbsd.org</a>
に投稿してください。

<p>問題を切り分けるため、下記のメッセージを見てください。

<p>
<pre>     Open Firmware, 1.0.5
     To continue booting the MacOS type:
     BYE&lt;return&gt;
     To continue booting from the default boot device type:
     BOOT&lt;return&gt;
      ok
     0 &gt; </pre>

もしこのようなメッセージが画面 (またはシリアルコンソール) に出ていなければ、
正しく Open Firmware に入っていません。マシンが MacOS のブートを始めている
(つまり、画面がグレーに変わり、 happy mac や broken folder が出る)
場合は、 <a href="SystemDisk-tutorial/">System Disk チュートリアル</a>
を見てください。
または、<a href="#ofw-access">Open Firmware に入る方法</a>
の指示を見てください。古い mac で画面が真っ黒になる場合は、
<a href="#ofw-boot-serial">シリアルコンソールを使う方法</a>
の指示を見てください。
画面がまったくもって妙な場合は、<a href="#non-sync-monitor">モニターの
同期の問題</a>の修正方法を見てください。

<p>OK、これで、 Open Firmware のプロンプトで止まるように設定していれば、
Open Firmware が起動してユーザーコマンドが使えるようになりますし、
そうでなければ、以前に行なった設定をもとにブートしようとするようになります。

<p>ふつうは、次の段階が最もトリッキーです─ Open Firmware がブートローダーを
正しい場所からロードできるようにします。どのような
<a href="#boot-support">ブート方法</a>がサポートされているか、 Open Firmware
の<a href="#boot-disk">ブートコマンド</a>、 <a href="#common-of-probs">Open
Firmware のブートでのありがちな問題</a>を見てください。
ネットブートに関連する質問は、
<a href="../../Documentation/network/netboot/">Diskless HOW-TO</a>、
特に
<a href="../../Documentation/network/netboot/intro.macppc.html">macppc 固有な部分</a>
の章、および後述する<a href="#netboot-probs">netboot
でありがちな問題</a>でカバーしています。

<pre>     0 &gt; <b>boot enet:,\ofwboot.xcf</b> file: 192.168.0.11,/ofwboot.xcfloading XCOFF
     tsize=C280 dsize=14AC bsize=2620 entry=600000
     SECTIONS:
     .text    00600000 00600000 0000C280 000000E0
     .data    0060D000 0060D000 000014AC 0000C360
     .bss     0060E4B0 0060E4B0 00002620 00000000
     loading .text, done..
     loading .data, done..
     clearing .bss, done..</pre>

もし、ここで止まって <tt>CLAIM failed</tt> と出力されたら、
<a href="#ofw-claim-failed">load-base</a> の値が不適切なものになっています。

<pre>     &gt;&gt; NetBSD/macppc OpenFirmware Boot, Revision 1.3
     &gt;&gt; (tsubai@mint.iri.co.jp, Sun Nov 26 01:41:27 JST 2000) 
    1701508+177748 [100+68176+55886]=0x1e9468</pre>

ここで止まる場合、 Open Firmware 1.0.5 や 2.0.x のマシンの
<a href="#ofw-real-base"><tt>real-base</tt></a> を設定する必要があります。
ここを過ぎれば、カーネルのロードが始まります。
もし、そこで問題があったら、それはもはや Open Firmware の問題ではなく、
ほとんど NetBSD の問題でしょう。

<p>PowerBook (FireWire) または PowerBook G4 (Titanium) を使っていて、
ここで固まる場合は、 <a href="#pb418">4.1.8 BootROM</a> に関する記述を読んでください。

<p>ラップトップで画面が真っ黒になる場合、途中で LCD の明るさが、
下げられたのかもしれません。<a href="#black-lcd">下記</a>
を見てください。

<pre>      start=0x100000
     Copyright (c) 1996, 1997, 1998, 1999, 2000, 2001
         The NetBSD Foundation, Inc.  All rights reserved.
     Copyright (c) 1982, 1986, 1989, 1991, 1993
         The Regents of the University of California.  All rights reserved.
     
     NetBSD 1.5S (AL) #0: Thu Mar 15 00:52:56 PST 2001
         mw@al:/usr/src/sys/arch/macppc/compile/AL
     total memory = 192 MB
     avail memory = 172 MB
     using 2483 buffers containing 9932 KB of memory
     [...]
     boot device: sd0
     root on sd0a dumps on sd0b
     root file system type: ffs</pre>

ときどき、カーネルは自身がどこからブートしたかがわからなくなります。
ブートデバイスを与えてカーネルを再構築するとよいかもしれません。
<a href="#dash-a">下記</a>を見てください。

<p>USB キーボードを使っていてここでハングする場合、
<a href="#usb-keyboard-problems">下記</a>を見てください。

<pre>     swapctl: adding /dev/sd0b as swap device at priority 0
     Automatic boot in progress: starting file system checks.
     [...]</pre>

OK、これで「マルチユーザーモード」に入り、ブートの過程が終わりました。
キーボードが機能しない場合は、 FAQ の
<a href="#usb-keyboard-problems">USB キーボード</a>および
<a href="#powerbook">最近のラップトップ</a>向けの項目を見てください。

<p>sysinst を使い、
<tt>I can not find any hard disk for use by NetBSD</tt>
と言われた場合は、 <a href="#nodisk">ディスクはどこへ
行った?</a> の FAQ 項目を参照すべきです。


<ENTRY>disk-sharing マシン上の OS 間でファイルを共有する方法は ?
残念ながら、素の NetBSD は、 Macintosh のファイルシステム (HFS、 HFS+ と UFS)
をサポートしていませんので、次善策を取らねばなりません。 NetBSD
パッケージコレクションから、
<a href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/hfsutils/README.html">hfstools</a>
や
<a href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/hfsutils/README.html">xhfs</a>
をインストールします。これらのユーティリティーを使うことで、コマンドラインや
グラフィカルブラウザーから、 HFS 上のファイルが読み書きできます (HFS+ や UFS
には<i>使えません</i>) 。これでは不都合がある場合は、さらに続きを読んでください。

<p>MS-DOS フォーマットのパーティションを作ります。古い MacOS ではこれを自動的に
マウントしますし、 unix-like OS (NetBSD、 linuxpcc、 Darwin、 MacOS X) では
<tt>mount_msdos</tt> コマンドを使ってマウントできます。
以下に、最も素直な方法の手順を概説します。

<p><ol>
<li>MacOS で Drive Setup (訳註: 日本語版ではドライブ設定) を使い、
ハードドライブのパーティションを切ります。<i>これにより、
ハードドライブ上の情報はすべて消えます</i>

<p><li>次に、
<a href="http://hyperarchive.lcs.mit.edu/cgi-bin/NewSearch?key=disk+charmer&amp;search=&amp;sp=sp">
Disk Charmer</a> または
<a href="http://www.versiontracker.com/moreinfo.fcgi?id=1253">DiskCharmer</a>
を入手し、 MS-DOS ファイルシステムを作るよう設定します。
設定画面は次のようになるはずです:
<p>
<img src="/images/ports/macppc/diskcharmer.gif" origlink="../../images/ports/macppc/diskcharmer.gif" width="405" height="251"
alt="screenshot of DiskCharmer">

<p><li>パーティションを DiskCharmer のウィンドウ上にドラッグします。すると、
最初に作った HFS パーティションを消去し、そこに MS-DOS ファイルシステムを
作る前に、プロンプトが出ます。

<p><li>これで、古い MacOS をブートしたら、このパーティションが PC Exchange
または File Exchange (これの呼び名は MacOS のバージョンによります)
によって自動的にマウントされるようになりました。

<p>MacOS X、 linuxppc や NetBSD をブートしたときは、次のコマンドを実行します:
<pre>mkdir -p /msdos.filesystem;/sbin/mount_msdos -m 777 /dev/disk0s11 /msdos.filesystem</pre>

ここで <tt>/msdos.filesystem</tt> はあなたが決めたマウントポイント、
<tt>/dev/disk0s11</tt> はそのパーティションのデバイス名です。あるいは、
NetBSD や linuxppc では、 <tt>/etc/fstab</tt> に項目を追加して、
このファイルシステムがいつもマウントされるようにもできます。 MacOS X でも
このような方法があるかもしれませんが、私はその方法をまだ知りません。
</ol>

<ENTRY>partitions ことごとく食い違ったパーティション記法で混乱しています
あなたが混乱するのはもっともです。私たちも混乱しました。

<p>NetBSD/macppc を使うときに、あなたが関わるであろうパーティション特定方式は
<i>三種類</i>あります。さらにややこしいことに、パーティションの順序は
方式ごとに変わりますし、含まれるパーティションも違ってきます。
Open Firmware 1.0.5、 1.1.22 または 2.0.x の機種を使うほとんどのユーザーは、
この問題で混乱することはありません。 NetBSD はドライブの内容上に
独自のパーティションマップを書き込んでそれを主張し、そしてそれが、
ユーザーが出会うであろう唯一のパーティションニング方式だからです。
本節は、おもに Open Firmware 3 のシステムについて説明します。

<p><a href="partitioning.html">NetBSD/macppc パーティショニング
HOW-TO</a> も参照してください。

<p><ol>
<li><b>MacOS で見えるパーティション (Finder 上のパーティション名による):</b><br>
Drive Setup でパーティションの群を作ったかもしれませんが、
この MacOS で見えるパーティションだけが Finder で表示されます。

<p>MacOS 9 以前で見えるパーティションは、 HFS、 HFS+ または MS-DOS フォーマット
でフォーマットされたものだけです。 MacOS X 以降で見えるパーティションは、
HFS、 HFS+ および UFS (NetBSD の 4.2BSD FFS では <i>ありません</i>)
でフォーマットされたものだけです。ユーザーは、 MS-DOS
フォーマットのパーティションを手動でマウントすることもできます。

<li><b>Open Firmware の方式 (Open Firmware で見られるとおりの
  0 から最大までのパーティション番号、 pdisk を使っても見られる):</b><br>
これは、 MacOS X や Darwin で使われるパーティション番号でもあります。
パーティションの順序は、 Drive Setup や NetBSD パーティショニングツール
で扱われる順序そのままです。
<p><table border=1 cellpadding=5>
 <tr><td>0</td>
 <td>第一段階のブートローダーのために予約された、特別な "パーティション"</td></tr>
 <tr><td>1 から ~8</td>
 <td>MacOS のツールでフォーマットされたドライブでは、しばしば MacOS ドライバー
  のために予約されており、 MacOS からは見えない</td></tr>
 <tr><td>~9 から ~15</td>
 <td>ユーザーが作ったパーティション、配置はディスクの物理的な位置の順
  (つまり、 HFS、 A/UX、 UFS パーティションは、とにかくユーザーが作った順に
  配置される) 。</td></tr>
 </table>

<p><li><b>NetBSD で見えるパーティション (<tt>disklabel</tt> で見られるとおりの
 a から h までの文字):</b><br>
NetBSD は、自分が処理しやすいような形にパーティションを並べます。
<tt>disklabel(8)</tt> で得られる <tt>fstype</tt> は、
Apple パーティションマップのフラグによっており、パーティション上の実際の
ファイルシステム (NetBSD FFS、 Apple HFS や MS-DOS) によってはいません。
特に、 MS-DOS フォーマットのパーティションは <tt>HFS</tt> パーティションに見えます。

<p><table border=1 cellpadding=5>
 <tr><td>a</td>
 <td>"A/UX Root" パーティション、ディスク上の順序とは無関係</td></tr>
 <tr><td>b</td>
 <td>"A/UX Swap" パーティション、ディスク上の順序とは無関係</td></tr>
 <tr><td>c</td>
 <td>ディスク全体 (最初のセクターから最後のセクターまで)</td></tr>
 <tr><td>d-f</td>
 <td>最初のほうにある A/UX 以外のパーティション (普通はユーザー HFS(+) パーティション)</td></tr>
 <tr><td>g</td>
 <td>(作ってあれば) "A/UX User" パーティション、ディスク上の順序とは無関係</td></tr>
 <tr><td>h</td>
 <td>さらにある A/UX 以外のパーティション (普通はユーザー HFS(+) パーティション)</td></tr>
</table>
</ol>

<p>そして、たとえば以下は PowerBook (FireWire) に Drive Setup
で作成したものです:
<p><table border=1 cellpadding=5>
<tr><td><b>MacOS</b></td><td><b>OF/OSX</b></td><td><b>NetBSD</b></td> 
  <td><b>Comment</b></td><td><b>Apple Partition Map type</b></td>
  <td><b>disklabel fstype</b></td></tr>

<tr><td><br></td>        <td>0</td>  <td><br></td>    
  <td>bootloader</td>               <td><br></td>
  <td><br></td></tr>

<tr><td><br></td>        <td>1</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_partition_map Apple</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td>2</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_Driver43*Macintosh</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td>3</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_Driver43*Macintosh</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td>4</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_Driver_ATA*Macintosh</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td>5</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_Driver_ATA*Macintosh</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td>6</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_FWDriver Macintosh</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td>7</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_Driver_IOKit Macintosh</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td>8</td>  <td><br></td>    
  <td>MacOS driver</td>             <td>Apple_Patches Patch Partition</td>
  <td>unknown</td></tr>

<tr><td>Untitled</td>   <td>9</td>  <td>d</td>    
  <td>MacOS 9 boot partition</td>   <td>Apple_HFS untitled</td>
  <td>HFS</td></tr>

<tr><td>Untitled 2</td> <td>10</td> <td>e</td>    
  <td>MacOS X boot partition</td>   <td>Apple_HFS untitled 2</td>
  <td>HFS</td></tr>

<tr><td>Untitled 3</td> <td>11</td> <td>f</td>    
  <td>MS-DOS shared partition</td>  <td>Apple_HFS untitled 3</td>
  <td>HFS</td></tr>

<tr><td><br></td>        <td>12</td> <td>a</td>      
  <td>NetBSD boot partition</td>    <td>Apple_UNIX_SVR2 A/UX Root</td>
  <td>4.2BSD</td></tr>

<tr><td><br></td>        <td>13</td> <td>b</td>      
  <td>NetBSD swap</td>              <td>Apple_UNIX_SVR2 Swap</td>
  <td>swap</td></tr>

<tr><td><br></td>        <td>14</td> <td>g</td>      
  <td>unused disk space</td>        <td>Apple_Free Extra</td>
  <td>unknown</td></tr>

<tr><td><br></td>        <td><br></td> <td>c</td>      
  <td>NetBSD whole disk</td>         <td><br></td>
  <td>unused</td></tr>
</table>

<p>インストール後、 HFS パーティションのひとつである "Untitled" (
Open Firmware のパーティションは 9、 NetBSD のパーティションは d) に
<tt>ofwboot.xcf</tt> が、 A/UX パーティションのひとつ (Open Firmware
のパーティションは 12、 NetBSD のパーティションは a) には NetBSD
カーネルがあり、ブートのためのコマンドは次のようになります:
<pre>boot hd:9,ofwboot.xcf hd:12</pre>

<ENTRY>scroll-speed なぜテキストの画面スクロールがこんなに遅いの?
GENERIC カーネルのテキストコンソールのコードは最適化されていません。
カーネルを再構築する場合、 -current には高速化された
テキストコンソールコードがあります。この修正は NetBSD 1.5.x には
<em>含まれません</em>。
<p>
カーネルを再構築する必要があります。
<a href="../../Documentation/kernel/#how_to_build_a_kernel">
カーネルコンフィギュレーション</a>に次の行を追加してください:
<pre>options	OFB_ENABLE_CACHE</pre>
<p>
X11 サーバーに関する情報は、 <a href="x11.html">NetBSD/macppc      
X11 FAQ</a> を見てください。


<ENTRY>usb-mouse-bug USB マウスが認識されません。

キーボードでなく、 Mac 本体背面に直接接続してみてください。


<ENTRY>usb-keyboard-problems USB キーボードの問題
USB キーボードには二種類の問題があります。一方の問題は NetBSD 1.4.3
リリース後に現れたもので、一部の iMac (ボンダイブルー) と一部の
PowerMacintosh G3 (青白) マシンでのみ起こります。
この問題は未修正です。
<p>
もう一方の問題は USB キーボードを持つすべての機種で起こるものですが、
NetBSD 1.5 リリース前に修正済です。

<p><H3>iMac (ボンダイブルー) と PowerMacintosh G3 (青白)
の問題:</h3>
PowerMacintosh G3 (青白) の問題の説明と回避策については、
Bob Nestor によるメーリングリストへの
<a href="http://mail-index.netbsd.org/port-macppc/2001/06/11/0009.html">記事</a>
を見てください。 iMac (ボンダイブルー) での回避策はありません。また、問題報告
<a href="http://www.NetBSD.org/cgi-bin/query-pr-single.pl?number=12894">port-macppc/12894</a>
も見てください。
<p>
手短にいえば、彼の勧告は次のとおりです:
<p>
<ol>
  <li>USB キーボードを外し、 ADB キーボードとマウスをつなぐ
    <p>
  <li>ADB キーボードをつないだ状態で NetBSD をブートする
    <p>
  <li>ADB キーボードで、 root、 swap、ファイルシステムの回答を入力
    <p>
  <li>システムがシェルプロンプトまで達したら (マルチユーザーの場合は
    ログインしたら)、 ADB を外し、 USB キーボードーをつなぐ
</ol>
<p>

これで USB が利用可能になり、システムが使えるようになります。
ADB は外す前から死んでいることがわかるでしょう。
また、 USB は外してブート<b>しなければなりません</b>。さもないと動作しません。
<p>
このほか、 NetBSD 1.4.3 は、この二機種でも問題なく動作し、
この USB の問題は起こりません。

<p><h3>NetBSD 1.5 より前でキーの打鍵が繰り返される問題:</h3>
カーネルによっては、 USB キーボードの最初の打鍵が何度も繰り返される
という問題があります。このため、インストールのさい
"<tt>(I)nstall, (S)hell or (H)alt ?</tt>" という質問が繰り返されます。
この問題を回避するため、最初に shift キーを押してください。
<p>
最近の機種では、 NetBSD がデバイスを設定後にシングルユーザーモードに入る前に
ハングすることがあります。
おすすめの回避策は、 USB デバイス (特にハブ) をすべて外し、
マウスをキーボードに挿し、キーボードを Mac 本体背面に直接つなぐことです。

<ENTRY>cannot-allocate-vm-panic <tt>panic: startup: cannot allocate VM for buffers</tt>
この問題は NetBSD 1.5 では修正されているはずです。
もしアップグレード後も問題があるようでしたら、
<a href="mailto:port-macppc@netbsd.org">port-macppc@netbsd.org</a>
に投稿してください。

<p>
RAM をたくさん積んだマシンでは、カーネルがバッファーキャッシュを
割り当てようとする際、カーネルがカーネル VM から逸脱することがあります。
次のいずれかで回避できます:
<ol>
<li>RAM をいくつか外す
<li><a href="../../Documentation/kernel/#how_to_build_a_kernel">カーネルコンフィグレーション</a>に
    <tt>"options BUFPAGES=800"</tt> を加える
</ol>

<ENTRY>wdc-lost-interrupt <tt>wdc0:0:1: lost interrupt</tt>
この問題は、 ATA4 ドライブをサポートする新しい機種上の NetBSD 1.5.2
で起こります。残念ながら、簡単な回避策はありません。助けが必要なら
<a href="mailto:port-macppc@netbsd.org">port-macppc@netbsd.org</a>
に投稿してください。

<p>これは、 BootROM 4.1.9 にアップグレードした iBook (Dual USB) と
iMac (Summer 2000) で報告されています。

<p>この問題は NetBSD-current では起こりません。

<ENTRY>pciide-lost-interrupt <tt>pciide0:0:0: lost interrupt</tt>
この問題は NetBSD 1.5.1 以降では修正済です。
もしアップグレード後も問題があるようでしたら、
<a href="mailto:port-macppc@netbsd.org">port-macppc@netbsd.org</a>
に投稿してください。

<p>
NetBSD の CMD 646 IDE コントローラーの初期化コードは、
Open Firmware による設定のいくつかを完全に解除しません。
Open Firmware は IDE コントローラーを 0646U2 モードに設定し、
いくつかの割り込みの設定を変更しているのです。
MI pciide ドライバーは、このような状況に対処できず、
"lost interrupt" というメッセージがたくさん出るのです。
<p>
この場合、 Open Firmware を使ってブートローダー (つまり <tt>ofwboot.xcf</tt>) 
やカーネルをそのハードドライブからロードすると、
NetBSD ではそのドライブを使えません。
<p>
次善策としては、カーネルを別のブート可能なバスに移し、
それから CMD 646 IDE バスにつないだドライブを
NetBSD ファイルシステムにマウントするという方法があります。
キーフレーズは「別のブート可能なバス」です。
この問題を持つ G3 や G4 の機種には、もうひとつの IDE バス
(と追加の SCSI バス) があります。
通常は、ハードドライブはこの問題があるバスにつながれており、
一方、CD-ROM や Zip のドライブは別のバスにつながれていて問題なく動作します。

<p>
遅い IDE バスのプロトコルを使うことにはなりますが、
ハードドライブを CD-ROM がつながっているバスに移し
(マスター / スレーブのジャンパーに注意してください) 、
この問題を回避するという方法もあります。


<ENTRY>mesh-fifo <tt>Panic: mesh: FIFO != 0</tt>
このバグは NetBSD 1.5 以降では現れません。
<p>
これは、 SCSI ケーブルやデバイスに問題がある場合に起こります。
内蔵と外付けの終端抵抗を確認してください。
ケーブルの長さと品質を確認してください。
不要なデバイスを全部外してみてください。
<p>
この問題は、 SCSI の世界のよい住人とはいえない
MESH SCSI バス上の Zip ドライブがある場合、しばしば起こります。
<p>
MacOS からリブートして NetBSD をブートするのでなければ、
MESH ドライバーはより信頼できるようになるという人もいます。
(つまり、 MacOS を動かしている場合、再起動ではなくシステム終了をしてから、
電源を入れて NetBSD をブートしてください。)
<p>
M L Riechers はこのトピックに関して、たいへん徹底的な
<a href="http://mail-index.netbsd.org/port-macppc/2000/08/02/0029.html">
記事</a>を投稿しています。
<p>
健闘を祈ります。


<ENTRY>bm0-device-timeouts device timeouts on bm0 と言われます
この問題は NetBSD 1.5 以降では修正済です。

<p>
10Mb のハブを介す (bm0 を強制的に 100Mb/s から 10Mb/s にする) と、
この問題を回避できるようです。


<ENTRY>power-off ほえ〜、マシンの電源が落ちます!

これは、最近のラップトップ (iBook、 PowerBook (FireWire)、
PowerBook G4 (Titanium)) を使ったことが原因かもしれません。
<p>
page up キーシーケンス (<tt>FN-uparrow</tt>) は NetBSD 1.5.x カーネルを
panic させます。これは NetBSD-current で修正済です。 page up
を押しがちな方は、新しいカーネルをコンパイルすべきです。
<p>
"brightness" キー (F1 および F2) は、マシンの電源を切って、
時計を狂わせます。
<tt>abtn</tt> オプションを外してカーネルを再構築する必要があります。
下記の行を、
<a href="../../Documentation/kernel/#how_to_build_a_kernel">
カーネルコンフィギュレーション</a>から削除してください:

<pre>#abtn*  at adb?</pre>

<ENTRY>power-manager PowerBook や iBook で、電源入、バッテリー充電、充電器の認識ができません
電源管理メモリーがおかしくなっているかもしれません。
<p>
リセット方法については <a href="http://til.info.apple.com/techinfo.nsf/artnum/n14449">TIL 14449</a>
を見てください。

<ENTRY>timedrift PowerComputing 互換機の時計がずれまくります。
あー、これは Open Firmware 内の <tt>timebase</tt> がハードウェアと
合致していないためです。正す必要があります。

<p>Adam Lebsack による
<a href="http://mail-index.netbsd.org/port-macppc/2001/08/03/0003.html">記事</a>
を見てください。

<ENTRY>dash-a カーネルがいつもルートデバイスを尋ねてくるのはなぜですか ?
多くの人が、 NetBSD/macppc システムを無人でブートさせられないと報告しています。
Open Firmware はカーネルを正しくロードするものの、
カーネルはルートデバイス (つまり / ファイルシステムの所在)
を見つけられていないようです。

<p>プロンプトで、ルートディスク (大抵は <tt>sd0a</tt> か <tt>wd0a</tt>
のようなもの)、スワップ (大抵は <tt>sd0b</tt> か <tt>wd0b</tt>
のようなもの)、ファイルシステムの種類 (大抵は <tt>ffs</tt>、 <tt>nfs</tt>
または <tt>cd9660</tt>) を入力してください。

<p>
これが修正されるまでの次善策があります。次のような設定で
<a href="../../Documentation/kernel/#how_to_build_a_kernel">カーネルを
コンパイル</a>する必要があります:
<pre>#config		netbsd	root on ? type ? #to automatically detect root device
config		netbsd	root on sd0 type ffs #for SCSI disk
#config		netbsd	root on wd0 type ffs #for IDE disk
#config		netbsd	root on ? type nfs #for netboot
</pre>

ここで <tt>sd0</tt> はルートファイルシステムのあるデバイス名です。


<!-- ======================================== -->
<SECTION>対応ハードウェア

<ENTRY>supported-models NetBSD/macppc 対応機種
<a href="models.html">NetBSD/macppc 対応機種一覧</a>を見てください。また、
<a href="#peripherals">対応周辺機器</a>の一覧も併せて見てください。

<ENTRY>nubus NetBSD/macppc は NuBus ベースの Power Mac (7100, 8100 等) をサポートしていますか ?

いいえ。 NetBSD/macppc は NuBus に対応していません。
さらに、 NuBus ベースの Power Mac は Open Firmware を持っていませんが、
NetBSD/macppc のブートストラップやコンソール操作は
Open Firmware に強く依存しています。

<p>
NuBus ベースの Power Macintosh マシンは、 4 グループに分類されます:
<ul>
<li><b>Apple PDM</b><br>
    あらゆる x1xx なマシン、たとえば 6100, 6150, 7100, 8100
<li><b>Apple PERFORMA class</b><br>
    52xx, 53xx, 62xx, 63xx (6360 は除く)
<li><b>Apple POWERBOOK ('M2') class</b><br>
    1400, 2300, 5300
<li><b>Power Computing "Power" シリーズ</b><br>
    "Power 100" と "Power 120"
</ul>

<p>これらの機種では、たとえプロセッサーを G3 にアップグレードしても、
他の部分が未サポートなので、動作しません。
(しかし、ロジックボードを完全にアップグレードすれば、
新しい機種と同等になるので、動作するでしょう)

<p>現在、これらの機種に対応するための作業をしている人を私たちは知りません。
もし、この作業に興味があれば、 (訳註: 英語で)
<a href="mailto:port-macppc@NetBSD.org">メールを送ってください</a>。

<p>私たちはすでに 603 マイクロプロセッサーをサポートしており、また、
RS/6000 移植の取り組みにおいて 601 マイクロプロセッサーサポートの作業中です。
そして、 <a href="../mac68k/">NetBSD/mac68k</a> ではマザーボードの
チップセットをサポートしています。あとは、単に、これらのドライバーの共有と、
現在サポートされている macppc マシンのブートの Open Firmware での方法と
互換なブートローダーの解決だけの問題です。


<ENTRY>68k-upgrade NetBSD/macppc は PowerPC プロセッサーにアップグレードした 68k ベースの Mac に対応していますか ?

いいえ。上記と同じ理由からです。
(これは<em>プロセッサー</em>だけをアップグレードした場合の話です。
マザーボードをすべてアップグレードすれば、
新しい機種と同等になるので、動作するでしょう。)


<ENTRY>601 NetBSD/macppc は Power Macintosh 7200 や 7500 (601 プロセッサー) に対応していますか ?

これらの機種は PCI と Open Firmware を持っていますが、 PowerPC 601
プロセッサーを使っているため、今のところ非対応です。しかし、
7500 のプロセッサーはアップグレード可能なので、 603/604/G3/G4 へ換装すれば
NetBSD が動作するでしょう。 <a href="#cpu-upgrade">下記</a>を見てください。

<p> また、 rs6000 ポートにおいて作業が進行中であり、これにより
NetBSD に 601 サポートがもたらされるでしょう。これが達成されれば、
あとは rs6000 と macppc でのコードの共有の問題になります。

<ENTRY>powerbook NetBSD/macppc は PowerPC ベースの PowerBooks に対応していますか ?

機種によります。 <a href="models.html">NetBSD/macppc
対応機種のリスト</a>を見てください。

<p>PowerBook 2400 と新しい G3 PowerBook は、
対応していることが知られています。
PowerBook 1400, 2300, 5300 は、 Open Firmware を持たないため、非対応です。
これ以降の機種のほとんどは、問題なく動作します。

<p>いくつかの最新機種 (iBook、 iBook SE、 iBook (Dual USB)、
PowerBook (FireWire)、 PowerBook G4 (Titanium)) のキーボードは、
NetBSD 1.5.1 で新たにサポートされました。これより前のバージョンの
NetBSD では、カーネルパッチが必要です。

<p>パワーマネージメントは未サポートですので注意してください。
NetBSD の動作中は PowerBook のサスペンド、レジュームはできません。

<p>このほか、 <a href="#power-off">ほえ〜、マシンの電源が落ちます!</a>、
<a href="#power-manager">PowerBook や iBook で、電源入、バッテリー充電、
充電器の認識ができません</a>、 <a href="#pb418">PowerBook 
(FireWire)、 PowerBook G4 (Titanium) と BootROM 4.1.8</a> も見てください。

<ENTRY>cpu-upgrade NetBSD/macppc は CPU アップグレードに対応していますか??
もちろん!
<p>
多くの人々が、遅い 601、 603、 604 や G3 CPU を、より速い 604、 G3 や G4 CPU
にアップグレードしています。最初の PowerPC 601 チップを持った
PowerMacintosh 7500 では、事実上必須でしょう。
<p>
PCI PowerMacintosh システム (7300 - 9600)、対応 PowerBook および初期の
G3 システムにもとから搭載されている CPU のアップグレードの成功が
報告されています。よく目にする製造元は、 Newer Technology、
Powerlogix、 Sonnet、 XLR8 です。その CPU が MacOS で動作していれば、 NetBSD
でも動作するはずです。 MacOS の "virtual firmware"
型のパッチは必要ないようです -- NetBSD は CPU を適切に初期化します。
<p>
稀な状況として、古いシステムでは G3 または G4 CPU の L2 キャッシュを有効に
するために特別にカーネルをコンパイルする必要があるかもしれません。これは
普通は必要なく、 "ちゃんと動き" ます。動かない場合は、次のようなメッセージが表示されます:
<pre>cpu0: 1MB backside cache</pre> 

<p>もし、ブート時にこのようなメッセージが出力された場合には、
この
<a href="http://mail-index.netbsd.org/port-macppc/2001/01/05/0000.html">記事</a>
と、この
<a href="http://mail-index.netbsd.org/port-macppc/2001/01/05/0007.html">記事</a>
の示すとおりにすべきです。

<ENTRY>peripherals NetBSD/macppc はどんな周辺機器に対応していますか ?
<a href="ftp://ftp.NetBSD.ORG/pub/NetBSD/NetBSD-1.5.2/macppc/INSTALL.html">
NetBSD/macppc 1.5.2 インストールノート</a>には、完全な一覧が載っています。
<br>特記ない限り、サードパーティー製デバイス (PCI や cardbus など)
は、 NetBSD/macppc のブート用には使えません。

<p>
<ul>
  <p><li> <strong>CPU</strong>
  <ul>
    <li>PowerPC 603、 604、 G3、 G4 (およびこれらの亜種)<br>
     CPU アップグレードの詳細は<a href="#cpu-upgrade">上記参照</a>
  </ul>
  <p><li> <strong>イーサネット</strong> 
  <ul>
    <li> オンボード 79C950 (MACE) イーサネット (<i>mc</i>)
    <li> オンボード bmac イーサネット、ただし 10Base-T のみ (<i>bm</i>)
    <li> オンボード gmac イーサネット (<i>gm</i>)
    <li> オンボード AirPort (<i>wi</i>)<br>
        <i><a href="#airport">下記</a>参照</i>
    <li> PCI、 PCMCIA、 cardbus および USB のイーサネットデバイス
        (<i>tlp</i>, <i>epic</i>, <i>ex</i>, <i>fxp</i>, <i>rtk</i>, <i>vr</i>,
         <i>ne</i>, <i>aue</i>, <i>cue</i>, and <i>kue</i>)<br>
       具体的には、
       Asante、 Farallon、 SMC、 3Com、 Intel、 RealTek、 D-Link、 NE2000、
       その他これらと互換のデバイス
  </ul>

  <p><li> <strong>SCSI</strong>

  <ul>
    <li> オンボード 53c94 SCSI コントローラー (<i>esp</i>)
    <li> オンボード MESH SCSI コントローラー (<i>mesh</i>)
    <li> Adaptec / Future Domain PCI SCSI (<i>ahc</i>)<br>
        多くの Adaptec 製カードは Macintosh firmware を内蔵しており、
        NetBSD/macppc のブートに使用可能。
	<i><a href="#boot-pci">下記</a>参照</i>
    <li> Advansys 1200[A,B] 9xx[U,UA] PCI SCSI (<i>adv</i>)
    <li> AMD 53c974 (<i>pcscp</i>)
    <li> NCR/Symbios 53c8xx (<i>ncr</i> または <i>siop</i>)
  </ul>

  <p><li><strong>IDE</strong>
  <ul>
    <li> オンボード IDE コントローラー (<i>wdc</i>)
    <li> Promise Ultra66 (<i>pciide</i>)
  </ul>

  <p><li><strong>入力デバイス</strong>
  <ul>
    <li>ほとんどの ADB キーボード、マウス、トラックボール、トラックパッド
    <li>ほとんどの USB キーボード、マウス、トラックボール、トラックパッド
    <li>ほとんどの PS/2 キーボード、マウス、トラックボール (3 ボタンマウスの
      中ボタンは機能しないかもしれません) 
  </ul>

  <p><li> <strong>ビデオ</strong> (<a href="#ofw-boot-video">下記</a>参照)
  <ul>
    <li> ほぼ全機種のオンボードビデオ (<i>ofb</i>)<br>
      下記の機種のオンボードビデオは、 NetBSD/macppc の動作中は
      <i>使えません</i>:
      <i>Performa 54xx、 6360、 6400、 PowerComputing PowerTower、 Umax C600、
      Apus 3000</i>
    <li> Open Firmware がサポートしている PCI ビデオカード (<i>ofb</i>)<br>
      ATI、 IMS、 Matrox、 NVIDIA いずれも、 Open Firmware 対応機種を出しています
  </ul>

  <p><li> <strong>オーディオ</strong>
  <ul>
    <li>ほとんどの機種でのオンボード AWACS オーディオ (未テスト) (<i>awacs</i>)
    <li>USB オーディオ (<i>uaudio</i>)
    <li>PCI オーディオカード、ただし、しっかりテストされたのは Ensoniq AudioPCI
        (<i>eap</i>) だけですが
  </ul>

  <p><li> <strong>シリアル</strong>
  <ul>
    <li> オンボード RS-422 シリアルポート (モデムポートは <i>ttya</i>、
      プリンターポートは <i>ttyb</i>)<br>
      オンボードシリアルのサポートは非常に貧弱で、
      システムをハングさせる可能性もあります。
      <i><a href="#badserial">下記</a>参照</i>
    <li> Gee Three Stealth Serial Port および Griffin Technology gPort<br>
      これらはデスクトップ G3 および G4 モデルの内蔵モデムを置き換えるもので、
      シリアルコンソールとして使用可能です
    <li> USB、 PCI、および cardbus ベースのシリアルポート
  </ul>

  <p><li> <strong>USB デバイス</strong>
  <ul><li>増設 USB デバイスの多くに対応しています。
    <a href="../../Hardware/usb.html">機種独立の USB ドライバー</a>のページを
    見てください。
  </ul>

  <p><li> <strong>PCMCIA および CardBus カード</strong>
  <ul><li>多くのカードに対応していますが、 NetBSD/macppc ではテストされていません。
    <a href="../../Hardware/pcmcia.html">機種独立の
    PCMCIA ドライバー</a>や、
    <a href="../../Hardware/cardbus.html">機種独立の Cardbus
    ドライバー</a>のページを見てください。
  </ul>

  <p><li> <strong>PCI カード</strong>
  <ul><li>多くのカードに対応していますが、 NetBSD/macppc ではテストされていません。
    <a href="../../Hardware/pci.html">機種独立の PCI ドライバー</a>
    のページを見てください。
  </ul>
</ul>

<p>
NetBSD/macppc で未対応のものは、

<ul>
  <li> ブート用として以外の (内蔵や USB の) フロッピードライブ
  <li> 電源管理
  <li> 仮想端末やカラーテキストといった、完全な wscons 互換性
  <li> 複数のプロセッサー (2 個目以降の CPU は動作しません)
  <li> ディスク、 CD-RW、スキャナーといった、通常の FireWire (IEEE 1394) デバイス
  <li> オンボードビデオキャプチャー
</ul>

<ENTRY>badserial シリアルポートの使用に問題が起こります!
これは、内蔵シリアルポートがあまりうまく動作しないせいです。実際のところ、
コンソールの使用ぐらいでしかうまく使えません (それすら、
時々不確実になります) 。
<p>
これが修正されるまでは、モデム、 ppp、 palm との同期その他が使えるとは
思わないでください。もし、あなたにシリアルドライバーについての経験があり、
手助けをする気がおありなら、どうか
<a href="mailto:port-macppc@netbsd.org">port-macppc@netbsd.org</a>
までご連絡ください。

<ENTRY>pppmacppc ppp を使う方法は?
うぐぅ。残念なことですが、内蔵シリアルポートが動作しないため、
ppp ドライバーには若干のバグがつぶされずに残っています。

<p>Donald Lee の、 Cyclades PCI カードで ppp を走らせた方法についての
<a href="http://mail-index.netbsd.org/port-macppc/2001/07/26/0023.html">記事</a>
を見てください。

<ENTRY>airport AirPort あるいは AirMac に対応していますか?
はい。ただし NetBSD 1.5.x 以前は非対応です。 -current のソースを使い、
<tt>wi</tt> ドライバーを含んだ
<a href="../../Documentation/kernel/#how_to_build_a_kernel">カーネルを
構築</a>する必要があります。
<p>
新しいカーネルでリブートすれば、
<a href="../../Documentation/network/wavelan.html">Using
WaveLAN IEEE under NetBSD</a> ページの説明に従うことができます。
<p>
AirPort ベースステーションを MacOS でセットアップし、さらに暗号化を
使っている場合には、 <tt>AirPort Admin Utility</tt> を実行し、
ベースステーションを設定し、同じネットワークパスワードを探す必要があります。


<!-- ======================================== -->
<SECTION>Open Firmware

<ENTRY>ofw Open Firmware って何ですか? なぜ注意を払わねばならないのですか ?

手短にいえば、 Open Firmware は FORTH 言語によるコマンド環境であって、
NetBSD カーネルは、システムについての情報の取得や一部のデバイスの
制御のためにこれを使っています。これは、ほとんどの PowerPC ベースの
Macintosh システムでブート ROM に組み込まれており、私たちは
カーネルをディスクやネットワークからロードするためにこれを使っています。

<p>Open Firmware は、 "IEEE Std 1275-1994: IEEE Standard
for Boot Firmware (Initialization Configuration) Firmware: Core
Requirements and Practices" とその補遺で仕様が定められた、
プラットフォーム独立のブートファームウェアです。
Sun の OpenBoot firmware を元にしており、
プロセッサー独立のインターフェース言語である ANS Forth を使っています。

<p>Open Firmware のより詳しい情報は、
<a href="http://playground.sun.com/1275/home.html">Open Firmware
ワーキンググループホームページ</a>や
<a href="http://bananajr6000.apple.com">Apple Computer Open Firmware Home 
Page</a>にあります。

<ENTRY>ofw-version 私の機種の Open Firmware のバージョンは ?

<a href="models.html">対応機種</a>ページを見てください。
あなたの機種が載っていなければ、 Open Firmware を使って確かめられます。
Open Firmware プロンプトで次のようにタイプします:
<pre>0 &gt; <b>dev /openprom .properties</b>
name                    openprom
device_type             BootROM
model                   OpenFirmware 3
relative-addressing     
supports-bootinfo       

 ok</pre>
<p>
ちなみに、 G3 や G4 プロセッサーを積んでいない機種は Open Firmware 1.0.5 か
2.0.x です。内蔵フロッピードライブを持たないデスクトップの機種はすべて
Open Firmware 3 です。内蔵 SCSI を持たないラップトップの機種はすべて
Open Firmware 3 です。

<p><i>注意:</i> Open Firmware 3 のシステムは、 <em>BootROM</em> とも呼ばれる
書き換え可能な "ファームウェア" を持っています。 Apple ファームウェア
アップデーターを使うと、 BootROM をアップデートします。これは、
Open Firmware のバージョンを変えるものでは<b>ありません</b> -
Open Firmware 3 のままです。 BootROM というのは、システムの電源を入れるか
リセットしたときに、最初に実行されるものです。それから BootROM
は Open Firmware をロードし、 Open Firmware がオペレーティングシステムを
ブートします。
<p>
この BootROM
のバージョンは、 MacOS の Apple System Profiler を使うとわかります。
これは、しばしば、ブートして Open Firmware に入ったときに画面の最初の行に
記されます。たとえば、私の PowerBook (FireWire) では、次のように表示されます:

<p><pre>Apple PowerBook3,1 2.1f1 BootROM built on 01/29/00 at 22:38:07
Copyright 1994-2000 Apple Computer, Inc.
All Rights Reserved

Welcome to Open Firmware.
[...]</pre>

<p>これは、 BootROM のバージョンが 2.1f1 であることを示しています。

<ENTRY>ofw-bugs 私の機種の Open Firmware の動作にバグはありますか ?

ありえます。
<p>

Open Firmware 3.0 以降の mac では、<a href="http://asu.info.apple.com/">Apple
Software Updates</a>ウェブサイトから、
その機種用の新しいファームウェア (つまり BootROM) をダウンロードできるかもしれません。
<tt>firmware</tt> を探して、
その機種用の最新のファイルをダウンロードしてください。
BootROM バージョンをもとに Open Firmware バージョンを知る方法については、
<a href="#ofw-version">上記</a>を見てください。
<p>

<i>Apple の 4.1.7 および 4.1.8 ファームウェアに関する警告</i><br>
    最近、 Apple は最近の機種用のファームウェアの新バージョンをリリース
    しました。多くの人のところで、
    サードパーティー製の RAM に関する問題が出ています。
    アップグレードしようとする前に、
    <a href="http://www.macfixit.com/archives/april.01.a.shtml#firm-04-07">
    www.macfixit.com での議論</a>を見てください。
    PowerBook (FireWire) および PowerBook G4 (Titanium) を使っている方は
    <a href="#pb418">上記</a>も参照してください。
    <p>

<i>iMac (Summer 2000) 上の FirmWare Update 4.1.9 に関する警告</i><br>
これらと NetBSD 1.5.2 との組み合わせによって、 CD-ROM とハードドライブが
扱えなくなるとの報告があります。
<a href="#wdc-lost-interrupt">上記</a>参照。<p>

古い (ファームウェアを更新できない) mac でも、
システムにパッチを当てることができます。
Open Firmware には、開発後に見付かった問題を修正するための小さな
nvram 領域があります。ありがたいことに、 Apple は多くの既知の問題を修正して
Open Firmware の変数を変えるための MacOS 用のユーティリティーを作っています。
このユーティリティーによるパッチから、 Open Firmware
を使ってブート可能でないデバイスからのブートができることがわかりました。
<p>

システムにパッチを当てるには、
<a href="ftp://ftp.apple.com/developer/macosxserver/utilities/SystemDisk2.3.1.smi.bin">
SystemDisk</a> をダウンロードして、
ディスクイメージ中の <tt>System Disk</tt> プログラムを実行して、
<tt>Power User (Open Firmware)</tt> をクリックして、
<tt>Save</tt> をクリックするだけです。より詳しい説明は、
<a href="SystemDisk-tutorial">NetBSD/macppc System Disk チュートリアル</a>
を参照してください。

<p>Note: <i><tt>Command-Option-P-R</tt> で PRAM をクリアすると、
nvram のパッチは消えます。</i>
<p>Note 2: <i>Open Firmware 1.0.5 の機種で MacOS を起動すると、
nvram のパッチは消えます。</i>
<p>

Open Firmware 1.0.5 の機種では、追加の
<a href="SystemDisk-tutorial/of105patch.html">パッチ</a>があり、
System Disk ユーティリティーには<i>ない</i>修正を施すことができます。

<ENTRY>ofw-access Open Firmware プロンプトに入る方法は?

<a href="ftp://ftp.NetBSD.ORG/pub/NetBSD/NetBSD-1.5.2/macppc/INSTALL.html">NetBSD 
1.5.2 インストールノート</a>を読んでください。特に、
"Getting to the Open Firmware Prompt" の節まで読んでください。

<p>これが面倒な方は、 Apple の <tt>System Disk</tt> を使って、
マシン起動時は常に Open Firmware に入るよう設定することができます。
この方法については簡単な<a
href="SystemDisk-tutorial/">チュートリアル</a>をご覧ください。ただし、<a
href="models.html#no.sysdisk">System Disk がお使いの機種で使えない</a>
場合を除きます。

<ENTRY>ofw-boot-serial Open Firmware に入ろうとすると、ブートが止まり、モニターに何も表示されなくなります。

<a href="ftp://ftp.NetBSD.ORG/pub/NetBSD/NetBSD-1.5.2/macppc/INSTALL.html">NetBSD 
1.5.2 インストールノート</a>を読みませんでしたね? 特に、
"Older Open Firmware System Preparation" の節は読んでください。
やや長たらしいですが、 Open Firmware をセットアップするための適切な手順を
非常に明解に説明しています。

<p>簡単にいうと、あらゆる Open Firmware 1.0.5 のシステムおよびほとんどの
Open Firmware 2.0.x のシステムは、デフォルトのコンソールとして、
ADB キーボードやオンボードビデオに接続されたモニターではなく
`Modem' シリアルポートを使うようになっています。
MacOS ベースのユーティリティーを使ってこれらを適切に設定するか、
そうでなければ、キーボードとスクリーンで使えるよう
一時的にシリアルコンソールから制御を奪う必要がある<i>でしょう</i>。

<p>これ以外では、
<a href="#ofw-boot-video">PCI ベースのビデオカード</a>を使おうとした場合、
画面が真っ黒になるのは、 <tt>output-device</tt> のパスの入力を打ち間違えたか、
そのビデオカードが Open Firmware に対応していないかのどちらかのせいです。

<ENTRY>ofw-boot-video PCI ビデオカードを使う方法は?
Macintosh や互換機の一部機種 (PowerMacintosh 9500 と 9600、 PowerComputing
PowerTowerPro および Umax S900 など) は、オンボードのビデオインターフェースを
持っていません。これらの機種では、 PCI スロットの一つにビデオカードが
挿されて出荷されています。

<p>この節では、 Open Firmware に PCI ベースのビデオカード
を使うようにさせる方法を、 (お使いのコンピューターとビデオカードを
別々に購入した場合と、カードがもとから附属していた場合の両方について)
説明します。いずれの場合も、使おうとしているビデオカード自体が
Open Firmware に対応している必要があります。

<p>
Open Firmware が使うデバイスパスは、カードとそれが挿さっている PCI
スロットによって異なります。お使いのビデオカードのパスと、
それを使うように Open Firmware に伝える方法を調べておく必要があります。
<p>
<ol>
 <li>ブートして Open Firmware (つまり <tt>0 &gt;</tt> プロンプト) に入る<br>
  古い機種ではシリアルコンソールを使う必要があるかもしれません
 <li><pre>0 &gt; <b>dev / ls</b></pre>
  これで、お使いのシステムの全デバイスの一覧が表示されます。ビデオカード
  に合致する項目を探します。たとえば、 PowerMacintosh 9500/150 での一覧を
  抜粋します:
<pre>0 &gt; <b>dev / ls</b>
  [...]
FF8313F0: /bandit@F4000000
  [...]
FF83F8A0:   /ATY,mach64@D
  [...]
 ok</pre>
おおむね、 Open Firmware 対応のカードでは、
ベンダー名に似た 4 文字のベンダー ID (ATI では <tt>ATY</tt>、 IMS では
<tt>IMS</tt>、 Adaptec では <tt>ADPT</tt> というように) が表示され、
また、文字列でカードの機種を表します。
"@" 記号は、カード名とそのコンピューターでのアドレスを区切っています。

<p>ここで、 <tt>/ATY,mach64@D</tt> の項目が <tt>/bandit@F4000000</tt>
よりも字下げされていることに注意してください。これは、 <tt>bandit</tt>
デバイスが <tt>ATY</tt> デバイスを含んでいることを意味しています。
この場合、 <tt>/bandit@F4000000</tt> は PCI バスの Open Firmware での名前で、
ATI カードはその PCI バス上にあります。

<li><p>よって、上記の情報により、お使いの機種で Mach64 カードを
Open Firmware 出力デバイスにするよう設定するためには、以下のように
タイプすればよいことになります:
<pre>0 &gt; <b>setenv output-device /bandit@F4000000/ATY,mach64@D</b> ok
0 &gt; <b>reset-all</b></pre>

</ol>

<p>ビデオカードに接続したモニターが、コンピューターのリセット後に真っ暗な
ままになる場合、問題があります (カードのパスを打ち間違えたか、
カードが実は Open Firmware に対応していないのかもしれません) 。


<ENTRY>non-sync-monitor ブート時に、モニターが同期しないことがあります
これは PowerMacintosh 7300 - 8600 の機種での問題で、
ビデオ信号が十分早く決定されないために起こります。
Open Firmware 1.0.5 用の<a
href="SystemDisk-tutorial/of105patch.html">パッチ</a>を当てるべきです。

<p>
Twentieth Anniversary Macintosh をお使いの場合、解決策はわかっていません。
この問題については、
<a href="http://mail-index.netbsd.org/port-macppc/2001/04/26/0008.html">この
投稿記事</a>の説明を見てください。
現時点では、この機種へのインストールの成功例の報告はありませんが、
<a href="SystemDisk-tutorial/">System Disk</a> で input と output デバイスを
<tt>ttya</tt> に設定し、端末エミュレーターの動くマシンを
シリアルケーブルでつなげば、うまくいくはずです。


<ENTRY>ofw-use Open Firmware プロンプトで何ができるか?
<a name="ofw-misc">
コンピューターのブートに関するさまざまな状態を設定することができます。</a>
この表は、あなたが使う可能性のある主なコマンドの単なる一覧とその文法です。

<table border=1 cellpadding=5>
<tr><th>コマンド名</th><th>注釈</th></tr>
<tr><td><tt>dev <i>device</i></tt></td><td>Open Firmware デバイスツリー上での
  カレント <i>device</i> の変更 (ファイルシステム上の <tt>cd</tt> に類似)</td></tr>
<tr><td><tt>ls</tt></td><td>デバイスツリー上でのカレントノード以下のデバイスの列挙
  (ファイルシステム上の <tt>ls</tt> に類似)</td></tr>
<tr><td><tt>pwd</tt></td><td>デバイスツリー上でのカレントノードの場所の列挙
  (ファイルシステム上の <tt>pwd</tt> に類似)</td></tr>
<tr><td><tt>words</tt></td><td>デバイスツリー上でのカレントノードにおいて
  使用可能な FORTH コマンドの列挙<br>
  ブートするためには、デバイスが少なくとも `<tt>open</tt>' を含む必要あり</td></tr>
<tr><td><tt>.properties</tt></td><td>デバイスツリー上でのカレントノードの
  状態を列挙</td></tr>
<tr><td><tt>printenv</tt></td><td>Open Firmware 環境変数の現在および
  デフォルトの設定値を表示</td></tr>
<tr><td><tt>setenv <i>variable</i> <i>value</i></tt></td><td>Open Firmware
  <i>variable</i> 変数に新たに値 <i>value</i> を設定する。
  <a href="#ofw-variables">Open Firmware 変数</a>一覧については
  下記参照</td></tr>
<tr><td><tt>set-default <i>variable</i></tt></td><td><i>variable</i> 変数値を
  デフォルト値に設定する。
  <a href="#ofw-variables">Open Firmware 変数</a>一覧については
  下記参照</td></tr>
<tr><td><tt>boot <i>boot-device</i> <i>boot-file</i></tt></td><td>プログラム
  <i>boot-file</i> を <i>boot-device</i> からロード・実行する。これを使って
  <tt>ofwboot</tt> ("partition zero" ブートローダー) または
  <tt>ofwboot.xcf</tt> をロードし、それから NetBSD カーネルをロードします</td></tr>
<tr><td><tt>dir <i>device</i></tt></td><td><i>device</i> にあるファイルの列挙
  (unix の <tt>ls</tt> と同じ)</td></tr>
<tr><td><tt>eject fd</tt></td><td>フロッピーディスクの排出</td></tr>
<tr><td><tt>reset-all</tt></td><td>Open Firmware 環境変数を永久に保持し
  コンピューターをリブートする</td></tr>
<tr><td><tt>shut-down</tt></td><td>Open Firmware 環境変数を永久に保持し
  コンピューターの電源を落とす</td></tr>
<tr><td><tt>bye</tt></td><td>Open Firmware 1.0.5、 2.0.x、 2.x
  のシステムで MacOS をブートする</td></tr>
<tr><td><tt>mac-boot</tt></td><td>Open Firmware 3 のシステムで
  MacOS をブートする</td></tr>
<tr><td><tt>devalias <i>alias</i> <i>device</i></tt></td><td>デバイス
  <i>device</i> の別名として <i>alias</i> を設定または修正
  (<tt>csh</tt> や眷族の <tt>alias</tt> に類似)<br>
  オプションがない場合は、現在のデバイスの別名をすべて列挙</td></tr>
</table>

<p>また、 Open Firmware を使う上で便利なキーストロークを
いくつか掲げます:
<table border=1 cellpadding=5>
<tr><th>キーストローク</th><th>機能</th></tr>
<tr><td>Backspace</td><td>後方の 1 文字を消去</td></tr>
<tr><td>Delete</td><td>後方の 1 文字を消去</td></tr>
<tr><td>^h</td><td>後方の 1 文字を消去</td></tr>
<tr><td>^d</td><td>前方の 1 文字を消去</td></tr>
<tr><td>Enter</td><td>FORTH パーサーに行を渡す</td></tr>
<tr><td>^b</td><td>1 文字戻る</td></tr>
<tr><td>^f</td><td>1 文字進む</td></tr>
<tr><td>ESC b</td><td>1 単語戻る</td></tr>
<tr><td>ESC f</td><td>1 単語進む</td></tr>
<tr><td>^a</td><td>行の先頭に戻る</td></tr>
<tr><td>^e</td><td>行の終端に進む</td></tr>
<tr><td>ESC h</td><td>単語の先頭までを消去・保持</td></tr>
<tr><td>^w</td><td>単語の先頭までを消去・保持</td></tr>
<tr><td>ESC d</td><td>単語の終端までを消去・保持</td></tr>
<tr><td>^k</td><td>行の終端までを消去・保持</td></tr>
<tr><td>^u</td><td>行をすべて消去・保持</td></tr>
<tr><td>^r</td><td>行を打ち直す</td></tr>
<tr><td>^q</td><td>次の文字を引用</td></tr>
<tr><td>^y</td><td>カーソルの前に保持されていた文字列を挿入</td></tr>
<tr><td>^p</td><td>履歴中の、前の行</td></tr>
<tr><td>^n</td><td>履歴中の、次の行</td></tr>
<tr><td>^l</td><td>履歴を表示</td></tr>
<tr><td>^space</td><td>単語が単一の補完候補を持つ場合は、そのように補完。
単語が複数の補完候補を持つ場合は、補完可能なところまで補完。
単語がまったく補完可能でない場合は、少なくともひとつの補完候補があるところまで
文字を消去。
<tr><td>^/</td><td>単語の補完候補 (ないこともある) を表示</td></tr>
<tr><td>^?</td><td>単語の補完候補 (ないこともある) を表示</td></tr>

<tr><td>^@</td><td>^space と同じ (Apple 特有)</td></tr>
<tr><td>^o</td><td>^/ と同じ (Apple 特有)</td></tr>
<tr><td>^\</td><td>^b と同じ (Apple 特有)</td></tr>
<tr><td>^]</td><td>^f と同じ (Apple 特有)</td></tr>
<tr><td>^^</td><td>^p と同じ (Apple 特有)</td></tr>
<tr><td>^_</td><td>^n と同じ (Apple 特有)</td></tr>
</table>

<p>このほか、 <a href="nvedit.html">NetBSD/macppc nvedit HOW-TO</a>、
<a href="http://karchive.info.apple.com/article.html?artnum=60285">Apple 
Network Server 500,700: Open Firmware Read Me</a> technote、
<a href="http://bananajr6000.apple.com/">Apple Computer Open Firmware Home
Page</a>
<a href="http://developer.apple.com/technotes/tn/tn2001.html">"Technote 
2001 - Running files from a hard drive in Open Firmware</a>と、
and the <a href="http://playground.sun.com/1275/home.html">Open Firmware
Working Group home page</a> も併せて参照してください。

<ENTRY>ofw-variables 関連する Open Firmware の変数
Open Firmware が利用したり保持したりしてブートに影響を与える変数が存在します。
これらの変数を変更するには、 <tt>printenv</tt>、 <tt>setenv</tt>、
<tt>set-default</tt> コマンドを使う (<a href="#ofw-use">上記参照</a>) か、
MacOS SystemDisk ユーティリティーを使います (
<a href="SystemDisk-tutorial/">チュートリアル</a>参照) 。
<tt>nvramrc</tt> 上の変数を変更するには、 <a href="nvedit.html">NetBSD/macppc
nvedit HOW-TO</a> で説明しているコマンドを使います。このほか、 ResEdit
を使って System Disk をいじくることもできます。 <tt>OFtc</tt> リソースを見て、
System Disk が使っているお使いの機種用の ID を調べてください。それから、
対応する <tt>OFpt</tt> リソースを編集します。

<p>設定を変更した後は、その変更を保存するため、以下のようにタイプするよう
注意してください:
<pre>0 &gt; <b>reset-all</b></pre>

<p><table border=1>
<tr><th>変数名</th><th>通常の値</th><th>機能</th></tr>
<tr><td><tt>auto-boot?</tt></td><td>false</td>
  <td><tt>false</tt> の場合は、コンピューターのリセット時に
  Open Firmware プロンプトで停止</td></tr>
<tr><td><tt>use-nvramrc?</tt></td><td>true</td>
  <td><tt>true</tt> の場合は <tt>nvramrc</tt> で設定されたコマンドを実行</td></tr>
<tr><td><tt>real-base</tt></td><td><tt>F00000 </tt> (Open Firmware &lt; 3 用)<br>
  <tt>-1 </tt> (Open Firmware 3 ではデフォルト値を使用)</td>
  <td><a href="#ofw-real-base">下記参照</a></td></tr>
<tr><td><tt>load-base</tt></td><td><i>デフォルト値を使用</i></td>
  <td><a href="#ofw-load-base">下記参照</a></td></tr>
<tr><td><tt>boot-device</tt></td><td><i>下記参照</i></td>
  <td>ブートローダーをロードするデバイス</td></tr>
<tr><td><tt>boot-file</tt></td><td><i>下記参照</i></td>
  <td>ブートローダーがロードすべきファイル</td></tr>
<tr><td><tt>input-device</tt></td><td><i>下記参照</i></td>
  <td>ADB キーボード、 USB キーボード、またはシリアルコンソール</td></tr>
<tr><td><tt>output-device</tt></td><td><i>下記参照</i></td>
  <td>オンボードビデオ、 PCI ビデオ、またはシリアルコンソール</td></tr>
<tr><td><tt>nvramrc</tt></td><td><i>System Disk によって入力された値</i></td>
  <td><tt>use-nvramrc?</tt> が <tt>true</tt> に設定されている場合に、
  コンピューターのリセット時に実行される FORTH コマンド群</td></tr>
<tr><td><tt>boot-command</tt></td><td>boot</td>
  <td><tt>auto-boot?</tt> が <tt>true</tt> に設定されている場合に実行されるコマンド</td></tr>
</table>

Note: <i><tt>Command-Option-P-R</tt> で PRAM をクリアすると、
すでに設定した Open Firmware の変数はすべて消えます。</i>
<p>
Note 2: <i>Open Firmware 1.0.5 の機種で MacOS をブートすると、
すでに設定した Open Firmware の変数はすべて消えます。</i>
<p>
Note 3: <i>極端な場合、 Open Firmware の設定によって
マシンが起動しなくなることもあります。これは PRAM クリアでは直りません。
この場合は、電源を抜き、 10 分間ほどマザーボードから電池を外します。
PowerBook の場合は power manager をリセットします。</i>

<ENTRY>ofw-load-base "load-base" の設定の問題
Open Firmware の環境変数 <tt>load-base</tt> は、
XCOFF バイナリーがメモリー上にロードされるアドレスです。
Open Firmware 1.0.5 と 2.X でのデフォルト値は 4000 です。
このアドレスが使われていると、
<tt>ofwboot.xcf</tt> で Open Firmware が上書きされ、 NetBSD をロードしません。
Open Firmware 1.0.5 や 2.X の機種では、 <tt>load-base</tt> を
安全なアドレスの範囲である 600000 にすることをおすすめします。
Apple は MacOS X に同じ問題があることを知っており、 <a
href="SystemDisk-tutorial/">System Disk</a> ユーティリティーは
Open Firmware 1.0.5 および 2.X の機種では自動的に <tt>load-base</tt> を
600000 に設定します。
mkLinux では異なる <tt>load-base</tt> 値を使いますが、
この値を使ってはいけませんので注意してください。
<p>
Open Firmware 3 の機種は書き換え可能なファームウェアを持っていますが、
<tt>load-base</tt> を 600000 に設定すると、ファームウェアを上書きして
マシンを壊してしまう (Apple での高価な修理が必要になる) ことがわかりました。
<b> Open Firmware 3 な機種で <tt>load-base</tt> を変更してはなりません。</b>
Apple は、 Open Firmware 3 では、 <tt>load-base</tt> のデフォルト値を
最適な値にしたので、どんな場合でも変更する必要はありません。
<p>
load-base を設定する必要があるのは、 Open Firmware から直接に
ofwboot.xcf をブートしようとする場合だけです。
installboot や NetBSD のインストーラーは、ファイルシステムが
<tt>ofwboot.xcf</tt> を含むようには設定<i>しない</i>ことに注意してください。
この場合、ファイルシステムは、パーティションマップにおいて、
細工された Apple パーティションマップのエントリーと ofwboot を持つようになります。
これら別種のブートローダーには、 <tt>ofwboot.xcf</tt> のような問題はありません。
このため、ブートデバイスとして、たとえば
<tt>scsi/sd@0:0</tt> や <tt>fd:0</tt> を使う場合、
<tt>ofwboot.xcf</tt> は使わないので、 <tt>load-base</tt> を設定する必要は
ありません。
<p>
その機種の Open Firmware が 1.0.5 か 2.X であるかを確認してから
(<a href="#ofw-version">上記</a>参照) 、下記のコマンドを実行して
<tt>load-base</tt> を適切に設定します
(System Disk はこれを自動的に行うことを、覚えておいてください):

<pre>0 &gt; <b>setenv load-base 600000</b></pre>

正しく設定されたか、 <tt>printenv</tt> コマンドで再確認すべきです。

<ENTRY>ofw-real-base "real-base" の設定の問題
Open Firmware の環境変数 <tt>real-base</tt> は、
<tt>ofwboot</tt> がカーネルをメモリー上にロードするアドレスです。
多くのユーザーからの報告によれば、
<tt>real-base</tt> のデフォルト値では、
あたかも SCSI に妙な問題があるような挙動を示したり、
大きな (通常 3 MB を超える) カーネルのロード中に
<tt>ofwboot</tt> がハングしたりするとのことです。
藤原誠氏の
<a href="http://mail-index.netbsd.org/port-macppc/2000/08/13/0004.html">報告</a>によれば、 
この問題は <tt>real-base</tt> を変えると修正できます。
<p>
Open Firmware 3 の機種は書き換え可能なファームウェアを持っていますが、
<tt>real-base</tt> を変更すると、ファームウェアを上書きして
マシンを壊してしまう (Apple での高価な修理が必要になる) ことがわかりました。
<b> Open Firmware 3 な機種で <tt>real-base</tt> を変更してはなりません。</b>
いずれにせよ、 Open Firmware 3 は、大きなカーネルに関してもうまく動作するので、
この件は問題にはなりません。
<p>
その機種の Open Firmware が 1.0.5 か 2.X であるかを確認してから
(<a href="#ofw-version">上記</a>参照) 、下記のコマンドを実行して
<tt>real-base</tt> を適切に設定します (注意: System Disk はこの変数を
適切に設定<b>しません</b> ─ System Disk を使うたびに、 <tt>real-base</tt>
を設定しなおす必要があります):
<pre>0 &gt; <b>setenv real-base F00000</b>
0 &gt; <b>reset-all</b></pre>
<p>
正しく設定されたか、 <tt>printenv</tt> コマンドで再確認すべきです。
<p>
この問題への次善策は、カーネルを再構築して、サイズを 3 MB より
小さくすることです。 Open Firmware 1.0.5 や 2.X の機種には内蔵 USB がないため、
PCI USB インターフェースがなければ、 USB ドライバーを含めずに
カーネルを作れます。


<ENTRY>ofw-boot-keys ほかに、ブートシーケンスを変更する特殊なキーはありますか ?

よく知られた、 PRAM をクリアするための Command-Option-P-R (これは
Open Firmware の設定も消します) や、
若干知名度が劣る、最初のブートデバイスからブートするための
Command-Option-Shift-Delete のほか、
いくつかの機種では次のようなキーが有効です。
内蔵 CD-ROM ドライブからブートする "C" 、
ネットブートする "N" 、内蔵 Zip ドライブからブートする "Z" 、
デフォルトのブートデバイスを無視して強制的に内蔵ディスクからブートする "D" 。
(これらは Apple の文献で "snag keys" として参照されています。)

<p>実際には、これらはそれぞれ Open Firmware のデバイスの別名
"cd", "enet", "zip", "hd" を使っているので、デバイスの別名を変えると
これらのキーの効果も変わります。機種によっては使えないキーもあります。


<SECTION>ブート

<ENTRY>boot-support NetBSD/macppc をブートするにはどんな方法がありますか ?

NetBSD/macppc は Open Firmware を使ってブートするので、
MacOS がブートできるすべてのデバイスからブートできます。
これには、あらゆる SCSI や IDE ドライブ (コントローラーが対応しているもの) 、
内蔵フロッピー、 CD-ROM が含まれます。
(<a href="../../Sites/cdroms.html#netbsdmissionrelease">NetBSD
Mission 1.5 Release CD-ROM</a> は macppc でブート可能です。)

<p>イーサネットハードウェアが Open Firmware のブートに対応していれば、
NetBSD (MacOS でも) をネットワーク経由でブートすることもできます。
すべての対応機種の内蔵イーサネットはネットブートに対応しています。
Asante は Open Firmware 対応の PCI イーサネットカード (10NIC PCI)
を製造していますが、ブート後の NetBSD が対応しているかは不明です。
NetBSD のブートに対応した Adaptec の PCI SCSI カードがいくつかあります。
PCI カードからのブートについては<a href="#boot-pci">下記</a>
を参照してください。


<p>Macintosh 用でない SCSI カードやブート可能でない Macintosh 用 SCSI カード
に接続された SCSI ドライブからは、
たとえその SCSI カードが NetBSD でサポートされていても、ブートはできません。
また、 Open Firmware は内蔵 USB を持つ初期の機種では
あらゆる USB デバイスからのブートに対応しません。
誰も試していませんが、最近の機種では USB ハードドライブからのブートが可能なはずです。

<p>
さらにややこしいことに、
NetBSD カーネルは 3 段階を経てロードされ、各段階について設定が必要です。

<table border=1>
<tr><td>段階名</td><td>OF 1.0.5 and 2.0.X</td><td>OF 2.4</td><td>OF 3</td>
<td>機能</td></tr>

<tr><td><tt>bootxx</tt></td>
<td>yes (optional)</td>
<td>yes (optional)</td>
<td>no</td>
<td>単純な初期段階のブートローダーで、ディスクのパーティション "zero"
に置かれ、 <tt>ofwboot.xcf</tt> をロードする。<br>
この実体は Apple Partition Map のあるべき場所に置かれるため、
<tt>bootxx</tt> を使うドライブでは MacOS と NetBSD は共存できない。</td></tr>

<tr><td><tt>ofwboot.xcf</tt></td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>必須のブートローダー (Open Firmware が扱えるファイルシステムから、または
<tt>bootxx</tt> によって、またはイーサネット経由でロードされる) で、
NetBSD ファイルシステムとディスクラベルを扱え、
ELF カーネル (gzip されていてもよい) をロードできる</td></tr>

<tr><td><tt>netbsd</tt></td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>NetBSD の動作に必要なカーネル。
<tt>ofwboot.xcf</tt> によりロードされる。
Open Firmware 3 の機種では、 Open Firmware が扱えるファイルシステムから直接、
またはイーサネット経由でカーネルをロード可能</td></tr>
</table>

<p>
いずれにせよ重要なことは、どのバージョンの Open Firmware も、
NetBSD が使うファイルシステムを扱えないということがです。
このため、 Open Firmware が扱えるファイルシステム上に必要なファイルを
置かねばなりません。<p>
<table border=1>
<tr><td>ファイルシステムの種類</td><td>OF 1.0.5 and 2.0.X</td><td>OF 2.4</td><td>OF 3</td>
<td>解説</td></tr>

<tr><td>"partition zero"</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td><tt>bootxx</tt> の置き場。現在、 <tt>bootxx</tt>
は Open Firmware 3 マシンに非対応。</td></tr>

<tr><td>ethernet</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>詳しくは <a href="../../Documentation/network/netboot/">The Diskless
HOW-TO</a> 参照</td></tr>

<tr><td>ISO 9660</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>標準的な CD-ROM フォーマット。詳しくは<a href="#boot-cd">下記</a>参照。
</td></tr>

<tr><td>floppy</td>
<td>yes</td>
<td>maybe</td>
<td>no</td>
<td>Open Firmware 3 の機種にはフロッピードライブがない。 Open Firmware
2.4 の機種ではフロッピーからのブートに問題があると報告されている。
フロッピーイメージの書き込み方は<a href="#write-floppy">下記</a>参照。
</td></tr>

<tr><td>MS-DOS</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>ただし、ブートローダー <tt>ofwboot.xcf</tt> は
MS-DOS ファイルシステムを扱えず、
カーネルを MS-DOS ファイルシステムからロードできないことに注意。
</td></tr>

<tr><td>HFS and HFS+</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>ただし、 NetBSD は HFS ファイルシステムを扱えず、
ブートローダーやカーネルを HFS 上に置いた場合は、これらのアップグレードには
MacOS や<a
href="ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/sysutils/hfsutils/README.html">
hfsutils</a> が必要なことに注意。
</td></tr>
</table>
<p>


この説明で、あなたの疑問を解消できれば幸いです。



<ENTRY>boot-disk ディスクをブート可能にする方法と、それをブートさせるための Open Firmware のコマンドは ?

これは Open Firmware のバージョンに完全に依存します。 Open Firmware
のバージョンの調べ方は、<a href="#ofw-version">上記</a>を見てください。
<p>

<ul>
<li><h4>Open Firmware 1.0.5 と 2.0.X:</h4> このバージョンの Open Firmware
 では、 ISO 9660 ディスク、 MS-DOS ディスク、ネットワークと、
"whole" disks (partition "0") からの XCOFF バイナリーによるブートのみ可能です。
"whole" disks 用として、第二段階のブートローダー (<tt>ofwboot.xcf</tt>) をロードするだけの大変シンプルな <tt>bootxx</tt> プログラムがあります。
<tt>bootxx</tt> ブートローダーは MacOS パーティションテーブルと同じ場所にインストールする必要があります。
このため、当然ながら、 NetBSD が MacOS とともに "whole" disks を共有して使うことは不可能です。
<p>
NetBSD/macppc には、 ELF カーネルをロードするため、専用の
XCOFF ブートローダーがあります。
この XCOFF ブートローダーが前提としている "load-base" 値を使うように
Open Firmware が設定されているか、確認してください。
この設定は (Open Firmware で)
"<tt>setenv&nbsp;load-base&nbsp;600000</tt>" とタイプします。
Open Firmware にこの XCOFF プログラムをロードさせるため、
次のいずれかが必要です:
<p>

<ul>
<li><a href="../../Documentation/network/netboot/">Diskless
HOW-TO</a> に従い、 <tt>ofwboot.xcf</tt> をネットワーク経由でロードする<br>
<tt>boot&nbsp;enet:,\ofwboot.xcf</tt>
<p>

<li><tt>installboot</tt> プログラムを使い、 <tt>bootxx</tt> と <tt>ofwboot</tt>
をインストールする (NetBSD/macppc インストーラーはこれを自動的に行います) 。
これを NetBSD/macppc 上で手動で行うには次のようにします:<br>
<tt>cp /usr/mdec/ofwboot </tt><em>bootfile</em><br>
<tt>/usr/mdec/installboot </tt><em>bootfile</em><tt> /usr/mdec/bootxx
</tt><em>bootdev</em>
<p>

ここで、 <em>bootfile</em> は、ブート可能とするディスクの
ルートファイルシステム上の "<tt>/boot</tt>" ファイルのパス、
<em>bootdev</em> は、このファイルを含むデバイスの raw デバイスノードです。
<p>

そして、フロッピーかネットワークからブートするのでなく、
ファイルシステム (sd0 とします) が /mnt にマウントされている場合、次のようにします:

<pre>
	cp /usr/mdec/ofwboot /mnt/boot
	/usr/mdec/installboot /mnt/boot /usr/mdec/bootxx /dev/rsd0a
</pre>
<p>

installboot が raw デバイスとマウントされたファイルシステムの双方に
アクセスする必要があるため、この作業はシングルユーザーモードで、または
"options INSECURE" としたカーネルの下でしかできないことに注意してください。
<p>

<li><tt>ofwboot.xcf</tt> を ISO 9660 フォーマットの CD-R の最上層に置きます。
これを SCSI CD-ROM ドライブを使って ISO 9660 フォーマットからロードするには、
次のようにします:<br>
<tt>boot&nbsp;scsi/sd@3:0,ofwboot.xcf</tt>
<p>

詳しくは<a href="#boot-cd">下記</a>を見てください。
<p>

<li><tt>bootxx</tt> と <tt>ofwboot.xcf</tt> を
(NetBSD/macppc インストールフロッピーのように) フロッピーディスクに置いて、<br>
<tt>boot fd:0</tt>

<li><tt>ofwboot.xcf</tt> をDOS フォーマットのフロッピーディスクに置く<br>
<tt>boot fd:1,ofwboot.xcf -a</tt><br>
ofwboot は (カーネルと違って)
DOS ファイルシステムからファイルをロード<i>できない</i>ことに注意。
</ul>

<p><li><h4>Open Firmware 2.4:</h4> このバージョンの Open Firmware は、
HFS や HFS+ ディスク、 ISO 9660 ディスク、 MS-DOS ディスクと、
ネットワーク経由での XCOFF イメージでのブートにのみ対応しています。 
旧バージョンの Open Firmware 用の <tt>installboot</tt> プログラムは使えません。
<p>NetBSD/macppc には、 ELF カーネルをロードするための専用の
XCOFF ブートローダーがあります。
XCOFF ブートローダーが前提としている "load-base" 値を
Open Firmware が使うようにしなければなりません。
この設定は (Open Firmware で)
"<tt>setenv&nbsp;load-base&nbsp;600000</tt>" とタイプします。
Open Firmware にこの XCOFF プログラムをロードさせるため、
次のいずれかが必要です:
<p>

<ul>
<li><a href="../../Documentation/network/netboot/">Diskless
HOW-TO</a> に従い、 <tt>ofwboot.xcf</tt> をネットワーク経由でロードする<br>
<tt>boot&nbsp;enet:0,\ofwboot.xcf</tt>
<p>

<li><tt>ofwboot.xcf</tt> を MacOS フォーマットのドライブの
HFS または HFS+ フォーマットのパーティションの最上層に置く
(バイナリーモードで転送するよう注意) 。
<p>

<li><tt>ofwboot.xcf</tt> を、 ISO 9660 フォーマットの CD-R の最上層に置きます。<p>

詳しくは<a href="#boot-cd">下記</a>を見てください。
<p>

<li><tt>ofwboot.xcf</tt> を DOS フォーマットのフロッピーディスクに置く<br>
<tt>boot fd:1,ofwboot.xcf -a</tt><br>
ofwboot は (カーネルと違って)
DOS ファイルシステムからファイルをロード<i>できない</i>ことに注意。
</ul>

<p><li><h4>Open Firmware 3.0 以降:</h4> このバージョンの Open Firmware は、
次のいずれかからの ELF バイナリーのロードのみに対応しています:
HFS と HFS+ のディスク、 MS-DOS のディスク、ネットワーク
<p>
NetBSD/macppc には、カーネルをロードするための専用の ELF ブートローダーがあります。
また、これらの機種では ELF カーネルを直接ロードすることもできますので、
Open Firmware にこれら ELF プログラムをロードさせるため、
次のいずれかが必要です:
<p>

<ul>
<li><a href="../../Documentation/network/netboot/">Diskless
HOW-TO</a> に従い、 <tt>ofwboot.xcf</tt> か <tt>netbsd</tt> をネットワーク経由で
ロードします。<br>
<tt>boot&nbsp;enet:0,\ofwboot.xcf</tt>
<p>

<li><tt>ofwboot.xcf</tt> か <tt>netbsd</tt> を MacOS でフォーマットした
ドライブの HFS か HFS+ のパーティションの最上位にコピーします。
(バイナリーモードで転送する必要があることに注意)<br>
<tt>boot hd:,ofwboot.xcf</tt>
<p>

<li><tt>ofwboot.xcf</tt> と <tt>netbsd</tt> を
HFS/ISO 9660 ハイブリッド CD-R の最上層にコピーします。<br>
<tt>boot cdrom:ofwboot.xcf</tt>
<p>
詳しくは<a href="#boot-cd">下記</a>を見てください。
</ul>
</li>
</ul>



<ENTRY>write-floppy フロッピーイメージを書き込む方法は ?
raw イメージをフロッピーディスクに書き込む方法はいくつかあります:
<ul>
<li>NetBSD などの unix 環境下で dd(1) を使う。
<li>DOS/Windows マシンで
  (<a href="../i386/">NetBSD/i386</a> と共に配布されている) rawrite.exe を使う。
<li>MacOS で
<a href="ftp://ftp.netbsd.org/pub/NetBSD/arch/macppc/floppy/README.rawdisk">suntar</a> 
  を使う。
</ul>

<p>このフロッピーは、 MacOS のフロッピーブートのような使い方は
できないことに注意: Open Firmware に入って
"<tt>boot fd:0</tt>" とタイプしなければなりません。

<ENTRY>boot-pci PCI card からブートする方法は ?
いくつかの PCI カードは Open Firmware のドライバーを持っており、
そのカード経由でブートできます。
特に、 Asante は Open Firmware ドライバーを持つイーサネットカードを作っており、
また、ほとんどの Adaptec の SCSI カードは Open Firmware
ドライバーを持っています。注意すべきは、あるカードが Open Firmware
で動作することは、そのカードが NetBSD でサポートされていることを意味しない
(その逆も同様) ということです。
<p>
まず最初に、 PCI カードの Open Firmware での名前を確認します。
Apple は、各機種共通の内蔵デバイスには (scsi, hd, enet のように)
別名を付けています。
サードパーティー (つまり PCI カードのメーカー) はそういうことができません。
Open Firmware のドライバーを持つすべてのデバイスのリストを得るには、
Open Firmware プロンプトで次のようにタイプします:<br>
<tt>0 &gt; <b>dev / ls</b></tt>
ここで、デバイス名がどうなっているかが問題です。
普通、ベンダー名はデバイス名に含まれていて、
<tt>/pci/pci-bridge@d/ADPT,2930@3</tt> のようになります
(ADPT は Adaptec 製品を表し、機種は 2930 です) 。
<p>
次に、そのデバイスがブート可能かどうか確認する必要があります。
ブートするには Open Firmware の "word" で <tt>open</tt> が必要です。
このデバイスがサポートする Open Firmware "words" から調べることができます:<br>
<tt>0 &gt; <b>dev /pci/pci-bridge@d/ADPT,2930@3</b><br>
0 &gt; <b>words</b></tt>
<p>
リスト中に "open" があれば、
そのデバイスは Open Firmware からブート可能のはずです。
ブートするには、次のようにします:<br>
<tt>0 &gt; <b>boot /pci/pci-bridge@d/ADPT,2930@3/@5:0</b></tt><br>
ここで 5 はブートしようとしているドライブの SCSI ID 、
0 はパーティション番号です。
<p>
注意: 実質的にはアットマーク以降のアドレスがすべてであり、
<tt>/pci/pci-bridge@d/ADPT,2930@3</tt> は <tt>/pci/@d/@3</tt> のように
短縮することができます。

<p><i>Adaptec 2940 シリーズの SCSI カードに関する注意</i>。このシリーズの
SCSI カードのファームウェアには三つのバージョンがあります。このカードを
PowerMacintosh 7300 から 9600 で使う場合、このカードは Open Firmware からの
ブートには使えません。より詳しい情報は、
<a href="http://mail-index.netbsd.org/port-macppc/2001/04/27/0000.html">この
投稿記事</a>を参照してください。

<ENTRY>boot-net netboot の設定は ?

<a href="../../Documentation/network/netboot/">Diskless NetBSD
HOW-TO</a> を見てください。

<p>Mitchell Spector も、簡単な<a
href="http://www.enchantedlearning.com/tech/netbsd_imac.shtml">iMac 向け
netboot 情報</a>を含んだページを作っています。

<ENTRY>netboot-probs netboot でありがちな問題
<ul>
<p><li><pre>0 &gt; <b>boot enet:,\ofwboot.xcf </b>BOOTP failed
 can't OPEN enet:
 ok</pre>
bootp または DHCP サーバーがクライアントの要求に反応していません。サーバーが
動作しているか、サーバーが同じイーサネットサブネット上にあるか、また、クライアントが
適切なイーサネットハードウェア (NAC) アドレスであるかどうか確認してみてください。
下記の出力結果から <tt>local-mac-address</tt> を探してください:
<pre>0 &gt; dev enet .properties</pre>

<p><li><pre>CLAIM failed</pre>
<a href="#ofw-claim-failed">上記</a>参照。

<p><li><pre>TFTP timeout</pre>
サーバーの TFTP サーバーが動作していないか、または Open Firmware 1.0.5
の機種でブートローダーの位置を指定しなかったかのいずれかです。
残念ながら、初期の機種では、たとえ bootp または DHCP サーバーが適切な情報を
提供してくれていても、明示的に <tt>boot-device</tt> からロードしない限り、
<tt>ofwboot.xcf</tt> が混乱してしまい、正しく動作しません。
以下のようなコマンドを使ってブートする必要があります:
<pre>0 &gt; <b>boot enet:,\ofwboot.xcf</b></pre>

<p><li><pre>enet:,/netbsd.ram.gz: Inappropriate file type or format</pre>
<tt>ofwboot.xcf</tt> は gzip 圧縮されたカーネルを扱えるはずですが、
Open Firmware 1.0.5 のシステム上では扱うことができません。伸長してください。
</ul>

<ENTRY>cdr151 NetBSD/macppc 1.5.x の公式 CD-R イメージはどこにありますか?
最寄りの <a href="../../mirrors/#iso">NetBSD ダウンロードサイト</a>
を探してください。
<p>
Open Firmware 1.0.5、 2.0.x または 2.4 のシステムで SCSI ドライブからブート
するためのコマンド (ファイル名を大文字にするよう注意):
<pre>boot <i>scsi-int</i>/sd@3:0,\OFWBOOT.XCF NETBSD.MACPPC</pre>
<p>
<tt><i>scsi-int</i></tt> は CD-ROM デバイスの devalias に置き換える必要が
あるかもしれません。
<p>
Open Firmware 3 のシステムでブートするためのコマンド (小文字のファイル名
を使うよう注意):
<pre>boot cd:,\ofwboot.xcf netbsd.macppc</pre>

<p>
<i>Note: この CD のインストールカーネルは、 PowerMacintosh G3 (青白)
システムの IDE バスを認識しません。</i>  <a href="#nodisk">下記参照</a>。


<ENTRY>boot-cd ブート可能な CD-ROM の作り方は ?
<tt>ofwboot.xcf</tt> と、
<i>gunzip で伸長した</i>カーネルを含む ISO 9660 イメージを作ります。
MacOS 用の gunzip プログラムには、カーネルを ASCII ファイルとみなして
伸長するものがあるので注意してください。
ofwboot とカーネルのファイルを CD の一番上の階層 ( <tt>/</tt> ) に置きます。
インストールに必要な他の配布物 (base.tgz, etc.tgz など)
を一緒に含めることもできます。
<p>
CD を焼きます。ブートして Open Firmware に入ります。
Open Firmware から CD でマシンをブートします。
Open Firmware のバージョンによって、ブート用のコマンドは異なります。
例を示します:

<table cellpadding=5>
<tr><td><tt>boot scsi/sd@3:0,ofwboot.xcf -a</tt></td>
<td>CD が "scsi" Open Firmware バス上にある Open Firmware 1.0.5 の機種<br>
<i>Note: Open Firmware 1.0.5 は <tt>ofwboot.xcf</tt> を、 ISO/HFS ハイブリッド
CD からロードできません。純粋な ISO CD でなければなりません。</i></td></tr>
<tr><td><tt>boot&nbsp;ata/atapi-disk:0,ofwboot.xcf&nbsp;-a</tt><br>
<tt>boot ide1/disk@0:0,ofwboot.xcf -a</tt></td>
<td><tt>cd</tt> devailas がない Open Firmware 2.0.X の機種</td></tr>
<tr><td><tt>boot cd:ofwboot.xcf -a</tt></td>
<td>Open Firmware 2.0.X、 2.4、および 3.0 の機種</td></tr>
<tr><td><tt>boot cd:netbsd</tt><br>
<td>Open Firmware 3.0 の機種<br>
<i>Note: Open Firmware 3 は HFS/ISO ハイブリッド CD からしかロードできません。</i></td></tr>
</table>
<p>
カーネルの名前を尋ねられたら <tt>netbsd</tt> とタイプします。
<p>
この方法で問題がある場合、単にブートフロッピーのイメージをそのまま
CD-ROM に焼くという方法もあります。ただし、この方法が使えるのは Open Firmware
1.0.5 か 2.X の機種だけです (Open Firmware 3.0 以降では使えません) 。
この方法を使ってブートする場合、ファイル名 <tt>ofwboot.xcf</tt>
を指定してはいけません。このファイルシステムのイメージは、
bootxx ブートローダーがインストールされている状態なので、
0 番目のパーティションを使うことになります。
<tt>boot&nbsp;scsi/sd@3:0</tt> や <tt>boot&nbsp;cd:0</tt> のようにします。



<ENTRY>bootx Linux の BootX ユーティリティーは NetBSD/macppc のブートに使えますか ?
いいえ。ですが、 BootX のメンテナーは、
誰かが NetBSD 用のパッチを書けば取り込むと言っています。 (<a
href="http://mail-index.netbsd.org/port-macppc/1999/03/12/0002.html">port-macppc メーリングリストのアーカイブ</a>を見てください。)
<p>
これは、 Darwin の BootX ブートローダーとは全くの別物ですので注意してください。

<ENTRY>bootx-darwin Darwin/MacOS X の BootX ブートローダーは NetBSD/macppc のブートに使えますか ?
いいえ。ですが、 Darwin の BootX は Open Firmware を使うため、 NetBSD/macppc
への移植は linuxppc の BootX より簡単なはずです。

<p>
この作業に関心のある方は、 BootX のソースコードの入手について、
<a href="http://mail-index.netbsd.org/port-macppc/2000/12/12/0003.html">
この投稿</a>を参照してください。

<p>
このリポジトリーには、 System Disk に含まれるパッチをもとにした、
Open Firmware 2.4 以前なマシン用の nvram パッチも含まれています。

<SECTION>ブートの問題

<ENTRY>common-of-probs Open Firmware のブートでのありがちな問題
<a href="#ofw-boot-serial">black monitors</a>、
<a href="#ofw-claim-failed"><tt>CLAIM failed</tt></a>、
<a href="#default-catch"><tt>DEFAULT CATCH!</tt></a>、
<a href="#ofw-load-base"><tt>load-base</tt></a>、
<a href="#cant-open"><tt>can't OPEN</tt></a>、
<a href="#formatstate-not-valid"><tt>unrecognized Client Program</tt></a>、
<a href="#bad-partition"><tt>bad partition number</tt></a>、
<a href="#ofw-real-base"><tt>real-base</tt></a>の情報を見てください。

<ENTRY>ofw-claim-failed <tt>CLAIM failed</tt>

これは Open Firmware がメモリーの割り当てに失敗したときに出る
一般的なメッセージです。
原因はいくつかあります。
<p>
これはしばしばメモリーに問題があることを意味します。
もし、何か試したことが失敗したのちに再度何かを試して
"CLAIM failed" とのメッセージが出たのであれば、
これは一旦リブート (Open Firmware コマンドは "reset-all") すべき
であるとの指示です。

<p>Open Firmware のバージョンが 1.0.5 か 2.X のマシンでは、
このエラーは、ときどきランダムに現れます。
かまわずに boot コマンドを試してみてもよいでしょう
(いくつかの機種では、これで動作することが知られています) 。
また、シリアルコンソールを使っていない場合は、
スクリーンドライバーと Open Firmware のコンフリクトによって
Open Firmware が ofwboot.xcf をロードできないのかもしれません。
いくつかの機種では、スクリーンとキーボードを使ってはブートできません。
特に、 "valkyrie" スタイルのビデオ (調べるには <tt>'devalias screen'</tt>
とタイプします) を使ったシステムでは、
シリアルコンソールからブートしなくてはなりません。
唯一の回避策はシリアルコンソールを使う
(入出力デバイスを ttya か ttyb にする) ことです。
System Disk ユーティリティーを使って (<a href="SystemDisk-tutorial/">チュートリアル</a>参照)
input と output を ttya に設定するか、
Open Firmware で次のようにタイプします:
<pre>0 &gt; <b>setenv input-device ttya</b>
0 &gt; <b>setenv output-device ttya</b>
0 &gt; <b>reset-all</b></pre>
<p>
これはマシンをリセットし、モデムポートに 38400 ビット毎秒、 8 ビット/バイト、
ストップビット 1 、 パリティなしでメッセージを送ります。

<ENTRY>default-catch <tt>DEFAULT CATCH!</tt>
Open Firmware のバージョンが 1.0.5 か 2.X のマシンでは、
このエラーは、ときどきランダムに現れます。
かまわずに boot コマンドを試してみてもよいでしょう
(いくつかの機種では、これで動作することが知られています) 。
これはまた、フロッピーディスクに問題があるか、
フロッピードライブに問題があることを表しています。

<p>また、シリアルコンソールを使っていない場合は、
スクリーンドライバーと Open Firmware のコンフリクトによって
Open Firmware が ofwboot.xcf をロードできないのかもしれません。
いくつかの機種では、スクリーンとキーボードを使ってはブートできません。
唯一の回避策はシリアルコンソールを使う
(入出力デバイスを ttya か ttyb にする) ことです。
System Disk ユーティリティーを使って (<a href="SystemDisk-tutorial/">チュートリアル</a>参照)
input と output を ttya に設定するか、
Open Firmware で次のようにタイプします:
<pre>0 &gt; <b>setenv input-device ttya</b>
0 &gt; <b>setenv output-device ttya</b>
0 &gt; <b>reset-all</b></pre>
<p>
これはマシンをリセットし、モデムポートに 38400 ビット毎秒、 8 ビット/バイト、
ストップビット 1 、 パリティなしでメッセージを送ります。

<ENTRY>cant-open <tt>can't OPEN</tt>
Open Firmware は、指定されたデバイス (それがそもそも存在しなかったり、
デバイスのパスの打ち間違いなどによって) や指定されたファイルを
オープンできていません。
打鍵を確認し、また、指定したファイルがメディア上にあるか確認してください。

<ENTRY>formatstate-not-valid <tt>unrecognized Client Program formatstate not valid</tt>
これは Open Firmware の一般的なエラーメッセージで、オープンしようとしている
ファイルが存在しないか、あるいはファイルが正しくないフォーマットであることを
表しています。
Open Firmware 1 や 2 の機種では、ファイルは (<tt>ofwboot.xcf</tt> のような)
XCOFF ファイルでなければなりませんし、
Open Firmware 3 の機種では、ファイルは XCOFF か (カーネルのような) ELF
でなければなりません。

<ENTRY>bad-partition <tt>bad partition number, using 0no bootable HFS partition</tt>
これは、 Open Firmware 1.x や 2.0.x の機種で、 HFS ファイルシステムを持つ
デバイス (ハイブリッド CD-R や MacOS パーティションのあるハードドライブなど)
からブートしようとしているためです。

<ENTRY>pb418 PowerBook (FireWire)、 PowerBook G4 (Titanium) と BootROM 4.1.8
ここに掲げた 2 機種では、 <a href="#ofw-version">BootROM</a> バージョン 4.1.8
以降を持っている場合、 NetBSD 1.5.x 以前のブートに失敗します。
<p>
残念ながら、これらの機種で NetBSD をブートするためには、 -current を使って
<a href="../../Documentation/kernel/#how_to_build_a_kernel">
カーネルを再構築</a>するか、マシンを Apple にセンドバックして以前の
BootROM バージョンに書き戻す必要があります。


<ENTRY>grey-screen ブートしようとすると、画面がグレーになってクエスチョンマークが点滅するのはなぜですか ?
これは、 Open Firmware のブートコマンドが間違っており、
マシンが  Open Firmware の <tt>boot-device</tt> 環境変数値をもとに
ブートしようとしていることを意味します。
この変数のデフォルト値は、 MacOS をブートするようになっています。
クエスチョンマークが点滅するグレーの画面は、
マシンがブート可能な MacOS のファイルシステムを探しているが
見付からないことを意味します。
<p>
リブートして Open Firmware に入り直し、コマンドをよく確認してください。


<ENTRY>black-lcd ブートの間、画面が真っ暗になってしまうのはなぜですか ?
バグです。 NetBSD カーネルはバックライトを消してしまいます。
回避するため、 PowerBook の画面の明るさを上げてください。
<p>
もし PowerBook を使っているのでなければ、
その機種はデフォルトでシリアルコンソールを使うようになっています。
<a href="#ofw-boot-serial">上記</a>を見てください。


<ENTRY>nodisk ディスクはどこに行った? (あるいは、 sysinst が <tt>I can not find any hard disk for use by NetBSD</tt> と言う)
うむ、よい質問です!

<p>おおもとの原因は、 NetBSD がハードドライブを見つけなかったことです
(より内部的にいえば、ドライブコントローラーを見つけなかったということです) 。
これが起きる原因は、さまざまです。まず最初に、 NetBSD がIDE コントローラー
を見つけているか確認してください (スクロールしてゆくブートメッセージ中に、
<tt>wdc0</tt> (IDE の場合) または <tt>scsibus0</tt> (SCSI の場合)
を含む行があるはずです) 。もし、それも見つけていなければ、お使いのドライブバス
をサポートした別のカーネルを使う必要があるでしょう。
<a href="mailto:port-macppc@netbsd.org">port-macppc@netbsd.org</a>
に投稿して助言を求めてください。

<p>ここで、ちょっとした問題を排除 (ドライブの接続、電源、ジャンパーが正しく
セットされているか確認) してください。 MacOS でドライブが動作するか確認してください。

<p>それでも NetBSD がディスクを見つけられず、それが SCSI ディスクの場合、
終端抵抗を確認してください。たとえ MacOS では使えていても、 NetBSD は SCSI
バスのタイミングに関して MacOS より厳格かもしれません。

<p>ATA4 をサポートする最近の機種を使っており、かつ/または、
最近の FirmWare update (2001 年後半) をインストールしており、かつ
NetBSD 1.5.2 を使おうとする場合、問題があるかもしれません。
<a href="#wdc-lost-interrupt">上記</a>参照。

<p>IDE ドライブの場合、あなたのシステムは PowerMacintosh G3 (青白) かそれ以前の
ものかもしれません。 B&amp;W システムまでは、 Apple は IDE に関する問題すべてを
完全に除去してはいませんでした。多くの人々が、 NetBSD のドライブを別の IDE
バスにつなぎ、かつ/または、そのドライブをマスターにする
(CD-ROM はスレーブにする) 必要があると報告しています。

<p>悪いことには、 NetBSD 1.5.1 のインストールカーネルイメージは、
PowerMacintosh G3 (青白) の IDE コントローラーをサポートしていません。
本番のカーネルはサポートしていますが。

<p>残念ながら、お使いの OS すべてが動作する正しい構成を見つけるため、
いろいろ試す必要があるかもしれません。 Open Firmware 3 を持たない
システムはいずれも、スレーブデバイスからはブートできない (Open Firmware
の制限) ということを覚えておいてください。

<p>Chris Tribo は初期の G3 モデルのよい分析と、その制限/特徴について
投稿しています。彼の
<a href="http://mail-index.netbsd.org/port-macppc/2001/07/26/0019.html">記事</a>を見てください。
また、このトピックに関する Apple Knowledgebase の
<a href="http://kbase.info.apple.com/cgi-bin/WebObjects/kbase.woa/24/wa/query?type=id&amp;val=24342">記事</a>
も見てください ('macppc@netbsd.org' と 'macppc' で認証する必要があります).


<!-- ======================================== -->
<SECTION>その他もろもろ

<ENTRY>elf <tt>ldconfig</tt>/<tt>ld.so.conf</tt> はどこにありますか ?

NetBSD/macppc は ELF を使っているので、
<tt>ldconfig</tt> や <tt>ld.so.conf</tt> はありません。
より詳しくは、<a href="/Documentation/elf.html" origlink="../../Documentation/elf.html">NetBSD ELF FAQ</a>
を見てください。


<ENTRY>cross-compile 他の NetBSD アーキテクチャーでクロスコンパイルする方法は ?

まず、パッケージコレクションから
cross/powerpc-netbsd パッケージをコンパイル、インストールしてください。

カーネルの構築のため、通常にコンフィグレーションしてから、
次のようにしてコンパイルします:

<pre>
	make PATH=/usr/pkg/cross/powerpc-netbsd/bin:$PATH \ 
		MACHINE=macppc MACHINE_ARCH=powerpc depend all
</pre>

クロスコンパイルユーザーランドは若干複雑になります。 (XXX 以上)

(XXX この項目は MI FAQ に移すべきです)


<ENTRY>linux NetBSD/macppc で MkLinux や LinuxPPC のバイナリーが動きますか ?
もう少しです ! 作業は進行中で、すでに Netscape Navigator など
いくつかのバイナリーは一部成功しています。より詳しくは、 NetBSD/PowerPC の
Linux 互換に関する
<a href="http://gizmo.minet.net:8080/emul_linux/">状況のページ</a>
をご覧ください。
<p>
この機能は NetBSD 1.5.x には含まれて<i>いません</i>。 <tt>-current</tt>
カーネルで実行するか、今後の NetBSD リリースを待つ必要があります。


<ENTRY>macos NetBSD/macppc で MacOS のバイナリーが動きますか ?
いずれ誰かが <a
href="http://www.ibrium.se/linux/mac_on_linux.html">Mac-on-linux</a>
(LinuxPPC 用) を動かすかもしれません。それまでは、 68k Mac をエミュレートする
<a href="http://www.uni-mainz.de/~bauec002/B2Main.html">Basilisk II</a>
や <a href="http://www.vmac.org">VMac</a> を使ってみてください。


<ENTRY>macosx NetBSD/macppc で Darwin/MacOS X のバイナリーが動きますか ?
いいえ。理論上は可能なはずですが。ほとんどの UNIX-like OS が
<tt>a.out</tt> や <tt>ELF</tt> や <tt>XCOFF</tt> フォーマットのバイナリーを
使っているのに対して、 Darwin のバイナリーはあまり使われていない
<tt>Mach-O</tt> フォーマットを使っています。

<ENTRY>keys <img src="/images/ports/macppc/icon-command.gif" origlink="../../images/ports/macppc/icon-command.gif" width="13" height="13" alt="command key"> や <img src="/images/ports/macppc/icon-option.gif" origlink="../../images/ports/macppc/icon-option.gif" width="17" height="13" alt="option key"> のアイコンの意味は (あるいは、 "command" や "option" キーはどれ) ?

Aplle はキーボードに特別なキーを用意しており、
(特に US キーボード以外では) 混乱する人がいるかもしれません。
<img src="/images/ports/macppc/icon-command.gif" origlink="../../images/ports/macppc/icon-command.gif" width="13" height="13"
alt="command key"> 印の付いたキーは、普通、 "Command" キーとして参照されます。
キーボードによっては、コマンドキーに "open apple"
(<img src="/images/ports/macppc/icon-open-apple.gif" origlink="../../images/ports/macppc/icon-open-apple.gif" width="13" height="15"
alt="open apple key">) 印も付いています。

US キーボード以外では、 US キーボードで "option" キーとして印のあるキーに
<img src="/images/ports/macppc/icon-option.gif" origlink="../../images/ports/macppc/icon-option.gif" width="17" height="13"
alt="option key"> 印の付いたキーがあります。
<p>
しばしば、 Mac のドキュメントでは、 "C-O-p-r" などを押すよう指示しています。
これは、 command キーと option キーを "p" と "r" とともに押すことを
意味しています。

<ENTRY>adb-short ADB キーボードを使わずにシステムをブートする方法は?
あなたがシリアルコンソールを使っていて、 ADB キーボードがなく、また、
電源スイッチ本体のある後部 (でなくてもどこでもいいですけど)
に手を伸ばしたくない場合、ハードウェアに細工して、コンピューターに
ADB キーボードの "power" キーを再現することができます。
すべての mac には、本当の電源スイッチ (ソフトまたはハード電源) がありますが、
見えないようになっているかもしれません。
この細工をすると保証は無効になりますし、私たちも責任を持てません。
このトピックに関する Chris Tribo によるメーリングリストの
<a href="http://mail-index.netbsd.org/port-macppc/2001/06/09/0002.html">記事</a>
を参照してください。

<!-- ======================================== -->
</LIST>

<a href="./">Up to <em>NetBSD/macppc Port Page</em></a>
<hr>

<DOCLINK>

<hr>
<address>
  <small>
  (連絡先 - <a href="../../Misc/feedback.html">英語</a>,
       <a href="mailto:www@JP.NetBSD.ORG">日本語:
       www@JP.NetBSD.ORG</a>)<br>
  $NetBSD: faq.list,v 1.92 2001/12/18 03:38:42 mbw Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy;
    1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
