<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html lang="ja">
<head>
<!-- Copyright (c) 1998-2003
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@jp.NetBSD.org">
<title>NetBSD/macppc Old Frequently Asked Questions</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<h1>NetBSD/macppc 過去のよくある質問</h1>

このよくある質問 (および回答) 文書では、 NetBSD/macppc の 1.6
リリース以前の問題を取り上げています。

<p>修正ずみと書かれている問題に遭遇したり、さらなる情報、質問、回答があれば、
<a href="mailto:port-macppc@NetBSD.org">port-macppc@NetBSD.org</a> までメールを
(訳註: 英語で) 送ってください。

<LIST>

<h2>以下の関連情報も見てください:</h2>
<ul>
    <li><a href="faq.html">NetBSD/macppc Frequently Asked Questions</a>
    <li><a href="SystemDisk-tutorial/">NetBSD/macppc System Disk
        チュートリアル</a>
    <li><a href="models.html">NetBSD/macppc 機種対応ページ</a>
    <li><a href="nvedit.html">NetBSD/macppc nvedit HOW-TO</a>、
        NVRAMRC の内容の編集方法の案内
    <li><a href="partitioning.html">NetBSD/macppc パーティショニング HOW-TO</a>
    <li><a href="x11.html">NetBSD/macppc X11 FAQ</a>
    <li><a href="../../Documentation/elf.html">NetBSD ELF FAQ</a>
    <li>NetBSD のプラットフォーム独立なワークステーションコンソールドライバー
	についての <a href="../../Documentation/wscons/">wscons
	FAQ</a> 。
</ul>
<p>

<h2>さらに追加情報を提供しています:</h2>
<ul>
<li><a href="../../MailingLists/#port-macppc"> port-macppc メーリングリスト</a>
    - さらなる質問があれば参加してください。
<li><a
href="../../Documentation/network/netboot/">Diskless NetBSD HOW-TO</a>.
<li><a href="../../Documentation/Hardware/Misc/serial.html">NetBSD
シリアルポート入門</a>
<li><a href="../../Documentation/">NetBSD 一般のドキュメンテーション</a>
    - NetBSD/macppc 特有でない質問向け。
</ul>


<ENTRY>usb-keyboard-problems USB キーボードの問題
USB キーボードには二種類の問題があります。一方の問題は NetBSD 1.4.3
リリース後に現れたもので、一部の iMac (ボンダイブルー) と一部の
PowerMacintosh G3 (青白) マシンでのみ起こります。
この問題は NetBSD 1.6 で直ったようです。
<p>
もう一方の問題は USB キーボードを持つすべての機種で起こるものですが、
NetBSD 1.5 リリース前に修正済です。

<p><H3>iMac (ボンダイブルー) と PowerMacintosh G3 (青白)
の問題:</h3>
PowerMacintosh G3 (青白) の問題の説明と回避策については、
Bob Nestor によるメーリングリストへの
<a href="http://mail-index.NetBSD.org/port-macppc/2001/06/11/0009.html">記事</a>
を見てください。この回避策は iMac (ボンダイブルー) には通用しませんが、
Rob Gridley によれば、マウスを外すとブートしてキーボードが使えるとのことです。
また、問題報告
<a href="http://www.NetBSD.org/cgi-bin/query-pr-single.pl?number=12894">port-macppc/12894</a>
も見てください。
<p>
手短にいえば、彼の勧める回避策は次のとおりです:
<p>
<ol>
  <li>USB キーボードを外し、 ADB キーボードとマウスをつなぐ
    <p>
  <li>ADB キーボードをつないだ状態で NetBSD をブートする
    <p>
  <li>ADB キーボードで、 root、 swap、ファイルシステムの回答を入力
    <p>
  <li>システムがシェルプロンプトまで達したら (マルチユーザーの場合は
    ログインしたら)、 ADB を外し、 USB キーボードをつなぐ
</ol>
<p>

これで USB が利用可能になり、システムが使えるようになります。
ADB は外す前から死んでいることがわかるでしょう。
また、 USB は外してブート<b>しなければなりません</b>。さもないと動作しません。
<p>
このほか、 NetBSD 1.4.3 は、この二機種でも問題なく動作し、
この USB の問題は起こりません。

<p><h3>NetBSD 1.5 より前でキーの打鍵が繰り返される問題:</h3>
カーネルによっては、 USB キーボードの最初の打鍵が何度も繰り返される
という問題があります。このため、インストールのさい
"<tt>(I)nstall, (S)hell or (H)alt ?</tt>" という質問が繰り返されます。
この問題を回避するため、最初に shift キーを押してください。
<p>
最近の機種では、 NetBSD がデバイスを設定後にシングルユーザーモードに入る前に
ハングすることがあります。
おすすめの回避策は、 USB デバイス (特にハブ) をすべて外し、
マウスをキーボードに挿し、キーボードを Mac 本体背面に直接つなぐことです。

<ENTRY>cannot-allocate-vm-panic <tt>panic: startup: cannot allocate VM for buffers</tt>
この問題は NetBSD 1.5 では修正されているはずです。

<p>
RAM をたくさん積んだマシンでは、カーネルがバッファーキャッシュを
割り当てようとする際、カーネルがカーネル VM から逸脱することがあります。
次のいずれかで回避できます:
<ol>
<li>RAM をいくつか外す
<li><a href="../../Documentation/kernel/#how_to_build_a_kernel">カーネルコンフィギュレーション</a>に
    <tt>"options BUFPAGES=800"</tt> を加える
</ol>

<ENTRY>wdc-lost-interrupt <tt>wdc0:0:1: lost interrupt</tt>
この問題は、 ATA4 ドライブをサポートする新しい機種上の NetBSD 1.5.2
で起こります。残念ながら、簡単な回避策はありません。助けが必要なら
<a href="mailto:port-macppc@NetBSD.org">port-macppc@NetBSD.org</a>
に投稿してください。

<p>これは、 BootROM 4.1.9 にアップグレードした iBook (Dual USB) と
iMac (Summer 2000) で報告されています。

<p>この問題は NetBSD 1.5.3 以降では起こりません。

<ENTRY>pciide-lost-interrupt <tt>pciide0:0:0: lost interrupt</tt>
この問題は NetBSD 1.5.1 以降では修正済です。

<p>
NetBSD の CMD 646 IDE コントローラーの初期化コードは、
Open Firmware による設定のいくつかを完全に解除しません。
Open Firmware は IDE コントローラーを 0646U2 モードに設定し、
いくつかの割り込みの設定を変更しているのです。
MI pciide ドライバーは、このような状況に対処できず、
"lost interrupt" というメッセージがたくさん出るのです。
<p>
この場合、 Open Firmware を使ってブートローダー (つまり <tt>ofwboot.xcf</tt>) 
やカーネルをそのハードドライブからロードすると、
NetBSD ではそのドライブを使えません。
<p>
次善策としては、カーネルを別のブート可能なバスに移し、
それから CMD 646 IDE バスにつないだドライブを
NetBSD ファイルシステムにマウントするという方法があります。
キーフレーズは「別のブート可能なバス」です。
この問題を持つ G3 や G4 の機種には、もうひとつの IDE バス
(と追加の SCSI バス) があります。
通常は、ハードドライブはこの問題があるバスにつながれており、
一方、CD-ROM や Zip のドライブは別のバスにつながれていて問題なく動作します。

<p>
遅い IDE バスのプロトコルを使うことにはなりますが、
ハードドライブを CD-ROM がつながっているバスに移し
(マスター / スレーブのジャンパーに注意してください) 、
この問題を回避するという方法もあります。


<ENTRY>mesh-fifo <tt>Panic: mesh: FIFO != 0</tt>
このバグは NetBSD 1.5 以降では現れません。
<p>
これは、 SCSI ケーブルやデバイスに問題がある場合に起こります。
内蔵と外付けの終端抵抗を確認してください。
ケーブルの長さと品質を確認してください。
不要なデバイスを全部外してみてください。
<p>
この問題は、 SCSI の世界のよい住人とはいえない
MESH SCSI バス上の Zip ドライブがある場合、しばしば起こります。
<p>
MacOS からリブートして NetBSD をブートするのでなければ、
MESH ドライバーはより信頼できるようになるという人もいます。
(つまり、 MacOS を動かしている場合、再起動ではなくシステム終了をしてから、
電源を入れて NetBSD をブートしてください。)
<p>
M L Riechers はこのトピックに関して、たいへん徹底的な
<a href="http://mail-index.NetBSD.org/port-macppc/2000/08/02/0029.html">
記事</a>を投稿しています。
<p>
健闘を祈ります。


<ENTRY>bm0-device-timeouts device timeouts on bm0 と言われます
この問題は NetBSD 1.5 以降では修正済です。

<p>
10Mb のハブを介す (bm0 を強制的に 100Mb/s から 10Mb/s にする) と、
この問題を回避できるようです。


<ENTRY>old-ofw-load-base "load-base" の設定の問題

Open Firmware の環境変数 <tt>load-base</tt> は、 Open Firmware
がブートローダーを <tt>boot-device</tt> からロードするアドレスです。
XCOFF バイナリーがメモリー上にロードされるアドレスです。
これによる作用は、 Open Firmware のバージョンや <tt>boot-device</tt>
によってさまざまです。 <tt>load-base</tt> が不適切な値に設定された場合、
<tt><a href="#ofw-claim-failed">CLAIM failed</a></tt> という症状が出ます。

<p><h3>Open Firmware 3</h3>
<b><tt>load-base</tt> の値を変えてはいけません</b>。
Open Firmware 3 の機種は書き換え可能なファームウェアを持っていますが、
<tt>load-base</tt> を変更すると、フラッシュ BootROM を上書きして
マシンを壊してしまう (Apple での高価な修理が必要になる) ことがわかりました。
<b>Open Firmware 3 な機種で <tt>load-base</tt> を変更してはなりません。</b>
Apple は Open Firmware 3 を、ブートのために <tt>load-base</tt>
の値を変更する必要はないようにしています。

<p><h3>Open Firmware 1.0.5, 1.1.22, 2.0.x, and 2.4</h3>
これらのシステムでの <tt>load-base</tt> のデフォルト値は 4000 ですが、
これは私たちにとって都合がよくありません。 <a href="SystemDisk-tutorial/">System
Disk</a> は <tt>load-base</tt> を 600000 に設定しますが、 NetBSD 1.5.3 以降
にはこれがちょうどよい値です。 mkLinux はこれとは異なる値を使いますが、
これでは NetBSD/macppc のブートはできないかもしれません。 NetBSD 1.5.3 以降を
使っている方は、ここから先を読んでも混乱するだけなので、ここで読むのをやめて
とにかく 600000 という値に設定してください。

<p><tt>load-base</tt> は、 <tt>ofwboot.xcf</tt> と <tt>ofwboot</tt> とでは
異なった扱われ方をされます。 <tt>ofwboot.xcf</tt> は、 MS-DOS フロッピー、
ISO CD-R 、およびネットブートの際に使われる XCOFF ブートローダーです。
<tt>ofwboot</tt> は、インストールフロッピー、インストール CD-R イメージ、
<tt>sysinst</tt> や <tt>installboot</tt> によって用意されたハードドライブ上の
"partition zero" ブートローダーです。

<p><tt>ofwboot</tt> は 600000 を使うよう設定されています。このため、
<tt>load-base</tt> は 600000 に設定します。

<p>NetBSD 1.5.3 以降の <tt>ofwboot.xcf</tt> は 640000 を使うよう設定されています。
Apple の Open FIrmware の特性上、 <tt>load-base</tt> のアドレスは、
<tt>ofwboot.xcf</tt> が使うアドレスとは異なっている必要があります。
このため、 <tt>load-base</tt> は 600000 に設定します。この値は、
MacOS X のブート用としても適切な値です。

<p>1.5.3 より前のバージョンの NetBSD の <tt>ofwboot.xcf</tt> は 600000
を使うよう設定されています。このため、このブートローダーを使ってブートする
場合は、 <tt>load-base</tt> を 640000 にするか、
そうでなければ新しいバージョンの <tt>ofwboot.xcf</tt> を入手します。

<p>お使いのマシンが、 Open Firmware 1.0.5、 1.1.22、 2.0.x または 2.4
であることが間違いないなら (<a href="#ofw-version">私の機種の
Open Firmware のバージョンは?</a> 参照) 、 <tt>load-base</tt>
を適切に設定するために次のコマンドを実行します

<pre>0 &gt; <b>setenv load-base 600000</b>
0 &gt; <b>reset-all</b></pre>

正しく設定されたか、 <tt>printenv</tt>
コマンドで再確認すべきです。


<ENTRY>pb418 PowerBook (FireWire)、 PowerBook G4 (Titanium) と BootROM 4.1.8
ここに掲げた 2 機種では、 <a href="#ofw-version">BootROM</a> バージョン 4.1.8
以降を持っている場合、 NetBSD 1.5.x 以前のブートに失敗します。
<p>
この問題は  NetBSD 1.6 およびそれ以降で修正済です。

<ENTRY>power-off ほえ〜、マシンの電源が落ちます!
これは、最近のラップトップ (iBook、 PowerBook (FireWire)、それ以降の一部の機種)
で NetBSD 1.5 またはそれ以降を使ったことが原因かもしれません。
<p>
page up キーシーケンス (<tt>FN-uparrow</tt>) は NetBSD 1.5.1 と 1.5
カーネルを panic させます。これは NetBSD 1.5.2 以降で修正済です。
<p>
"brightness" キー (F1 および F2) は、マシンの電源を切って、
時計を狂わせます。
<tt>abtn</tt> オプションを外してカーネルを再構築する必要があります。
下記の行を、
<a href="../../Documentation/kernel/#how_to_build_a_kernel">
カーネルコンフィギュレーション</a>から削除してください:

<pre>#abtn*  at adb?</pre>


<ENTRY>old-nodisk ディスクはどこに行った? (あるいは、 sysinst が <tt>I can not find any hard disk for use by NetBSD</tt> と言う)
うむ、よい質問です!

<p>おおもとの原因は、 NetBSD がハードドライブを見つけなかったことです
(より内部的にいえば、ドライブコントローラーを見つけなかったということです) 。
これが起きる原因は、さまざまです。

<p>ATA4 をサポートする最近の機種を使っており、かつ/または、
最近の FirmWare update (2001 年後半) をインストールしており、かつ
NetBSD 1.5.2 を使おうとする場合、 <a href="#wdc-lost-interrupt"><tt>wdc0:0:1:
lost interrupt</tt></a> の問題があるかもしれません。

<p>NetBSD 1.5.1 のインストールカーネルイメージは、
PowerMacintosh G3 (青白) の IDE コントローラーをサポートしていません。
本番のカーネルはサポートしていますが。


<!-- ======================================== -->
</LIST>

<a href="./">Up to <em>NetBSD/macppc Port Page</em></a>
<hr>

<DOCLINK>

<hr>
<address>
  <small>
  (連絡先 - <a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">英語</a>,
       <a href="mailto:www@jp.NetBSD.org">日本語:
       www@jp.NetBSD.org</a>)<br>
  $NetBSD: oldfaq.list,v 1.1 2004/04/18 22:52:16 mbw Exp $<br>
  <!-- based on english translation: -->
  <!-- NetBSD: oldfaq.list,v 1.1 2004/04/18 22:52:16 mbw Exp   -->
  <a href="../../Misc/disclaimer.html">Copyright &copy; 1998-2003
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
