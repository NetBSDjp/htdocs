<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
<!-- Copyright (c) 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.ORG">
<title>NetBSD/macppc nvedit HOW-TO</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<h1>NetBSD/macppc nvedit HOW-TO</h1>

<hr>
<p>

This page gives a quick introduction to the commands needed to edit the
contents of the Open Firmware nvram.
<p>

As specified in the Open Firmware spec, there is an editor built into all
OF implementations.  This page describes how to use it.  You may notice
that some of the commands are very similar to emacs.  We use <tt>C-x</tt>
to represent holding down the control key and the <tt>x</tt> key.
<p>

<table>
<tr><td><tt>nvedit</tt></td>
<td>start the editor with the current nvramrc contents</td></tr>

<tr><td><tt>C-l</tt></td>
<td>refreshes the display</td></tr>

<tr><td><tt>C-k</tt></td>
<td>deletes from the cursor to the end of that line of text</td></tr>

<tr><td><tt>C-n</tt></td>
<td>moves to the next line of text</td></tr>

<tr><td><tt>C-p</tt></td>
<td>moves to the previous line of text</td></tr>

<tr><td><tt>C-f</tt></td>
<td>moves forward one character</td></tr>

<tr><td><tt>C-b</tt></td>
<td>moves back one character</td></tr>

<tr><td><tt>C-c</tt></td>
<td>exit the editor and store edited contents into a nvram buffer<br>
<i>note: this does <b>not</b> save the changes to nvramrc</i></td></tr>

<tr><td><tt>nvstore</tt></td>
<td>stores the edited nvram buffer into the nvramrc</td></tr>

<tr><td><tt>nvquit</tt></td>
<td>discards the contents of the edited nvram buffer</td></tr>

<tr><td><tt>nvrun</tt></td>
<td>executes the contents of the edited nvram buffer</td></tr>

<tr><td><tt>nvalias</tt></td>
<td>adds device aliases to the nvramrc</td></tr>

<tr><td><tt>nvrun</tt></td>
<td>removes device aliases from the nvramrc</td></tr>
</table>
<p>

<b>Common nvramrc scripts</b>
<p>

To add a delay before trying to boot (to allow a hard drive to spin up),
put the <a href="SystemDisk-tutorial/of105patch2.txt">following
patch</a> in your nvramrc:

<pre>: wBoot
begin
 boot-device ['] $boot catch drop
 ." -Waiting for boot-device" cr
 d# 500 ms
key? until
;</pre>

Then you need to run <tt>nvstore</tt>.  Now, you need to specify that your
boot command is different, so at the OF prompt, typet:<br>

<tt>0 &gt; <b>setenv boot-command wBoot</b></tt>
<p>

Alternatively, you can just patch the boot-command for OF 2 and higher
systems, as such:<br>

<tt>0 &gt; <b>boot-command begin ['] boot catch 1000 ms cr again</b></tt>
<p>

<hr>
<a href="">Up to <em>NetBSD/macppc Port Page</em></a>
<hr>

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../../"><img
        src="../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a>
  </td><td>
    <a href="../../"><img
        src="../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Home Page</a>
  </td></tr></table>
</td><td>
  <table><tr><td>
    <a href="../../Ports/"><img
        src="../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a>
  </td><td> 
    <a href="../../Ports/"><img
        src="../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Supported Architectures</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  www@NetBSD.ORG<br>
  $NetBSD: nvedit.html,v 1.2 2000/08/27 06:12:33 mbw Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy;
    1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
