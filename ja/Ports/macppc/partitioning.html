<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
<!-- Copyright (c) 1998, 1999, 2000
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.ORG">
<title>NetBSD/macppc Partitioning HOW-TO</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<h1>NetBSD/macppc Partitioning HOW-TO</h1>

<hr>
<p>

This page describes how to partition a disk such that it can be used with 
both MacOS and NetBSD/macppc.  The disk will be bootable for MacOS, and 
(depending on your model -- read the INSTALL notes) bootable for NetBSD.
<p>
This procedure will erase the contents of your drive, so back up 
everything from the disk you will be partitioning.  If you are feeling 
brave, you can use the command-line pdisk utility to change the partition 
types of your disk instead of using Drive Setup.  See 
<a href="http://mail-index.netbsd.org/port-macppc/2000/12/16/0005.html">this 
post</a> for general instructions on pdisk.
<p>
If you had previously installed linux on your drive, you may have some
trouble, as the flags required to be set for NetBSD don't match with what
linux wants.  Either re-partition your disk with Drive Setup, or post to
<a href="mailto:port-macppc@netbsd.org">port-macppc@netbsd.org</a> asking
for help.
<p>

<ol>
<li>You will need to use Drive Setup version 1.8.1 or later.  This is the 
version that comes with MacOS 9.0.  If you are unsure, you need to select 
Drive Setup and pick <tt>Get Info</tt> from the <tt>File</tt> menu.
<p>
<img src="../../images/ports/macppc/drive-setup.gif"
 width="354" height="401" alt="drive setup">
<p>
If you have an older version of MacOS,  you can download either the 
<a href="http://docs.info.apple.com/article.html?artnum=60791">MacOS 
9.0.4</a> (12.2 MB), 
<a href="http://docs.info.apple.com/article.html?artnum=75103">MacOS 9.1</a>
 (71 MB), 
<a href="http://docs.info.apple.com/article.html?artnum=120030">MacOS
9.2.1</a> (82 MB), or
<a href="http://docs.info.apple.com/article.html?artnum=75186">MacOS 
9.2.2</a> (21.3 MB) updates, all of which include a 
version of Drive Setup that works for us.  Note, these are big MacOS 
updates, so you will have to download a multi-megabyte disk image just to 
get the 500 KB Drive Setup application.  Apple has not provided a recent 
version of Drive Setup as a standalone update.
<p>
Also, the 
<a href="http://www.opensource.apple.com/projects/darwin/1.3/release.html">Darwin 
installer</a> has a version of Drive Setup that works.  
Darwin is also enormous (120.7 MB), since it contains a complete operating 
system.
<p>
You'll need to open the disk image and copy Drive Setup to a hard drive, 
RAM disk, Zip disk, or floppy disk (it can't run from the disk image).

<p><li>When you first run Drive Setup, it'll give you a screen like this, 
where you can select the drive that you want to re-partition.
<p>
<img src="../../images/ports/macppc/drive-selection.gif"
 width="328" height="257" alt="select a drive">
<p>
Select the drive to re-partition and click the <tt>Initialize...</tt> 
button.  This will open another dialog box.  Click the <tt>Custom 
Setup...</tt> button.
<p>
<img src="../../images/ports/macppc/initialize.gif"
 width="330" height="244" alt="initialize">

<p><li>Select the number of partitions you'll be using.  You will probably 
need at least 5 partitions, see the INSTALL notes for suggestions.
<p>
<img src="../../images/ports/macppc/custom-setup.gif"
 width="480" height="355" alt="custom setup">
<p>
Pick the <tt>Partitioning Scheme</tt> first since you lose all of your 
<tt>Volumes</tt> info each time you chose a different number of 
partitions.

<p><li>For each of the <tt>Volumes</tt> set the <tt>Type:</tt> under the 
<tt>Volume Info</tt> and <tt>Size:</tt> as suggested in the INSTALL notes.
<p>
<img src="../../images/ports/macppc/custom-type.gif"
 width="480" height="428" alt="custom type">
<p>
You can use the <tt>TAB</tt> key to rotate through the <tt>Volumes</tt>.

<p><li>When you're done, you should have something like the following (you 
get to name the MacOS partitions later from the Finder):
<p>
<img src="../../images/ports/macppc/suggested-layout.gif"
 width="480" height="355" alt="suggested layout">

<p><li>Click the <tt>OK</tt> button.  It will request confirmation of the 
changes.
<p>
<i>This is the point of no return!  If you accept the changes, it will 
erase all contents of your drive</i>

<p><li>After it's done partitioning and creating the HFS(+) partitions, it 
will return to the original screen.
<p>
<img src="../../images/ports/macppc/drivesetup-done.gif"
 width="328" height="257" alt="after partitioning">
<p>
Note: the <tt>A/UX</tt> partitions are not accessible to MacOS.

<p><li>You can quit Drive Setup, you're done with it.  Now, from the 
Finder, you can rename your HFS(+) partitions.  If you are using an Open 
Firmware 1.0.5 or 2.0.x model, you're done -- contine with the INSTALL 
notes.
<p>
If your model has Open Firmware 2.4 or 3, and you're going to 
make this disk bootable for NetBSD, you still need to do one more step.  
<p>
You will need to copy <tt>ofwboot.xcf</tt> (the bootloader) and 
<tt>netbsd.GENERIC_MD.gz</tt> or <tt>netbsd.ram.gz</tt> (the installer) to 
one of the HFS(+) partitions on your drive.  Make sure that you have 
downloaded these files in <tt>binary</tt> mode.
</ol>

<hr>

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../../"><img
        src="../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a>
  </td><td>
    <a href="../../"><img
        src="../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Home Page</a>
  </td></tr></table>
</td><td>
  <table><tr><td>
    <a href="../../Ports/"><img
        src="../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a>
  </td><td> 
    <a href="../../Ports/"><img
        src="../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Supported Architectures</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  www@NetBSD.ORG<br>
  $NetBSD: partitioning.html,v 1.6 2002/03/02 19:04:39 mbw Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy;
    1998, 1999, 2000
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
