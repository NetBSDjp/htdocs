<html>
<head>
<!-- Copyright (c) 1997, 1998
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<TITLE>Communication and Networking</TITLE>
</HEAD>
<BODY>
<A NAME="comm"></A> <H1>8. <A NAME="s8"></A>Communication and Networking</H1>
<P>
<HR>
<A HREF="faq.html#toc8">Contents of this section</A><HR>
</P>

<P>Please note that this section is rather sparse because it is waiting for a
few HOWTO's to be written.</P>
<P></P>
<A NAME="F.G"></A> <H2>8.1 <A NAME="ss8.1"></A> How do I set up networking under NetBSD? </H2>

<P>There are several sources of information about this.  If you already have
networking running under MacOS, then you will probably want to check out
the HOWTO page for information on adapting your MacTCP or Open Transport
settings to NetBSD:
<A HREF="http://www.macbsd.com/macbsd/howto/">http://www.macbsd.com/macbsd/howto/</A>
</P>
<P>On the other hand, if you are looking at a fairly in-depth treatment of
NetBSD networking, you can take a look at the Beginner's Guide to TCP/IP
Networking and Networking FAQ for NetBSD/amiga:
<A HREF="http://rfhs8012.fh-regensburg.de/~feyrer/NetBSD/NWF/nwf_toc.html">http://rfhs8012.fh-regensburg.de/~feyrer/NetBSD/NWF/nwf_toc.html</A>
</P>
<P>Thanks to Henry B. Hotz (h.b.hotz@jpl.nasa.gov) for providing the above
information. </P>
<P></P>

<A NAME="F.A"></A> <H2>8.2 <A NAME="ss8.2"></A> I'm trying to use <CODE>cu</CODE> to establish a SLIP connection, but everytime I try, I get an error message and am disconnected from the serial port.  How can I fix this?</H2>

<P>There appear to be problems with <CODE>cu</CODE> working under recent kernels.  Use
PPP or SLIP via <CODE>bsddip</CODE> instead.</P>
<P>The <CODE>bsddip</CODE> program can be obtained from:
<BLOCKQUOTE><CODE>
<A HREF="ftp://ftp.netbsd.org/pub/NetBSD/packages/src/GPLed-sources/bsddip-1.02.tar.gz">ftp://ftp.netbsd.org/pub/NetBSD/packages/src/GPLed-sources/bsddip-1.02.tar.gz</A>
</CODE></BLOCKQUOTE>

Keep in mind that I have had problems with getting <CODE>bsddip</CODE> to work with
-current kernels, but that may just be me.</P>
<P>For information on how to set up a PPP connection, see the
<A HREF="#F.B">FAQ on PPP</A>
.</P>
<P></P>

<A NAME="F.B"></A> <H2>8.3 <A NAME="ss8.3"></A> How do I set up a connection using PPP? </H2>

<P>One way is to read the manual pages for the <CODE>chat</CODE> program and
<CODE>pppd</CODE>, but perhaps the easiest way to do this is to get the PPP-kit put
together by Bill Studenmund (wrstuden@loki.stanford.edu):
<BLOCKQUOTE><CODE>
<A HREF="ftp://ftp.macbsd.com/private/wrstuden/ppp.setup.tgz">ftp://ftp.macbsd.com/private/wrstuden/ppp.setup.tgz</A>
</CODE></BLOCKQUOTE>
</P>
<P>Since the kit is located in a subdirectory of the <CODE>/private</CODE> FTP
directory, you must <CODE>cd</CODE> directly to Bill's directory.  Otherwise you
may get permissions problems due to the fact that read permission is turned
off on <CODE>/private</CODE>.</P>
<P>The kit includes instructions on how to set it up and use it.  It should be
untarred in the <CODE>/etc</CODE> directory, or else have its contents moved
there before you use it.  Bill admonishes that the modem init string needs
to be changed to work with your modem, though.</P>
<P>Paul Goyette (paul@pgoyette.bdt.com) has contributed a newer PPP kit which
supports 
<A HREF="#F.C">demand-dial PPP</A>
.  See below for more
details.</P>
<P></P>

<A NAME="F.C"></A> <H2>8.4 <A NAME="ss8.4"></A> Does NetBSD include demand-dial PPP? </H2>

<P>NetBSD has included support demand-dial PPP since the 1.2 release.  For
information on how to set it up, you can either read the <CODE>pppd(8)</CODE>
manual page for more information on this option, or you can get the new
dial-on-demand PPP kit contributed by Paul Goyette (paul@pgoyette.bdt.com):
<BLOCKQUOTE><CODE>
<A HREF="ftp://ftp.macbsd.com/private/pgoyette/pppd/ppp-dod.tgz">ftp://ftp.macbsd.com/private/pgoyette/pppd/ppp-dod.tgz</A>
</CODE></BLOCKQUOTE>
</P>
<P>Since the kit is located in a subdirectory of the <CODE>/private</CODE> FTP
directory, you must <CODE>cd</CODE> directly to Paul's directory.  Otherwise you
may get permissions problems due to the fact that read permission is turned
off on <CODE>/private</CODE>.</P>
<P>The kit includes all the files you need, including a HOWTO on getting PPP
up and running on your system.</P>
<P>Keep in mind that demand-dial PPP requires that your ISP give you a static
IP address.</P>
<P></P>

<A NAME="F.D"></A> <H2>8.5 <A NAME="ss8.5"></A> Does anyone have any idea how to use PAP with chat or pppd?</H2>

<P>From Bill Studenmund (wrstuden@loki.stanford.edu):
<BLOCKQUOTE>
chat does nothing w/ PAP. pppd can use it, and you don't need special
scripts to do it.
</BLOCKQUOTE>

<BLOCKQUOTE>
To make PAP work, see the man pages on pppd.
</BLOCKQUOTE>

<BLOCKQUOTE>
The basic idea is you make a file /etc/ppp/pap-secrets which contains
the secrets for authentication. Each line has a server & client field
(who's authenticating to whom) and a secret.
</BLOCKQUOTE>

<BLOCKQUOTE>
The only possable changes needed to use PAP are (AFAIK) you must
have the chat script end right where the PAP authentication will happen
(as pppd does it, not chat). And your options must not disalow
it. pppd will allow autentication if requested by default, so when the 
other side asks, it will receive.
</BLOCKQUOTE>

<BLOCKQUOTE>
Here are suggestions for how to change the ppp.setup scripts. As I've not
used PAP, I'm depending on the list to correct anything I get wrong. :-)
</BLOCKQUOTE>

<BLOCKQUOTE>
1) Delete everything in the chat script after the "CONNECT" line. Once
chat sees CONNECT, it's done. Leave the "" at the end of the line.
</BLOCKQUOTE>

<BLOCKQUOTE>
Thus all the login ID and password stuff will disapear from the chat file.
You can leave the things in /etc/ppp/ppp-login. They won't hurt anything
after you change the chat script.
</BLOCKQUOTE>

<BLOCKQUOTE>
2) Make a /etc/ppp/pap-secrets file and put in it:
</BLOCKQUOTE>

<BLOCKQUOTE><CODE>
<PRE>
* * &lt;your password&gt;
</PRE>
</CODE></BLOCKQUOTE>

<BLOCKQUOTE>
3) Add a line to /etc/ppp/options which contains:
</BLOCKQUOTE>

<BLOCKQUOTE><CODE>
<PRE>
user (your user name)
</PRE>
</CODE></BLOCKQUOTE>

<BLOCKQUOTE>
I think this should cover everything.
</BLOCKQUOTE>
</P>
<P></P>

<A NAME="F.E"></A> <H2>8.6 <A NAME="ss8.6"></A> Does anyone have a PPP setup that works with an ISP that doesn't allocate static IP addresses?</H2>

<P>From Bill Studenmund (wrstuden@loki.stanford.edu):</P>
<P>
<BLOCKQUOTE>
If you have a working ppp setup, YOU have a setup which works w/ dynamic
addresses. Just don't have an IP address set in your options file and
the other end will tell you your address. Unless you do something silly
like tell ppp to not negotiate the address.
</BLOCKQUOTE>

<BLOCKQUOTE>
ppp works fine w/ dynamic addresses. Oh, and do set the "defaultroute"
option for your dialup connection, and pppd will make it all work
right. When you dial up, you will get a default route. When you quit
the ppp link, the default route will go away. When you dial up again,
you will get a (different but correct) default route again.
</BLOCKQUOTE>

<BLOCKQUOTE>
To recap, your ppp chat file should end with the connection ready for
pppd to take over. If you are using account name & password logins,
the chat script should send them (possably with magic to keep others from
seeing the pw in a text file). If you are using PAP or CHAP, the chat
script should end just when PAP or CHAP authentication will happen.
</BLOCKQUOTE>
</P>
<P>Bill's 
<A HREF="ftp://ftp.macbsd.com/private/wrstuden/ppp.setup.tgz">PPP kit</A>

on puma should work just fine with dynamic addresses.  Keep in mind that
demand-dial PPP requires static IP addresses, though.</P>
<P></P>

<A NAME="F.F"></A> <H2>8.7 <A NAME="ss8.7"></A> Is there any documentation on PPP other than the manual pages?</H2>

<P>Yes.  O'Reilly and Associates happens to have the chapter on PPP
configuration from the <EM>Linux Network Administrator's Guide</EM> available on
the web:
<BLOCKQUOTE><CODE>
<A HREF="http://www.ora.com/catalog/linag/excerpt/ch08-01.htm">http://www.ora.com/catalog/linag/excerpt/ch08-01.htm</A>
</CODE></BLOCKQUOTE>

Although it was not written for NetBSD, most of it still applies, and the
section on PAP/CHAP authentication is quite helpful.</P>
<P>You might also want to try Mark Andres' (mark@ratbert.aisol.net) page on
how he setup PPP for his system:
<BLOCKQUOTE><CODE>
<A HREF="http://www2.giganet.net/~mark/NetBSD/ppp.html">http://www2.giganet.net/~mark/NetBSD/ppp.html</A>
</CODE></BLOCKQUOTE>
</P>
<P></P>

<A NAME="F.H"></A> <H2>8.8 <A NAME="ss8.8"></A> Why won't my network interface work now that I've upgraded to NetBSD 1.3?</H2>

<P>This is because the network interface file format and naming convention
have changed.  Instead of <CODE>hostname.ae0</CODE>, you now have a file named
<CODE>ifconfig.xxN</CODE> where xx is one of <CODE>ae</CODE>, <CODE>sn</CODE>, or <CODE>mc</CODE> depending
on your networking hardware, and N is the number of the interface (probably
0 unless you have multiple interfaces of the same type).  The contents of
this new file are simply the arguments that you would give to the
<CODE>ifconfig</CODE> command to bring up the interface manually.  Please see the
Networking Howto for more info:</P>
<P>
<A HREF="http://www.macbsd.com/macbsd/howto/networking/">http://www.macbsd.com/macbsd/howto/networking/</A>
</P>
<P></P>

<A NAME="F.I"></A> <H2>8.9 <A NAME="ss8.9"></A> I know that Netatalk is now supported in the kernel, but where can I find the userland utilities?</H2>

<P>They are not currently integrated in the NetBSD distribution (although this
is tentatively planned to happen by the 1.4 release).  A version of
Netatalk userland which has been patched to work with NetBSD is available
at:  </P>
<P>
<A HREF="ftp://ftp.macbsd.com/pub/NetBSD/contrib/netatalk/">ftp://ftp.macbsd.com/pub/NetBSD/contrib/netatalk/</A>

and
<A HREF="ftp://ftp.netbsd.org/pub/NetBSD/misc/netatalk/">ftp://ftp.netbsd.org/pub/NetBSD/misc/netatalk/</A>
</P>
<P>The next release of Netatalk should include the NetBSD-specific patches.</P>
<P></P>

<A NAME="F.J"></A> <H2>8.10 <A NAME="ss8.10"></A> Since the kernel understands AppleTalk now, does this mean I can use LocalTalk on my serial ports?</H2>

<P>No.  LocalTalk support isn't in the kernel quite yet.  However, Bill
Studenmund (wrstuden@loki.stanford.edu) is working on this when he has time.</P>
<P></P>
<P></P>

<P>
<HR>
<A HREF="faq-9.html">Next</A> Chapter,
<A HREF="faq-7.html">Previous</A> Chapter
<HR>
</P>
<P>
Table of contents of <A HREF="faq.html#toc8">this chapter</A>,
 General <A HREF="faq.html#toc">table of contents</A></P>
<P>
<A HREF="faq.html">Top</A> of the document,
 <A HREF="#0"> Beginning of this Chapter</A></P>

<hr>
<address>
  www@NetBSD.ORG<br>
  $NetBSD: faq-8.html,v 1.1.1.1 1999/05/02 12:45:30 kenn Exp $<br>
  <a href="../../../Misc/disclaimer.html">Copyright &copy; 1997, 1998
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
</address>

</BODY>
</HTML>
