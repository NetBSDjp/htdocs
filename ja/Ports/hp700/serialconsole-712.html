<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html lang="ja">
<head>
<!-- Copyright (c) 2002-2003
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@jp.NetBSD.org">
<title>NetBSD/hp700: HP 9000/712 モデルでのシリアルコンソールへの移行方法
</title>
</head>
<body bgcolor="#ffffff" text="#000000" link="#2020cc" vlink="#700080">

<h1>NetBSD/hp700: HP 9000/712 モデルでのシリアルコンソールへの移行方法</h1>

<p><em>警告:
不適切なコンソールパスを設定すると、システムが操作不能になるおそれがあります。
気をつけてください。
</em>

<p>困ったことに、 HP は、 712 をヘッドレスで使うための設定をしづらいようにしてしまいました。
手短にいうと、HP-UX ブートローダープロンプト(<tt>ISL</tt> と呼ばれます)
に入る必要があります。ここから、コンソールを 9600 8N1
の一番目のシリアルポートに固定することができます。

<p>この説明の一次情報源は、
<a href="http://lists.parisc-linux.org/pipermail/parisc-linux/1999-December/008117.html"
>http://lists.parisc-linux.org/pipermail/parisc-linux/1999-December/008117.html</a> です。

<p>シリアルコンソールを変更するには、以下のものが必要です。

<ol>
<li>PS/2 キーボード
<li>VGA インターフェースを持つモニター
<li>HP-UX ISL (HP-UX がブート可能なハードディスクとネットブートのどちらでも可)
</ol>

<p>最初に、BootROM プロンプトに入る必要があります。
システムが以下の表示をしたら <tt>ESC</tt> キーを押し、
<tt>BOOT_ADMIN&gt;</tt> プロンプトが出るまで押し続けます。
<pre>Press &lt;ESCAPE&gt; to stop boot sequence.</pre>

<h2>段階 1: モニタータイプの設定</h2>

<p>ディスプレイの表示がおかしい場合は、周波数が外れている可能性があります。
ディスプレイに合ったモニタータイプを選ぶことができます。
<p>712 に VRAM ボードを増設している場合は、通常の VGA 680x480 モードの
モニタータイプは 7 です。 VRAM ボードがない場合はこれとは異なる可能性があります (おそらく 5?)。

<pre>
BOOT_ADMIN&gt; <b>monitor 7</b>
        Monitor Choices
Type     Resolution     Frequency
----     ----------     ---------
  1      1280x1024        72Hz
  2      1024x768         75Hz
  3      1024x768         70Hz
  4      1024x768         75Hz     Flat Panel
  5      1280x1024        60Hz
  6      1024x768         60Hz
  7       640x480         60Hz
  8      1280x1024        75Hz     VESA
  9      1024x768         75Hz     VESA
 10       800x600         75Hz     VESA
 11       640x480         75Hz     VESA
 12      1280x1024        72Hz     Greyscale
 13      1280x1024        50Hz

Current Monitor Type is
  7       640x480         60Hz

BOOT_ADMIN&gt; <b>reset</b>
</pre>

<h2>段階 2, 場合 1: HP-UX がローカルディスクにインストールされている場合</h2>

<pre>
BOOT_ADMIN&gt; <b>boot pri isl</b>

Booting

ISL Revision A.00.38  OCT 26, 1994 


ISL&gt;
</pre>

<h2>段階 2, 場合 2: HP-UX がない場合</h2>

<p>準備すること:

<ol>

<li>HP のサイトからファームウェアアップデート
(<a href="ftp://ftp.itrc.hp.com/firmware_patches/hp/cpu/PF_C7120023"
>PF_C7120023</a>) を入手します
(ただし、この段階ではファームウェアを更新しません)。

<li>バイナリーを展開します。
<pre>
    % <b>mkdir /tmp/712</b>
    % <b>cd /tmp/712</b>
    % <b>sh /<var>somewhere</var>/PF_C7120023</b>
    x - C7120023.text
    Compiling unpacker for non-ascii files
    /tmp/ccIy0Rg8.o: warning: this program uses gets(), which is unsafe.
    x - C7120023.frm [compressed]
    ERROR: wc results of C7120023.frm are 5518 32547 709632 should be 5518 22318 709632
    % <b>rm /tmp/uud*end</b>
</pre>
<p>HP-UX 以外の OS 上で実行した場合、チェックサムが異なるかもしれませんが、
たぶんそれでもかまいません。

<li><a href="../../Documentation/network/netboot/intro.hp700.html">
ネットブートの設定</a> (BOOTP と tftp を使用) をして、さきほど展開したファイルでブートできるようにします
(dhcpd.conf または bootptab で C7120023.frm を指定し、tftpd を設定するだけです)。
<p>
<li>LAN から 712 をブートします。
<pre>
BOOT_ADMIN&gt; <b>boot lan isl</b>

Booting

ISL Revision A.00.25 November 18, 1992 


ISL&gt;
</pre>

</ol>

<h2>段階 3: コンソールの場所の設定</h2>
シリアルコンソールを使うようにするため、712 で以下のコマンドを実行します。
<pre>ISL&gt; <b>conspath 2/0/4.0x283</b>
</pre>

712 がローカルコンソール (つまり、キーボードとスクリーン) を使うように設定するには、
以下のコマンドを実行します。
<pre>
ISL&gt; <b>conspath 1/0/0.0</b>
</pre>

<tt>display</tt> および <tt>information</tt> コマンドを使って、
設定が正しく保存されたか確認することができます。
すべて順調にできていれば、
ワークステーションの電源を再投入してシリアルコンソールの使用を開始します。

<p>さらに、リセット時に PS/2 キーボードの <kbd>Esc</kbd> キーを押し続けると、
一時的にローカルコンソールを使うことができます。
この方法は、コンソールの場所を一時的に変えるだけで、
ファームウェアのリビジョン 1.6 およびそれ以降でのみ使えます。


<h2>使用例</h2>

<pre>
----------------------------------------------------------------------------
BootRom Version    1.6  

Memory Size:  64 MB
----------------------------------------------------------------------------




(c) Copyright 1990-1993, Hewlett-Packard Company.
All rights reserved

Press &lt;ESCAPE&gt; to stop boot sequence.
<b>&lt;ESC&gt;</b>
Selecting a system to boot.
----------------------------------------------------------------------------
Command                             Description
-------                             -----------
Auto [boot|search] [on|off]         Display or set auto flag
Boot [pri|alt|scsi.addr] [isl]      Boot from primary, alternate or SCSI
Boot lan[.lan_addr] [install] [isl] Boot from LAN
Chassis [on|off]                    Enable chassis codes
Diagnostic [on|off]                 Enable/disable diagnostic boot mode
Fastboot [on|off]                   Display or set fast boot flag
Help                                Display the command menu
Information                         Display system information
LanAddress                          Display LAN station addresses
Monitor [type]                      Select monitor type
Path [pri|alt] [lan.id|SCSI.addr]   Change boot path
Pim [hpmc|toc|lpmc]                 Display PIM info
Search [ipl] [scsi|lan [install]]   Display potential boot devices
Secure [on|off]                     Display or set security mode
----------------------------------------------------------------------------
BOOT_ADMIN&gt; <b>monitor 7</b>
        Monitor Choices
Type     Resolution     Frequency
----     ----------     ---------
  1      1280x1024        72Hz
  2      1024x768         75Hz
  3      1024x768         70Hz
  4      1024x768         75Hz     Flat Panel
  5      1280x1024        60Hz
  6      1024x768         60Hz
  7       640x480         60Hz
  8      1280x1024        75Hz     VESA
  9      1024x768         75Hz     VESA
 10       800x600         75Hz     VESA
 11       640x480         75Hz     VESA
 12      1280x1024        72Hz     Greyscale
 13      1280x1024        50Hz

Current Monitor Type is
  7       640x480         60Hz

BOOT_ADMIN&gt; <b>reset</b>

----------------------------------------------------------------------------
BootRom Version    1.6  

Memory Size:  64 MB
----------------------------------------------------------------------------




(c) Copyright 1990-1993, Hewlett-Packard Company.
All rights reserved

Press &lt;ESCAPE&gt; to stop boot sequence.
<b>&lt;ESC&gt;</b>
Selecting a system to boot.
----------------------------------------------------------------------------
Command                             Description
-------                             -----------
Auto [boot|search] [on|off]         Display or set auto flag
Boot [pri|alt|scsi.addr] [isl]      Boot from primary, alternate or SCSI
Boot lan[.lan_addr] [install] [isl] Boot from LAN
Chassis [on|off]                    Enable chassis codes
Diagnostic [on|off]                 Enable/disable diagnostic boot mode
Fastboot [on|off]                   Display or set fast boot flag
Help                                Display the command menu
Information                         Display system information
LanAddress                          Display LAN station addresses
Monitor [type]                      Select monitor type
Path [pri|alt] [lan.id|SCSI.addr]   Change boot path
Pim [hpmc|toc|lpmc]                 Display PIM info
Search [ipl] [scsi|lan [install]]   Display potential boot devices
Secure [on|off]                     Display or set security mode
----------------------------------------------------------------------------
BOOT_ADMIN&gt; <b>boot lan isl</b>

Booting

ISL Revision A.00.25 November 18, 1992 


ISL&gt; <b>display</b>

    Fastsize value is 0000000F

    Autoboot is ON (enabled)

    Autosearch is ON (enabled)

    Primary boot path is 2/0/1.6.0.0.0.0.0
    Primary boot path is (hex) 2/0/1.6.0.0.0.0.0

    Alternate boot path is 2/0/2.0.0.0.0.0.0
    Alternate boot path is (hex) 2/0/2.0.0.0.0.0.0

    System console path is 1.0.0.0.0.0.0
    System console path is (hex) 1.0.0.0.0.0.0

ISL&gt; <b>conspath 2/0/4.0x283</b>

ISL&gt; <b>display</b>

    Fastsize value is 0000000F

    Autoboot is ON (enabled)

    Autosearch is ON (enabled)

    Primary boot path is 2/0/1.6.0.0.0.0.0
    Primary boot path is (hex) 2/0/1.6.0.0.0.0.0

    Alternate boot path is 2/0/2.0.0.0.0.0.0
    Alternate boot path is (hex) 2/0/2.0.0.0.0.0.0

    System console path is 2/0/4.643.0.0.0.0.0
    System console path is (hex) 2/0/4.283.0.0.0.0.0

ISL&gt; 

</pre>

<p>この後、電源を再投入します。

<hr>
<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../../"><img
        src="../../../images/NetBSD-flag.png" border="0"
        width="90" height="90" alt=""></a>
  </td><td>
    <a href="../../"><img
        src="../../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">ホームページ</a>
  </td></tr></table>
</td><td>
  <table><tr><td>
    <a href="../../Ports/"><img
        src="../../../images/NetBSD-flag.png" border="0"
        width="90" height="90" alt=""></a>
  </td><td> 
    <a href="../../Ports/"><img
        src="../../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">対応アーキテクチャー</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  www@jp.NetBSD.org<br>
  $NetBSD: serialconsole-712.html,v 1.5 2004/10/30 22:33:46 jschauma Exp $<br>
  <!-- Based on english version: -->
  <!-- NetBSD: serialconsole-712.html,v 1.5 2004/10/30 22:33:46 jschauma Exp   -->
  <a href="../../Misc/disclaimer.html">Copyright &copy; 2002-2003
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
