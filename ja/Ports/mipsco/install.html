<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
<!-- Copyright (c) 1994-2001
        The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@JP.NetBSD.ORG">
<title>NetBSD/mipsco: Installation Notes</title>
</head>
<body bgcolor="#ffffff" text="#000000" link="#2020cc" vlink="#700080">

<h1>NetBSD/mipsco インストールノート</h1>

<hr>
<i>この文書はまだ作成されたばかりの段階であり、いずれ INSTALL
マニュアルページが書かれればそれに置き換えられることになります</i>
<hr>
<p>

<h3>対応ハードウェア</h3>

現在のところ、 Mips Magnum 3000 ワークステーション上の下記のデバイスがサポートされています
<p>

<ul>
<li>オンボード NCR 53c94 SCSI コントローラー</li>
<li>オンボード AM7990 Lance Ethernet コントローラー</li>
<li>オンボード Z8530 シリアルポート 0 および 1</li>
</ul>
<p>

現在のところ、下記のデバイスはサポートされていません:
<p>

<ul>
<li>ISA 拡張バス</li>
<li>Intel 82072 フロッピーディスクコントローラー</li>
<li>フレームバッファー (モノクロ、カラーいずれも)</li>
<li>PS/2 キーボードコントローラー</li>
</ul>
<p>

<h3>はじめましょう</h3>

現在のところ、 NetBSD カーネルのブートは、 RISC/os ディスクパーティション
から、または bootp を利用したネットワーク経由でのみ可能です。<br>

NetBSD/sparc や NetBSD/newsmips など、他のビッグエンディアンのマシンで
NetBSD パーティションを作る必要があります
<p>

miniroot ファイルシステムと構築済スナップショットを使って、ディスク分割と
NetBSD インストールを直接可能にするような、インストール作業単純化のための
作業がおこなわれています。
<p>

まず最初に、最新のカーネルのコピーを <a
href="ftp://ftp.netbsd.org/pub/NetBSD/arch/mipsco/snapshot/">ftp.netbsd.org/pub/NetBSD/arch/mipsco/snapshot/</a>
から入手します。
<p>

<h3>RISC/os ディスクパーティションからブートする</h3>

動作するバージョンの RISC/os がマシンにインストールされていれば、
これは、ずば抜けて最も簡単なカーネルのブート方法です。<br>

netbsd カーネルファイルを単に RISC/os オペレーティングシステムにコピーして
おくだけで、シャットダウンし、以下のようにして新しいカーネルからブートできます:

<blockquote><tt>boot dksd(,,0)/netbsd</tt></blockquote>

この方法では、まず stand alone shell (SASH) を dksd(,,8)sash から
ロードし、それから NetBSD カーネルをロードします。
<p>

<h3>bootp と tftp を使ってネットワークブートする</h3>

Mips PROM ファームェアには、 bootp プロトコルに関していくつかの制限があります:
<p>

<ul>
<li>マシンの IP アドレスは bootp を使っては決定されません - prom 環境変数
'netaddr' を設定する必要があります
<li>ブロードキャストアドレスは、 netaddr の設定にもとづき、厳密にクラス A、
B または C が使われます
<li>使われるブロードキャストアドレスは、オールゼロな形式です。
OS によってはこのアドレスをデフォルトでは受け付けず、
ifconfig の引数で明示する必要があります。
</ul>
<p>

bootp および tftp デーモンの設定の詳細については、どうか上記の制限を念頭に置いた上で <a
href="../../Documentation/network/netboot/">Diskless
NetBSD HOW-TO</a>&nbsp; を参照してください。
<p>

イーサネット MAC アドレスを決めるための最も簡単な方法は、
'<tt>tcpdump -e</tt>' を使ってネットワークを覗くことです。
<p>

サーバーで bootpd と tftpd を動かしておけば、ファームウェアで下記の
<b>太字</b>部分のコマンド使うことで、カーネルをブートすることができます

<blockquote>
<tt>Rx3230 MIPS Monitor: Version 5.43 OPT Mon May 13 17:31:12
PDT 1991 root</tt>
<br><tt>Memory size: 33554432 (0x2000000) bytes, 32 MB</tt>
<br><tt>Icache size: 32768 (0x8000) bytes</tt>
<br><tt>Dcache size: 32768 (0x8000) bytes</tt>
<br><tt>&gt;&gt; <b>setenv bootfile bootp()netbsd</b></tt>
<br><tt>&gt;&gt; <b>setenv netaddr&nbsp; 192.168.58.46</b></tt>
<br><tt>&gt;&gt; <b>boot</b></tt>
<br><tt>Obtaining netbsd from server netbsd-alpha.lab.niwa.cri.nz</tt>
<br><tt>1026032+501367+124032 entry: 0x80021000</tt>
<br><tt>Copyright (c) 1996, 1997, 1998, 1999, 2000</tt>
<br><tt>&nbsp;&nbsp;&nbsp; The NetBSD Foundation, Inc.&nbsp; All rights
reserved.</tt>
<br><tt>Copyright (c) 1982, 1986, 1989, 1991, 1993</tt>
<br><tt>&nbsp;&nbsp;&nbsp; The Regents of the University of California.&nbsp;
All rights reserved.</tt>
</blockquote>
<p>

<h3>NetBSD ファイルシステムのセットアップ</h3>

NetBSD/mipsco カーネルのブートに成功したら、残りの配布物を使って
ファイルシステムのセットアップが必要です。
<p>

<ol>
<li>ビッグエンディアンの NetBSD マシンでディスクにラベルを書き込み、適切な
ファイルシステムを用意します。ビッグエンディアンのマシンが必要になる理由は、
ディスクラベル値がホストのバイトオーダーによって書かれるからです。このため
MIPS R3000 ネイティブフォーマットと同じバイトオーダーであることが必要になります。
この手順は、ディスクの最初のセクターにオフセット 0x80 でディスクラベルを置く
NetBSD/sparc でうまくいくことがわかっています。
<li>NetBSD 配布物をダウンロードし、作ったファイルシステムのルートに
展開します。 mipsco の公式スナップショットができるまでは、 newsmips
か sgimips いずれかのスナップショットリリースを使うことができます

<ul>
<li><a href="ftp://ftp.netbsd.org/pub/NetBSD/arch/newsmips/snapshot/19991218/">ftp://ftp.netbsd.org/pub/NetBSD/arch/newsmips/snapshot/19991218/</a>
<li><a href="ftp://ftp.netbsd.org/pub/NetBSD/arch/sgimips/snapshot/20001123/">ftp://ftp.netbsd.org/pub/NetBSD/arch/sgimips/snapshot/20001123/</a>
</ul>
</li>

<li>&lt;rootdir&gt;/dev に移動し、そこで '.<tt>/MAKEDEV all'</tt> を実行して
デフォルトのデバイスノードを作ります。
<li>&lt;rootdir&gt;/etc に移動し、 rc.config その他のスタートアップファイルを
手動で設定します。
<li>ディスクをアンマウントしてドライブを Mips マシンにつなぎます
<li>bootp を使うかまたは RISC/os ディスクパーティションからカーネルをブートします。
ルートデバイスを尋ねられたらさきほど作ったルートファイルシステムのデバイス名を
答えます。
</ol>
<p>

<hr>
<a href="./">Up to <em>NetBSD/mipsco Port Page</em></a>
<hr>

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../../"><img
        src="../../../images/NetBSD-flag.gif" origlink="../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a>
  </td><td>
    <a href="../../"><img
        src="../../../images/empty.gif" origlink="../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">ホームページ</a>
  </td></tr></table>
</td><td>
  <table><tr><td>
    <a href="../../Ports/"><img
        src="../../../images/NetBSD-flag.gif" origlink="../../images/NetBSD-flag.gif" border="0"
        width="91" height="42" alt=""></a>
  </td><td> 
    <a href="../../Ports/"><img
        src="../../../images/empty.gif" origlink="../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">対応アーキテクチャー</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  (連絡先 - <a href="../../Misc/feedback.html">英語</a>,
       <a href="mailto:www@JP.NetBSD.ORG">日本語:
       www@JP.NetBSD.ORG</a>)<br>
  $NetBSD: install.html,v 1.9 2001/07/11 14:57:46 dent Exp $<br>
  <a href="../../Misc/disclaimer.html">Copyright &copy; 1994-2001
  The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
