<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Chapter 3. NetBSD 以外のシステムで pkgsrc を使う</title>
<link rel="stylesheet" type="text/css" href="/global.css">
<meta name="generator" content="DocBook XSL Stylesheets VX.X.X">
<link rel="home" href="index.html" title="The pkgsrc guide">
<link rel="up" href="users-guide.html" title="Part I. pkgsrc 利用者向けの手引き">
<link rel="prev" href="getting.html" title="Chapter 2. どこからpkgsrcを得て、どうやって最新に保つか">
<link rel="next" href="using.html" title="Chapter 4. pkgsrc を使う">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Chapter 3. NetBSD 以外のシステムで pkgsrc を使う</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="getting.html">Prev</a> </td>
<th width="60%" align="center">Part I. pkgsrc 利用者向けの手引き</th>
<td width="20%" align="right"> <a accesskey="n" href="using.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="chapter" title="Chapter 3. NetBSD 以外のシステムで pkgsrc を使う">
<div class="titlepage"><div><div><h2 class="title">
<a name="platforms"></a>Chapter 3. NetBSD 以外のシステムで pkgsrc を使う</h2></div></div></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="sect1"><a href="platforms.html#binarydist">3.1. バイナリー配布</a></span></dt>
<dt><span class="sect1"><a href="platforms.html#bootstrapping-pkgsrc">3.2. pkgsrc を使う準備をする</a></span></dt>
<dt><span class="sect1"><a href="platforms.html#platform-specific-notes">3.3. プラットフォーム別の覚書</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="platforms.html#darwin">3.3.1. Darwin (Mac OS X)</a></span></dt>
<dt><span class="sect2"><a href="platforms.html#freebsd">3.3.2. FreeBSD</a></span></dt>
<dt><span class="sect2"><a href="platforms.html#interix">3.3.3. Interix</a></span></dt>
<dt><span class="sect2"><a href="platforms.html#irix">3.3.4. IRIX</a></span></dt>
<dt><span class="sect2"><a href="platforms.html#linux">3.3.5. Linux</a></span></dt>
<dt><span class="sect2"><a href="platforms.html#openbsd">3.3.6. OpenBSD</a></span></dt>
<dt><span class="sect2"><a href="platforms.html#solaris">3.3.7. Solaris</a></span></dt>
</dl></dd>
</dl>
</div>
<div class="sect1" title="3.1. バイナリー配布">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="binarydist"></a>3.1. バイナリー配布</h2></div></div></div>
<p><a class="xref" href="using.html#using-pkg" title="4.1. バイナリーパッケージを使う">Section 4.1, “バイナリーパッケージを使う”</a>をご覧ください。</p>
</div>
<div class="sect1" title="3.2. pkgsrc を使う準備をする">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="bootstrapping-pkgsrc"></a>3.2. pkgsrc を使う準備をする</h2></div></div></div>
<p>ブートストラップキットは、以下のようにして簡単にソースからインストールすることができます。</p>
<pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>env CVS_RSH=ssh cvs -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout pkgsrc</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd pkgsrc/bootstrap</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./bootstrap</code></strong>
    </pre>
<p>bootstrap を実行する前に、上で例示した方法以外で
    pkgsrc を取得する方法については、<a class="xref" href="getting.html" title="Chapter 2. どこからpkgsrcを得て、どうやって最新に保つか">Chapter 2, <i>どこからpkgsrcを得て、どうやって最新に保つか</i></a>を参照してください。
    上で例示した <span class="command"><strong>bootstrap</strong></span> コマンドでは、
    <span class="emphasis"><em>prefix</em></span> (プログラムのインストール先) をデフォルトの
    <code class="filename">/usr/pkg</code> とし、
    パッケージデータベースのディレクトリー (pkgsrc 内部の記録用) を
    <code class="filename">/var/db/pkg</code> とします。
    これらをコマンドライン引数で設定することもできます。</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>bootstrap は  <span class="command"><strong>bmake</strong></span> ツールをインストールします。
      pkgsrc で構築をおこなう際には、この <span class="command"><strong>bmake</strong></span> を使ってください。
      たとえばこの手引きにおいて <span class="quote">“<span class="quote">make</span>”</span> は
      <span class="command"><strong>bmake</strong></span> に読み替えてください。</p>
</div>
</div>
<div class="sect1" title="3.3. プラットフォーム別の覚書">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="platform-specific-notes"></a>3.3. プラットフォーム別の覚書</h2></div></div></div>
<p>いくつかのプラットフォームについては、以下のことを知っておくとよいでしょう。</p>
<div class="sect2" title="3.3.1. Darwin (Mac OS X)">
<div class="titlepage"><div><div><h3 class="title">
<a name="darwin"></a>3.3.1. Darwin (Mac OS X)</h3></div></div></div>
<p>対応は、 Darwin 5.x 以上に対しておこなわれています。
      始める前に、Apple Developer Connection から Mac OS X Developer
      Tools をダウンロードしてインストールする必要があります。詳細は
      <a class="ulink" href="http://developer.apple.com/macosx/" target="_top">http://developer.apple.com/macosx/</a>
      をご覧ください。また、X11 Window System を使うパッケージを構築したい場合は、
      X11 (Developer Tools に附属するオプションパッケージ) をインストールしておくことも必要です。</p>
</div>
<div class="sect2" title="3.3.2. FreeBSD">
<div class="titlepage"><div><div><h3 class="title">
<a name="freebsd"></a>3.3.2. FreeBSD</h3></div></div></div>
<p>確認および対応は、 FreeBSD 4.7 および 5.0 に対しておこなわれています。
      これら以外のバージョンでも動くかもしれません。</p>
<p>ブートストラップキットのインストールに際しては、
      FreeBSD のユーザーランドのツールと衝突することがないように注意を払ってください。以下のような複数の事項があります。</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>FreeBSD の ports は、 <code class="filename">/var/db/pkg</code>
	  以下にパッケージデータベースを置きます。このため、
	  ブートストラップスクリプトの --pkgdbdir オプションで、
	  別の場所 (たとえば <code class="filename">/usr/pkgdb</code>)
	  を指定することをおすすめします。</p></li>
<li class="listitem">
<p>FreeBSD ports のツールを使う予定がない場合は、混同を避けるために、
	  それらを移動してしまってもいいかもしれません。たとえば以下のようにします。</p>
<pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/sbin</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_add pkg_add.orig</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_create pkg_create.orig</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_delete pkg_delete.orig</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_info pkg_info.orig</code></strong>
	  </pre>
</li>
<li class="listitem"><p>ブートストラップスクリプトを使った際、
	  <a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> ファイルの例は
	  <code class="filename">/etc/mk.conf.example</code> ファイルに置かれます。</p></li>
</ol></div>
</div>
<div class="sect2" title="3.3.3. Interix">
<div class="titlepage"><div><div><h3 class="title">
<a name="interix"></a>3.3.3. Interix</h3></div></div></div>
<p>Interix は Windows NT カーネルの POSIX 準拠のサブシステムで、
      Cygwin よりも密接にカーネルと統合された Unix 風の環境を提供します。
      Interix は Windows Services for Unix パッケージの一部であり、
      ライセンスされた Windows 2000, XP (XP Home は含まず), 2003 のコピー用として、
      無料で使うことができます。SFU は、<a class="ulink" href="http://www.microsoft.com/windows/sfu/" target="_top">http://www.microsoft.com/windows/sfu/</a> からダウンロードできます。</p>
<p>確認は、Services for Unix 3.5 に対しておこなわれています。 3.0
      や 3.1 でも動作するかもしれませんが、公式には対応していません。  (3.0/3.1 の主な違いは、
      pthreads がないことですが、このほかにも libc に欠けているものがあるかもしれません。)</p>
<p>Services for Unix Applications (別名 SUA) は、Windows Server 2003 R2
      (5.2), Windows Vista および Windows Server 2008
      (6.0), Windows 7 および Windows Server 2008 R2 (6.1)
      に統合されている構成要素です。本稿執筆時点において、
      SUA の Interix 6.0 (32 ビット) および 6.1 (64 ビット) サブシステムで確認がおこなわれています。
      これら以外のバージョンでも動作するかもしれません。
      Interix 5.x サブシステムで、pkgsrc を使った確認はまだおこなわれていません。</p>
<div class="sect3" title="3.3.3.1. Interix/SFU のインストールに際して">
<div class="titlepage"><div><div><h4 class="title">
<a name="platform.interix-sfu-install"></a>3.3.3.1. Interix/SFU のインストールに際して</h4></div></div></div>
<p>pkgsrc を使うためには、Windows Services for Unix 3.5 の配布物のうち、
	最低限、以下のパッケージをインストールする必要があります。</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>Utilities -&gt; Base Utilities</p></li>
<li class="listitem"><p>Interix GNU Components -&gt; (all)</p></li>
<li class="listitem"><p>Remote Connectivity</p></li>
<li class="listitem"><p>Interix SDK</p></li>
</ul></div>
<p>Interix 上で pkgsrc を使う場合、Utilities 以下の "UNIX Perl"
	はインストールしないでください。これは共有モジュールに対応していない Perl 5.6 で、
	/usr/local にインストールされますが、混乱を起こすだけです。これのかわりに、
	pkgsrc (またはバイナリーパッケージ) の Perl 5.8 をインストールします。</p>
<p>Remote Connectivity 以下の "Windows Remote Shell Service"
	のインストールは必須ではありませんが、inetd を動作させるために Remote Connectivity
	そのものはインストールすることをおすすめします。</p>
<p>インストール中に、Interix のプログラムに対して setuid を有効にするかどうか、
	また、パス名の大文字と小文字を標準で区別するかどうかを尋ねられるかもしれません。
	setuid は有効にするようにし、また大文字と小文字はかならず区別するようにします。
	(大文字と小文字を区別しないと、
	perl をはじめ多くのプログラムが構築できなくなります。)</p>
<p>註:  最近の Windows サービスパックでは、
	バイナリーを実行する方法を (データ実行防止機能を使ったものに) 変更します。
	pkgsrc その他の gcc でコンパイルされたバイナリーを信頼して使うためには、
	POSIX.EXE, PSXDLL.DLL, PSXRUN.EXE, PSXSS.EXE (899522 またはこれより新しいもの)
	を含んだホットフィックスをインストールする必要があります。
	ホットフィックスは Microsoft からサポート窓口を通じて提供されていますが、
	Debian Interix Port が、ほとんどの Interix ホットフィックスを個人的に使えるように <a class="ulink" href="http://www.debian-interix.net/hotfixes/" target="_top">http://www.debian-interix.net/hotfixes/</a>
	に用意しています。</p>
<p>Interix を使えるようにするためには、上述のホットフィックスのほか、
	Data Execution Prevention を完全に無効化する必要があるかもしれません。
	これが必要となるのは、ある種の CPU を使っている場合だけです。
	上述のホットフィックスのいずれかひとつをインストールした後にも
	gcc その他のアプリケーションが依然として繰り返し segfault する場合には、
	Windows ブートドライブ上の適切な "boot.ini" 行に、
	以下のオプションを追加することができます: /NoExecute=AlwaysOff
	(警告: これは DEP を完全に無効化するものであり、
	Administrators グループのユーザーとしてアプリケーションをよく実行する場合には、
	セキュリティー上の危険となる可能性があります。)</p>
</div>
<div class="sect3" title="3.3.3.2. Interix/SFU がインストール済みの場合はどうすればよいか">
<div class="titlepage"><div><div><h4 class="title">
<a name="platform.interix-sfu-postinstall"></a>3.3.3.2. Interix/SFU がインストール済みの場合はどうすればよいか</h4></div></div></div>
<p>SFU がすでにインストールされており、その設定を変更して
	pkgsrc が動作するようにしたい場合は、以下のことに気をつけてください。</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>UNIX Perl をアンインストールするため、Add/Remove Programs を使い、Microsoft
	    Windows Services for UNIX を選んで Change をクリックします。インストーラーで
	    Add or Remove を選んでから Utilities-&gt;UNIX Perl のチェックを外します。</p></li>
<li class="listitem">
<p>ファイルシステムの大文字と小文字の区別を有効にするため、REGEDIT.EXE を実行して
	    以下のレジストリーキーを変更します。</p>
<p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel</p>
<p>DWORD 値 "obcaseinsensitive" を 0 に設定した後、リブートします。</p>
</li>
<li class="listitem">
<p>setuid バイナリーを有効にするため (これは必須ではありません)、REGEDIT.EXE を実行して
	    以下のレジストリーキーを変更します。</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Services for UNIX</p>
<p>DWORD 値 "EnableSetuidBinaries" を 1 に設定した後、リブートします。</p>
</li>
</ul></div>
</div>
<div class="sect3" title="3.3.3.3. pkgsrc を使ううえで重要な覚書">
<div class="titlepage"><div><div><h4 class="title">
<a name="platform.interix-notes"></a>3.3.3.3. pkgsrc を使ううえで重要な覚書</h4></div></div></div>
<p>パッケージの管理者 (pkgsrc の "su" ユーザーと
	"pkg_add" を実行するユーザーのいずれかまたは両方) は、ローカルの Administrators
	グループに所属している必要があります。bootstrap を実行するユーザーも同様です。これは、通常の
	pkgsrc が "root" を要求するのにくらべ、若干緩い条件です。</p>
<p>パッケージの管理者は umask を 002 に設定するようにします。そうしておかないと、
	自動的に "make install" が文句をいうようになります。こう設定することで、
	/var/db/pkg 以下に書かれるディレクトリーに Administrators グループが確実に書き込み可能とできます。</p>
<p>http://www.interopsystems.com/ にある人気のある Interix バイナリーパッケージは、
	古いバージョンの pkgsrc の pkg_* ツールを使います。
	理想的には、これらは pkgsrc と混用しないほうがよいものです。
	これらを pkgsrc のパッケージと同時に使う場合は、かならず、
	それぞれのバイナリーパッケージに応じて適切な pkg_* ツールを使うようにしてください。</p>
<p>DOS 型のコンソールウィンドウ (csh および ksh
	のスタートアップショートカットから起動されるものを含む)
	用の TERM の設定は "interix" です。
	たいていのシステムには、そのような termcap/terminfo エントリーがありませんが、
	ほとんどの場合、以下のような .termcap エントリーを用意すれば十分です。</p>
<pre class="programlisting">
interix:kP=\E[S:kN=\E[T:kH=\E[U:dc@:DC@:tc=pcansi:
	</pre>
</div>
<div class="sect3" title="3.3.3.4. Interix プラットフォームの制約">
<div class="titlepage"><div><div><h4 class="title">
<a name="platform.interix-limits"></a>3.3.3.4. Interix プラットフォームの制約</h4></div></div></div>
<p>Interix は、完全な Unix 風のプラットフォームの
	とっつきやすく柔軟な代替品としては十分なものですが、Interix
	を最大限に活用したい場合は、若干の制約があることを知っておくとよいでしょう。</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<p><span class="strong"><strong>X11:</strong></span></p>
<p>Interix には標準的な X11R6 クライアントライブラリー一式が附属しており、
	  X11 にもとづくアプリケーションを実行することができますが、
	  X サーバーは附属<span class="emphasis"><em>しません</em></span>。X サーバーの選択肢としては、
	  <a class="ulink" href="http://www.starnet.com/products/xwin32/" target="_top">StarNet X-Win32</a>,
	  <a class="ulink" href="http://connectivity.hummingbird.com/products/nc/exceed/" target="_top">Hummingbird Exceed</a>
	  (Interix 用に調整された
	  <a class="ulink" href="http://www.interopsystems.com/InteropXserver.htm" target="_top">Interop X Server</a>
	  というものを、Interop Systems が提供しています) や、
	  <a class="ulink" href="http://x.cygwin.com/" target="_top">Cygwin</a>
	  に含まれるフリーの X11 サーバーがあります。</p>
</li>
<li class="listitem">
<p><span class="strong"><strong>X11 アクセラレーション:</strong></span></p>
<p>Interix は、Win32 アプリケーションとは完全に別の
	  NT サブシステム内で動いているため、現在のところ、アクセラレーションのための
	  X11 プロトコルの各種拡張 (MIT-SHM や DGA など) には対応していません。
	  ローカルの X サーバーを使った対話的なアプリケーションのほとんどは、
	  そこそこ速く動きますが、フルモーションビデオなど画像に特化したアプリケーションを動かすには、
	  思ったよりも速い CPU が必要になるかもしれません。</p>
</li>
<li class="listitem">
<p><span class="strong"><strong>オーディオ:</strong></span></p>
<p>Interix は、オーディオ出力にネイティブで対応していません。
	  オーディオに対応するため、pkgsrc では Interix 上で <span class="command"><strong>esound</strong></span>
	  クライアントサーバー型オーディオシステムを使っています。
	  他のほとんどのプラットフォームとは異なり、
	  <a href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc/audio/esound/README.html" target="_top"><code class="filename">audio/esound</code></a> パッケージには、
	  <span class="command"><strong>esd</strong></span> サーバーが含まれません。
	  Interix ホストを経由してオーディオを出力するには、
	  <a href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc/emulators/cygwin_esound/README.html" target="_top"><code class="filename">emulators/cygwin_esound</code></a>
	  パッケージもあわせてインストールする必要があります。</p>
</li>
<li class="listitem">
<p><span class="strong"><strong>CD/DVD, USB, SCSI:</strong></span></p>
<p>現在のところ、Interix はデバイスへの直接のアクセスに対応していませんので、
	  CD/DVD ドライブ、USB デバイス、SCSI デバイスを、
	  ファイルシステム経由以外の方法で使うことはできません。このため、
	  Interix を使って、直接 CD/DVD を焼くことなどはできません。</p>
</li>
<li class="listitem">
<p><span class="strong"><strong>テープドライブ:</strong></span></p>
<p>CD-ROM や SCSI デバイスと同様の制約があるため、
	  Interix ではテープドライブに直接アクセスすることもできません。ただし、
	  Cygwin を介して使うことで (Cygwin の esound
	  サーバーを介してオーディオを使えるように)
	  テープドライブにアクセスできるようにするための作業がおこなわれています。</p>
</li>
</ul></div>
</div>
<div class="sect3" title="3.3.3.5. Interix 上での pkgsrc に関する、既知の問題">
<div class="titlepage"><div><div><h4 class="title">
<a name="platform.interix-knownissues"></a>3.3.3.5. Interix 上での pkgsrc に関する、既知の問題</h4></div></div></div>
<p>一般的に、Windows システム上に "root" ユーザーを用意することは必須ではありません。
	ユーザーがローカルの Administrators グループに属してさえいれば、それで十分です。
	ただし、現在のところ、パッケージのなかには
	"root" という名前のユーザーが特権ユーザーであることを前提にしているものがあります。
	そのようなパッケージのために、"root" という名前のユーザーを作ってもかまいませんが、
	ローカルの Administrators グループ (または、お使いの言語でこれに対応するもの)
	に属させるようにしてください。</p>
<p><span class="command"><strong>pkg_add</strong></span> は、<code class="filename">$PKG_DBDIR</code> 内のディレクトリーを、モード 0775 ではなく
	0755 で作成します。この問題を回避するため、当面は、ローカルの
	Administrator (または、お使いの言語でこれに対応するもの)
	としてパッケージをインストールするか、
	各パッケージのインストール後に以下のコマンドを実行してください。</p>
<pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>chmod -R g+w $PKG_DBDIR</code></strong>
	</pre>
</div>
</div>
<div class="sect2" title="3.3.4. IRIX">
<div class="titlepage"><div><div><h3 class="title">
<a name="irix"></a>3.3.4. IRIX</h3></div></div></div>
<p>機能する C コンパイラー、つまり、 gcc または SGI の MIPS
      および MIPSpro コンパイラー (cc/c89) が必要です。 <code class="varname">CC</code> 環境変数を、
      使用するコンパイラーに応じて設定してください。
      MIPSpro コンパイラースイートのライセンスがない場合は、<a class="ulink" href="http://freeware.sgi.com/" target="_top">http://freeware.sgi.com/</a>
      から gcc の tar 配布ファイルをダウンロードすることができます。</p>
<p>IRIX 6.5.17 以上が必要です。
      このバージョンの IRIX で <a class="citerefentry" href="http://netbsd.gw.com/cgi-bin/man-cgi?if_indextoname+3+NetBSD-5.0.1+i386"><span class="citerefentry"><span class="refentrytitle">if_indextoname</span>(3)</span></a>, <a class="citerefentry" href="http://netbsd.gw.com/cgi-bin/man-cgi?if_nametoindex+3+NetBSD-5.0.1+i386"><span class="citerefentry"><span class="refentrytitle">if_nametoindex</span>(3)</span></a>
      などへの対応がおこなわれたからです。</p>
<p>現在のところ、pkgsrc は同時には一つの ABI にしか対応しません。つまり、
	古い 32 ビット ABI、新しい 32 ビット ABI、64 ビット ABI を切り替えることはできません。
	最初に "abi=n32" を使って始めた場合は、
	すべてのパッケージがこれを使って構築されることになります。</p>
<p>このため、環境変数または <a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> の
      <code class="varname">CFLAGS</code> が衝突しないようにしてください。
      特に、 n32 オブジェクトファイルに lib64 を、また、その逆の組合せを、
      リンクしないようにしてください。
      <code class="filename">/etc/compiler.defaults</code> を確認してください。</p>
<p>pkgsrc ツリーの実体を別ホストから NFS を使ってマウントしている場合は、必ず
      <code class="varname">WRKOBJDIR</code> をローカルのディレクトリーに設定しておいてください。
      IRIX のリンカーは、ネットワーク経由でマウントされたファイルシステム越しにリンクするときに
      問題を起こすことが時々あるからです。</p>
<p>事前準備の過程では、imake(1) などのプログラムにすべて正しいオプションが設定されるはずですが、
      ローカルの設定に依存するオプションを設定したい場合があるかもしれません。
      詳細は、<code class="filename">pkgsrc/mk/defaults/mk.conf</code> をご覧ください。
      そしてもちろん、お使いのコンパイラーのマニュアルページもご覧ください。</p>
<p>SGI の MIPSPro コンパイラーを使っている場合は、
         <a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> で

      </p>
<pre class="programlisting">
PKGSRC_COMPILER=        mipspro
      </pre>
<p>

      を設定してください。これを設定しないと、
      pkgsrc は gcc を使っていることを仮定するので、コンパイラーに不適切なフラグを渡すことがあります。
      なお、標準状態では、bootstrap は適切な <code class="filename">mk.conf.example</code>
      を作成するはずです。</p>
<p>gcc と MIPSPro コンパイラーチェインの両方をインストールしているが、
      必ず MIPSPro を使うようにしたい場合は、<code class="varname">PATH</code>
      に gcc の場所 (ありがちなのは
      <code class="filename">/usr/freeware/bin</code>) を<span class="emphasis"><em>含めない</em></span>でください。さらに (重要)、
      '--preserve-path' フラグを bootstrap に渡してください。</p>
</div>
<div class="sect2" title="3.3.5. Linux">
<div class="titlepage"><div><div><h3 class="title">
<a name="linux"></a>3.3.5. Linux</h3></div></div></div>
<p>Linux のなかには、libtermcap と libcurses (libncurses) のいずれかを必要とするものがあります
      (たとえば Debian GNU/Linux など)。そのようなディストリビューションでは
      libncurses-dev パッケージ (または相当品) をインストールすれば問題なくなるはずです。</p>
<p>pkgsrc は gcc (GNU Compiler Collection) と icc
      (Intel C++ Compiler) のどちらにも対応しています。gcc が標準で使われます。
      icc は i386 上の icc 8.0 と 8.1 で確認がおこなわれています。      </p>
<p>icc を使って bootstrap をおこなうには、以下のようにします
      (icc は標準のディレクトリーにインストールされているものとします)。</p>
<pre class="programlisting">
env CC=/opt/intel_cc_80/bin/icc LDFLAGS=-static-libcxa \
ac_cv___attribute__=yes ./bootstrap
      </pre>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>icc 8.1 では、引数の -static-libcxa を `-i-static' にする必要があります。</p>
</div>
<p>icc は __attribute__ に対応していますが、GNU configure のテストではネストした関数を使っており、
      icc はネストした関数に対応していません。__attribute__ を #undef してしまうと、
      Linux の多くのヘッダーファイルが __attribute__ なしでは正しくコンパイルできず、
      壊れてしまうという副作用があります。このため、テストは、コンパイラーが
      __attribute__ に対応しているとしたもので上書きする必要があります。</p>
<p>bootstrap した後に、<a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> で
      <code class="varname">PKGSRC_COMPILER</code> を設定します。</p>
<pre class="programlisting">
PKGSRC_COMPILER=        icc
      </pre>
<p>icc がインストールされるディレクトリーは標準では
      <code class="filename">/opt/intel_cc_80</code> であり、pkgsrc
      でもこのディレクトリーを標準としています。これ以外のディレクトリーに
      icc をインストールしている場合は、<a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> で
      <code class="varname">ICCBASE</code> を設定してください。</p>
<pre class="programlisting">
ICCBASE=                /opt/icc
      </pre>
<p>pkgsrc は、icc が提供する実行時ライブラリーを静的リンクするので、
      作られたバイナリーはその共有ライブラリーがインストールされていないシステムでも
      動かすことができます。</p>
<p>ただし、libtool は、C++ の共有ライブラリーをリンクして記録する時に実行された
      (ライブラリーごとに -Bstatic や -Bdynamic オプションの指定がまちまちな)
      <a class="citerefentry" href="http://netbsd.gw.com/cgi-bin/man-cgi?ld+1+NetBSD-5.0.1+i386"><span class="citerefentry"><span class="refentrytitle">ld</span>(1)</span></a> コマンドをもとにライブラリーの一覧を展開します
      このことから、libtool でリンクされた C++ の共有ライブラリーは、libtool が修正されない限り、
      icc のライブラリーに対して実行時依存性を持った状態になります。</p>
</div>
<div class="sect2" title="3.3.6. OpenBSD">
<div class="titlepage"><div><div><h3 class="title">
<a name="openbsd"></a>3.3.6. OpenBSD</h3></div></div></div>
<p>確認および対応は、 OpenBSD 3.0 および 3.2 に対しておこなわれています。</p>
<p>ブートストラップキットのインストールに際しては、
	OpenBSD のユーザーランドのツールと衝突することがないように注意を払ってください。以下のような複数の事項があります。</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>OpenBSD の ports は、 <code class="filename">/var/db/pkg</code>
	  以下にパッケージデータベースを置きます。このため、
	  ブートストラップスクリプトの --pkgdbdir オプションで、
	  別の場所 (たとえば <code class="filename">/usr/pkgdb</code>)
	  を指定することをおすすめします。</p></li>
<li class="listitem">
<p>OpenBSD ports のツールを使う予定がない場合は、混同を避けるために、
	  それらを移動してしまってもいいかもしれません。たとえば以下のようにします。</p>
<pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/sbin</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_add pkg_add.orig</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_create pkg_create.orig</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_delete pkg_delete.orig</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv pkg_info pkg_info.orig</code></strong>
	  </pre>
</li>
<li class="listitem">
<p>ブートストラップスクリプトを使った際、
	    <a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> ファイルの例は
	    <code class="filename">/etc/mk.conf.example</code> ファイルに置かれます。
	    OpenBSD の make プログラムは
	    <a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> も使います。
	    このファイル中の pkgsrc 特有の記述を以下のように括ることで、
	    回避することができます。</p>
<pre class="programlisting">
.ifdef BSD_PKG_MK
# pkgsrc の記述。たとえば defaults/mk.conf の挿入など
.else
# OpenBSD の記述
.endif
	  </pre>
</li>
</ol></div>
</div>
<div class="sect2" title="3.3.7. Solaris">
<div class="titlepage"><div><div><h3 class="title">
<a name="solaris"></a>3.3.7. Solaris</h3></div></div></div>
<p>対応は x86 と sparc それぞれの Solaris 2.6 から 9 までに対しておこなわれています。
      機能する C コンパイラーが必要です。 gcc 2.95.3 および
      Sun WorkShop 5 の両者で確認がおこなわれています。</p>
<p>Solaris 8 でのブートストラップ過程およびパッケージの構築では、
      以下の各パッケージが必要になります。</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>SUNWsprot</p></li>
<li class="listitem"><p>SUNWarc</p></li>
<li class="listitem"><p>SUNWbtool</p></li>
<li class="listitem"><p>SUNWtoo</p></li>
<li class="listitem"><p>SUNWlibm</p></li>
</ul></div>
<p>なお、2006 年 6 月現在、Solaris 上では GNU binutils
      はサポートされて<span class="emphasis"><em>いません</em></span>。</p>
<p>どのコンパイラーを使うにせよ、コンパイラーツールと
      $prefix を、必ず <code class="varname">PATH</code> に含めてください。
      これは、<code class="filename">/usr/ccs/{bin,lib}</code>
      や、たとえば <code class="filename">/usr/pkg/{bin,sbin}</code> などです。</p>
<div class="sect3" title="3.3.7.1. gcc を使う場合">
<div class="titlepage"><div><div><h4 class="title">
<a name="solaris-gcc-note"></a>3.3.7.1. gcc を使う場合</h4></div></div></div>
<p>どのパッケージの構築にも同じ gcc だけを使うようにすると、
	話が簡単になります。</p>
<p>外部から導入した gcc を使うのはブートストラップの時だけにして、
	その後は gcc を
	<a href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc/lang/gcc/README.html" target="_top"><code class="filename">lang/gcc</code></a> から構築するかバイナリーパッケージをインストールして、
	ブートストラップで使った gcc は削除することをおすすめします。</p>
<p>gcc のバイナリーパッケージは、<a class="ulink" href="http://www.sunfreeware.com/" target="_top">http://www.sunfreeware.com/</a> から辿れます。</p>
</div>
<div class="sect3" title="3.3.7.2. Sun WorkShop を使う場合">
<div class="titlepage"><div><div><h4 class="title">
<a name="solaris-sun-workshop-note"></a>3.3.7.2. Sun WorkShop を使う場合</h4></div></div></div>
<p>少なくとも、以下の各パッケージを (WorkShop 5.0 から)
	インストールしておく必要があります。</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>SPROcc
	  - Sun WorkShop Compiler C 5.0</p></li>
<li class="listitem"><p>SPROcpl
	  - Sun WorkShop Compiler C++ 5.0</p></li>
<li class="listitem"><p>SPROild
	  - Sun WorkShop Incremental Linker</p></li>
<li class="listitem"><p>SPROlang
	  - Sun WorkShop Compilers common components</p></li>
</ul></div>
<p><a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a>
	で、以下の変数を設定します。</p>
<pre class="programlisting">
CC=     cc
CXX=    CC
CPP=    cc -E
CXXCPP= CC -E
</pre>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>C プリプロセッサーを使って
	C のソースコード以外のものを処理するパッケージのなかには、
	この <code class="varname">CPP</code> の設定では問題が起きるものがあるかもしれません。</p>
</div>
</div>
<div class="sect3" title="3.3.7.3. SunPro を使って 64 ビットバイナリーを構築する">
<div class="titlepage"><div><div><h4 class="title">
<a name="solaris-sunpro-64"></a>3.3.7.3. SunPro を使って 64 ビットバイナリーを構築する</h4></div></div></div>
<p>64 ビットパッケージを構築する場合に必要なことは、
	<a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> ファイルに以下の行を追加するだけです。</p>
<pre class="programlisting">
PKGSRC_COMPILER=        sunpro
ABI=                    64
</pre>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>この設定は、SPARC アーキテクチャーについてのみ確認がおこなわれています。
	Intel および AMD マシンでは、
	必要な作業がまだ残っています。</p>
</div>
</div>
<div class="sect3" title="3.3.7.4. ありがちな問題">
<div class="titlepage"><div><div><h4 class="title">
<a name="plat.sunos.problems"></a>3.3.7.4. ありがちな問題</h4></div></div></div>
<p><span class="command"><strong>libtool</strong></span> を使っていると、時々、<code class="filename">/bin/ksh</code>
      がセグメンテーションフォールトを起こしてクラッシュすることがあります。
      回避策は、たとえば <a href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc/shells/bash/README.html" target="_top"><code class="filename">shells/bash</code></a> をインストールして、
      以下の各行を <a class="link" href="configuring.html#mk.conf"><code class="filename">mk.conf</code></a> に追加するなどして、
      別のシェルを configure スクリプト用に使うことです。</p>
<pre class="programlisting">
CONFIG_SHELL=   ${LOCALBASE}/bin/bash
WRAPPER_SHELL=  ${LOCALBASE}/bin/bash
      </pre>
<p>こうしてから、<a href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/libtool-base/README.html" target="_top"><code class="filename">devel/libtool-base</code></a> パッケージを構築しなおします。</p>
</div>
</div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="getting.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="users-guide.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="using.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 2. どこからpkgsrcを得て、どうやって最新に保つか </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Chapter 4. pkgsrc を使う</td>
</tr>
</table>
</div>
</body>
</html>
