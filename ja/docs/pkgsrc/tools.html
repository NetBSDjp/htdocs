<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Chapter 18. Tools needed for building or running</title>
<link rel="stylesheet" type="text/css" href="/global.css">
<meta name="generator" content="DocBook XSL Stylesheets VX.X.X">
<link rel="home" href="index.html" title="The pkgsrc guide">
<link rel="up" href="developers-guide.html" title="Part II. The pkgsrc developer's guide">
<link rel="prev" href="build.html" title="Chapter 17. The build process">
<link rel="next" href="fixes.html" title="Chapter 19. Making your package work">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Chapter 18. Tools needed for building or running</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="build.html">Prev</a> </td>
<th width="60%" align="center">Part II. The pkgsrc developer's guide</th>
<td width="20%" align="right"> <a accesskey="n" href="fixes.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="chapter" title="Chapter 18. Tools needed for building or running">
<div class="titlepage"><div><div><h2 class="title">
<a name="tools"></a>Chapter 18. Tools needed for building or running</h2></div></div></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="sect1"><a href="tools.html#pkgsrc-tools">18.1. Tools for pkgsrc builds</a></span></dt>
<dt><span class="sect1"><a href="tools.html#package-tools">18.2. Tools needed by packages</a></span></dt>
<dt><span class="sect1"><a href="tools.html#platform-tools">18.3. Tools provided by platforms</a></span></dt>
<dt><span class="sect1"><a href="tools.html#tools.questions">18.4. Questions regarding the tools</a></span></dt>
</dl>
</div>
<p>The <code class="varname">USE_TOOLS</code> definition is used both internally
by pkgsrc and also for individual packages to define what commands
are needed for building a package (like <code class="varname">BUILD_DEPENDS</code>)
or for later run-time of an installed packaged (such as
<code class="varname">DEPENDS</code>).
If the native system provides an adequate tool, then in many cases, a pkgsrc
package will not be used.</p>
<p>When building a package, the replacement tools are
made available in a directory (as symlinks or wrapper scripts)
that is early in the executable search path. Just like the buildlink
system, this helps with consistent builds.</p>
<p>A tool may be needed to help build a specific package. For example,
perl, GNU make (gmake) or yacc may be needed.</p>
<p>Also a tool may be needed, for example, because the native system's supplied
tool may be inefficient for building a package with pkgsrc.
For example, a package may need GNU awk, bison (instead of
yacc) or a better sed.</p>
<p>The tools used by a package can be listed by running
<span class="command"><strong>make show-tools</strong></span>.</p>
<div class="sect1" title="18.1. Tools for pkgsrc builds">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="pkgsrc-tools"></a>18.1. Tools for pkgsrc builds</h2></div></div></div>
<p>The default set of tools used by pkgsrc is defined in
<code class="filename">bsd.pkg.mk</code>. This includes standard Unix tools,
such as: <span class="command"><strong>cat</strong></span>, <span class="command"><strong>awk</strong></span>,
<span class="command"><strong>chmod</strong></span>, <span class="command"><strong>test</strong></span>, and so on.
These can be seen by running:
<span class="command"><strong>make show-var VARNAME=USE_TOOLS</strong></span>.</p>
<p>If a package needs a specific program to build
then the <code class="varname">USE_TOOLS</code> variable can be used
to define the tools needed.</p>
</div>
<div class="sect1" title="18.2. Tools needed by packages">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="package-tools"></a>18.2. Tools needed by packages</h2></div></div></div>
<p>In the following examples, the :run means that it is needed at
run-time (and becomes a DEPENDS).
The default is a build dependency which can be set with
:build. (So in this example, it is the same as gmake:build
and pkg-config:build.)</p>
<pre class="programlisting">
USE_TOOLS+=     gmake perl:run pkg-config
</pre>
<p>When using the tools framework, a
<code class="varname">TOOLS_PATH.foo</code> variable is defined
which contains the full path to the appropriate tool. For example,
<code class="varname">TOOLS_PATH.bash</code> could be <span class="quote">&#8220;<span class="quote">/bin/bash</span>&#8221;</span>
on Linux systems.</p>
<p>If you always need a pkgsrc version of the
tool at run-time, then just use <code class="varname">DEPENDS</code> instead.
</p>
</div>
<div class="sect1" title="18.3. Tools provided by platforms">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="platform-tools"></a>18.3. Tools provided by platforms</h2></div></div></div>
<p>When improving or porting pkgsrc to a new platform, have a look
at (or create) the corresponding platform specific make file fragment under
<code class="filename">pkgsrc/mk/tools/tools.${OPSYS}.mk</code> which defines
the name of the common tools. For example:</p>
<pre class="programlisting">
.if exists(/usr/bin/bzcat)
TOOLS_PLATFORM.bzcat?=          /usr/bin/bzcat
.elif exists(/usr/bin/bzip2)
TOOLS_PLATFORM.bzcat?=          /usr/bin/bzip2 -cd
.endif

TOOLS_PLATFORM.true?=           true                    # shell builtin
</pre>
</div>
<div class="sect1" title="18.4. Questions regarding the tools">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="tools.questions"></a>18.4. Questions regarding the tools</h2></div></div></div>
<div class="qandaset" title="Frequently Asked Questions">
<a name="id1168229290459"></a><dl>
<dt>18.4.1. <a href="tools.html#tools.new">How do I add a new tool?</a>
</dt>
<dt>18.4.2. <a href="tools.html#tools.listall">How do I get a list of all available
	tools?</a>
</dt>
<dt>18.4.3. <a href="tools.html#tools.used">How can I get a list of all the tools that a
	package is using while being built? I want to know whether it
	uses sed or not.</a>
</dt>
</dl>
<table border="0" width="100%" summary="Q and A Set">
<col align="left" width="1%">
<col>
<tbody>
<tr class="question" title="18.4.1.">
<td align="left" valign="top">
<a name="tools.new"></a><a name="id1168229290462"></a><p><b>18.4.1.</b></p>
</td>
<td align="left" valign="top"><p>How do I add a new tool?</p></td>
</tr>
<tr class="answer">
<td align="left" valign="top"></td>
<td align="left" valign="top"><p>TODO</p></td>
</tr>
<tr class="question" title="18.4.2.">
<td align="left" valign="top">
<a name="tools.listall"></a><a name="id1168229290471"></a><p><b>18.4.2.</b></p>
</td>
<td align="left" valign="top"><p>How do I get a list of all available
	tools?</p></td>
</tr>
<tr class="answer">
<td align="left" valign="top"></td>
<td align="left" valign="top"><p>TODO</p></td>
</tr>
<tr class="question" title="18.4.3.">
<td align="left" valign="top">
<a name="tools.used"></a><a name="id1168229290480"></a><p><b>18.4.3.</b></p>
</td>
<td align="left" valign="top"><p>How can I get a list of all the tools that a
	package is using while being built? I want to know whether it
	uses sed or not.</p></td>
</tr>
<tr class="answer">
<td align="left" valign="top"></td>
<td align="left" valign="top"><p>Currently, you can't. (TODO: But I want to be able
	to do it.)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="build.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="developers-guide.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="fixes.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 17. The build process </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Chapter 19. Making your package work</td>
</tr>
</table>
</div>
</body>
</html>
