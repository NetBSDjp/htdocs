<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Chapter 2. Where to get pkgsrc and how to keep it up-to-date</title>
<link rel="stylesheet" type="text/css" href="/global.css">
<meta name="generator" content="DocBook XSL Stylesheets VX.X.X">
<link rel="home" href="index.html" title="The pkgsrc guide">
<link rel="up" href="users-guide.html" title="Part I. The pkgsrc user's guide">
<link rel="prev" href="users-guide.html" title="Part I. The pkgsrc user's guide">
<link rel="next" href="platforms.html" title="Chapter 3. Using pkgsrc on systems other than NetBSD">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Chapter 2. Where to get pkgsrc and how to keep it up-to-date</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="users-guide.html">Prev</a> </td>
<th width="60%" align="center">Part I. The pkgsrc user's guide</th>
<td width="20%" align="right"> <a accesskey="n" href="platforms.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="chapter" title="Chapter 2. Where to get pkgsrc and how to keep it up-to-date">
<div class="titlepage"><div><div><h2 class="title">
<a name="getting"></a>Chapter 2. Where to get pkgsrc and how to keep it up-to-date</h2></div></div></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="sect1"><a href="getting.html#getting-first">2.1. Getting pkgsrc for the first time</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="getting.html#getting-via-tar">2.1.1. As tar file</a></span></dt>
<dt><span class="sect2"><a href="getting.html#getting-via-cvs">2.1.2. Via anonymous CVS</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="getting.html#uptodate">2.2. Keeping pkgsrc up-to-date</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="getting.html#uptodate-tar">2.2.1. Via tar files</a></span></dt>
<dt><span class="sect2"><a href="getting.html#uptodate-cvs">2.2.2. Via CVS</a></span></dt>
</dl></dd>
</dl>
</div>
<p>Before you download and extract the files, you need to decide
where you want to extract them. When using pkgsrc as root user, pkgsrc
is usually installed in <code class="filename">/usr/pkgsrc</code>. You are though
free to install the sources and binary packages wherever you want in
your filesystem, provided that the pathname does not contain white-space
or other characters that are interpreted specially by the shell and some
other programs. A safe bet is to use only letters, digits, underscores
and dashes.</p>
<div class="sect1" title="2.1. Getting pkgsrc for the first time">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="getting-first"></a>2.1. Getting pkgsrc for the first time</h2></div></div></div>
<p>Before you download any pkgsrc files, you should decide
	whether you want the <span class="emphasis"><em>current</em></span> branch or the
	<span class="emphasis"><em>stable</em></span> branch. The latter is forked on a
	quarterly basis from the current branch and only gets modified
	for security updates. The names of the stable branches are built
	from the year and the quarter, for example
	<code class="literal">2009Q1</code>.</p>
<p>The second step is to decide <span class="emphasis"><em>how</em></span> you
	want to download pkgsrc. You can get it as a tar file or via CVS.
	Both ways are described here.</p>
<div class="sect2" title="2.1.1. As tar file">
<div class="titlepage"><div><div><h3 class="title">
<a name="getting-via-tar"></a>2.1.1. As tar file</h3></div></div></div>
<p>The primary download location for all pkgsrc files is
	<a class="ulink" href="ftp://ftp.NetBSD.org/pub/pkgsrc/" target="_top">ftp://ftp.NetBSD.org/pub/pkgsrc/</a>. There are a
	number of subdirectories for different purposes, which are
	described in detail in <a class="xref" href="ftp-layout.html" title="Appendix C. Directory layout of the pkgsrc FTP server">Appendix C, <i>Directory layout of the pkgsrc FTP server</i></a>.</p>
<p>The tar file for the current branch is in the directory
	<code class="filename">current</code> and is called <a class="ulink" href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.gz" target="_top"><code class="filename">pkgsrc.tar.gz</code></a>.
	It is autogenerated daily.</p>
<p>The tar file for the stable branch 2009Q1 is in the
	directory <code class="filename">pkgsrc-2009Q1</code> and is also called <a class="ulink" href="ftp://ftp.NetBSD.org/pub/pkgsrc/pkgsrc-2009Q1/pkgsrc-2009Q1.tar.gz" target="_top"><code class="filename">pkgsrc-2009Q1.tar.gz</code></a>.</p>
<p>To download a pkgsrc stable tarball, run:</p>
<pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>ftp ftp://ftp.NetBSD.org/pub/pkgsrc/<em class="replaceable"><code>pkgsrc-20xxQy</code></em>/<em class="replaceable"><code>pkgsrc-20xxQy</code></em>.tar.gz</code></strong></pre>
<p>Where <em class="replaceable"><code>pkgsrc-20xxQy</code></em> is the
	stable branch to be downloaded, for example, 
	<span class="quote">&#8220;<span class="quote">pkgsrc-2009Q1</span>&#8221;</span>.</p>
<p>Then, extract it with:</p>
<pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>tar -xzf <em class="replaceable"><code>pkgsrc-20xxQy</code></em>.tar.gz -C /usr</code></strong></pre>
<p>This will create the directory <code class="filename">pkgsrc/</code>
	in <code class="filename">/usr/</code> and all the package source will be 
	stored under <code class="filename">/usr/pkgsrc/</code>.</p>
<p>To download pkgsrc-current, run:</p>
<pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>ftp ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.gz</code></strong></pre>
</div>
<div class="sect2" title="2.1.2. Via anonymous CVS">
<div class="titlepage"><div><div><h3 class="title">
<a name="getting-via-cvs"></a>2.1.2. Via anonymous CVS</h3></div></div></div>
<p>To fetch a specific pkgsrc stable branch, run:</p>
<pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>cd /usr &amp;&amp; cvs -q -z3 -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -r <em class="replaceable"><code>pkgsrc-20xxQy</code></em> -P pkgsrc</code></strong>
</pre>
<p>Where <em class="replaceable"><code>pkgsrc-20xxQy</code></em> is the stable 
	branch to be checked out, for example, <span class="quote">&#8220;<span class="quote">pkgsrc-2009Q1</span>&#8221;</span></p>
<p>This will create the directory <code class="filename">pkgsrc/</code> 
	in your <code class="filename">/usr/</code> directory and all the package source 
	will be stored under <code class="filename">/usr/pkgsrc/</code>.</p>
<p>To fetch the pkgsrc current branch, run:</p>
<pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>cd /usr &amp;&amp; cvs -q -z3 -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -P pkgsrc</code></strong>
</pre>
<p>Refer to <a class="ulink" href="http://NetBSD.org/FIXME" target="_top">list of available CVS mirrors</a> to choose faster one.</p>
<p>If you get error messages from <code class="literal">rsh</code>, you need to set CVS_RSH variable. E.g.:</p>
<pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>cd /usr &amp;&amp; env CVS_RSH=ssh cvs -q -z3 -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -P pkgsrc</code></strong>
</pre>
<p>Refer to documentation on your command shell how to set CVS_RSH=ssh permanently.
	For Bourne shells, you can set it in your <code class="filename">.profile</code>
	or better globally in <code class="filename">/etc/profile</code>:</p>
<pre class="programlisting">
# set CVS remote shell command
CVS_RSH=ssh
export CVS_RSH
</pre>
<p>By default, CVS doesn't do things like most people would expect it to do.
	But there is a way to convince CVS, by creating a file called <code class="filename">.cvsrc</code>
	in your home directory and saving the following lines to it.
	This file will save you lots of headache and some bug reports, so we strongly recommend it.
	You can find an explanation of this file in the CVS documentation.</p>
<pre class="programlisting">
# recommended CVS configuration file from the pkgsrc guide
cvs -q -z3
checkout -P
update -dP
diff -upN
rdiff -u
release -d
</pre>
</div>
</div>
<div class="sect1" title="2.2. Keeping pkgsrc up-to-date">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="uptodate"></a>2.2. Keeping pkgsrc up-to-date</h2></div></div></div>
<p>The preferred way to keep pkgsrc up-to-date is via CVS
	(which also works if you have first installed it via a tar
	file). It saves bandwidth and hard disk activity, compared to
	downloading the tar file again.</p>
<div class="sect2" title="2.2.1. Via tar files">
<div class="titlepage"><div><div><h3 class="title">
<a name="uptodate-tar"></a>2.2.1. Via tar files</h3></div></div></div>
<div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Warning</h3>
<p>When updating from a tar file, you first need to
	completely remove the old pkgsrc directory. Otherwise those
	files that have been removed from pkgsrc in the mean time will
	not be removed on your local disk, resulting in inconsistencies.
	When removing the old files, any changes that you have done to
	the pkgsrc files will be lost after updating. Therefore updating
	via CVS is strongly recommended.</p>
</div>
<p>Note that by default the distfiles and the binary packages
	are saved in the pkgsrc tree, so don't forget to rescue them
	before updating. You can also configure pkgsrc to use other than
	the default directories by setting the
	<code class="varname">DISTDIR</code> and <code class="varname">PACKAGES</code>
	variables. See <a class="xref" href="configuring.html" title="Chapter 5. Configuring pkgsrc">Chapter 5, <i>Configuring pkgsrc</i></a> for the details.</p>
<p>To update pkgsrc from a tar file, download the tar file as
	explained above. Then, make sure that you have not made any
	changes to the files in the pkgsrc directory. Remove the pkgsrc
	directory and extract the new tar file. Done.</p>
</div>
<div class="sect2" title="2.2.2. Via CVS">
<div class="titlepage"><div><div><h3 class="title">
<a name="uptodate-cvs"></a>2.2.2. Via CVS</h3></div></div></div>
<p>To update pkgsrc via CVS, change to the <code class="filename">pkgsrc</code> directory and run cvs:</p>
<pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>cd /usr/pkgsrc &amp;&amp; cvs update -dP</code></strong>
</pre>
<p>If you get error messages from <code class="literal">rsh</code>, you need to set CVS_RSH variable as described above. E.g.:</p>
<pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>cd /usr/pkgsrc &amp;&amp; env CVS_RSH=ssh cvs up -dP</code></strong>
</pre>
<div class="sect3" title="2.2.2.1. Switching between different pkgsrc branches">
<div class="titlepage"><div><div><h4 class="title">
<a name="uptodate-cvs-switch"></a>2.2.2.1. Switching between different pkgsrc branches</h4></div></div></div>
<p>When updating pkgsrc, the CVS program keeps track of the
	branch you selected. But if you, for whatever reason, want to
	switch from the stable branch to the current one, you can do it
	by adding the option <span class="quote">&#8220;<span class="quote">-A</span>&#8221;</span> after the
	<span class="quote">&#8220;<span class="quote">update</span>&#8221;</span> keyword. To switch from the current branch
	back to the stable branch, add the
	<span class="quote">&#8220;<span class="quote">-rpkgsrc-2009Q3</span>&#8221;</span> option.</p>
</div>
<div class="sect3" title="2.2.2.2. What happens to my changes when updating?">
<div class="titlepage"><div><div><h4 class="title">
<a name="uptodate-cvs-changes"></a>2.2.2.2. What happens to my changes when updating?</h4></div></div></div>
<p>When you update pkgsrc, the CVS program will only touch
	those files that are registered in the CVS repository. That
	means that any packages that you created on your own will stay
	unmodified. If you change files that are managed by CVS, later
	updates will try to merge your changes with those that have been
	done by others. See the CVS manual, chapter
	<span class="quote">&#8220;<span class="quote">update</span>&#8221;</span> for details.</p>
</div>
</div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="users-guide.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="users-guide.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="platforms.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Part I. The pkgsrc user's guide </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Chapter 3. Using pkgsrc on systems other than NetBSD</td>
</tr>
</table>
</div>
</body>
</html>
