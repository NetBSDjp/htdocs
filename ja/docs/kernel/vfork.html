<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="generator" content="Website XSL Stylesheet V2.6.0">
<link rel="home" href="../../../." title="Welcome to The NetBSD Project: Of course it runs NetBSD.">
<link rel="up" href="../../../ja/docs/kernel/." title="NetBSD &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;: &#12459;&#12540;&#12493;&#12523;">
<link rel="previous" href="../../../ja/docs/kernel/uvm.html" title="NetBSD &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;: UVM&#12289;&#26032;&#12375;&#12356;&#20206;&#24819;&#12513;&#12514;&#12522;&#12540;&#12471;&#12473;&#12486;&#12512;">
<link rel="next" href="../../../ja/docs/kernel/porting-freebsd-net.html" title="FreeBSD &#12398;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#12489;&#12521;&#12452;&#12496;&#12540;&#12434; NetBSD &#12395;&#31227;&#26893;&#12377;&#12427;&#12383;&#12417;&#12398;&#12513;&#12514;">
<link rel="first" href="../../../ja/docs/kernel/lazyfpu.html" title="NetBSD &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;: &#12393;&#12398;&#12424;&#12358;&#12395; lazy FPU &#12467;&#12531;&#12486;&#12461;&#12473;&#12488;&#12473;&#12452;&#12483;&#12481;&#12399;&#21205;&#20316;&#12377;&#12427;&#12398;&#12363;">
<link rel="last" href="../../../ja/docs/kernel/elf-notes.html" title="NetBSD &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;: &#12505;&#12531;&#12480;&#12540;&#29305;&#26377;&#12398; ELF &#35352;&#21495;&#35201;&#32032;(Note Elements)">
<link rel="stylesheet" href="../../../global.css" type="text/css">



<title>NetBSD &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;: &#12394;&#12380;&#20253;&#32113;&#30340;&#12394; vfork()&#12434;&#23455;&#35013;&#12375;&#12383;&#12398;&#12363;</title>
</head>
<body class="website"><div class="webpage">
<a name="ja-docs-kernel-vfork"></a><div id="top"><a href="#mainContent" class="doNotDisplay doNotPrint">Skip to main content.</a></div>
<div id="centralHeader">
<div id="logo">
<a href="../../../"><img alt="[NetBSD Logo]" src="../../../images/NetBSD-smaller.png"></a><div id="name"><a href="../../../">
	  The NetBSD Project
	</a></div>
<div id="slogan"><a href="../../../">
	  &#8220;Of course it runs NetBSD&#8221;
	</a></div>
</div>
<div id="headerTools">
<div id="header-cse-search-form">Google custom search</div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script><script type="text/javascript"> 
		  google.load('search', '1', {language : 'ja'});
		  google.setOnLoadCallback(function() {
		    var header_customSearchControl = new google.search.CustomSearchControl('016685087845965994609:5539h4dkepg');
		    header_customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
		    var header_options = new google.search.DrawOptions();
		    header_options.enableSearchboxOnly("http://google.com/cse?cx=016685087845965994609:5539h4dkepg");    
		    header_customSearchControl.draw('header-cse-search-form', header_options);
		  }, true);
		</script>
</div>
</div>
<div id="navBar" role="navigation">
<span class="doNotDisplay">
	  &#26696;&#20869;:
	</span><ul>
<li><a href="../../../ja/">
	  &#12507;&#12540;&#12512;</a></li>
<li>
<a href="../../../ja/">
	  &#12491;&#12517;&#12540;&#12473;&#12392;&#12513;&#12487;&#12451;&#12450;</a><ul>
<li><a href="../../../ja/changes/">
	    &#26368;&#36817;&#12398;&#22793;&#26356;</a></li>
<li><a href="http://blog.NetBSD.org/">
	    NetBSD&#12502;&#12525;&#12464;</a></li>
<li><a href="../../../ja/gallery/events.html">
	    &#12452;&#12505;&#12531;&#12488;</a></li>
<li><a href="../../../ja/changes/rss.html">
	    &#12501;&#12451;&#12540;&#12489;</a></li>
</ul>
</li>
<li>
<a href="../../../ja/about/">
	  &#27010;&#35201;</a><ul>
<li><a href="../../../ja/about/">
	    NetBSD</a></li>
<li><a href="../../../ja/foundation/">
	    The NetBSD Foundation</a></li>
<li><a href="../../../ja/gallery/">
	    &#25512;&#34214;</a></li>
</ul>
</li>
<li>
<a href="../../../ja/docs/">
	  &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;</a><ul>
<li><a href="../../../ja/docs/misc/index.html">
	    FAQ&#12392;HOWTO</a></li>
<li><a href="../../../ja/docs/guide/en/">
	    &#12460;&#12452;&#12489;</a></li>
<li><a href="http://man.NetBSD.org/">
	    &#12510;&#12491;&#12517;&#12450;&#12523;&#12506;&#12540;&#12472;</a></li>
<li><a href="http://wiki.NetBSD.org/">
	    Wiki</a></li>
</ul>
</li>
<li>
<a href="../../../ja/support/">
	  &#12469;&#12509;&#12540;&#12488;</a><ul>
<li><a href="../../../ja/support/send-pr.html">
	    &#21839;&#38988;&#22577;&#21578;&#12460;&#12452;&#12489;</a></li>
<li><a href="../../../cgi-bin/sendpr.cgi?gndb=netbsd">
	    &#12496;&#12464;&#12398;&#22577;&#21578;</a></li>
<li><a href="../../../ja/support/query-pr.html">
	    &#12496;&#12464;&#12398;&#29031;&#20250;</a></li>
<li><a href="../../../ja/support/security/">
	    &#12475;&#12461;&#12517;&#12522;&#12486;&#12451;&#12540;</a></li>
</ul>
</li>
<li>
<a href="../../../ja/community/">
	  &#12467;&#12511;&#12517;&#12491;&#12486;&#12451;&#12540;</a><ul>
<li><a href="http://onetbsd.org/">
	    &#12502;&#12525;&#12464;</a></li>
<li><a href="../../../ja/mailinglists/">
	    &#12513;&#12540;&#12522;&#12531;&#12464;&#12522;&#12473;&#12488;</a></li>
<li><a href="http://mail-index.NetBSD.org/">
	    &#12513;&#12540;&#12522;&#12531;&#12464;&#12522;&#12473;&#12488;&#12450;&#12540;&#12459;&#12452;&#12502;</a></li>
</ul>
</li>
<li>
<a href="../../../ja/developers/">
	  &#38283;&#30330;&#32773;</a><ul>
<li><a href="http://cvsweb.NetBSD.org/">
	    &#12477;&#12540;&#12473;&#12434;&#38322;&#35239;</a></li>
<li><a href="http://nxr.NetBSD.org/">
	    &#12463;&#12525;&#12473;&#12522;&#12501;&#12449;&#12524;&#12531;&#12473;</a></li>
<li><a href="http://releng.NetBSD.org/">
	    &#12522;&#12522;&#12540;&#12473;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;</a></li>
<li><a href="http://wiki.NetBSD.org/projects/">
	    &#12503;&#12525;&#12472;&#12455;&#12463;&#12488;&#12522;&#12473;&#12488;</a></li>
</ul>
</li>
<li>
<a href="../../../ja/ports/">
	  &#27231;&#31278;</a><ul>
<li><a href="../../../ja/ports/history.html">
	    &#27508;&#21490;</a></li>
<li><a href="../../../ja/ports/emulators.html">
	    &#12456;&#12511;&#12517;&#12524;&#12540;&#12479;&#12540;</a></li>
</ul>
</li>
<li>
<a href="http://www.pkgsrc.org/">
	  &#12497;&#12483;&#12465;&#12540;&#12472;</a><ul>
<li><a href="http://www.pkgsrc.se/">
	    &#12497;&#12483;&#12465;&#12540;&#12472;&#12434;&#38322;&#35239;</a></li>
<li><a href="http://releng.NetBSD.org/index-pkgsrc.html">
	    &#12522;&#12522;&#12540;&#12473;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;</a></li>
</ul>
</li>
</ul>
</div>
<div id="content"><div class="fullWidth"><div class="rowOfBoxes">
<h1>NetBSD &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;: &#12394;&#12380;&#20253;&#32113;&#30340;&#12394; vfork()&#12434;&#23455;&#35013;&#12375;&#12383;&#12398;&#12363;</h1>
<h3 class="title"><a name="vfork"></a></h3>
<ul>
<li><a href="#intro">&#24207;</a></li>
<li><a href="#4bsd-vfork-cow">4.4BSD&#12398; vfork()/exec() &#12434;&#20351;&#12387;&#12383;
vfork() &#12392; COW &#12398;&#20966;&#29702;</a></li>
<li><a href="#3bsd-vfork">&#12450;&#12489;&#12524;&#12473;&#31354;&#38291;&#20849;&#26377;&#12434;&#29992;&#12356;&#12383;
3.0BSD/NetBSD &#12398; vfork() &#12398;&#20966;&#29702;</a></li>
</ul>
<hr>
<h3 class="title"></h3>
<h4 class="title">
<a name="intro"></a>&#24207; (<a href="#vfork">&#12488;&#12483;&#12503;</a>)
  </h4>
<p><code class="function">vfork()</code>
&#12399;&#12289;&#23376;&#12503;&#12525;&#12475;&#12473;&#12364;&#12356;&#12378;&#12428;&#20182;&#12398;&#12503;&#12525;&#12464;&#12521;&#12512;&#12434; <code class="function">exec()</code>&#12375;&#12289;
&#12363;&#12388;&#35242;&#12503;&#12525;&#12475;&#12473;&#12399;&#12381;&#12428;&#12364;&#36215;&#12365;&#12427;&#12414;&#12391;&#24453;&#12387;&#12390;&#12356;&#12427;&#12392;&#12356;&#12358;&#12289;&#29305;&#21029;&#12394;&#29366;&#27841;&#12391;
&#29992;&#12356;&#12427;&#12383;&#12417;&#12395;&#35373;&#35336;&#12373;&#12428;&#12383;&#12418;&#12398;&#12391;&#12377;&#12290;
&#20253;&#32113;&#30340;&#12394; <code class="function">fork()</code> &#12391;&#12399;&#12289;&#23376;&#12503;&#12525;&#12475;&#12473;&#12395;&#35242;&#12503;&#12525;&#12475;&#12473;&#12398;
&#12377;&#12409;&#12390;&#12398;&#12506;&#12540;&#12472;&#12434;&#35079;&#35069;&#12377;&#12427;&#12392;&#12356;&#12358;&#33879;&#12375;&#12356;&#12458;&#12540;&#12496;&#12540;&#12504;&#12483;&#12489;&#12364;&#29983;&#12376;&#12414;&#12377;&#12290;</p>

<p>
COW (&#12467;&#12500;&#12540;&#12458;&#12531;&#12521;&#12452;&#12488;)&#12364;&#36861;&#21152;&#12373;&#12428;&#12383;
Mach VM &#12471;&#12473;&#12486;&#12512;&#12391;&#12399;
<code class="function">fork()</code> &#12398;&#36000;&#33655;&#12364;&#22823;&#22793;&#36605;&#12367;&#12394;&#12426;&#12289;
BSD 4.4&#12391;&#12399; <code class="function">vfork()</code>&#12399; <code class="function">fork()</code> &#12392;
&#21516;&#32681;&#12398;&#12418;&#12398;&#12392;&#12373;&#12428;&#12414;&#12375;&#12383;&#12290;
NetBSD 1.3 &#20197;&#38477;&#12391;&#12399;&#12289;&#20253;&#32113;&#30340;&#12394; <code class="function">vfork()</code> &#12364;&#20877;&#23455;&#35013;&#12373;&#12428;&#12414;&#12375;&#12383;&#12290;</p>

<p><a class="ulink" href="uvm.html" target="_top"><span class="bold"><strong>UVM</strong></span></a>&#12391; COW &#12434;
&#12424;&#12426;&#12424;&#12356;&#12418;&#12398;&#12395;&#12377;&#12427;&#12383;&#12417;&#12395;&#22810;&#22823;&#12394;&#21162;&#21147;&#12364;&#12362;&#12371;&#12394;&#12431;&#12428;&#12414;&#12375;&#12383;&#12290;
&#12375;&#12363;&#12375;&#12450;&#12489;&#12524;&#12473;&#31354;&#38291;&#12434;&#20849;&#26377;&#12377;&#12427; <code class="function">vfork()</code>&#12364; <span class="emphasis"><em>&#12356;&#12414;&#12384;&#12395;</em></span>
&#21213;&#12427;&#12371;&#12392;&#12364;&#20998;&#12363;&#12387;&#12383;&#12398;&#12391;&#12377;&#12290;
&#12371;&#12428;&#12395;&#12424;&#12426;&#12289;200MHz PPro &#12391;&#12398; libc&#12398;&#12499;&#12523;&#12489;&#12398;&#25152;&#35201;&#26178;&#38291;&#12434;
&#25968;&#31186;&#21066;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#12290;</p>

<h4 class="title">
<a name="4bsd-vfork-cow"></a>4.4BSD&#12398; <code class="function">vfork()</code>/<code class="function">exec()</code> &#12434;&#20351;&#12387;&#12383;
<code class="function">vfork()</code> &#12392; COW &#12398;&#20966;&#29702; (<a href="#vfork">&#12488;&#12483;&#12503;</a>)
  </h4>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem"><p>&#35242;&#12398; vm_map &#12434;&#12383;&#12393;&#12387;&#12390;&#12289;&#12450;&#12489;&#12524;&#12473;&#31354;&#38291;&#12398;&#26360;&#12365;&#36796;&#12415;&#21487;&#33021;&#12394;&#37096;&#20998;&#12434;
        COW &#12392;&#12510;&#12540;&#12463;&#12377;&#12427;&#12290;&#12371;&#12428;&#12399;&#12289; pmap&#12434;&#21628;&#12403;&#20986;&#12375;&#12289; PTE&#12434;&#20462;&#27491;&#12375;&#12289;
        TLB&#12434;&#12501;&#12521;&#12483;&#12471;&#12517;&#12377;&#12427;&#12371;&#12392;&#12434;&#24847;&#21619;&#12375;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#23376;&#12503;&#12525;&#12475;&#12473;&#12398; vm_map &#12434;&#29983;&#25104;&#12375;&#12289;&#35242;&#12398; vm_map &#12456;&#12531;&#12488;&#12522;&#12540;&#12434;&#23376;&#12398; vm_map&#12395;&#12467;&#12500;&#12540;&#12375;&#12414;&#12377;&#12290;
        &#22580;&#21512;&#12395;&#12424;&#12387;&#12390;&#12399;&#12289; pmap&#12434;&#21628;&#12403;&#20986;&#12375;&#12390;&#35242;&#12398;&#12506;&#12540;&#12472;&#12486;&#12540;&#12502;&#12523;&#12363;&#12425;
        &#12371;&#12398;&#12506;&#12540;&#12472;&#12486;&#12540;&#12502;&#12523;&#12395; PTE &#12434;&#12467;&#12500;&#12540;&#12375;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#35242;&#12434;&#12502;&#12525;&#12483;&#12463;&#12375;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#23376;&#12364;&#36208;&#12426;&#12414;&#12377;&#12290; PTE&#12364;&#12467;&#12500;&#12540; <span class="emphasis"><em>&#12373;&#12428;&#12390;&#12394;&#12356;</em></span>&#22580;&#21512;&#12395;&#12399;&#12289;
        &#12506;&#12540;&#12472;&#12501;&#12457;&#12523;&#12488;&#12364;&#36215;&#12365;&#12390;&#29694;&#22312;&#12503;&#12525;&#12464;&#12521;&#12512;&#12459;&#12454;&#12531;&#12479;&#12398;&#12354;&#12427;&#12486;&#12461;&#12473;&#12488;&#12506;&#12540;&#12472;&#12398;&#29289;&#29702;&#12510;&#12483;&#12500;&#12531;&#12464;&#12364;&#24471;&#12425;&#12428;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#23376;&#12399; exec &#12375;&#12289;&#12381;&#12375;&#12390; &#20316;&#12425;&#12428;&#12383;&#12400;&#12363;&#12426;&#12398;&#12450;&#12489;&#12524;&#12473;&#31354;&#38291;&#20840;&#20307;&#12434; unmap&#12375;&#12390;
        &#26032;&#12375;&#12367;&#20316;&#12426;&#12414;&#12377;&#12290;
        &#12371;&#12428;&#12399;&#12289;&#35242;&#12398; vm_map&#12434;&#36799;&#12387;&#12390; COW&#12392;&#12510;&#12540;&#12463;&#12373;&#12428;&#12383;&#37096;&#20998;&#12434;
        &#38750;COW&#12395;&#12377;&#12427;&#20316;&#26989;&#12434;&#20276;&#12356;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#35242;&#12398;&#12502;&#12525;&#12483;&#12463;&#12434;&#35299;&#12365;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#35242;&#12364;&#36208;&#12426;&#12289;&#20197;&#21069;&#12395;&#12399; R/W &#12391;&#12354;&#12387;&#12390; COW&#12395;&#12377;&#12427;&#12383;&#12417;&#12395; R/O&#12392;&#12510;&#12540;&#12463;&#12375;&#12383;&#12487;&#12540;&#12479;&#12434;
        &#22793;&#26356;&#12377;&#12427;&#12392;&#12506;&#12540;&#12472;&#12501;&#12457;&#12523;&#12488;&#12434;&#36215;&#12371;&#12375;&#12414;&#12377;&#12290;&#12371;&#12398;&#26178;&#28857;&#12391;&#12399;&#12487;&#12540;&#12479;&#12398;&#12467;&#12500;&#12540;&#12399;&#34892;&#12394;&#12431;&#12428;&#12414;&#12379;&#12435;&#12290;</p></li>
</ul></div>

<h4 class="title">
<a name="3bsd-vfork"></a>&#12450;&#12489;&#12524;&#12473;&#31354;&#38291;&#20849;&#26377;&#12434;&#29992;&#12356;&#12383;
3.0BSD/NetBSD &#12398; <code class="function">vfork()</code> &#12398;&#20966;&#29702; (<a href="#vfork">&#12488;&#12483;&#12503;</a>)
  </h4>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem"><p>&#35242;&#12503;&#12525;&#12475;&#12473;&#12398; vmspace&#27083;&#36896;&#20307;&#12408;&#12398;&#21442;&#29031;&#12434;&#24471;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#35242;&#12434;&#12502;&#12525;&#12483;&#12463;&#12375;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#23376;&#12364;&#36208;&#12426;&#12414;&#12377;&#12290; &#35242;&#12398;&#12506;&#12540;&#12472;&#12486;&#12540;&#12502;&#12523;&#12364;&#29992;&#12356;&#12425;&#12428;&#12427;&#12398;&#12391;&#12289; PTE&#12399;&#26082;&#12395;
        &#26377;&#21177;&#12391;&#12354;&#12426;&#12506;&#12540;&#12472;&#12501;&#12457;&#12523;&#12488;&#12399;&#36215;&#12371;&#12426;&#12414;&#12379;&#12435;&#12290;</p></li>
<li class="listitem"><p>&#23376;&#12364; exec &#12375;&#12289;&#35242;&#12398; vmspace&#27083;&#36896;&#20307;&#12395;&#23550;&#12375;&#12390;&#25345;&#12387;&#12390;&#12356;&#12383;&#21442;&#29031;&#12434;&#21066;&#38500;&#12375;&#12289;
	&#26032;&#12375;&#12356;&#12418;&#12398;&#12434;&#20316;&#12426;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#35242;&#12398;&#12502;&#12525;&#12483;&#12463;&#12434;&#35299;&#12365;&#12414;&#12377;&#12290;</p></li>
<li class="listitem"><p>&#35242;&#12364;&#36208;&#12426;&#12414;&#12377;&#12290;(&#35242;&#12398; vm_map&#12399;&#22793;&#26356;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12398;&#12391;&#12289;
        &#12506;&#12540;&#12472;&#12501;&#12457;&#12523;&#12488;&#12399;&#36215;&#12371;&#12426;&#12414;&#12379;&#12435;&#12290;)</p></li>
</ul></div>

<p>
&#12371;&#12398;&#12424;&#12358;&#12395;&#12289;fork &#12375;&#12390;&#12373;&#12425;&#12395; exec&#12377;&#12427;&#12424;&#12358;&#12394;&#22580;&#21512;&#12395;&#12399;&#12289;
&#26126;&#12425;&#12363;&#12395;&#24460;&#32773;&#12364;&#12424;&#12426;&#39640;&#36895;&#12391;&#12377;&#12290;
&#12383;&#12392;&#12360;&#33391;&#12356; COW&#12450;&#12523;&#12468;&#12522;&#12474;&#12512;&#12434;&#20351;&#12387;&#12390;&#12356;&#12427;&#12392;&#12375;&#12390;&#12418;&#12289;&#20206;&#24819;&#31354;&#38291;&#12434;&#20849;&#26377;&#12377;&#12427;
&#22580;&#21512;&#12392;&#27604;&#12409;&#12390;&#22823;&#22793;&#22810;&#12367;&#12398;&#20316;&#26989;&#12434;&#34892;&#12394;&#12431;&#12397;&#12400;&#12394;&#12426;&#12414;&#12379;&#12435;!
</p>
<hr>Back to  <em><a href="./">NetBSD &#12489;&#12461;&#12517;&#12513;&#12531;&#12486;&#12540;&#12471;&#12519;&#12531;: &#12459;&#12540;&#12493;&#12523;</a></em>
</div></div></div>
<div class="navfoot"></div>
<div id="footer"><div id="footerContent"><center>
<span class="footfeed"><a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">
	  &#36899;&#32097;</a> |
      </span><span class="footcopy"><a href="../../../about/disclaimer.html">
      &#20813;&#36012;&#20107;&#38917;</a> |

      <span class="copyright">Copyright © 1994-2012 The NetBSD Foundation, Inc. </span>ALL RIGHTS RESERVED.<br>NetBSD<sup>®</sup>&#12399;
	 NetBSD Foundation, Inc. &#12398;&#30331;&#37682;&#21830;&#27161;&#12391;&#12377;&#12290;</span>
</center></div></div>
</div></body>
</html>
