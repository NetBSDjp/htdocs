<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
<!-- Copyright (c) 1998-2004
	The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED. -->
<link rev="made" href="mailto:www@NetBSD.org">
<title>Setting up Remote Access Without Any Console</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">

<a href="files.html">Back</a> |
<a href="./">Table of Contents</a>

<hr>

<h1>Setting up Remote Access Without Any Console</h1>

You only need to follow these directions if your machine doesn't have a
working local console or a working serial console (such as an iBook 
or an hp425e).  It's not the best
way to run a machine, as there are some things that you can only do from
console, such as choosing the boot disk, kernel, and booting options.
<p>

Basically what this page describes is how to set up your NFS filesystem
such that the client will boot far enough to start a telnet daemon and let
you log in to further configure the machine.
<p>

<ol>
<li>Create the device files.<br>
   Trivial as this sounds, this may be the most difficult step
   here.  First, try to run the <tt>MAKEDEV</tt> script:<br>
   <tt># <b>cd /export/client/root/dev;./MAKEDEV all</b></tt>
   <p>
   If your NFS server OS doesn't deal with this gracefully, then you will
   need to manually create the necessary device files, then run
   <tt>MAKEDEV all</tt> once your client is booted to get the standard set
   of device files.  To manually create them, you need to look through
   your <tt>MAKEDEV</tt> file and determine which devices you need
   (probably ethernet, pseudo-terminals, null, stdin, stdout, and stderr).  
   If you will be mounting the miniroot filesystem, you'll probably also
   need the vnode disk device files.  Once you know what the major and
   minor numbers are for your devices,
   then you need to <tt>man mknod</tt> to determine the syntax 
   of your server's <tt>mknod</tt> command, then make those devices.
<p>

<li>Edit <tt>/export/client/root/etc/rc.conf</tt> and change the line
to read:<br>
<tt>rc_configured=<b>YES</b></tt>
<p>

<li>Edit <tt>/export/client/root/etc/inetd.conf</tt> and make sure that
the telnet daemon is uncommented (in NetBSD 1.5 and later, telnet is
disabled by default).
<p>

<li>Edit <tt>/export/client/root/etc/master.passwd</tt> and add a user
so that you can telnet in.  Just add a line to the end of the file
reading something like:<br>
<tt><b>me::1000:100::0:0:My account:/home/me:/bin/csh</b></tt><br>
where <tt>me</tt> is the name of the account, there's no password, the
home directory is in <tt>/home/me</tt>, and the shell is
<tt>/bin/csh</tt>.  Make sure there's a return at the end of this line,
but that there are no blank lines in the file.
<p>

<li>Edit <tt>/export/client/root/etc/group</tt> and add yourself to
group <tt>wheel</tt>:<br>
<tt>wheel:*:0:root<b>,me</b></tt>
<p>

<li>Edit <tt>/export/client/root/etc/rc.local</tt> and add a line to
the end of the file reading:<br>
<tt><b>/usr/sbin/pwd_mkdb -p /etc/master.passwd</b></tt><br>
This will create all of the shadow password files and databases so that
your user can log in.
<p>

<li>Boot and telnet in.  <tt>su</tt> to root.
<p>

<li>If you didn't make all of the device files before, do so now:<br>
<tt># <b>cd /dev;./MAKEDEV all</b></tt>
<p>

<li>Create passwords for both your <tt>me</tt> user and for
<tt>root</tt>:<br>
<tt># <b>/usr/bin/passwd -l root</b></tt>
<tt># <b>/usr/bin/passwd -l me</b></tt>
<p>

<li>Remove the <tt>pwd_mkdb</tt> line from <tt>/etc/rc.local</tt> as
this was only needed the first time your machine booted.
</ol>
<p>

Congratulations!  Now you need to <a href="finish.html">finish</a> up by
setting all of your diskless server daemons to automatically start when
your server reboots.  Either that, or you need to 
<a href="local.install.html#scripts">manually install</a> onto your local
hard drive.
<p>

<hr>

<a href="files.html">Back</a> |
<a href="./">Table of Contents</a>

<hr> 

<table width="100%"><tr><td>
  <table><tr><td>
    <a href="../../../"><img
        src="../../../images/NetBSD-flag.png" border="0"
        width="90" height="90" alt=""></a> 
  </td><td>
    <a href="../../../"><img
        src="../../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Home Page</a>
  </td></tr></table>
</td><td>
  <table><tr><td> 
    <a href="../../../docs/"><img
        src="../../../images/NetBSD-flag.png" border="0"
        width="90" height="90" alt=""></a>
  </td><td>
    <a href="../../../docs/"><img
        src="../../../images/empty.gif" border="0"
        width="1" height="1" alt="NetBSD ">Documentation top level</a>
  </td></tr></table>
</td></tr></table>

<hr>
<address>
  <small>
  <a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">(Contact us)</a>
  $NetBSD: files.nocons.html,v 1.3 2007/08/01 15:36:01 kano Exp $<br>
  <a href="../../../about/disclaimer.html">Copyright &copy; 1998-2004
    The NetBSD Foundation, Inc.  ALL RIGHTS RESERVED.</a>
  </small>
</address>

</body>
</html>
