<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Website XSL Stylesheet V2.6.0">
<link rel="home" href="../../../." title="Welcome to The NetBSD Project: Of course it runs NetBSD.">
<link rel="up" href="../../../ja/docs/." title="NetBSD ドキュメンテーション">
<link rel="previous" href="../../../ja/docs/misc/." title="NetBSD ドキュメンテーション: 他の FAQ と HOWTO">
<link rel="next" href="../../../ja/docs/network/dhcp.html" title="NetBSD DHCP HOWTO">
<link rel="first" href="../../../ja/docs/Hardware/." title="ハードウェアドキュメンテーション">
<link rel="last" href="../../../ja/docs/x/." title="NetBSD ドキュメンテーション: X Window System">
<link rel="stylesheet" href="../../../global.css" type="text/css">


<title>The NetBSD Network FAQ</title>
</head>
<body class="website"><div class="webpage">
<a name="ja-docs-network-index"></a><div id="top"><a href="#mainContent" class="doNotDisplay doNotPrint">本文へ飛ぶ。</a></div>
<div id="header">
<div class="topNavigation">
<span>» </span><a href="../../../docs/guide/en/">
	  ガイド</a> |
	<a href="http://man.NetBSD.org/">マニュアルページ</a> |
	<a href="../../../ja/mailinglists/">
	  メーリングリスト</a>と
	<a href="http://mail-index.NetBSD.org/">記事</a> |
	<a href="http://cvsweb.NetBSD.org/">CVS リポジトリー</a> |
	バグの<a href="http://www.NetBSD.org/cgi-bin/sendpr.cgi?gndb=netbsd">報告</a>
	と
	<a href="../../../ja/support/query-pr.html">
	 照会</a> |
	<a href="../../../ja/docs/software/packages.html">
	  ソフトウェアパッケージ
	</a>
</div>
<div class="centralHeader">
<a href="../../../ja/"><img alt='NetBSD プロジェクト "Of course it runs NetBSD"' width="506" height="90" src="../../../images/NetBSD-headerlogo.png"></a><div class="headerTools"><div id="headerSearch">
<div id="header-cse-search-form" style="width: 24%;">Google custom search</div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script><script type="text/javascript"> 
		  google.load('search', '1', {language : 'ja'});
		  google.setOnLoadCallback(function() {
		  var header_customSearchControl = new google.search.CustomSearchControl(
		  '016685087845965994609:5539h4dkepg');

		  header_customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
		  var header_options = new google.search.DrawOptions();
		  header_options.enableSearchboxOnly("http://google.com/cse?cx=016685087845965994609:5539h4dkepg");
		  header_customSearchControl.draw('header-cse-search-form', header_options);
		  }, true);
		</script><link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css">
</div></div>
</div>
<div class="navBar">
<span class="doNotDisplay">
	  案内:
	</span><a href="../../../ja/">
	  ホーム</a> | 
	<a href="../../../ja/about/">
	  概要</a> | 
	<a href="../../../ja/gallery/">
	  展示室</a> | 
	<a href="../../../ja/releases/">
	  ダウンロード</a> | 
	<a href="../../../ja/docs/">
	  ドキュメンテーション</a> | 
	<a href="../../../ja/support/">
	  サポート</a> | 
	<a href="../../../ja/community/">
	  コミュニティー</a> | 
	<a href="../../../ja/ports/">
	  機種</a>
</div>
</div>
<div id="content"><div class="fullWidth"><div class="rowOfBoxes">
<h1>The NetBSD Network FAQ</h1>
<p>
このページは作成中ですので、
<a class="ulink" href="http://www.NetBSD.org/cgi-bin/feedback.cgi" target="_top">コメントや提案</a>を歓迎します。
</p>
<h3 class="title"><a name="NetworkingFAQ">Networking FAQ</a></h3>
<ul>
<li><a href="#getting_started">始めよう</a></li>
<li><a href="#configuration_files"> ネットワーク設定ファイル</a></li>
<li><a href="#configuration_programs"> ネットワーク設定プログラム</a></li>
<li><a href="#adding_a_host"> ネットワークに新しいホストを追加する</a></li>
<li><a href="#naming_a_host"> ネットワークの新しいホストを名づける</a></li>
<li><a href="#internetworking"> インターネットワーキング</a></li>
<li><a href="#ppp"> PPPによるインターネットワーキング</a></li>
<li><a href="#pppleased">専用線を用いた pppd の設定</a></li>
<li><a href="#ppp-wince">WinCE から NetBSD に PPP 接続する</a></li>
<li><a href="#isdn-ta">ISDN モデム (ターミナルアダプター、 TA) の使い方は?</a></li>
<li><a href="#isdn4bsd">ISDN カードを用いたインターネットワーキング</a></li>
<li><a href="#pppoe">DSL / PPPoE を用いたインターネットワーキング</a></li>
<li><a href="#gprs">GPRS / CDPD を用いたインターネットワーキング</a></li>
<li><a href="#nonsubnetgateway">ローカルサブネット上にないゲートウェイを用いたネットワーキング</a></li>
<li><a href="#simplenat">簡単な NAT ("IP Masquerading") の設定</a></li>
<li><a href="#maintenance">メンテナンス</a></li>
<li><a href="#security">セキュリティー</a></li>
<li><a href="#appletalk">Appletalk を使う</a></li>
<li><a href="#kerberos">Kerberos</a></li>
<li><a href="#win2k">Windows 2000 に対する認証</a></li>
</ul>
<h3 class="title"><a name="network-problems">Network の問題</a></h3>
<ul>
<li><a href="#unable-to-ping">他のホスト名に ping できない</a></li>
<li><a href="#connection-delays">接続に 30秒くらいかかる</a></li>
</ul>
<h3 class="title"><a name="otherlinks">Other links</a></h3>
<ul><li><a href="#linklist">Miscellaneous links</a></li></ul>
<hr>
<h3 class="title">Networking FAQ</h3>
<h4 class="title">
<a name="getting_started"></a>始めよう (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
NetBSD のインストール手順は基本的なネットワークの設定を含んでおり、
標準的なワークステーション構成の設定を行います。
この設定は NetBSD の多くのネットワークの機能を利用するために拡張することができます。
</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
    <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
<a class="ulink" href="http://www.cis.ohio-state.edu/cgi-bin/rfc/rfc1918.html" target="_top">RFC 1918</a>
        (<a class="ulink" href="ftp://ftp.nic.ad.jp/jpdoc/rfc-jp/rfc1918-jp.txt" target="_top">和訳</a>)
       - プライベート・インターネットのアドレス割り当て
      </li></ul></div>
  </li></ul></div>


<h4 class="title">
<a name="configuration_files"></a> ネットワーク設定ファイル (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
ネットワークの設定は、テキスト形式の設定ファイルによって
設定します。
</p>

<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<code class="filename">/etc/rc.conf</code> - <a href="http://netbsd.gw.com/cgi-bin/man-cgi?rc.conf+5+NetBSD-5.1+i386">rc.conf(5)</a>
      システムの初期化時に、ネットワークサービスを含む
      システムサービスを自動的に開始するための設定。
  </li>
<li class="listitem">
<code class="filename">/etc/hosts</code> - <a href="http://netbsd.gw.com/cgi-bin/man-cgi?hosts+5+NetBSD-5.1+i386">hosts(5)</a> もっとも基本的なホスト名とIPアドレスの対応表。
  </li>
<li class="listitem">
<code class="filename">/etc/myname</code> - そのホストの FQDN (ドメイン名のついたホスト名) (<code class="filename">/etc/rc.conf</code> で
      <strong class="userinput"><code>hostname</code></strong> を設定していない場合に使われる)。
  </li>
<li class="listitem">
<code class="filename">/etc/mygate</code> - デフォルトゲートウェイ。通常は <code class="filename">/etc/rc.conf</code> に
      <strong class="userinput"><code>defaultroute</code></strong> として記述する方がよい。また、
      <a href="http://netbsd.gw.com/cgi-bin/man-cgi?routed+8+NetBSD-5.1+i386">routed(8)</a> を使用することもできる。
  </li>
<li class="listitem">
<code class="filename">/etc/ifconfig.{<span class="emphasis"><em>IF</em></span>}</code>. - 
      ネットワークインターフェース <span class="emphasis"><em>IF</em></span> の設定。
      システムの初期化時、ネットワークインターフェースを
     設定するために <code class="filename">/etc/rc.d/network</code> で用いられる。 <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ifconfig.if+5+NetBSD-5.1+i386">ifconfig.if(5)</a> 参照。
     <code class="filename">/etc/rc.conf</code> で
     <strong class="userinput"><code>ifconfig_IF="..."</code></strong> のように設定することもできる。
  </li>
<li class="listitem">
<code class="filename">/etc/ifaliases</code> - <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ifaliases+5+NetBSD-5.1+i386">ifaliases(5)</a>
      一つのインターフェースには一つ以上の IP アドレス (alias) を割り当てることができる。
      ここで記述された alias は、システムの初期化時に
      <code class="filename">/etc/rc.d/network</code> で用いられる。
  </li>
<li class="listitem">
      <p>
        <code class="filename">/etc/resolv.conf</code> - <a href="http://netbsd.gw.com/cgi-bin/man-cgi?resolv.conf+5+NetBSD-5.1+i386">resolv.conf(5)</a>
        は、数値 IP アドレスからホスト名への
        名前解決方法を指定します。たいていの場合、探索用のドメインを指定する行と、
        問い合わせ先ネームサーバーの IP アドレス (1 行または複数) を書いておきます:
      </p>

      <p>
      </p>
<pre class="programlisting">
search subdomain.yourdomain.tld yourdomain.tld
nameserver 192.168.253.10
nameserver 192.168.253.11
      </pre>
<p>
      </p>

      <p>
        このファイルは <a href="http://netbsd.gw.com/cgi-bin/man-cgi?dhclient+8+NetBSD-5.1+i386">dhclient(8)</a> が上書きすることに注意してください!
      </p>
  </li>
</ul></div>

<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
      <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"> <a href="http://netbsd.gw.com/cgi-bin/man-cgi?hostname+7+NetBSD-5.1+i386">hostname(7)</a> </li></ul></div>
  </li></ul></div>


<h4 class="title">
<a name="configuration_programs"></a> ネットワーク設定プログラム (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>

二つの重要なネットワーク設定プログラムがネットワークスタートアップスクリプト
(/etc/rc.d/network) で使われています。
これらは使用中のネットワークの設定を手動で変更するのに使うこともできます。
</p>

<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
  <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ifconfig+8+NetBSD-5.1+i386">ifconfig(8)</a> - ネットワークインターフェースの設定を変更、参照する。
  </li>
<li class="listitem">
  <a href="http://netbsd.gw.com/cgi-bin/man-cgi?route+8+NetBSD-5.1+i386">route(8)</a> - ネットワークルーティングテーブルを操作する。
  </li>
</ul></div>

<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
      <div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem"><a href="http://netbsd.gw.com/cgi-bin/man-cgi?domainname+1+NetBSD-5.1+i386">domainname(1)</a></li>
<li class="listitem">
<a href="http://netbsd.gw.com/cgi-bin/man-cgi?hostname+1+NetBSD-5.1+i386">hostname(1)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?hostname+7+NetBSD-5.1+i386">hostname(7)</a>
</li>
</ul></div>
  </li></ul></div>


<h4 class="title">
<a name="adding_a_host"></a> ネットワークに新しいホストを追加する (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
そのネットワークが DHCP を使うように設定されている場合、必要なのは
<code class="filename">/etc/rc.conf</code> で <strong class="userinput"><code>dhclient=yes</code></strong>
と設定することだけです。すると、
ブート時に DHCP クライアントが起動して、マシンの IP アドレス、ホスト名、
デフォルトルーター、ネームサーバー、ドメイン名を自動的に設定します。
DHCP に関するさらなる情報は、<a class="ulink" href="dhcp.html" target="_top">ここ</a>を参照してください。
</p>

<p>
DHCP が使えない場合、新たにネットワークに接続するホストでは、インターフェースを、
そのローカル・ネットワーク上のアドレスに設定することが最低限必要です。
NetBSD のインストール中にネットワークの情報を与えると、
新しいホストはすぐにネットワークに接続され、
その IP アドレスでアクセスできるようになります。
</p>

<p>
ネットワークの設定の簡単な例を以下に示します。ネットワークインターフェースは
<code class="systemitem">ex</code>で、 IP アドレスを 192.168.253.2 に設定し、デフォルトルーターは
192.168.253.1 を使うものとします:
</p>

<p>
</p>
<pre class="programlisting">
  # ifconfig lo0 127.0.0.1
  # ifconfig ex0 192.168.253.2 netmask 255.255.255.0
  # route add default 192.168.253.1
</pre>
<p>
</p>


<h4 class="title">
<a name="naming_a_host"></a> ネットワークの新しいホストを名づける (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
IP アドレスと同じようにホスト名でのアクセスを可能にするには、
新しいホスト名とその IP アドレスをネットワーク設定ファイルに
追加します。それにはいくつかの方法があります;
</p>

<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p>
      <code class="filename">/etc/hosts</code>: <a href="http://netbsd.gw.com/cgi-bin/man-cgi?hosts+5+NetBSD-5.1+i386">hosts(5)</a>
      少数のホストからなる小さなネットワークでは、
      ホスト名と IP の対応を、各ホストの
      <code class="filename">/etc/hosts</code>
      ファイルに
      手でコピーすることができるでしょう。
      </p>

      <p>
      </p>
<pre class="programlisting">
      192.168.1.2  host2.mydomain.org.au host2
      </pre>
<p>
      </p>
  </li>
<li class="listitem">
      NIS (Network Information Service、以前は Yellow Pages
      (YP) という名前でした) を使うと
      /etc/hosts ファイルと同等な情報を、ネットワーク上で
      自動的に共有できるようになります。(hosts にある情報だけではなく
      passwd や group など、他のファイルにある情報も共有できます)。
      さらなる情報は、
      <a href="http://netbsd.gw.com/cgi-bin/man-cgi?rc.conf+5+NetBSD-5.1+i386">rc.conf(5)</a> の <strong class="userinput"><code>ypbind</code></strong> および <strong class="userinput"><code>domainname</code></strong>
      変数と、 <a href="http://netbsd.gw.com/cgi-bin/man-cgi?domainname+1+NetBSD-5.1+i386">domainname(1)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ypinit+8+NetBSD-5.1+i386">ypinit(8)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?yp+8+NetBSD-5.1+i386">yp(8)</a> を参照してください。
  </li>
<li class="listitem">
      DNS: ホスト名の対応をネームサーバー <a href="http://netbsd.gw.com/cgi-bin/man-cgi?named+8+NetBSD-5.1+i386">named(8)</a>
      経由でアクセスするゾーンファイルで集中管理します。
      (DNS ファイルの設定や管理についての多くのドキュメントが
      <a class="ulink" href="http://www.dns.net/dnsrd/docs/" target="_top">www.dns.net</a>
      にあります)。

      <p>
      <span class="emphasis"><em>正引きゾーンファイルのエントリー</em></span>
      </p>
<pre class="programlisting">
      host2  IN A     192.168.1.2
      </pre>
<p>

      <span class="emphasis"><em>逆引きゾーンファイルのエントリー</em></span>
      </p>
<pre class="programlisting">
      2      IN PTR   host2.mydomain.org.au.
      </pre>
<p>
      </p>
  </li>
</ol></div>

<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
      <div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem"><a href="http://netbsd.gw.com/cgi-bin/man-cgi?named.conf+5+NetBSD-5.1+i386">named.conf(5)</a></li>
<li class="listitem"><a href="http://netbsd.gw.com/cgi-bin/man-cgi?nsswitch.conf+5+NetBSD-5.1+i386">nsswitch.conf(5)</a></li>
</ul></div>
  </li></ul></div>


<h4 class="title">
<a name="internetworking"></a> インターネットワーキング (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
あなたのネットワーク (一つのホストから成るかもしれません) を
他のネットワークにつなぐ場合、少なくとも一つのホストを
二つのネットワーク間のゲートウェイとして動作させなくてはなりません。
ゲートウェイホストは二つのネットワークインターフェースを持っており、
それぞれを各ネットワークについて設定します。
</p>

<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
      <p>
       二つ目のイーサネットのインターフェース設定ファイルを作成する
      (<code class="filename">/etc/ifconfig.{<span class="emphasis"><em>interface</em></span>}</code>)
      。
      </p>

      <p>
      <code class="filename">/etc/ifconfig.we1</code>
      </p>
<pre class="programlisting">
      192.168.2.30 netmask 0xffffff00 media 10base2/BNC
      </pre>
<p>

      こうするかわりに、以下の行を
      <code class="filename">/etc/rc.conf</code> に書き足す方法もあります:

      </p>
<pre class="programlisting">
      ifconfig_we1="192.168.2.30 netmask 0xffffff00 media 10base2/BNC"
      </pre>
<p>
      </p>
  </li>
<li class="listitem">新しいインターフェースを有効にする為にリブートする。
  </li>
<li class="listitem">
      必要ならば IP パケットフォワーディングを有効にします。カーネルを
      <strong class="userinput"><code>options GATEWAY</code></strong> をつけて compile してもいいですし、
ブートのたびに <span class="command"><strong>sysctl -w net.inet.ip.forwarding=1</strong></span> を実行するか、
      <code class="filename">/etc/sysctl.conf</code> に
      <span class="command"><strong>net.inet.ip.forwarding=1</strong></span> を書いておいてもいいでしょう。
  </li>
</ul></div>

<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
      <div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem">
<a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipnat+5+NetBSD-5.1+i386">ipnat(5)</a>,<a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipnat+8+NetBSD-5.1+i386">ipnat(8)</a>
</li>
<li class="listitem">
<a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf.conf+5+NetBSD-5.1+i386">ipf.conf(5)</a>,<a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf+8+NetBSD-5.1+i386">ipf(8)</a>
</li>
<li class="listitem">
<a href="http://netbsd.gw.com/cgi-bin/man-cgi?sysctl.conf+5+NetBSD-5.1+i386">sysctl.conf(5)</a>,<a href="http://netbsd.gw.com/cgi-bin/man-cgi?sysctl+8+NetBSD-5.1+i386">sysctl(8)</a>
</li>
</ul></div>
  </li></ul></div>


<h4 class="title">
<a name="ppp"></a> PPPによるインターネットワーキング (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
<a href="http://netbsd.gw.com/cgi-bin/man-cgi?pppd+8+NetBSD-5.1+i386">pppd(8)</a>
を用いるとシリアルポート (モデムの有無にかかわらず) 上に特殊な
ネットワークインターフェースを作成できます。
</p>

<p>
PPP のセットアップには多くの方法があります。あなたの ISP に接続するのに
適した一つの簡単な方法は:
</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p>
      ピアーオプションファイル <code class="filename">/etc/ppp/peers/myisp</code> を作成する
      </p>

      <p>
      </p>
<pre class="programlisting">
      # Example pppd options
      # Specific for myisp
      /dev/tty01
      local_IP_address:remote_IP_address
      connect '/usr/sbin/chat -v -f /etc/ppp/peers/myisp.chat'
      defaultroute
      persist
      ipparam myisp
      asyncmap 0
      noauth
      </pre>
<p>
      </p>
  </li>
<li class="listitem">
      <p>
      デバイスオプションファイル
      <code class="filename">/etc/ppp/options.{ttyname}</code> を作成する
      </p>

      <p>
      </p>
<pre class="programlisting">
      # Example pppd options
      # Specific for ttyname
      lock
      crtscts
      57600
      modem
      </pre>
<p>
      </p>
  </li>
<li class="listitem">
      <p>
      チャットファイル
      <code class="filename">/etc/ppp/peers/myisp.chat</code> を作成する
      </p>

      <p>
      </p>
<pre class="programlisting">
      # Example chat file
      # Specific for myisp
      ABORT BUSY ABORT 'NO CARRIER' ""
      \da\ptz0 OK
      \da\ptdt8887776655 CONNECT
      </pre>
<p>
      </p>
  </li>
<li class="listitem">
      コネクションを確立する;
      <span class="command"><strong>
      pppd call myisp
      </strong></span>
  </li>
<li class="listitem">
      変数の設定を <strong class="userinput"><code>ppp_peers="myisp"</code></strong>
      のように <code class="filename">/etc/rc.conf</code> <a href="http://netbsd.gw.com/cgi-bin/man-cgi?rc.conf+5+NetBSD-5.1+i386">rc.conf(5)</a>
      に書いておくとブート時に自動的にコネクションが確立するようになります。
  </li>
</ol></div>

<p>
イーサネットインターフェースと異なり、<code class="filename">/etc/ifconfig.{interface}</code>
ファイルを PPP インターフェースに作成する必要はありません。
</p>
<p>
デマンドダイアル ppp を使用していて、特定のトラフィック(例えば <a href="http://netbsd.gw.com/cgi-bin/man-cgi?xntpd+8+NetBSD-5.1+i386">xntpd(8)</a> の
ntp のトラフィック)でリンクが確立されないようにしたいならば、
<code class="filename">ppd.conf</code> ファイル中で <strong class="userinput"><code>active-filter</code></strong> を使うことができます:
</p>
<pre class="programlisting">	active-filter   'not udp port ntp'</pre>
<p>
</p>

<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
      <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
<a href="http://netbsd.gw.com/cgi-bin/man-cgi?chat+8+NetBSD-5.1+i386">chat(8)</a> - Automated conversational script</li></ul></div>
  </li></ul></div>


<h4 class="title">
<a name="pppleased"></a>専用線を用いた pppd の設定 (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
専用線とは固定された2点間 link の事です。
この場合、NetBSD での設定は非常に簡単です。
サーバーで次のような <code class="filename">/etc/ppp/options</code>
を作成します:
</p>

<p>
     </p>
<pre class="programlisting">
     /dev/tty00
     57600
     noauth
     crtscts
     passive
     &lt;local_IP_address&gt;:&lt;remote_IP_address&gt;
     debug
     netmask 255.255.255.255
     proxyarp
     </pre>
<p>
</p>

<p>
<code class="literal">&lt;local_IP_address&gt;</code> と
<code class="literal">&lt;remote_IP_address&gt;</code> は使用するネットワーク上の
適切なものに変更する必要があります。
(<code class="literal">&lt;local_IP_address&gt;</code> は
イーサネットと同じでも構いませんが、<code class="literal">&lt;remote_IP_address&gt;</code> は
イーサネットのセグメントで有効なアドレスである必要があります)。
</p>

<p>
クライアントで次のような <code class="filename">/etc/ppp/options</code> を作成します:
     </p>
<pre class="programlisting">
     /dev/tty00
     57600
     noauth
     crtscts
     defaultroute
     debug
     </pre>
<p>
</p>
両方の設定中にあらわれる <code class="filename">/dev/tty00</code> は適切なシリアルポート名に変更して下さい。


<h4 class="title">
<a name="ppp-wince"></a>WinCE から NetBSD に PPP 接続する (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
Windows CE は接続の際、"CLIENT" という語を送出し、
行末に CR のない "CLIENTSERVER" という応答を待ちます。
上で説明したように pppd を設定したうえで、以下の行を追加します。

</p>
<pre class="programlisting">
connect "chat 'CLIENT' 'CLIENTSERVER\\c'"
</pre>
<p>
</p>

<h4 class="title">
<a name="isdn-ta"></a>ISDN モデム (ターミナルアダプター、 TA) の使い方は? (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>

NetBSD からは TA は普通のモデムに見えます。また、 TA は適切なモードに
切り替えれば asynchronous PPP をしゃべります。お使いの ISP
によっては、以下のモードから選べるかもしれません:
</p>

<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
	sync-to-async-HDLC conversion: 同期 HDLC フレームを非同期 HDLCフレームに
        変換します。お使いのプロバイダーが、昨今での標準である、 B チャネル上直接の
	"本物の" PPP over HDLC を推奨している場合はこれを使ってください。
  </li>
<li class="listitem">X75: X.25 over ISDN B-channel
  </li>
<li class="listitem">V120: 遅いコンピューター端末線用に狭い帯域のモデムを
	シミュレートするためのもの; しかし、残念なことに ISDN
	線の帯域をいくらか浪費しますが
  </li>
<li class="listitem"> V110: V120 の古いバージョン
  </li>
</ul></div>

<p>
TA のモードは Hayes <span class="command"><strong>AT</strong></span> モデムコマンドで設定します。正確なコマンドは
モデムのマニュアルを調べてください。さらに、これら <span class="command"><strong>AT</strong></span> コマンドに、
"普通の" (アナログ) でやっているようにして、いつも使う PPP 接続先用に
チャットスクリプトを追加することができます。
</p>


<h4 class="title">
<a name="isdn4bsd"></a>ISDN カードを用いたインターネットワーキング (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
<a class="ulink" href="../../../docs/network/isdn/" target="_top">ここ</a>をご覧ください。
</p>


<h4 class="title">
<a name="pppoe"></a>DSL / PPPoE を用いたインターネットワーキング (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
DSL/ PPPoE 全般の説明は、<a class="ulink" href="pppoe/" target="_top">ここ</a>をご覧ください。
ドイツの ISP T-Online 利用者向けの<a class="ulink" href="pppoe/#t-online" target="_top">追加説明</a>
もあります。
</p>


<h4 class="title">
<a name="gprs"></a>GPRS / CDPD を用いたインターネットワーキング (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
<a class="ulink" href="gprs.html" target="_top">ここ</a>をご覧ください。
</p>


<h4 class="title">
<a name="nonsubnetgateway"></a>ローカルサブネット上にないゲートウェイを用いたネットワーキング (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
場合によっては、経由する必要のあるゲートウェイが、
ネットワークインターフェースに割り当てられたアドレスと同じサブネット上にないことがあります。
たとえば、ネットワークインターフェースが fxp0 でそのアドレスが
10.0.0.1 であるが、ゲートウェイは 192.168.0.1 である (そして、
インターフェース fxp0 から到達可能である) 場合は、
以下のようにしてネットワークの設定をすることができます。
</p>
<p>
</p>
<pre class="programlisting">
 # ifconfig fxp0 inet 10.0.0.1
 # route add -host 192.168.0.1 -link fxp0 -iface
 # route add default -ifa 10.0.0.1 192.168.0.1
</pre>
<p>
</p>
このようなものは、典型的なネットワーキングの構成ではありませんが、
実際にありえます。


<h4 class="title">
<a name="simplenat"></a>簡単な NAT ("IP Masquerading") の設定 (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
ローカルネットワーク(例えば 10.0.0.0/24) に接続されているホストから
NetBSD マシンをルーターとして使用するために、ネットワークアドレス変換
(Network Address Translation, NAT、よそでは  "IP Masquerading" とも呼ばれる)
を設定するには、次のようにすればいいでしょう:
</p>

<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
        クライアントでは、NAT マシンをデフォルトルーターとして指定します。
	(NetBSD を使用しているならば、
        <code class="filename">/etc/rc.conf</code> に
	<strong class="userinput"><code>defaultroute="<span class="emphasis"><em>a.b.c.d</em></span>"</code></strong> を加えてください。
        ここで、 <strong class="userinput"><code><span class="emphasis"><em>a.b.c.d</em></span></code></strong> は内部向の IP アドレス
	(つまり、10.0.0.0 ネットワークのアドレス) を意味します)。
  </li>
<li class="listitem">
	<p>
        NAT マシンで、まずカーネルが ipfilter オプションが有効になっているかを
	確認してください (最新の GENERIC カーネルではデフォルトで有効になっています。):
	</p>

	<p>
	</p>
<pre class="programlisting">
options         PFIL_HOOKS    	        # <a href="http://netbsd.gw.com/cgi-bin/man-cgi?pfil+9+NetBSD-5.1+i386">pfil(9)</a> packet filter hooks
pseudo-device   ipfilter                # IP filter (firewall) and NAT
	</pre>
<p>
	</p>
  </li>
<li class="listitem">
  <p>
  以下の内容を <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf.conf+5+NetBSD-5.1+i386">ipf.conf(5)</a> に書きます:
  </p>
<pre class="programlisting">
pass in from any to any
pass out from any to any
  </pre>
<p>
  </p>
  </li>
<li class="listitem">
  <p>
  以下の内容を  <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipnat.conf+5+NetBSD-5.1+i386">ipnat.conf(5)</a> に書きます:
  </p>
<pre class="programlisting">
map ppp0 10.0.0.0/24 -&gt; 0/32 proxy port ftp ftp/tcp
map ppp0 10.0.0.0/24 -&gt; 0/32 portmap tcp/udp 40000:60000
map ppp0 10.0.0.0/24 -&gt; 0/32
  </pre>
<p>
  </p>
  </li>
<li class="listitem">
  <p>
  <code class="filename">/etc/rc.conf</code> で設定を有効にします:
  </p>
<pre class="programlisting">
ipfilter=YES                                    # uses /etc/ipf.conf
ipnat=YES                                       # uses /etc/ipnat.conf
  </pre>
<p>
  </p>
  </li>
<li class="listitem">
  <p>
  <code class="filename">/etc/sysctl.conf</code> で ipv4 パケットフォワーディングを有効にします:
  </p>
<pre class="programlisting">
net.inet.ip.forwarding=1
  </pre>
<p>
  </p>
  </li>
<li class="listitem"> リブートします。
  </li>
<li class="listitem"> デバッグには <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ping+8+NetBSD-5.1+i386">ping(8)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?tcpdump+8+NetBSD-5.1+i386">tcpdump(8)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipfstat+8+NetBSD-5.1+i386">ipfstat(8)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipnat+8+NetBSD-5.1+i386">ipnat(8)</a> を使って下さい。
  </li>
</ol></div>

<p>
PPPoE 接続上で (DSL 接続で通常はそうしますが) NAT を使いたい場合は、
<a class="ulink" href="pppoe/#clamping" target="_top">MSS の調整</a>もしておく必要があるかもしれません。
</p>


<h4 class="title">
<a name="maintenance"></a>メンテナンス (<a href="#NetworkingFAQ">top</a>)
  </h4>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">監視 - 便利なツール
      <div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem">
        <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ifconfig+8+NetBSD-5.1+i386">ifconfig(8)</a> - ネットワークインターフェースのパラメーターの設定と表示
	</li>
<li class="listitem">
        <a href="http://netbsd.gw.com/cgi-bin/man-cgi?route+8+NetBSD-5.1+i386">route(8)</a> - ルーティングテーブルの操作
	</li>
<li class="listitem">
        <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ping+8+NetBSD-5.1+i386">ping(8)</a> - ICMP ECHO_REQUEST パケットをネットワークホストに送る
	</li>
<li class="listitem">
        <a href="http://netbsd.gw.com/cgi-bin/man-cgi?traceroute+8+NetBSD-5.1+i386">traceroute(8)</a> - パケットがネットワークホストに到達するルートを表示
	</li>
<li class="listitem">
        <a href="http://netbsd.gw.com/cgi-bin/man-cgi?tcpdump+8+NetBSD-5.1+i386">tcpdump(8)</a> - ネットワークインターフェース上のトラフィックを選択して表示
	</li>
<li class="listitem">
        <a href="http://netbsd.gw.com/cgi-bin/man-cgi?netstat+1+NetBSD-5.1+i386">netstat(1)</a> - ネットワーク状態の表示
	</li>
<li class="listitem">
        <a href="http://netbsd.gw.com/cgi-bin/man-cgi?systat+1+NetBSD-5.1+i386">systat(1)</a> 'systat netstat' - ネットワーク接続を動的に表示
	</li>
</ul></div>
  </li></ul></div>

<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
      <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
<a href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc/net/mrtg/README.html" target="_top"><code class="filename">net/mrtg</code></a> - 
	パッケージコレクションにあるこのユーティリティーで、
	ネットワークの状態を視覚的に監視できるようになります。
	</li></ul></div>
  </li></ul></div>


<h4 class="title">
<a name="security"></a>セキュリティー (<a href="#NetworkingFAQ">top</a>)
  </h4>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<code class="filename">/etc/hosts.{allow,deny}</code>: tcp-wrappers  (<a href="http://netbsd.gw.com/cgi-bin/man-cgi?hosts_access+5+NetBSD-5.1+i386">hosts_access(5)</a>)
      の設定ファイル。マスターデーモン
      <a href="http://netbsd.gw.com/cgi-bin/man-cgi?inetd+8+NetBSD-5.1+i386">inetd(8)</a> に組み込まれている。
  </li>
<li class="listitem">もし、ネットワークアドレス変換 (NAT 、ときには IP マスカレードとも呼ばれます)
      も含んだ完全な防火壁が必要ならば、NetBSD 付属の IPfilter を
      使用して下さい。
      IP filter の <a class="ulink" href="http://coombs.anu.edu.au/ipfilter/" target="_top">ホームページ</a>を
      参照してください。
      NetBSD での設定ファイルについては <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf.conf+5+NetBSD-5.1+i386">ipf.conf(5)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf6.conf+5+NetBSD-5.1+i386">ipf6.conf(5)</a>,
      <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipnat.conf+5+NetBSD-5.1+i386">ipnat.conf(5)</a> を、コマンドおよび有用なマニュアルページとしては <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf+4+NetBSD-5.1+i386">ipf(4)</a>,
      <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf+8+NetBSD-5.1+i386">ipf(8)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipfs+8+NetBSD-5.1+i386">ipfs(8)</a>, <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipfstat+8+NetBSD-5.1+i386">ipfstat(8)</a> を参照してください。
  </li>
</ul></div>

<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
    参考:
      <div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem">
<a class="ulink" href="http://www.cert.org/" target="_top">CERT* Coordination Center</a>
            は、インターネットのセキュリティー脆弱性を研究しています。
	</li>
<li class="listitem">
<a class="ulink" href="http://www.cert.org/tech_tips/root_compromise.html" target="_top">
            UNIX の Root 権限奪取からの復旧手順</a>
	</li>
<li class="listitem">
<a class="ulink" href="http://www.obfuscation.org/ipf/ipf-howto.txt" target="_top">IP Filter
            による防火壁 HOWTO</a>
	</li>
</ul></div>
  </li></ul></div>


<h4 class="title">
<a name="appletalk"></a>Appletalk を使う (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
NetBSD は unix マシンと appletalk マシンをイーサネット (localtalk では
ありません) で通信を可能にする
'<a href="ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc/net/netatalk/README.html" target="_top"><code class="filename">net/netatalk</code></a>' をサポートしています。
これは Mac OS マシンが NetBSD マシンを介してファイルシステムを読んだり
プリンターを用いたり、NetBSD マシンが appletalk プリンターに印刷したり
することができます。必要なソースは NetBSD の<a class="ulink" href="../software/packages.html" target="_top">Packages
Collection</a>から利用可能です。
</p>


<h4 class="title">
<a name="kerberos"></a>Kerberos (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
Kerberos は、秘密鍵暗号を使用してクライアント/サーバー型アプリケーションに
強力な認証を提供するネットワーク認証システムです。
NetBSD には KTH Heimdal Kerberos 5 の実装が附属しています。
</p>
<p>
ここでは、 NetBSD システムで Kerberos を使うための設定について
簡単に説明します。 Kerberos 初心者にとっては、この文書は基本的な
手引きとなります。 Kerberos 熟練者にとっては、すでに使っているかもしれない
他のシステム上の Kerberos と、 NetBSD の Kerberos との違いを示すものに
なるかもしれません。
</p>
<p>
この説明では、あなたの DNS ドメイン名を "foo.com" であるとします。
また、 foo.com ドメインには 2 台のマシンがあって、その名前は
<span class="emphasis"><em>mach1.foo.com</em></span> と <span class="emphasis"><em>mach2.foo.com</em></span> であるとします。
</p>
<p>
Kerberos で管理される domain を
<code class="systemitem">realm</code> といいます。
realm は好きなように名付けることができますが、ここでは、
組織の DNS ドメイン名を大文字にしたものを使うことにします。つまり、
ドメインの例 "foo.com" に対しては、 Kerberos realm は "FOO.COM" になります。
</p>
<p>
Kerberos で識別されるものを <code class="systemitem">principal</code> といいます。ユーザー、
ホスト、さらにはホスト上の個々のサービスまで、すべて principal です。
principal は "name@REALM" という形をしています。 "@REALM" を省略すると、
デフォルトの realm が仮定されます。サービスの principal は
"service/hostname@REALM" という形をしています。ここで hostname はホストの
完全修飾名にしてください。すべてのホストは、 "host/..."
というサービス principal を持っています。この "host/..." principal は、
一般的にログインプログラム (たとえば <a href="http://netbsd.gw.com/cgi-bin/man-cgi?telnetd+8+NetBSD-5.1+i386">telnetd(8)</a>、 <a href="http://netbsd.gw.com/cgi-bin/man-cgi?sshd+8+NetBSD-5.1+i386">sshd(8)</a>) や、
その他ホストが他の principal の認証をする必要のある場合
(たとえばいくつかの IPsec 鍵管理プロトコル) に使われます。
</p>
<p>
Kerberos の信任状インスタンスは<code class="systemitem">チケット</code>と呼ばれます。チケットには、
<code class="systemitem">ticket granting ticket</code> (チケット保障チケット)
すなわち <code class="systemitem">TGT</code>
と呼ばれる特別なチケットがあります。 <code class="systemitem">TGT</code> は信任状の初期設定で、
ユーザーが <a href="http://netbsd.gw.com/cgi-bin/man-cgi?login+1+NetBSD-5.1+i386">login(1)</a> プログラムを使うか <a href="http://netbsd.gw.com/cgi-bin/man-cgi?kinit+1+NetBSD-5.1+i386">kinit(1)</a> を実行してログイン
したときに得られます。 <code class="systemitem">TGT</code> は、 Kerberos で認証をおこなうサービスを
利用するために必要なサービスチケットを取得するために使われます。チケットは、
<code class="systemitem">信任状キャッシュ</code>と呼ばれる専用のデータベースに保持されます。
ログインセッションでは、信任状キャッシュは通常は <code class="filename">/tmp</code> 以下のファイルに
保持されます。信任状キャッシュは、 <a href="http://netbsd.gw.com/cgi-bin/man-cgi?kdestroy+1+NetBSD-5.1+i386">kdestroy(1)</a> コマンドによるログアウト時に
破棄されます。
</p>
<p>
<span class="emphasis"><em>信任状キャッシュを安全な状態にしておくことが重要です!</em></span>
</p>
<p>
そうでないと、誰かがあなたの信任状を使って信任状の必要なサービスにアクセス
することができるようになってしまいます。
</p>
<p>
信任状は <code class="systemitem">Key Distribution
Center</code> (鍵配布センター) すなわち <code class="systemitem">KDC</code>
で集中管理されます。 <code class="systemitem">KDC</code> によるユーザー認証は、
<code class="systemitem">TGT</code> 取得時にパスワードを提供することで行われます。
<code class="systemitem">KDC</code> によるサービス認証も同様の仕組みを使いますが、
<code class="systemitem">key table</code> すなわち keytab からサービスの "パスワード" が提供され、
ホストに保持されます。
</p>
<p>
Kerberos では、 realm 内の全ホストの時刻が同期している必要があることに
注意してください。そのようにするための最良の方法は、このネットワークで
NTP を使うことです。
</p>
<p>
以下、ネットワークで Kerberos を使うための設定を、
順序立てて説明します。
</p>

<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
     <p>
     Kerberos <code class="systemitem">KDC</code>
     となるシステムを決めます。このシステムは安全でなければ
     なりません; <code class="systemitem">KDC</code> が危険に晒されると、すべての
     principal に被害が及びます。
     この例では、この役目を <span class="emphasis"><em>mach1.foo.com</em></span> に与えることにします。
     </p>
     <p>
     <code class="systemitem">KDC</code> システムはまた、
     Kerberos 管理サーバーや Kerberos
     パスワード変更サーバーといった役割も演じます。
     </p>
     <p>
     <code class="systemitem">KDC</code>
     に関する情報を提供するためのもっとも簡単な方法は、 DNS の SRV
     レコードを使うことです。この場合、 FOO.COM realm でのエントリーの例は、
     次のようになります:

     </p>
<pre class="programlisting">
     _kerberos._udp      IN  SRV     01 00 88 mach1.foo.com.
     _kerberos._tcp      IN  SRV     01 00 88 mach1.foo.com.
     _kpasswd._udp       IN  SRV     01 00 464 mach1.foo.com.
     _kerberos-adm._tcp  IN  SRV     01 00 749 mach1.foo.com.
     _kerberos           IN  TXT     FOO.COM
     </pre>
<p>
     </p>

     <p>
     SRV レコードの書式については、 RFC 2782 を参照してください。
     DNS による方法を使いたくなければ、この情報を realm 内の各ホストで
     手動で設定することができることに注意してください。
     </p>
  </li>
<li class="listitem">
     <p>
     realm 内の各システムの <code class="filename">/etc/krb5.conf</code>
     を設定します。このファイルで
     デフォルトの realm を指定する必要があります。 注意: Kerberos
     の実装によっては、これが必要ない (Kerberos が DNS の TXT レコード
     "_kerberos" からデフォルトの realm を知ることができる) ものもありますが、
     NetBSD の Kerberos では <code class="filename">/etc/krb5.conf</code>
     ファイルが存在しないと
     有効にはなりませんので、ここで設定しておくのがよいでしょう。

     </p>
<pre class="programlisting">
     # cat &gt; /etc/krb5.conf
     [libdefaults]
             default_realm = FOO.COM
     ^D
     #
     </pre>
<p>
     </p>

     <p>
     realm の設定に DNS SRV レコードを使って<span class="emphasis"><em>いない</em></span>場合は、
     <code class="filename">/etc/krb5.conf</code> に以下のような <code class="systemitem">KDC</code>、 kadmin および kpasswd
     サーバーのリストも必要です:

     </p>
<pre class="programlisting">
     # cat &gt;&gt; /etc/krb5.conf
     [realms]
             FOO.COM = {
                     kdc = mach1.foo.com
                     admin_server = mach1.foo.com
                     # optional, defaults to admin_server
                     kpasswd_server = mach1.foo.com
             }
     ^D
     #
     </pre>
<p>
     </p>

     <p>
     モバイルホストを、そのホストが参加している別の realm に持ち込んだ場合、
     <code class="filename">/etc/krb5.conf</code> ファイルのデフォルト realm は DNS の _kerberos TXT
     レコードで上書きされます。
     </p>
  </li>
<li class="listitem">
     <p>
     <code class="systemitem">KDC</code> システムには <code class="filename">/var/heimdal</code>
     ディレクトリーが必ず存在するようにします。
     これは root:wheel の所有にして、モードを 0755 にするよう推奨します。

     </p>
<pre class="programlisting">
     mach1# ls -ld /var/heimdal
     1 drwxr-xr-x  2 root  wheel  512 Nov 30 15:21 /var/heimdal/
     mach1#
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     マスターキーを作ります。これを使って <code class="systemitem">KDC</code> データベースに蓄積される
     principal キーを暗号化します。

     </p>
<pre class="programlisting">
     mach1# kstash
     Master key:
     Verifying password - Master key:
     mach1#
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     <a href="http://netbsd.gw.com/cgi-bin/man-cgi?kadmin+8+NetBSD-5.1+i386">kadmin(8)</a> を使って、 <code class="systemitem">KDC</code> のデータベースを作ります。これには
     "local database" オプションが必要です。

     </p>
<pre class="programlisting">
     mach1# kadmin -l
     kadmin&gt; init FOO.COM
     Realm max ticket life [unlimited]:
     Realm max renewable ticket life [unlimited]:
     kadmin&gt;
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     <code class="systemitem">KDC</code> が動いているシステム用の principal を作ります。
     
     </p>
<pre class="programlisting">
     kadmin&gt; add --random-key host/mach1.foo.com
     Max ticket life [1 day]:
     Max renewable life [1 week]:
     Principal expiration time [never]:
     Password expiration time [never]:
     Attributes []:
     kadmin&gt;
     </pre>
<p>
     </p>

     <p>
     これで principal が作られましたが、これのキーを <code class="systemitem">KDC</code> システムの
     keytab に展開するよう推奨します。

     </p>
<pre class="programlisting">
     kadmin&gt; ext -k /etc/krb5.keytab host/mach1.foo.com
     kadmin&gt;
     </pre>
<p>
     </p>

     <p>
     <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ktutil+8+NetBSD-5.1+i386">ktutil(8)</a> コマンドで、 keytab 中のキーを列挙できます:
     </p>
<pre class="programlisting">
     mach1# ktutil list
     Vno  Type           Principal
       1  des-cbc-crc    host/mach1.foo.com
       1  des-cbc-md4    host/mach1.foo.com
       1  des-cbc-md5    host/mach1.foo.com
       1  des3-cbc-sha1  host/mach1.foo.com
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     Kerberos を使って認証したいユーザーの principal を作ります。

     </p>
<pre class="programlisting">
     kadmin&gt; add joe
     Max ticket life [1 day]:
     Max renewable life [1 week]:
     Principal expiration time [never]:
     Attributes []:
     joe@FOO.COM's Password:
     Verifying password - joe@FOO.COM's Password:
     kadmin&gt;
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     <code class="systemitem">KDC</code> がブート時に起動するよう設定し、 <code class="systemitem">KDC</code> を起動します。

     </p>
<pre class="programlisting">
     mach1# echo "kdc=YES" &gt;&gt; /etc/rc.conf
     mach1# /etc/rc.d/kdc start
     Starting kdc.
     mach1#
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     kadmin (Kerberos administration) と kpasswd (Kerberos password change)
     サーバーを起動するよう inetd を設定します。
     <code class="systemitem">KDC</code> システムの
     <code class="filename">/etc/inetd.conf</code> に、下記の各行が存在するようにします:

     </p>
<pre class="programlisting">
     kerberos-adm stream tcp  nowait root /usr/libexec/kadmind  kadmind
     kerberos-adm stream tcp6 nowait root /usr/libexec/kadmind  kadmind
     kpasswd      dgram  udp  wait   root /usr/libexec/kpasswdd kpasswdd
     kpasswd      dgram  udp6 wait   root /usr/libexec/kpasswdd kpasswdd
     </pre>
<p>
     </p>

     <p>
     <a href="http://netbsd.gw.com/cgi-bin/man-cgi?inetd+8+NetBSD-5.1+i386">inetd(8)</a> に設定を読み直させます。

     </p>
<pre class="programlisting">
     mach1# /etc/rc.d/inetd reload
     Reloading inetd config files.
     mach1#
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     <code class="systemitem">KDC</code> をテストします。
     Kerberos を使って <code class="systemitem">TGT</code> を取得し、
     <code class="systemitem">KDC</code>
     システムに自分自身からログインしてみます。

     </p>
<pre class="programlisting">
     mach1:joe$ kinit
     joe@FOO.COM's Password:
     joe$ klist
     Credentials cache: FILE:/tmp/krb5cc_100
             Principal: joe@FOO.COM

       Issued           Expires          Principal
     Nov 30 14:10:16  Dec  1 00:10:16  krbtgt/FOO.COM@FOO.COM
     Nov 30 14:10:16  Dec  1 00:10:16  krbtgt/FOO.COM@FOO.COM
     mach1:joe$ telnet -ax mach1.foo.com
     Trying 10.0.0.1
     Connected to mach1.foo.com.
     Escape character is '^]'.
     [ Trying KERBEROS5 ... ]
     [ Kerberos V5 accepts you as ``joe@FOO.COM'' ]
     Last login: Thu Nov 30 14:08:33 2000 from mach1
     ...
     mach1:joe$ exit
     Connection closed by foreign host.
     mach1:joe$
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     うまく機能していることが確認できたら、 Kerberos realm
     に参加させる他のホストの principals も追加します。

     </p>
<pre class="programlisting">
     mach1# kadmin -l
     kadmin&gt; add --random-key host/mach2.foo.com
     Max ticket life [1 day]:
     Max renewable life [1 week]:
     Principal expiration time [never]:
     Password expiration time [never]:
     Attributes []:
     kadmin&gt;
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     ここでシステム管理者用の "admin" principal を追加するというのは
     よい考えです。偽装される可能性があるので、 Kerberos の管理をすべて
     root として行うつもりならば "root/admin" principal
     だけを追加します。

     </p>
<pre class="programlisting">
     mach1# kadmin -l
     kadmin&gt; add root/admin
     Max ticket life [1 day]:
     Max renewable life [1 week]:
     Principal expiration time [never]:
     Password expiration time [never]:
     Attributes []:
     root/admin@FOO.COM's Password:
     Verifying password - root/admin@FOO.COM's Password:
     kadmin&gt;
     </pre>
<p>
     </p>

     <p>
     この principal は必ず kadmind ACL に追加しておいてください:

     </p>
<pre class="programlisting">
     mach1# echo "root/admin@FOO.COM all" &gt;&gt; /var/heimdal/kadmind.acl
     mach1#
     </pre>
<p>
     </p>
  </li>
<li class="listitem">
     <p>
     これで "admin" principal ができ、 host/... という principal
     を、そのホスト群が通信するマシン群の keytab に簡単に展開することが
     できます。

     </p>
<pre class="programlisting">
     mach2# kadmin
     kadmin&gt; ext -k /etc/krb5.keytab host/mach2.foo.com
     root/admin@FOO.COM's Password:
     kadmin&gt;
     </pre>
<p>
     </p>

     <p>
     Kerberos を使ってマシンにログインして試してみます。

     </p>
<pre class="programlisting">
     mach1:joe$ telnet -ax mach2.foo.com
     Trying 10.0.0.2
     Connected to mach2.foo.com.
     Escape character is '^]'.
     [ Trying KERBEROS5 ... ]
     [ Kerberos V5 accepts you as ``joe@FOO.COM'' ]
     Last login: Thu Nov 30 16:26:51 2000 from mach1
     ...
     mach2:joe$ exit
     Connection closed by foreign host.
     mach1:joe$
     </pre>
<p>
     </p>
  </li>
</ol></div>

<p>
おめでとうございます! これで Kerberos realm で作業ができるようになりました!
</p>


<h4 class="title">
<a name="win2k"></a>Windows 2000 に対する認証 (<a href="#NetworkingFAQ">top</a>)
  </h4>
<p>
Windows 2000 を使っている場合でも、 NetBSD <code class="systemitem">KDC</code> を
Windows 2000
ホストに対する認証サーバーとして使うことができます。 Windows 2000 は
Kerberos を Windows ドメインログインの認証に使っています。 NetBSD は
Windows 2000 ドメインコントローラーになることはできませんが、
Samba を使うことでワークグループサーバーになることができます。
</p>
<p>
この説明では、サーバー上で Samba がすでに設定済であるものとし、
また、 Windows 2000 ホストはそのサーバーを使うよう設定済で
あるものとします。
</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
     Windows 2000 システムに <span class="emphasis"><em>Supplemental Tools</em></span> を
     インストールしておいてください。これは Windows 2000
     配布メディアに含まれています。
  </li>
<li class="listitem">
     <p>
     <code class="systemitem">KDC</code> で、 Windows 2000 ホスト用の host principal を追加します:

     </p>
<pre class="programlisting">
     mach1# kadmin -l
     kadmin&gt; add host/win2k.foo.com
     Max ticket life [1 day]:
     Max renewable life [1 week]:
     Principal expiration time [never]:
     Password expiration time [never]:
     Attributes []:
     host/win2k.foo.com@FOO.COM's Password: 
     Verifying password - host/win2k.foo.com@FOO.COM's Password: 
     kadmin&gt; 
     </pre>
<p>
     </p>

     <p>
     <span class="bold"><strong>*入力したパスワードを覚えておいてください!*</strong></span> このパスワードは、
     あとで Windows 2000 ホストで再度入力しなければなりません。
     </p>
  </li>
<li class="listitem">
     <p>
     Windows 2000 ホストで、 <span class="command"><strong>ksetup</strong></span> コマンドを使って realm、
     <code class="systemitem">KDC</code> と <span class="emphasis"><em>machine
     password</em></span> エントリーを設定します:

     </p>
<pre class="programlisting">
     C:&gt; ksetup /setdomain FOO.COM
     C:&gt; ksetup /addkdc FOO.COM mach1.foo.com
     C:&gt; ksetup /setmachpassword <span class="emphasis"><em>password</em></span>
     </pre>
<p>
     </p>
  </li>
<li class="listitem"> Windows 2000 システムをリブートします。
  </li>
<li class="listitem">
     <p>
     <span class="command"><strong>ksetup</strong></span> コマンドを使って、 Windows 2000 システムの
     ローカルユーザーを Kerberos principals に対応づけます:

     </p>
<pre class="programlisting">
     C:&gt; ksetup /mapuser * *
     </pre>
<p>
     </p>

     <p>
     以下のようにして、特定のユーザーを特定の Kerberos principals
     に対応させることもできます:

     </p>
<pre class="programlisting">
     C:&gt; ksetup /mapuser user@FOO.COM localuser
     </pre>
<p>
     </p>
  </li>
<li class="listitem"> Windows 2000 システムをリブートします。
  </li>
</ol></div>

<p>
以上のようにすることで、 Windows 2000 システムへのログイン時に
Kerberos realm へのログインができるようになります。ユーザーが
透過的に使えるよう、 Samba パスワードはユーザーの Kerberos
パスワードと同期させておくようにするよう注意してください。
</p>

<p>
Kerberos に関してより詳しい情報は、下記のリンクを参照してください:
</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<a class="ulink" href="http://web.mit.edu/kerberos/www/" target="_top">MIT Kerberos</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://www.pdc.kth.se/kth-krb/" target="_top">KTH Kerberos</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://www.nrl.navy.mil/CCS/people/kenh/kerberos-faq.html" target="_top">Kerberos FAQ</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://members.nbci.com/_XMCM/jtruitt/ferret/kerberos.html" target="_top">Meta information (Links)</a>
  </li>
</ul></div>

<hr>
<h3 class="title">Network の問題</h3>
  <h4 class="title">
<a name="unable-to-ping"></a>他のホスト名に ping できない (<a href="#network-problems">top</a>)
  </h4>
  <p>
    もし、他のマシンに IP アドレスで <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ping+8+NetBSD-5.1+i386">ping(8)</a>
    ("<span class="command"><strong><span class="bold"><strong>ping
    -n <span class="emphasis"><em>W.X.Y.Z</em></span></strong></span></strong></span>") できるのに、ホスト名ではできないのならば、
    <a href="http://netbsd.gw.com/cgi-bin/man-cgi?resolv.conf+5+NetBSD-5.1+i386">resolv.conf(5)</a> に問題がある可能性があります。nameserver が正しく
    設定されているか、サーバーからの応答があるかどうかを確認してください。
  </p>


  <h4 class="title">
<a name="connection-delays"></a>接続に 30秒くらいかかる (<a href="#network-problems">top</a>)
  </h4>
  <p>
    これは通常以下の理由によります。
    </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<a href="http://netbsd.gw.com/cgi-bin/man-cgi?resolv.conf+5+NetBSD-5.1+i386">resolv.conf(5)</a> の設定が間違っているために、指定したネームサーバーからの
	レスポンスがなく、ホスト名探索がタイムアウトを起こしている。
      </li>
<li class="listitem">リモートのメールサーバーが、あなたのマシン上の <a href="http://netbsd.gw.com/cgi-bin/man-cgi?identd+8+NetBSD-5.1+i386">identd(8)</a> に
	接続しようとしているのに、 tcp の 113 番ポートへの
	パケットがレスポンスすることなく落されるように <a href="http://netbsd.gw.com/cgi-bin/man-cgi?ipf+8+NetBSD-5.1+i386">ipf(8)</a> が
	設定されている。
      </li>
</ol></div>
<p>
  </p>
<hr>
<h3 class="title">Other links</h3>
  <h4 class="title">
<a name="linklist"></a>Miscellaneous links (<a href="#otherlinks">top</a>)
  </h4>

<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<a class="ulink" href="../../../docs/guide/en/chap-inetd.html" target="_top">インターネットスーパーサーバー (inetd)</a>
  </li>
<li class="listitem">
<a class="ulink" href="../../../docs/network/nsps/" target="_top">NetBSD Security Processes and Services</a>
  </li>
<li class="listitem">
<a class="ulink" href="../../../docs/network/wavelan.html" target="_top">Lucent WaveLAN を用いたワイヤレスネットワーキング</a>
  </li>
<li class="listitem">
<a class="ulink" href="netboot/" target="_top">HOWTO ディスクレスマシンのネットブート</a>
  </li>
<li class="listitem">
<a class="ulink" href="../../../docs/network/isdn/" target="_top">ISDN での接続手順</a>
  </li>
<li class="listitem">
<a class="ulink" href="gprs.html" target="_top">GPRS / CDPD を使った接続手順</a>
  </li>
<li class="listitem">
<a class="ulink" href="pppoe/" target="_top">PPPoE (DSL) 経由の接続手順</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://coombs.anu.edu.au/~avalon/ip-filter.html" target="_top">IP-Filter</a> を
      用いた<a class="ulink" href="http://www.static.net/~armenb/ipnat.html" target="_top">ネットワーク
      アドレス変換 (Network Address Translation, NAT) FAQ</a>
  </li>
<li class="listitem">
<a class="ulink" href="dhcp.html" target="_top">DHCP クライアントとサーバー設定の HOWTO</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://www.feyrer.de/NetBSD/NWF/" target="_top">
      NetBSD/amiga のためのネットワーキング FAQ ガイド</a>
  </li>
<li class="listitem">
<a class="ulink" href="ipv6/" target="_top">IPv6 ネットワーキング FAQ</a>
  </li>
<li class="listitem">
<a class="ulink" href="ipsec/" target="_top">IPsec FAQ</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://www.macbsd.com/macbsd/howto/index.html" target="_top">
      PPP、クロスコンパイル、その他の HOWTO</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://www.obfuscation.org/ipf/ipf-howto.txt" target="_top">IP Filter ベースの防火壁 HOWTO</a>
  </li>
<li class="listitem">The <a class="ulink" href="ftp://ftp.csl.sony.co.jp/pub/kjc/papers/altq98.ps.gz" target="_top">AltQ Paper</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://caunter.ca/nsupdate.txt" target="_top">nsupdate HOWTO</a>
  </li>
<li class="listitem">
<a class="ulink" href="http://www.public.iastate.edu/~kula/talks/afs-bpw-2005/" target="_top">NetBSD,
      AFS and Kerberos: From Zero to Distributed File System in N
      Easy Steps</a>
  </li>
</ul></div>
</div></div></div>
<div class="navfoot"></div>
<div id="footer"><center>
<span class="footfeed"><a href="http://www.NetBSD.org/cgi-bin/feedback.cgi">
	  連絡</a> |
      </span><span class="footcopy"><a href="../../../ja/about/disclaimer.html">
      免責事項</a> |

      <span class="copyright">Copyright © 1994-2012 The NetBSD Foundation, Inc. </span>ALL RIGHTS RESERVED.<br>NetBSD<sup>®</sup> は The NetBSD
	Foundation, Inc. の登録商標です。</span>
</center></div>
</div></body>
</html>
