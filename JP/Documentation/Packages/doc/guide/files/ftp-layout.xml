<!-- $NetBSD: ftp-layout.xml,v 1.13 2009/10/11 20:50:48 rillig Exp $ -->
<!-- Based on english version: -->
<!-- NetBSD: ftp-layout.xml,v 1.13 2009/10/11 20:50:48 rillig Exp   -->

<appendix id="ftp-layout">
<title>pkgsrc FTP サーバーのディレクトリー配置</title>

	<para>他の大規模プロジェクトと同様に、初心者の方にとって
	pkgsrc のディレクトリー配置は非常に複雑なものです。
	<filename>ftp.NetBSD.org</filename> での基点ディレクトリーは <ulink
	url="ftp://ftp.NetBSD.org/pub/pkgsrc/"><filename>/pub/pkgsrc/</filename></ulink> です。
	他のサーバーでは、基点ディレクトリーの場所は異なるかもしれませんが、
	基点ディレクトリー以下の内容はどのサーバーでもすべて同じはずです。
	このディレクトリーには、以下で説明するような、
	いくつかのサブディレクトリーがあります。</para>

<sect1 id="ftp-distfiles">
<title><filename>distfiles</filename>: ソースファイルの配布物</title>

	<para><filename>distfiles</filename> ディレクトリーは、
	pkgsrc の各パッケージのアーカイブファイルのうち、
	このサーバーにミラーされているものを多数含んでいます。
	配布ファイルのファイル名にバージョン番号が明示的に含まれていなかったり、
	一般的すぎる名前 (たとえば <filename>release.tar.gz</filename>)
	だったりする場合には、パッケージ名を冠したサブディレクトリーが使われます。</para>

</sect1>
<sect1 id="ftp-misc">
<title><filename>misc</filename>: 種々雑多なもの</title>

	<para>このディレクトリーは、
	個々の pkgsrc 開発者がサーバーに置いておく価値があると判断したものを含んでいます。</para>

</sect1>
<sect1 id="ftp-packages">
<title><filename>packages</filename>: バイナリーパッケージ</title>

	<para>このディレクトリーは、
	pkgsrc が対応している各種プラットフォーム用のバイナリーパッケージを含んでいます。
	各プラットフォーム用のサブディレクトリーは <replaceable>OPSYS</replaceable
	>/<replaceable>ARCH</replaceable
	>/<replaceable>OSVERSION_TAG</replaceable
	> のような形式になっています。これらの意味は以下のとおりです。</para>

	<itemizedlist>

	<listitem><para><varname>OPSYS</varname> は、
	当該パッケージが構築された対象のオペレーティングシステム名です。
	この名前は <command>uname</command> コマンドの出力に合わせているので、
	ふだん聞き慣れた名前とは違う名前になっていることがあります。</para></listitem>
	
	<listitem><para><varname>ARCH</varname> は、
	当該パッケージが構築された対象のプラットフォームのハードウェアアーキテクチャー名です。
	<varname>ABI</varname> (Application
	Binary Interface) が複数あるプラットフォームでは、
	<varname>ABI</varname> も含めた名称になっています。</para></listitem>

	<listitem><para><varname>OSVERSION</varname> は、
	オペレーティングシステムのバージョンです。バージョン番号が頻繁に変わる場合
	(たとえば NetBSD-current) は、たとえば
	<literal>4.99.x</literal> のように、頻繁に変わる部分を
	<literal>x</literal> に置き換えています。</para></listitem>

	<listitem><para><varname>TAG</varname> は、安定版の枝の場合は
	<literal>20<replaceable>xx</replaceable>Q<replaceable>y</replaceable></literal>、
	HEAD の場合は <literal>head</literal> です。後者は、
	パッケージが定期的に更新されるものである場合にのみ使います。
	そうでない場合は、たとえば <literal>head_20071015</literal> のように、
	pkgsrc のチェックアウト日を付け加えた形にします。</para></listitem>

	</itemizedlist>

	<para>このような方式となっている理由は、pkgsrc の利用者がバイナリーパッケージを探すときに、
	サーバー上のディレクトリーを辿って、
	自分のマシンに最適なバイナリーパッケージを簡単に見つけられるからです。
	利用者はたいてい、オペレーティングシステムとハードウェアアーキテクチャーを知っているので、
	OPSYS と ARCH を最初にしています。これらを選べば、
	OSVERSION と TAG の最適な組合せを選ぶことができます。
	通常の場合、オペレーティングシステムのバージョンが違っても、
	パッケージには互換性があるからです。</para>

	<para>これらの各ディレクトリーには、
	当該プラットフォーム用のバイナリーパッケージ全体が置かれています。
	<filename>All</filename> というディレクトリーがあり、
	ここにすべてのバイナリーパッケージを含んでいます。
	このほか、カテゴリー別のディレクトリーがあり、
	バイナリーパッケージの実体へのシンボリックリンクを含んでいます。</para>

</sect1>
<sect1 id="ftp-reports">
<title><filename>reports</filename>: バルクビルドの結果報告</title>

	<para>ここには、構築できないプラットフォームがあるパッケージを修正したい方向けに、
	バルクビルドの結果の報告が置いてあります。
	サブディレクトリーの構造は<xref
	linkend="ftp-packages"/>と同じです。</para>

</sect1>
<sect1 id="ftp-source">
<title><filename>current</filename>,
<filename>pkgsrc-20<replaceable>xx</replaceable>Q<replaceable>y</replaceable></filename>:
ソースパッケージ</title>

	<para>このディレクトリーは pkgsrc <quote>そのもの</quote>、つまり、
	ソースアーカイブからバイナリーパッケージを作る方法を定義したファイル一式を含んでいます。</para>

	<para><filename>pkgsrc</filename> ディレクトリーは、
	CVS リポジトリーのスナップショットを含んでおり、定期的に更新されます。
	<filename>pkgsrc.tar.gz</filename> ファイルは、
	このディレクトリーと同じ内容を含んでおり、
	全体をダウンロードできるようになっています。</para>

	<para>四半期ごとの枝用のディレクトリーには、
	さらに
	<filename>pkgsrc-20<replaceable>xx</replaceable>Q<replaceable>y</replaceable>.tar.gz</filename>
	というファイルがあります。
	これは、枝が分岐した時点の状態の pkgsrc を含んでいます。</para>

</sect1>
</appendix>
